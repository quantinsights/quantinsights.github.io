<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>quantdev.blog</title>
<link>https://quantdev.blog/</link>
<atom:link href="https://quantdev.blog/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Fri, 15 Nov 2024 00:00:00 GMT</lastBuildDate>
<item>
  <title>Tridiagonal Systems</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/tridiagonal-systems/</link>
  <description><![CDATA[ 





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The special case of a system of linear equations that is <em>tridiagonal</em>, that is, has non-zero elements only on the diagonal plus or minus one column, is one that occurs frequently. Also common are systems that are <em>band-diagonal</em>, with non-zero elements only along a few diagonal lines adjacent to the main diagonal (above and below).</p>
<p>For triadiagonal sets, the procedures <img src="https://latex.codecogs.com/png.latex?LU">-decomposition, forward- and back- substitution each take only <img src="https://latex.codecogs.com/png.latex?O(n)"> operations and the whole solution can be coded very concisely. In this blog post, I am going to explore solving triadiagonal matrix systems. I closely follow Daniel Duffy’s exposition in <em>Chapter 13</em> of his excellent book <a href="https://www.amazon.co.uk/Financial-Instrument-Pricing-Using-Finance-ebook/dp/B07H51DPQP/ref=sr_1_1?crid=35L1ITLEUA1S&amp;dib=eyJ2IjoiMSJ9.FeGDbbRPp2NQKdDQycirWzCkF5j0TlM92l9p6jCKk-U.9ZQRlCNBa5pshnZTad_fcM8KxN4SyD60z1tCbwwwE-g&amp;dib_tag=se&amp;keywords=Financial+Instrument+Pricing+Using+C%2B%2B&amp;nsdOptOutParam=true&amp;qid=1731655789&amp;sprefix=financial+instrument+pricing+using+c%2B%2B%2Caps%2C177&amp;sr=8-1">Financial Instrument Pricing using C++</a>.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?A"> be a <img src="https://latex.codecogs.com/png.latex?m%20%5Ctimes%20n"> general banded matrix with <img src="https://latex.codecogs.com/png.latex?kl"> subdiagonals and <img src="https://latex.codecogs.com/png.latex?ku"> superdiagonals. Then, <img src="https://latex.codecogs.com/png.latex?a_%7Bij%7D=0">, when <img src="https://latex.codecogs.com/png.latex?%7Ci%20-%20j%7C%20%3E%20kl%20+%20ku%20%20+%201">. All non-zero elements are positioned on the main diagonal, <img src="https://latex.codecogs.com/png.latex?kl"> subdiagonals below it and <img src="https://latex.codecogs.com/png.latex?ku"> superdiagonals above it.</p>
<ul>
<li><p>A <em>diagonal</em> matrix is a <img src="https://latex.codecogs.com/png.latex?n%20%5Ctimes%20n"> band matrix with <img src="https://latex.codecogs.com/png.latex?kl%20=%20ku%20=%200">.</p></li>
<li><p>A <em>Toeplitz</em> matrix is a <img src="https://latex.codecogs.com/png.latex?n%20%5Ctimes%20n"> band matrix <img src="https://latex.codecogs.com/png.latex?T_n=%5Bt_%7Bk,j%7D;k,j=0,1,%5Cldots,n-1%5D"> where <img src="https://latex.codecogs.com/png.latex?t_%7Bk,j%7D=t_%7Bk-j%7D">. That is, a matrix of the form: <img src="https://latex.codecogs.com/png.latex?%0AT_n%20=%20%5Cbegin%7Bbmatrix%7D%0At_0%20&amp;%20t_%7B-1%7D%20&amp;%20t_%7B-2%7D%20&amp;%20%5Cldots%20&amp;%20t_%7B-(n-1)%7D%5C%5C%0At_1%20&amp;%20t_0%20&amp;%20t_%7B-1%7D%20&amp;%20%5Cldots%20&amp;%20t_%7B-(n-2)%7D%5C%5C%0At_2%20&amp;%20t_1%20&amp;%20t_%7B0%7D%20&amp;%20%5Cldots%20&amp;%20t_%7B-(n-3)%7D%5C%5C%0A%5Cvdots%20&amp;%20&amp;%20&amp;%20%5Cddots%20&amp;%20%5C%5C%0At_%7Bn-1%7D%20&amp;%20t_%7Bn-2%7D%20&amp;%20t_%7Bn-3%7D%20&amp;%20%5Cldots%20&amp;%20t_%7B0%7D%0A%5Cend%7Bbmatrix%7D%0A"></p></li>
<li><p>A <em>tridiagonal</em> (Jacobi) matrix is a <img src="https://latex.codecogs.com/png.latex?n%20%5Ctimes%20n"> band matrix of width three <img src="https://latex.codecogs.com/png.latex?kl%20=%20ku%20=%201">. <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0Ab_0%20&amp;%20c_0%20&amp;%200%20&amp;%20%5Cldots%20%5C%5C%0Aa_1%20&amp;%20b_1%20&amp;%20c_1%20&amp;%20%5Cldots%20%5C%5C%0A0%20&amp;%20a_2%20&amp;%20b_2%20&amp;%20%5Cldots%20%5C%5C%0A&amp;%20&amp;%20&amp;%20%5Cldots%20%5C%5C%0A&amp;%20&amp;%20&amp;%20%5Cldots%20&amp;%20a_%7Bn-2%7D%20&amp;%20b_%7Bn-2%7D%20&amp;%20c_%7Bn-2%7D%5C%5C%0A&amp;%20&amp;%20&amp;%20%5Cldots%20&amp;%200%20&amp;%20a_%7Bn-1%7D%20&amp;%20b_%7Bn-1%7D%0A%5Cend%7Bbmatrix%7D%0A"></p></li>
</ul>
<p>Consider a two-point boundary value problem on the interval <img src="https://latex.codecogs.com/png.latex?(0,1)"> with Dirichlet boundary conditions:</p>
<p><span id="eq-two-point-bvp"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7Bd%5E2%20u%7D%7Bd%20x%5E2%7D%20&amp;=%20f(x),%20%5Cquad%200%20%3C%20x%20%3C%201%5C%5C%0Au(0)%20&amp;=%20%5Cphi,%20%5C%5C%0Au(1)%20&amp;=%20%5Cpsi%0A%5Cend%7Balign*%7D%0A%5Ctag%7B1%7D"></span></p>
<p>We approximate the solution <img src="https://latex.codecogs.com/png.latex?u"> by creating a <em>discrete mesh of points</em> defined by <img src="https://latex.codecogs.com/png.latex?%5C%7Bx_j%5C%7D">, <img src="https://latex.codecogs.com/png.latex?j=0,%5Cldots,N"> where <img src="https://latex.codecogs.com/png.latex?N"> is a positive integer. At each interior mesh point the second derivative in the Equation&nbsp;1 can be approximated by a second-order divided difference. The corresponding discrete scheme is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bmatrix%7D%0AU_0%20&amp;-%202U_1%20&amp;+%20U_2%20&amp;%20&amp;%20&amp;%20&amp;%20&amp;%20&amp;%20&amp;%20&amp;=%20h%5E2%20f_1%20%5C%5C%0A&amp;%20U_1%20&amp;-%202U_2%20&amp;+%20U_3%20%20&amp;%20&amp;%20&amp;%20&amp;%20&amp;%20&amp;%20&amp;=%20h%5E2%20f_2%20%5C%5C%0A&amp;%20&amp;%20U_2%20&amp;-%202U_3%20&amp;+%20U_4%20&amp;%20&amp;%20&amp;%20&amp;%20&amp;%20&amp;=%20h%5E2%20f_3%20%5C%5C%0A&amp;%20&amp;%20%20%20%20%20&amp;%20%20%20%20%20%20%20&amp;%20%20%20%20%20%20&amp;%20%5Cldots%20&amp;%20&amp;%20&amp;%20&amp;%20&amp;%20%5Cvdots%20%5C%5C%0A&amp;%20&amp;%20%20%20%20%20&amp;%20%20%20%20%20%20%20&amp;%20%20%20%20%20%20&amp;%20%5Cldots%20&amp;%20U_%7BN-3%7D%20&amp;-%202U_%7BN-2%7D%20&amp;+%20U_%7BN-1%7D%20&amp;%20%20&amp;=%20h%5E2%20f_%7BN-2%7D%5C%5C%0A&amp;%20&amp;%20%20%20%20%20&amp;%20%20%20%20%20%20%20&amp;%20%20%20%20%20%20&amp;%20%5Cldots%20&amp;%20%20&amp;%20U_%7BN-2%7D%20&amp;-2%20U_%7BN-1%7D%20&amp;+%20U_N%20&amp;=%20h%5E2%20f_%7BN-1%7D%5C%5C%0A%5Cend%7Bmatrix%7D%0A"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?U_0%20=%20%5Cphi"> and <img src="https://latex.codecogs.com/png.latex?U_N%20=%20%5Cpsi">, we have <img src="https://latex.codecogs.com/png.latex?N-1"> equations in <img src="https://latex.codecogs.com/png.latex?%7BN-1%7D"> unknowns. These can be arranged in the matrix form as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A-2%20&amp;%201%5C%5C%0A1%20%20&amp;-2%20&amp;%201%20%20&amp;%20%20%20&amp;%20%5Cldots%20&amp;%20%20%20&amp;%20%20%20%20&amp;%20%20%5C%5C%0A%20%20%20&amp;%201%20&amp;-2%20%20&amp;%201%20&amp;%20%5Cldots%20&amp;%20%20%20&amp;%20%20%20%20&amp;%20%20%5C%5C%0A%20%20%20&amp;%20%20%20&amp;%20%20%20%20&amp;%20%20%20&amp;%20%5Cldots%20&amp;%20%20%20&amp;%20%20%20%20&amp;%20%20%5C%5C%0A%20%20%20&amp;%20%20%20&amp;%20%20%20%20&amp;%20%20%20&amp;%20%5Cldots%20&amp;%201%20&amp;%20-2%20&amp;%201%20%5C%5C%0A%20%20%20&amp;%20%20%20&amp;%20%20%20%20&amp;%20%20%20&amp;%20%5Cldots%20&amp;%20%20%20&amp;%20%201%20&amp;%20-2%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%0AU_1%20%5C%5C%0AU_2%20%5C%5C%0A%5Cvdots%5C%5C%0AU_%7BN-2%7D%20%5C%5C%0AU_%7BN-1%7D%0A%5Cend%7Bbmatrix%7D%20=%20%5Cbegin%7Bbmatrix%7D%0Ah%5E2%20f_1%20-%20%5Cphi%5C%5C%0Ah%5E2%20f_2%20%5C%5C%0A%5Cvdots%5C%5C%0Ah%5E2%20f_%7BN-2%7D%20%5C%5C%0Ah%5E2%20f_%7BN-1%7D%20-%20%5Cpsi%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>or in matrix form <img src="https://latex.codecogs.com/png.latex?AU=F">.</p>
</section>
<section id="thomas-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="thomas-algorithm">Thomas Algorithm</h2>
<p>The Thomas algorithm is an efficient way of solving tridiagonal matrix systems. It is based on <img src="https://latex.codecogs.com/png.latex?LU">-decomposition in which the matrix system <img src="https://latex.codecogs.com/png.latex?Ax=r"> is written as <img src="https://latex.codecogs.com/png.latex?LUx=r">, where <img src="https://latex.codecogs.com/png.latex?L"> is a lower-triangular matrix and <img src="https://latex.codecogs.com/png.latex?U"> is an upper triangular matrix. The system can be efficiently solved by setting <img src="https://latex.codecogs.com/png.latex?Ux=%5Crho"> and then solving first <img src="https://latex.codecogs.com/png.latex?L%5Crho=r"> and then <img src="https://latex.codecogs.com/png.latex?Ux=%5Crho"> for <img src="https://latex.codecogs.com/png.latex?x">. The Thomas algorithm consists of two steps. In step 1, decomposing the matrix <img src="https://latex.codecogs.com/png.latex?M%20=%20LU"> and solving <img src="https://latex.codecogs.com/png.latex?L%5Crho=r"> are accomplished in a single downwards sweep, taking us straight from <img src="https://latex.codecogs.com/png.latex?Ax=r"> to <img src="https://latex.codecogs.com/png.latex?Ux=%5Crho">. In step 2, the equation <img src="https://latex.codecogs.com/png.latex?Ux%20=%20%5Crho"> is solved for <img src="https://latex.codecogs.com/png.latex?x"> in an upward sweep.</p>
<section id="stage-1" class="level3">
<h3 class="anchored" data-anchor-id="stage-1">Stage 1</h3>
<p>In the first stage, the matrix equation <img src="https://latex.codecogs.com/png.latex?Ax=r"> is converted to the form <img src="https://latex.codecogs.com/png.latex?Ux=%5Crho">. Initially, the matrix equation looks like this:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A%7B%5Ccolor%7Bblue%7Db_1%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Dc_1%7D%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A%7B%5Ccolor%7Bblue%7Da_2%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Db_2%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Dc_2%7D%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%20%7B%5Ccolor%7Bblue%7Da_3%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Db_3%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Dc_3%7D%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%20%7B%5Ccolor%7Bblue%7Da_4%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Db_4%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Dc_4%7D%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%20%7B%5Ccolor%7Bblue%7Da_5%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Db_5%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Dc_5%7D%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%20a_6%20&amp;%20b_6%0A%5Cend%7Bbmatrix%7D%20%5Cbegin%7Bbmatrix%7D%0Ax_1%20%5C%5C%0Ax_2%20%5C%5C%0Ax_3%20%5C%5C%0Ax_4%20%5C%5C%0Ax_5%20%5C%5C%0Ax_6%0A%5Cend%7Bbmatrix%7D%20=%0A%5Cbegin%7Bbmatrix%7D%0A%7B%5Ccolor%7Bblue%7Dr_1%7D%20%5C%5C%0A%7B%5Ccolor%7Bblue%7Dr_2%7D%20%5C%5C%0A%7B%5Ccolor%7Bblue%7Dr_3%7D%20%5C%5C%0A%7B%5Ccolor%7Bblue%7Dr_4%7D%20%5C%5C%0A%7B%5Ccolor%7Bblue%7Dr_5%7D%20%5C%5C%0A%7B%5Ccolor%7Bblue%7Dr_6%7D%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>Row <img src="https://latex.codecogs.com/png.latex?1">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7B%5Ccolor%7Bblue%7Db_1%7D%20x_1%20+%20%7B%5Ccolor%7Bblue%7Dc_1%7D%20x_2%20=%20%7B%5Ccolor%7Bblue%7Dr_1%7D%0A"></p>
<p>Dividing throughout by <img src="https://latex.codecogs.com/png.latex?%5Ccolor%7Bblue%7Db_1">,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_1%20+%20%7B%5Ccolor%7Bblue%7D%5Cfrac%7Bc_1%7D%7Bb_1%7D%7D%20x_2%20=%20%7B%5Ccolor%7Bblue%7D%5Cfrac%7Br_1%7D%7Bb_1%7D%7D%0A"></p>
<p>Rewrite:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_1%20+%20%7B%5Ccolor%7Bred%7D%5Cgamma_1%7D%20x_2%20=%20%7B%5Ccolor%7Bred%7D%5Crho_1%7D,%20%5Cquad%20%7B%5Ccolor%7Bred%7D%5Cgamma_1%7D%20=%20%7B%5Ccolor%7Bblue%7D%5Cfrac%7Bc_1%7D%7Bb_1%7D%7D,%20%5Cquad%20%7B%5Ccolor%7Bred%7D%5Crho_1%7D%20=%20%7B%5Ccolor%7Bblue%7D%5Cfrac%7Br_1%7D%7Bb_1%7D%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A%7B%5Ccolor%7Bred%7D1%7D%20&amp;%20%7B%5Ccolor%7Bred%7D%5Cgamma_1%7D%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A%7B%5Ccolor%7Bblue%7Da_2%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Db_2%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Dc_2%7D%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%20%7B%5Ccolor%7Bblue%7Da_3%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Db_3%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Dc_3%7D%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%20%7B%5Ccolor%7Bblue%7Da_4%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Db_4%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Dc_4%7D%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%20%7B%5Ccolor%7Bblue%7Da_5%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Db_5%7D%20&amp;%20%7B%5Ccolor%7Bblue%7Dc_5%7D%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%20a_6%20&amp;%20b_6%0A%5Cend%7Bbmatrix%7D%20%5Cbegin%7Bbmatrix%7D%0Ax_1%20%5C%5C%0Ax_2%20%5C%5C%0Ax_3%20%5C%5C%0Ax_4%20%5C%5C%0Ax_5%20%5C%5C%0Ax_6%0A%5Cend%7Bbmatrix%7D%20=%0A%5Cbegin%7Bbmatrix%7D%0A%7B%5Ccolor%7Bred%7D%5Crho_1%7D%20%5C%5C%0A%7B%5Ccolor%7Bblue%7Dr_2%7D%20%5C%5C%0A%7B%5Ccolor%7Bblue%7Dr_3%7D%20%5C%5C%0A%7B%5Ccolor%7Bblue%7Dr_4%7D%20%5C%5C%0A%7B%5Ccolor%7Bblue%7Dr_5%7D%20%5C%5C%0A%7B%5Ccolor%7Bblue%7Dr_6%7D%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>Row <img src="https://latex.codecogs.com/png.latex?2">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7B%5Ccolor%7Bblue%7Da_2%7D%20x_1%20+%20%7B%5Ccolor%7Bblue%7Db_2%7D%20x_2%20+%20%7B%5Ccolor%7Bblue%7Dc_2%7D%20x_3%20=%20%7B%5Ccolor%7Bblue%7Dr_2%7D%0A"></p>
<p>Use <img src="https://latex.codecogs.com/png.latex?a_2"> times row <img src="https://latex.codecogs.com/png.latex?1"> of the matrix to eliminate the first term</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aa_2(x_1%20+%20%7B%5Ccolor%7Bred%7D%5Cgamma_1%7Dx_2%20=%20%7B%5Ccolor%7Bred%7D%5Crho_1%7D)%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Barray%7D%7Bc%7Ccccc%7D%0A%5Ctext%7BRow%202%7D%20&amp;%20a_2%20x_1%20&amp;+%20b_2%20x_2%20&amp;+%20c_2%20x_3%20&amp;=%20r_2%5C%5C%0Aa_2%20%5Ctimes%20%5Ctext%7BRow%201%7D%20&amp;%20a_2%20x_1%20&amp;+%20a_2%20%5Cgamma_1%20x_2%20&amp;%20&amp;=%20a_2%5Crho_1%5C%5C%0A%5Chline%0A%5Ctext%7BNew%20Row%202%7D%20&amp;%20&amp;%20(b_2%20-%20a_2%20%5Cgamma_1)%20x_2%20&amp;+%20c_2%20x_3%20%20&amp;=%20r_2%20-%20a_2%20%5Crho_1%0A%5Cend%7Barray%7D%0A"></p>
<p>Dividing throughout by <img src="https://latex.codecogs.com/png.latex?(b_2%20-%20a_2%20%5Cgamma_1)">, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_2%20+%20%5Cfrac%7Bc_2%7D%7Bb_2%20-%20a_2%20%5Cgamma_1%7Dx_3%20=%20%5Cfrac%7B(r_2%20-%20a_2%20%5Crho_1)%7D%7B(b_2%20-%20a_2%20%5Cgamma_1)%7D%0A"></p>
<p>We can rewrite this as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_2%20+%20%5Cgamma_2%20x_3%20=%20%5Crho_2,%20%5Cquad%20%5Cgamma_2%20=%20%5Cfrac%7Bc_2%7D%7Bb_2%20-%20a_2%20%5Cgamma_1%7D,%20%5Cquad%20%5Crho_2%20=%20%5Cfrac%7B(r_2%20-%20a_2%20%5Crho_1)%7D%7B(b_2%20-%20a_2%20%5Cgamma_1)%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%20%5Cgamma_1%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%20%5Cgamma_2%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%20a_3%20&amp;%20b_3%20&amp;%20c_3%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%20a_4%20&amp;%20b_4%20&amp;%20c_4%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%20a_5%20&amp;%20b_5%20&amp;%20c_5%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%20a_6%20&amp;%20b_6%0A%5Cend%7Bbmatrix%7D%20%5Cbegin%7Bbmatrix%7D%0Ax_1%20%5C%5C%0Ax_2%20%5C%5C%0Ax_3%20%5C%5C%0Ax_4%20%5C%5C%0Ax_5%20%5C%5C%0Ax_6%0A%5Cend%7Bbmatrix%7D%20=%0A%5Cbegin%7Bbmatrix%7D%0A%5Crho_1%20%5C%5C%0A%5Crho_2%20%5C%5C%0Ar_3%20%5C%5C%0Ar_4%20%5C%5C%0Ar_5%20%5C%5C%0Ar_6%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>Row <img src="https://latex.codecogs.com/png.latex?3">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aa_3%20x_2%20+%20b_3%20x_3%20+%20c_3%20x_4%20=%20r_3%0A"></p>
<p>Use <img src="https://latex.codecogs.com/png.latex?a_3"> times row <img src="https://latex.codecogs.com/png.latex?2"> of the matrix to eliminate the first term:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Barray%7D%7Bc%7Ccccc%7D%0A%5Ctext%7BRow%203%7D%20&amp;%20a_3%20x_2%20&amp;+%20b_3%20x_3%20&amp;+%20c_3%20x_4%20&amp;=%20r_3%5C%5C%0Aa_3%20%5Ctimes%20%5Ctext%7BRow%202%7D%20&amp;%20a_3%20x_2%20&amp;+%20a_3%20%5Cgamma_2%20x_3%20&amp;%20&amp;=%20a_3%5Crho_2%5C%5C%0A%5Chline%0A%5Ctext%7BNew%20Row%203%7D%20&amp;%20&amp;%20(b_3%20-%20a_3%20%5Cgamma_2)%20x_3%20&amp;+%20c_3%20x_4%20%20&amp;=%20r_3%20-%20a_3%20%5Crho_2%0A%5Cend%7Barray%7D%0A"></p>
<p>Dividing throughout by <img src="https://latex.codecogs.com/png.latex?(b_3%20-%20a_3%20%5Cgamma_2)">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_3%20+%20%5Cfrac%7Bc_3%7D%7Bb_3%20-%20a_3%20%5Cgamma_2%7D%20x_4%20=%20%5Cfrac%7Br_3%20-%20a_3%5Crho_2%7D%7Bb_3%20-%20a_3%20%5Cgamma_2%7D%0A"></p>
<p>We can rewrite this as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_3%20+%20%5Cgamma_3%20x_4%20=%20%5Crho_3,%20%5Cquad%20%20%5Cgamma_3%20=%20%5Cfrac%7Bc_3%7D%7Bb_3%20-%20a_3%20%5Cgamma_2%7D,%20%5Cquad%20%5Crho_3=%5Cfrac%7Br_3%20-%20a_3%20%5Crho_2%7D%7Bb_3%20-%20a_3%20%5Cgamma_2%7D%0A"></p>
<p>Continuing in this fashion, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%20%5Cgamma_1%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%20%5Cgamma_2%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%201%20&amp;%20%5Cgamma_3%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%201%20&amp;%20%5Cgamma_4%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%201%20&amp;%20%5Cgamma_5%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%20a_6%20&amp;%20b_6%0A%5Cend%7Bbmatrix%7D%20%5Cbegin%7Bbmatrix%7D%0Ax_1%20%5C%5C%0Ax_2%20%5C%5C%0Ax_3%20%5C%5C%0Ax_4%20%5C%5C%0Ax_5%20%5C%5C%0Ax_6%0A%5Cend%7Bbmatrix%7D%20=%0A%5Cbegin%7Bbmatrix%7D%0A%5Crho_1%20%5C%5C%0A%5Crho_2%20%5C%5C%0A%5Crho_3%20%5C%5C%0A%5Crho_4%20%5C%5C%0A%5Crho_5%20%5C%5C%0Ar_6%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>Row <img src="https://latex.codecogs.com/png.latex?6">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aa_6%20x_5%20+%20a_6%20x_6%20=%20r_6%0A"></p>
<p>Use <img src="https://latex.codecogs.com/png.latex?a_6"> times row 5 of the matrix:</p>
<p><img src="https://latex.codecogs.com/png.latex?a_6(x_5%20+%20%5Cgamma_5%20x_6%20=%20%5Crho_5)"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Barray%7D%7Bc%7Ccccc%7D%0A%5Ctext%7BRow%206%7D%20&amp;%20a_6%20x_5%20&amp;+%20b_6%20x_6%20&amp;=%20r_6%5C%5C%0Aa_6%20%5Ctimes%20%5Ctext%7BRow%205%7D%20&amp;%20a_6%20x_5%20&amp;+%20a_6%20%5Cgamma_5%20x_6%20%20&amp;=%20a_6%5Crho_5%5C%5C%0A%5Chline%0A%5Ctext%7BNew%20Row%203%7D%20&amp;%20&amp;%20(b_6%20-%20a_6%20%5Cgamma_5)%20x_6%20%20&amp;=%20r_6%20-%20a_6%20%5Crho_5%0A%5Cend%7Barray%7D%0A"></p>
<p>Dividing throughout by <img src="https://latex.codecogs.com/png.latex?(b_6%20-%20a_6%20%5Cgamma_5)">, we can rewrite:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_6%20=%20%5Crho_6,%20%5Cquad%20%5Crho_6%20=%20%5Cfrac%7Br_6%20-%20a_6%20%5Crho_5%7D%7Bb_6%20-%20a_6%20%5Cgamma_5%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%20%5Cgamma_1%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%20%5Cgamma_2%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%201%20&amp;%20%5Cgamma_3%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%201%20&amp;%20%5Cgamma_4%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%201%20&amp;%20%5Cgamma_5%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%201%0A%5Cend%7Bbmatrix%7D%20%5Cbegin%7Bbmatrix%7D%0Ax_1%20%5C%5C%0Ax_2%20%5C%5C%0Ax_3%20%5C%5C%0Ax_4%20%5C%5C%0Ax_5%20%5C%5C%0Ax_6%0A%5Cend%7Bbmatrix%7D%20=%0A%5Cbegin%7Bbmatrix%7D%0A%5Crho_1%20%5C%5C%0A%5Crho_2%20%5C%5C%0A%5Crho_3%20%5C%5C%0A%5Crho_4%20%5C%5C%0A%5Crho_5%20%5C%5C%0A%5Crho_6%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>These steps may be summarized as compute the following sequences:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cgamma_1%20=%20%5Cfrac%7Bc_1%7D%7Bb_1%7D,%20%5Cquad%20%5Crho_1%20=%20%5Cfrac%7Br_1%7D%7Bb_1%7D%0A"></p>
<p>And <img src="https://latex.codecogs.com/png.latex?%5Cgamma_j%20=%20%5Cfrac%7Bc_j%7D%7Bb_j%20-%20a_j%20%5Cgamma_%7Bj-1%7D%7D,%20%5Cquad%20%5Crho_j%20=%20%5Cfrac%7Br_j%20-%20a_j%20%5Crho_%7Bj-1%7D%7D%7Bb_j%20-%20a_j%20%5Cgamma_%7Bj-1%7D%7D"></p>
<p>for <img src="https://latex.codecogs.com/png.latex?j=2:6">.</p>
<p>At this point, the matrix has been reduced to the upper diagonal form, so our equations are of the form <img src="https://latex.codecogs.com/png.latex?Ux%20=%20%5Crho">.</p>
</section>
<section id="stage-2" class="level3">
<h3 class="anchored" data-anchor-id="stage-2">Stage 2</h3>
<p>The matrix is now in a form which is trivial to solve for <img src="https://latex.codecogs.com/png.latex?x">. We start with the last row and work our way up. The final equation is already solved.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_6%20=%20%5Crho_6%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%20%5Cgamma_1%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%20%5Cgamma_2%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%201%20&amp;%20%5Cgamma_3%20&amp;%200%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%201%20&amp;%20%5Cgamma_4%20&amp;%200%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%201%20&amp;%20%5Cgamma_5%5C%5C%0A0%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%201%0A%5Cend%7Bbmatrix%7D%20%5Cbegin%7Bbmatrix%7D%0Ax_1%20%5C%5C%0Ax_2%20%5C%5C%0Ax_3%20%5C%5C%0Ax_4%20%5C%5C%0Ax_5%20%5C%5C%0Ax_6%0A%5Cend%7Bbmatrix%7D%20=%0A%5Cbegin%7Bbmatrix%7D%0A%5Crho_1%20%5C%5C%0A%5Crho_2%20%5C%5C%0A%5Crho_3%20%5C%5C%0A%5Crho_4%20%5C%5C%0A%5Crho_5%20%5C%5C%0A%5Crho_6%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>Row <img src="https://latex.codecogs.com/png.latex?5">: <img src="https://latex.codecogs.com/png.latex?%0Ax_5%20+%20%5Cgamma_5%20x_6%20=%20%5Crho_5%0A"></p>
<p>Rearrange to get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_5%20=%20%5Crho_5%20-%20%5Cgamma_5%20x_6%0A"></p>
<p>Row <img src="https://latex.codecogs.com/png.latex?4">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_4%20+%20%5Cgamma_4%20x_5%20=%20%5Crho_4%0A"></p>
<p>Rearrange to get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_4%20=%20%5Crho_4%20-%20%5Cgamma_4%20x_5%0A"></p>
<p>Continuing in this fashion, we find that, <img src="https://latex.codecogs.com/png.latex?x_6%20=%20%5Crho_6"> and</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ax_j%20=%20%5Crho_j%20-%20%5Cgamma_j%20x_%7Bj+1%7D%0A"></p>
<p>for all <img src="https://latex.codecogs.com/png.latex?j=1:5">.</p>
</section>
</section>
<section id="computational-solution" class="level2">
<h2 class="anchored" data-anchor-id="computational-solution">Computational Solution</h2>
<p>Let’s quickly code up the algorithm in Julia.</p>
<div id="00559260" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">thomasAlgorithm</span>(a, b, c, r)</span>
<span id="cb1-2">    N <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">size</span>(a)[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-3"></span>
<span id="cb1-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Stage 1</span></span>
<span id="cb1-5">    γ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Array</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{Float64,1}</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">undef</span>,N)</span>
<span id="cb1-6">    ρ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Array</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{Float64,1}</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">undef</span>,N)</span>
<span id="cb1-7">    u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Array</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{Float64,1}</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">undef</span>,N)</span>
<span id="cb1-8"></span>
<span id="cb1-9">    γ[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> c[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>b[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-10">    ρ[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>b[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-11"></span>
<span id="cb1-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>N</span>
<span id="cb1-13">        γ[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> c[j]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(b[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> γ[j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-14">        ρ[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (r[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> ρ[j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(b[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> γ[j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb1-16"></span>
<span id="cb1-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Stage 2</span></span>
<span id="cb1-18">    u[N] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  ρ[N]</span>
<span id="cb1-19"></span>
<span id="cb1-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reverse</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-21">        u[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ρ[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> γ[j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> u[j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb1-23"></span>
<span id="cb1-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> u</span>
<span id="cb1-25"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test Case</span></span>
<span id="cb1-28"></span>
<span id="cb1-29">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Array</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{Float64,1}</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb1-30">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Array</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{Float64,1}</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb1-31">c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Array</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{Float64,1}</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb1-32">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Array</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{Float64,1}</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>])</span>
<span id="cb1-33">u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">thomasAlgorithm</span>(a, b, c, r)</span>
<span id="cb1-34"></span>
<span id="cb1-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(u)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[2.0, 3.0, 1.9999999999999996, 1.0000000000000004]</code></pre>
</div>
</div>
<p>Here is an implementation in modern C++:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb3-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb3-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;memory&gt;</span></span>
<span id="cb3-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;functional&gt;</span></span>
<span id="cb3-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;concepts&gt;</span></span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb3-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">concept</span> Real <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>integral<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>floating_point<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;;</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb3-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">requires</span> Real<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb3-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">using</span> Function <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;)&gt;;</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb3-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">requires</span> Real<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb3-15"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> thomasAlgorithm<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb3-16">      <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> a</span>
<span id="cb3-17">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> b</span>
<span id="cb3-18">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> c</span>
<span id="cb3-19">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> r</span>
<span id="cb3-20">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span>x </span>
<span id="cb3-21">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb3-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Stage-1</span></span>
<span id="cb3-23">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> N <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb3-24">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> gamma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb3-25">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> rho<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb3-26">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb3-27"></span>
<span id="cb3-28">    gamma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]/</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span> </span>
<span id="cb3-29">    rho<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]/</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb3-30"></span>
<span id="cb3-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-32">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb3-33">        gamma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]/(</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> gamma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]);</span></span>
<span id="cb3-34">        rho<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> rho<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">])/(</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> gamma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]);</span></span>
<span id="cb3-35">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-36"></span>
<span id="cb3-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Stage-2</span></span>
<span id="cb3-38">    x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rho<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb3-39">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>N<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--)</span></span>
<span id="cb3-40">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb3-41">        x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rho<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gamma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb3-42">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-43"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-44"></span>
<span id="cb3-45"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb3-46"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">requires</span> Real<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb3-47"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> LUTridiagonalSolver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb3-48">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">private</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb3-49">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-50">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-51">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_c</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-52">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_r</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-53">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-54">        Function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_LUTridiagonalSolverStrategy</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-55">    </span>
<span id="cb3-56">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb3-57">        LUTridiagonalSolver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">default</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-58">        LUTridiagonalSolver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb3-59">              <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> a</span>
<span id="cb3-60">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> b</span>
<span id="cb3-61">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> c</span>
<span id="cb3-62">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> r</span>
<span id="cb3-63">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> Function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> solver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span id="cb3-64">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_a</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)}</span></span>
<span id="cb3-65">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_b</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)}</span></span>
<span id="cb3-66">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_c</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)}</span></span>
<span id="cb3-67">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_r</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)}</span></span>
<span id="cb3-68">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_LUTridiagonalSolverStrategy</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>solver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> </span>
<span id="cb3-69">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span></span>
<span id="cb3-70"></span>
<span id="cb3-71">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> solve<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb3-72">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_LUTridiagonalSolverStrategy</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_a</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_b</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_c</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_r</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb3-73">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">m_x</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-74">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-75"></span>
<span id="cb3-76">        LUTridiagonalSolver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> LUTridiagonalSolver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-77">        LUTridiagonalSolver <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>LUTridiagonalSolver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-78">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>LUTridiagonalSolver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){}</span></span>
<span id="cb3-79"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb3-80"></span>
<span id="cb3-81"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb3-82"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb3-83">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb3-84">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb3-85">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb3-86">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb3-87"></span>
<span id="cb3-88">    LUTridiagonalSolver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> solver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> thomasAlgorithm<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;);</span></span>
<span id="cb3-89">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> u <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> solver<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>solve<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb3-90">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-91"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><a href="https://godbolt.org/z/T7846WY8v">Compiler Explorer</a></p>
</section>
<section id="deriving-the-one-dimensional-heat-equation" class="level2">
<h2 class="anchored" data-anchor-id="deriving-the-one-dimensional-heat-equation">Deriving the one-dimensional Heat equation</h2>
<p>Consider a slender homogenous rod, lying along the <img src="https://latex.codecogs.com/png.latex?x">-axis and insulated, so that no heat can escape across its longitudinal surface. In addition, we make the simplifying assumption that the temperature in the rod is constant on each cross-section perpendicular to the <img src="https://latex.codecogs.com/png.latex?x">-axis, and thus that the flow of heat in the rod takes place only in the <img src="https://latex.codecogs.com/png.latex?x">-direction.</p>
<p>Consider a small segment of the rod at position <img src="https://latex.codecogs.com/png.latex?x"> of length <img src="https://latex.codecogs.com/png.latex?%5CDelta%20x">.</p>
<p>The thermal energy in this segment at time <img src="https://latex.codecogs.com/png.latex?t"> is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AE(x,x+%5CDelta%20x,%20t)%20%5Capprox%20u(x,t)%20s%20%5Crho%20%5CDelta%20x%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?s"> is the constant of specific heat i.e.&nbsp;amount of heat required to raise one unit of mass by one unit of temperature, <img src="https://latex.codecogs.com/png.latex?%5Crho"> is the mass density.</p>
<p>Fourier’s law of heat conduction quantifies the idea that heat flows from warmer to colder regions and states that the (rightward) heat flux density <img src="https://latex.codecogs.com/png.latex?%5Cphi(x,t)"> (the flow of heat energy per unit area per unit time, SI units <img src="https://latex.codecogs.com/png.latex?J/s/m%5E2">) at any point is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cphi(x,t)%20=%20-K_0%20u_x%20(x,%20t)%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?K_0"> is the thermal conductivity of the rod. The negative sign shows that the heat flows from higher temperature regions to colder temperature regions.</p>
<p>Appealing to the law of conservation of energy:</p>
<p><span id="eq-heat-content"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cunderbrace%7B%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7D(u(x,t)%20s%20%5Crho%20%5CDelta%20x)%7D_%7B%5Ctext%7BHeat%20flux%20through%20segment%7D%7D%20=%20%5Cunderbrace%7B(-K_0%20u_x(x,%20t))%7D_%7B%5Ctext%7BFlux%20in%7D%7D%20-%20%5Cunderbrace%7B(-%20K_0%20u_x(x%20+%20%5CDelta%20x,t))%7D_%7B%5Ctext%7BFlux%20out%7D%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B2%7D"></span></p>
<p>Dividing throughout by <img src="https://latex.codecogs.com/png.latex?%5CDelta%20x"> we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Au_t(x,t)%20%5Capprox%20%5Cfrac%7BK_0%7D%7Bs%20%5Crho%20%7D%20%5Cfrac%7Bu_x(x+%5CDelta%20x,%20t)%20-%20u_x(x,t)%7D%7B%5CDelta%20x%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Letting <img src="https://latex.codecogs.com/png.latex?%5CDelta%20x%20%5Cto%200"> improves the approximation and leads to the heat equation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Au_t=c%5E2%20u_%7Bxx%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?c%5E2%20=%20%5Cfrac%7BK_0%7D%7B%5Crho%20s%7D"> is called the <em>thermal diffusivity</em>.</p>
</section>
<section id="the-crank-nicolson-and-theta-methods" class="level2">
<h2 class="anchored" data-anchor-id="the-crank-nicolson-and-theta-methods">The Crank-Nicolson and Theta methods</h2>
<p>Consider the initial boundary value problem for the <img src="https://latex.codecogs.com/png.latex?1">d-heat equation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Au_t%20&amp;=%20a%5E2%20u_%7Bxx%7D,%20%5Cquad%20&amp;%200%20%3C%20x%20%3C%20L,%20t%3E0%5C%5C%0Au(x,0)%20&amp;=%20f(x),%20%5Cquad%200%20%5Cleq%20x%20%5Cleq%20L%20%5C%5C%0Au(0,t)%20&amp;=%20A,%20%5C%5C%0Au(L,t)%20&amp;=%20B%0A%5Cend%7Balign*%7D%0A"></p>
<p>In this case, we can assume without the loss of generality that <img src="https://latex.codecogs.com/png.latex?L%20=%201">. Here, <img src="https://latex.codecogs.com/png.latex?a">, <img src="https://latex.codecogs.com/png.latex?A"> and <img src="https://latex.codecogs.com/png.latex?B"> are constants.</p>
<p>We find a solution to this system in the case when <img src="https://latex.codecogs.com/png.latex?A%20=%20B%20=%200"> and <img src="https://latex.codecogs.com/png.latex?a%20=%201"> by the <em>method of the separation of variables</em>. In this case, the analytical solution is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Au(x,t)%20=%20%5Cfrac%7B8%7D%7B%5Cpi%5E2%7D%5Csum_%7Bn=1%7D%5E%7B%5Cinfty%7D%5Cfrac%7B1%7D%7Bn%5E2%7D%5Csin%5Cleft(%5Cfrac%7Bn%5Cpi%7D%7B2%7D%5Cright)%5Csin(n%5Cpi%20x)%5Cexp(-n%5E2%20%5Cpi%5E2%20t)%0A"></p>
<p>and we are going to use this solution as a benchmark against which the numerical solutions can be compared.</p>
<p>We can discretize a parabolic PDE in the space dimension (using centered difference schemes) while keeping the time variable continuous. We examine the following initial boundary value problem for the <img src="https://latex.codecogs.com/png.latex?1">d-heat equation on the unit interval with zero Dirichlet boundary conditions.</p>
<p>The problem is:</p>
<p><span id="eq-IBVP"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Au_t%20&amp;=%20u_%7Bxx%7D,%20%5Cquad%20&amp;%200%20%3C%20x%20%3C%201,%20t%3E0%5C%5C%0Au(x,0)%20&amp;=%20f(x),%20%5Cquad%200%20%5Cleq%20x%20%5Cleq%201%20%5C%5C%0Au(0,t)%20&amp;=%20u(1,t)%20=%200%0A%5Cend%7Balign*%7D%0A%5Ctag%7B3%7D"></span></p>
<p>We partition the space interval <img src="https://latex.codecogs.com/png.latex?(0,1)"> into <img src="https://latex.codecogs.com/png.latex?J"> subintervals and we approximate Equation&nbsp;3 by the <em>semi-discrete</em> scheme:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7BdU_j%7D%7Bdt%7D%20&amp;=%20%5Cfrac%7B1%7D%7Bh%5E2%7D(U_%7Bj+1%7D%20-%202U_j%20+%20U_%7Bj-1%7D),%20%5Cquad%201%20%5Cleq%20j%20%5Cleq%20J-1%20%5C%5C%0AU_0(t)%20&amp;=%20U_J(t)%20=%200,%20%5Cquad%20t%20%3E%200%20%5C%5C%0AU_j(0)%20&amp;=%20f(x_j)%0A%5Cend%7Balign*%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?h%20=%201/J"> is the constant mesh size. The <img src="https://latex.codecogs.com/png.latex?U_j">’s are functions of time <img src="https://latex.codecogs.com/png.latex?t">. So, we define the following vectors:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AU(t)%20&amp;=%20(U_1(t),U_2(t),%5Cldots,U_J(t))%5ET%20%5C%5C%0AU%5E0%20&amp;=%20(f(x_1),f(x_2),%5Cldots,f(x_%7BJ-1%7D))%5ET%0A%5Cend%7Balign*%7D%0A"></p>
<p>Then, we can rewrite the system Equation&nbsp;3 as a system of ordinary differential equations:</p>
<p><span id="eq-heat-eq-1"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7BdU%7D%7Bdt%7D%20&amp;=%20AU%5C%5C%0AU(0)%20&amp;=%20U%5E0%0A%5Cend%7Balign*%7D%0A%5Ctag%7B4%7D"></span></p>
<p>where the matrix <img src="https://latex.codecogs.com/png.latex?A"> is given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cfrac%7B1%7D%7Bh%5E2%7D%5Cbegin%7Bbmatrix%7D%0A-2%20&amp;%201%20&amp;%200%20&amp;%20%5Cldots%20%5C%5C%0A1%20%20&amp;-2%20&amp;%201%20&amp;%20%5Cldots%20%5C%5C%0A0%20%20&amp;%201%20&amp;%20-2%20&amp;%20%5Cldots%20%5C%5C%0A%20%20%20&amp;%20%20%20&amp;%20%20%20%20&amp;%20%5Cldots%20%5C%5C%0A%20%20%20%20%20%20&amp;%20%20%20&amp;%20%20%20%20&amp;%20%5Cldots%20&amp;%201%20&amp;%20-2%20&amp;%201%5C%5C%0A%20%20%20%20%20%20&amp;%20%20%20&amp;%20%20%20%20&amp;%20%5Cldots%20&amp;%200%20&amp;%201%20%20&amp;%20-2%5C%5C%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>There are many discretization schemes. I plan to explore various finite difference schemes and their application to derivatives pricing in future posts. For now, I will concentrate on the one-step explicit and implicit methods to discretise the system of ODEs(Equation&nbsp;4) as:</p>
<p><span id="eq-heat-eq-2"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7BU%5E%7Bn+1%20-%20U%5En%7D%7D%7B%5CDelta%20t%7D%20&amp;=%20%5Ctheta%20AU%5E%7Bn+1%7D%20+%20(1-%5Ctheta)AU%5E%7Bn%7D,%20%5Cquad%200%20%5Cleq%20n%20%5Cleq%20N-1,%200%20%5Cleq%20%5Ctheta%20%5Cleq%201%20%5C%5C%0AU%5E%7B0%7D%20&amp;=%20U(0)%0A%5Cend%7Balign*%7D%0A%5Ctag%7B5%7D"></span></p>
<p>In this case, <img src="https://latex.codecogs.com/png.latex?%5CDelta%20t"> is the constant mesh size in time.</p>
<p>We can rewrite Equation&nbsp;5 in the equivalent form:</p>
<p><span id="eq-heat-eq-3"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AU%5E%7Bn+1%7D%20-%20U%5E%7Bn%7D%20&amp;=%20%5Ctheta%20%5CDelta%20t%20A%20U%5E%7Bn+1%7D%20+%20%5CDelta%20t%20(I-%20%5Ctheta)AU%5E%7Bn%7D%20%5C%5C%0A%5BI%20-%20%5CDelta%20t%20A%5DU%5E%7Bn+1%7D%20&amp;=%20(%5CDelta%20t%20(1%20-%20%5Ctheta)%20+%201)AU%5En%0A%5Cend%7Balign*%7D%0A%5Ctag%7B6%7D"></span></p>
<p>or formally as:</p>
<p><span id="eq-heat-eq-4"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AU%5E%7Bn+1%7D%20=%20%5B1-%5CDelta%20t%20%5Ctheta%20A%5D%5E%7B-1%7D%20(I%20+%20%5CDelta%20t(I%20-%20%5Ctheta))%20A%20U%5En%0A%5Cend%7Balign*%7D%0A%5Ctag%7B7%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?I"> is the identity matrix.</p>
<p>Some special cases of <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> are:</p>
<p><span id="eq-heat-eq-5"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Ctheta%20&amp;=%201,%20%5Cquad%20%5Ctext%7BImplicit%20Euler%20Scheme%7D%5C%5C%0A%5Ctheta%20&amp;=%200,%20%5Cquad%20%5Ctext%7BExplicit%20Euler%20Scheme%7D%5C%5C%0A%5Ctheta%20&amp;=%201/2,%5Cquad%20%5Ctext%7BCrank-Nicolson%20Scheme%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B8%7D"></span></p>
<p>When the schemes are implicit, we can solve the system of equations (Equation&nbsp;5) at each time level <img src="https://latex.codecogs.com/png.latex?n+1"> using the Thomas algorithm. No matrix inversion is needed in the case of explicit schemes. The formulation (Equation&nbsp;4) is called the <em>method of lines</em> and it corresponds to semi-discretization of the PDE in the space direction while keeping the time variable continuous (I will explore MOL in future posts).</p>
<p>We can write the scheme (Equation&nbsp;6 - Equation&nbsp;8) in the component form:</p>
<p><span id="eq-component-form"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7BU%5E%7Bn+1%7Dj%20-%20U%5E%7Bn%7Dj%7D%7B%5CDelta%20t%7D%20=%20%5Ctheta(U%5E%7Bn+1%7D_%7Bj+1%7D-2U%5E%7Bn+1%7D_j%20+%20U%5E%7Bn+1%7D_%7Bj-1%7D)/h%5E2%20+%20(1-%5Ctheta)(U%5E%7Bn%7D_%7Bj+1%7D-2U%5E%7Bn%7D_j%20+%20U%5E%7Bn%7D_%7Bj-1%7D)/h%5E2%0A%5Cend%7Balign*%7D%0A%5Ctag%7B9%7D"></span></p>
<p>or equivalently:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%7BU%5E%7Bn+1%7Dj%20-%20U%5E%7Bn%7D_j%7D%20&amp;=%20%5Clambda%5Ctheta(U%5E%7Bn+1%7D_%7Bj+1%7D-2U%5E%7Bn+1%7D_j%20+%20U%5E%7Bn+1%7D_%7Bj-1%7D)/h%5E2%20%5C%5C&amp;+%20(1-%5Ctheta)(U%5E%7Bn%7D_%7Bj+1%7D-2U%5E%7Bn%7D_j%20+%20U%5E%7Bn%7D_%7Bj-1%7D)%0A%5Cend%7Balign*%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Clambda%20=%20%5CDelta%20t/h%5E2">.</p>
<p>Finally:</p>
<p><span id="eq-finite-difference-scheme"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A-%5Clambda%20%5Ctheta%20U%5E%7Bn+1%7D_%7Bj+1%7D%20+%20(1+2%5Clambda%20%5Ctheta)U_j%5E%7Bn+1%7D%20-%20%5Clambda%20%5Ctheta%20U%5E%7Bn+1%7D_%7Bj-1%7D%20%5C%5C=%20%5Clambda%20(1-%5Ctheta)U%5E%7Bn%7D_%7Bj+1%7D+(1-2%5Clambda(1-%5Ctheta))U%5E%7Bn%7D_j%20+%20%5Clambda(1-%5Ctheta)U%5E%7Bn%7D_%7Bj-1%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B10%7D"></span></p>
<p>The system (Equation&nbsp;10) is tridiagonal and we can apply the Thomas algorithm to solve it. In the case of the explicit Euler scheme <img src="https://latex.codecogs.com/png.latex?(%5Ctheta%20=%200)">, these algorithms are not needed, because the solution at time level <img src="https://latex.codecogs.com/png.latex?n+1"> can be explicitly computed:</p>
<p><span id="eq-explicit-euler"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AU%5E%7Bn+1%7D_j%20=%20%5Clambda%20U%5E%7Bn%7D_%7Bj+1%7D%20+%20(1-2%5Clambda)U%5E%7Bn%7D_j%20+%5Clambda%20U%5E%7Bn%7D_%7Bj-1%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B11%7D"></span></p>
<section id="computational-solution-1" class="level3">
<h3 class="anchored" data-anchor-id="computational-solution-1">Computational Solution</h3>
<p>I implemented the algorithm in Equation&nbsp;10. This is a one-step marching scheme called BTCS(Backward in Time, Centered in Space) that computes the solution at time level <img src="https://latex.codecogs.com/png.latex?n+1"> in terms of the solution at time <img src="https://latex.codecogs.com/png.latex?n">. Since there are three unknowns to be computed at each time level <img src="https://latex.codecogs.com/png.latex?n+1">, we need to use the Thomas algorithm. The main steps in the algorithm are:</p>
<ul>
<li>Choose input parameters and generate meshes</li>
<li>Define the initial solution and the boundary conditions</li>
<li>Compute the solution at each time upto and including expiration.</li>
</ul>


<!-- -->

</section>
</section>

 ]]></description>
  <category>Numerical Methods</category>
  <guid>https://quantdev.blog/posts/tridiagonal-systems/</guid>
  <pubDate>Fri, 15 Nov 2024 00:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/tridiagonal-systems/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Interpolation and Approximation</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/interpolation-and-approximation/</link>
  <description><![CDATA[ 





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this blog post, I would like to implement some interpolation algorithms using modern C++. It’s important we understand <em>how</em> and <em>why</em> these algorithms work. Because there are nuances, exceptions and corner-cases, we need to understand. It’s a great learning experience! You never fully understand something like the <img src="https://latex.codecogs.com/png.latex?QR">-algorithm (which is actually incredibly complicated to get the details right), unless you spend some time implementing it. A lot of the skills you pick up will translate when you write numerical codes.</p>
<p>Even if you have excellent implementations of any algorithm, you still need to understand some of the internals in order to make good use of your library. For example, any linear algebra library can compute an inverse matrix really fast and as accurately as mathematics allows. But, you have to know a little theory in order to know that you should still avoid using that if at all possible. (Matrix decomposition and solving without explicitly computing the inverse is better, generally speaking).</p>
</section>
<section id="the-interpolation-problem" class="level2">
<h2 class="anchored" data-anchor-id="the-interpolation-problem">The Interpolation Problem</h2>
<p>Polynomials are used as the basic means of approximation and are ubiquitous in nearly all areas of computational science.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?a=x_1%20%3C%20x_2%20%3C%20%5Cldots%20%3C%20x_n%20=%20b"> be a grid of distinct points. Let <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D_n"> be the vector space of of polynomials in one variable with degree <img src="https://latex.codecogs.com/png.latex?%5Cleq%20n%20-%201">. We are interested to find a polynomial <img src="https://latex.codecogs.com/png.latex?p%20%5Cin%20%5Cmathcal%7BP%7D_n"> such that:</p>
<p><span id="eq-interpolation-problem"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ap(x_i)%20=%20f(x_i),%20%5Cquad%20i%20=%201%20:%20n%0A%5Cend%7Balign*%7D%0A%5Ctag%7B1%7D"></span></p>
<div id="thm-uniqueness-of-the-interpolating-polynomial" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Uniqueness of the interpolating polynomial)</strong></span> If <img src="https://latex.codecogs.com/png.latex?x_1,%5Cldots,x_n"> are distinct real numbers, then for arbitrary values <img src="https://latex.codecogs.com/png.latex?y_1,%5Cldots,y_n">, there is a unique polynomial <img src="https://latex.codecogs.com/png.latex?p%5Cin%20%5Cmathcal%7BP%7D_%7Bn%7D"> of degree at most <img src="https://latex.codecogs.com/png.latex?n-1"> such that:</p>
<p><img src="https://latex.codecogs.com/png.latex?p(x_i)%20=%20y_i,%20%20%5Cquad%20i%20=%201%20:%20n"></p>
</div>
<p><em>Proof.</em></p>
<p>Suppose that there were two such polynomials <img src="https://latex.codecogs.com/png.latex?p"> and <img src="https://latex.codecogs.com/png.latex?q">. Then, the polynomial <img src="https://latex.codecogs.com/png.latex?p-q"> would have the property <img src="https://latex.codecogs.com/png.latex?(p-q)(x_i)=0"> for <img src="https://latex.codecogs.com/png.latex?1%20%5Cleq%20i%20%5Cleq%20n">. Since, the degree of <img src="https://latex.codecogs.com/png.latex?(p-q)"> can be at most <img src="https://latex.codecogs.com/png.latex?n-1">, this polynomial can have atmost <img src="https://latex.codecogs.com/png.latex?(n-1)"> zeroes, if is not the <img src="https://latex.codecogs.com/png.latex?0"> polynomial. Since the <img src="https://latex.codecogs.com/png.latex?x_i">’s are distinct, it follows that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(p-q)(x)%20=%20(x%20-%20x_1)(x%20-%20x_2)%5Cldots(x-x_n)%20=%20%5Cprod_%7Bi=1%7D%5En%20(x-x_i)%0A"></p>
<p>and it has atleast <img src="https://latex.codecogs.com/png.latex?n"> zeroes. Hence, <img src="https://latex.codecogs.com/png.latex?(p-q)(x)%5Cequiv%200"> - it must be identically equal to zero. So, <img src="https://latex.codecogs.com/png.latex?p(x)%20=%20q(x)"> for all <img src="https://latex.codecogs.com/png.latex?x">. This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<section id="bases-for-polynomial-interpolation" class="level3">
<h3 class="anchored" data-anchor-id="bases-for-polynomial-interpolation">Bases for polynomial interpolation</h3>
<p>A set of polynomials <img src="https://latex.codecogs.com/png.latex?%5C%7Bp_1(x),%20p_2(x),%20%5Cldots,%20p_n(x)%5C%7D"> such that the polynomial <img src="https://latex.codecogs.com/png.latex?p%20%5Cin%20%5Cmathcal%7BP%7D_n"> can be expressed as a linear combination :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap(x)%20=%20%5Csum_%7Bj=1%7D%20c_j%20p_j(x)%0A"></p>
<p>is called a basis for <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D_n">. The column vector <img src="https://latex.codecogs.com/png.latex?c=(c_1,c_2,%5Cldots,c_n)%5ET"> can be viewed as the coordinate vector of <img src="https://latex.codecogs.com/png.latex?p"> in the polynomial space <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BP%7D_n">. The inerpolation problem leads to a system of equations:</p>
<p><span id="eq-system-of-equations"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ac_1%20p_1(x_i)%20+%20c_2%20p_2(x_i)%20+%20%5Cldots%20+%20c_n%20p_n(x_i)%20=%20f(x_i),%20%5Cquad%20i=1:n%0A%5Cend%7Balign*%7D%0A%5Ctag%7B2%7D"></span></p>
<p>If we introduce the matrix :</p>
<p><span id="eq-matrix"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AP_n%20=%20%5Bp_j(x_i)%5D_%7Bi,j=1%7D%5En%0A%5Cend%7Balign*%7D%0A%5Ctag%7B3%7D"></span></p>
<p>and the column vector <img src="https://latex.codecogs.com/png.latex?f=(f(x_1),%5Cldots,f(x_n))%5ET">, then the linear system becomes:</p>
<p><span id="eq-matrix-form-of-eq"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AP_n%20c%20=%20f%0A%5Cend%7Balign*%7D%0A%5Ctag%7B4%7D"></span></p>
<p>Mathematically, the choice of a basis (for a finite-dimensional space) makes no difference. Computationally, when working with <em>rounded values of coefficients</em>, the choice of basis can make a great difference. If the purpose is to compute derivatives or integrals of the interpolation polynomial, the power basis or the <strong>shifted power basis</strong>, where <img src="https://latex.codecogs.com/png.latex?p_j(x)%20=%20(x%20-%20c)%5E%7Bj-1%7D"> that is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap(x)=%20%5Csum_%7Bj=1%7D%5En%20c_j(x)(x%20-%20c)%5E%7Bj-1%7D%0A"></p>
<p>is convenient although not always the best. If a shifted power basis is to be used for polynomial approximation on an interval <img src="https://latex.codecogs.com/png.latex?%5Ba,b%5D">, it is often the best to choose <img src="https://latex.codecogs.com/png.latex?c%20=%20(a%20+%20b)/2">, equal to the midpoint of the interval.</p>
<p>For the <strong>power basis</strong> <img src="https://latex.codecogs.com/png.latex?p_j(x)%20=%20x%5E%7Bj-1%7D">, the coefficients of the interpolation polynomial are given by the solution of the linear system <img src="https://latex.codecogs.com/png.latex?V_n%5ET%20c%20=%20f">, where <img src="https://latex.codecogs.com/png.latex?V_n"> is the Vandermonde matrix</p>
<p><span id="eq-vandermonde-matrix"><img src="https://latex.codecogs.com/png.latex?%0AV_n%20=%20%5Bx_j%5E%7Bi-1%7D%5D_%7Bi,j=1%7D%5En%20=%0A%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%201%20&amp;%20%5Cldots%20&amp;%201%5C%5C%0Ax_1%20&amp;%20x_2%20&amp;%20%5Cldots%20&amp;%20x_n%20%5C%5C%0A%5Cvdots%20&amp;%20%5Cvdots%20&amp;%20%5Cldots%20&amp;%20%5Cvdots%5C%5C%0Ax_1%5E%7Bn-1%7D%20&amp;%20x_2%5E%7Bn-1%7D%20&amp;%20%5Cldots%20&amp;%20x_n%5E%7Bn-1%7D%0A%5Cend%7Bbmatrix%7D%0A%5Ctag%7B5%7D"></span></p>
</section>
</section>
<section id="piecewise-polynomial-interpolation" class="level2">
<h2 class="anchored" data-anchor-id="piecewise-polynomial-interpolation">Piecewise Polynomial Interpolation</h2>
<p>Interpolating a given function by a single polynomial over its entire range can be an ill-conditioned problem, as illustrated by <em>Runge’s phenomenon</em>. On the other hand, polynomials of low degree can give good approximations <em>locally</em> in a small interval. I would like to discuss approximation schemes for <strong>piecewise polynomial interpolation</strong> with different degrees of global continuity.</p>
<p>With the use of piecewise polynomials, there is no reason to fear equidistant data, as opposed to the situation with higher-degree polynomials. In computer graphics and computer-aided design(CAD), curves and surfaces have to be represented mathematically, so that they can be manipulated and visualized easily. In 1962, <a href="https://en.wikipedia.org/wiki/Pierre_B%C3%A9zier">Bezier</a> and <a href="https://en.wikipedia.org/wiki/Paul_de_Casteljau">de Casteljau</a>, working for French car companies Renault and Citroen, independently developed Bezier curves for fitting curves and surfaces. Similar work, using bicubic splines, was done in USA at general motors by Garret Birkhoff and Henry Garabedian.</p>
<p>Today, <a href="https://en.wikipedia.org/wiki/B%C3%A9zier_curve">Bezier curves</a> and <a href="https://en.wikipedia.org/wiki/Spline_(mathematics)">spline functions</a> are used extensively in all aircraft and automotive industries. Spline functions can also be used in the numerical treatment of boundary value problems for differential equations. Bezier curves have found use in computer graphics and typography. Trutype font glyphs are made of quadratic bezier curves.</p>
<section id="bernstein-polynomials-and-bezier-curves" class="level3">
<h3 class="anchored" data-anchor-id="bernstein-polynomials-and-bezier-curves">Bernstein Polynomials and Bezier Curves</h3>
<p>Parametric curves are often used find the functional form of a curve given geometrically by a set of points <img src="https://latex.codecogs.com/png.latex?p_i%20%5Cin%20%5Cmathbf%7BR%7D%5Ed">, <img src="https://latex.codecogs.com/png.latex?i=0:n">.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?c(t)%20%5Cin%20%5Cmathbf%7BR%7D%5Ed">, <img src="https://latex.codecogs.com/png.latex?t%5Cin%5B0,1%5D">, be a <strong>parameteric curve</strong>. In the simplest case, <img src="https://latex.codecogs.com/png.latex?n=1">, we take <img src="https://latex.codecogs.com/png.latex?c(t)"> to be linear:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ac(t)%20=%20(1-t)p_0%20+%20tp_1%0A"></p>
<p>and connecting the two points <img src="https://latex.codecogs.com/png.latex?p_0"> and <img src="https://latex.codecogs.com/png.latex?p_1">, so that <img src="https://latex.codecogs.com/png.latex?p(0)=c_0"> and <img src="https://latex.codecogs.com/png.latex?p_1%20=%20c(1)">. It is the parametric equation for a straight-line.</p>
<p>For <img src="https://latex.codecogs.com/png.latex?n%20%3E%201">, this will not give a smooth curve and is therefore of limited interest.</p>
<p>We can generalize this approach and take <img src="https://latex.codecogs.com/png.latex?c(t)"> to be a polynomial of degree <img src="https://latex.codecogs.com/png.latex?n">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ac(t)%20=%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20p_i%20B_i(t),%5Cquad%20t%5Cin%5B0,1%5D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?B_i(t)">, <img src="https://latex.codecogs.com/png.latex?i=0%20:%20n"> are the <strong>Bernstein polynomials</strong> defined by :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AB_i%5E%7Bn%7D(t)%20=%20%7Bn%20%5Cchoose%20i%7D%20t%5E%7Bi%7D%20(1-t)%5E%7Bn-i%7D,%20%5Cquad%20i=0:n%0A"></p>
<p>Using the binomial theorem, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A1%20=%20((1-t)%20+%20t)%5En%20=%20%5Csum_%7Bi=0%7D%5En%20%7Bn%20%5Cchoose%20i%7Dt%5Ei%20(1-t)%5E%7Bn-i%7D%20=%20%5Csum_%7Bi=0%7D%5En%20B_i%5E%7Bn%7D(t)%0A"></p>
<p>Thus, the Bernstein polynomials of degree <img src="https://latex.codecogs.com/png.latex?n"> are non-negative on <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D"> and give a <em>partition of unity</em>.</p>
<p>For <img src="https://latex.codecogs.com/png.latex?n=3">, the four cubic Bernstein polynmials are:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AB_0%5E3%20&amp;=%20(1-t)%5E3%5C%5C%0AB_1%5E3%20&amp;=%203(1-t)%5E2%20t%5C%5C%0AB_2%5E3%20&amp;=%203(1-t)t%5E2%5C%5C%0AB_3%5E3%20&amp;=%20t%5E3%0A%5Cend%7Balign*%7D%0A"></p>
<div id="8457563f" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Plots</span></span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">LaTeXStrings</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">B₀</span>(t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">B₁</span>(t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">B₂</span>(t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">B₃</span>(t) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>([B₀, B₁, B₂, B₃], <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[L<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B_0"</span> L<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B_1"</span> L<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B_2"</span> L<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B_3"</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip250">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip250)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip251">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip250)" d="M189.154 1800.78 L2640.76 1800.78 L2640.76 47.2441 L189.154 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip252">
    <rect x="189" y="47" width="2453" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="258.539,1800.78 258.539,47.2441 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="836.747,1800.78 836.747,47.2441 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1414.95,1800.78 1414.95,47.2441 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1993.16,1800.78 1993.16,47.2441 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.37,1800.78 2571.37,47.2441 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="189.154,1751.15 2640.76,1751.15 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="189.154,1337.58 2640.76,1337.58 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="189.154,924.012 2640.76,924.012 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="189.154,510.442 2640.76,510.442 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="189.154,96.8724 2640.76,96.8724 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="189.154,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="258.539,1800.78 258.539,1781.88 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="836.747,1800.78 836.747,1781.88 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1414.95,1800.78 1414.95,1781.88 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1993.16,1800.78 1993.16,1781.88 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.37,1800.78 2571.37,1781.88 "></polyline>
<path clip-path="url(#clip250)" d="M220.842 1834 Q217.231 1834 215.403 1837.57 Q213.597 1841.11 213.597 1848.24 Q213.597 1855.34 215.403 1858.91 Q217.231 1862.45 220.842 1862.45 Q224.477 1862.45 226.282 1858.91 Q228.111 1855.34 228.111 1848.24 Q228.111 1841.11 226.282 1837.57 Q224.477 1834 220.842 1834 M220.842 1830.3 Q226.653 1830.3 229.708 1834.9 Q232.787 1839.49 232.787 1848.24 Q232.787 1856.96 229.708 1861.57 Q226.653 1866.15 220.842 1866.15 Q215.032 1866.15 211.954 1861.57 Q208.898 1856.96 208.898 1848.24 Q208.898 1839.49 211.954 1834.9 Q215.032 1830.3 220.842 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M241.004 1859.6 L245.889 1859.6 L245.889 1865.48 L241.004 1865.48 L241.004 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M266.074 1834 Q262.463 1834 260.634 1837.57 Q258.828 1841.11 258.828 1848.24 Q258.828 1855.34 260.634 1858.91 Q262.463 1862.45 266.074 1862.45 Q269.708 1862.45 271.513 1858.91 Q273.342 1855.34 273.342 1848.24 Q273.342 1841.11 271.513 1837.57 Q269.708 1834 266.074 1834 M266.074 1830.3 Q271.884 1830.3 274.939 1834.9 Q278.018 1839.49 278.018 1848.24 Q278.018 1856.96 274.939 1861.57 Q271.884 1866.15 266.074 1866.15 Q260.263 1866.15 257.185 1861.57 Q254.129 1856.96 254.129 1848.24 Q254.129 1839.49 257.185 1834.9 Q260.263 1830.3 266.074 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M296.236 1834 Q292.624 1834 290.796 1837.57 Q288.99 1841.11 288.99 1848.24 Q288.99 1855.34 290.796 1858.91 Q292.624 1862.45 296.236 1862.45 Q299.87 1862.45 301.675 1858.91 Q303.504 1855.34 303.504 1848.24 Q303.504 1841.11 301.675 1837.57 Q299.87 1834 296.236 1834 M296.236 1830.3 Q302.046 1830.3 305.101 1834.9 Q308.18 1839.49 308.18 1848.24 Q308.18 1856.96 305.101 1861.57 Q302.046 1866.15 296.236 1866.15 Q290.425 1866.15 287.347 1861.57 Q284.291 1856.96 284.291 1848.24 Q284.291 1839.49 287.347 1834.9 Q290.425 1830.3 296.236 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M799.548 1834 Q795.937 1834 794.108 1837.57 Q792.303 1841.11 792.303 1848.24 Q792.303 1855.34 794.108 1858.91 Q795.937 1862.45 799.548 1862.45 Q803.182 1862.45 804.988 1858.91 Q806.817 1855.34 806.817 1848.24 Q806.817 1841.11 804.988 1837.57 Q803.182 1834 799.548 1834 M799.548 1830.3 Q805.358 1830.3 808.414 1834.9 Q811.492 1839.49 811.492 1848.24 Q811.492 1856.96 808.414 1861.57 Q805.358 1866.15 799.548 1866.15 Q793.738 1866.15 790.659 1861.57 Q787.604 1856.96 787.604 1848.24 Q787.604 1839.49 790.659 1834.9 Q793.738 1830.3 799.548 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M819.71 1859.6 L824.594 1859.6 L824.594 1865.48 L819.71 1865.48 L819.71 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M838.807 1861.55 L855.126 1861.55 L855.126 1865.48 L833.182 1865.48 L833.182 1861.55 Q835.844 1858.79 840.427 1854.16 Q845.034 1849.51 846.214 1848.17 Q848.46 1845.65 849.339 1843.91 Q850.242 1842.15 850.242 1840.46 Q850.242 1837.71 848.298 1835.97 Q846.377 1834.23 843.275 1834.23 Q841.076 1834.23 838.622 1835 Q836.191 1835.76 833.414 1837.31 L833.414 1832.59 Q836.238 1831.46 838.691 1830.88 Q841.145 1830.3 843.182 1830.3 Q848.552 1830.3 851.747 1832.98 Q854.941 1835.67 854.941 1840.16 Q854.941 1842.29 854.131 1844.21 Q853.344 1846.11 851.238 1848.7 Q850.659 1849.37 847.557 1852.59 Q844.455 1855.78 838.807 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M864.988 1830.92 L883.344 1830.92 L883.344 1834.86 L869.27 1834.86 L869.27 1843.33 Q870.288 1842.98 871.307 1842.82 Q872.325 1842.64 873.344 1842.64 Q879.131 1842.64 882.511 1845.81 Q885.89 1848.98 885.89 1854.4 Q885.89 1859.97 882.418 1863.08 Q878.946 1866.15 872.626 1866.15 Q870.45 1866.15 868.182 1865.78 Q865.937 1865.41 863.529 1864.67 L863.529 1859.97 Q865.613 1861.11 867.835 1861.66 Q870.057 1862.22 872.534 1862.22 Q876.538 1862.22 878.876 1860.11 Q881.214 1858.01 881.214 1854.4 Q881.214 1850.78 878.876 1848.68 Q876.538 1846.57 872.534 1846.57 Q870.659 1846.57 868.784 1846.99 Q866.932 1847.4 864.988 1848.28 L864.988 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M1377.26 1834 Q1373.65 1834 1371.82 1837.57 Q1370.01 1841.11 1370.01 1848.24 Q1370.01 1855.34 1371.82 1858.91 Q1373.65 1862.45 1377.26 1862.45 Q1380.89 1862.45 1382.7 1858.91 Q1384.53 1855.34 1384.53 1848.24 Q1384.53 1841.11 1382.7 1837.57 Q1380.89 1834 1377.26 1834 M1377.26 1830.3 Q1383.07 1830.3 1386.12 1834.9 Q1389.2 1839.49 1389.2 1848.24 Q1389.2 1856.96 1386.12 1861.57 Q1383.07 1866.15 1377.26 1866.15 Q1371.45 1866.15 1368.37 1861.57 Q1365.31 1856.96 1365.31 1848.24 Q1365.31 1839.49 1368.37 1834.9 Q1371.45 1830.3 1377.26 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M1397.42 1859.6 L1402.3 1859.6 L1402.3 1865.48 L1397.42 1865.48 L1397.42 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M1412.54 1830.92 L1430.89 1830.92 L1430.89 1834.86 L1416.82 1834.86 L1416.82 1843.33 Q1417.84 1842.98 1418.86 1842.82 Q1419.87 1842.64 1420.89 1842.64 Q1426.68 1842.64 1430.06 1845.81 Q1433.44 1848.98 1433.44 1854.4 Q1433.44 1859.97 1429.97 1863.08 Q1426.49 1866.15 1420.17 1866.15 Q1418 1866.15 1415.73 1865.78 Q1413.49 1865.41 1411.08 1864.67 L1411.08 1859.97 Q1413.16 1861.11 1415.38 1861.66 Q1417.61 1862.22 1420.08 1862.22 Q1424.09 1862.22 1426.42 1860.11 Q1428.76 1858.01 1428.76 1854.4 Q1428.76 1850.78 1426.42 1848.68 Q1424.09 1846.57 1420.08 1846.57 Q1418.21 1846.57 1416.33 1846.99 Q1414.48 1847.4 1412.54 1848.28 L1412.54 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M1452.65 1834 Q1449.04 1834 1447.21 1837.57 Q1445.41 1841.11 1445.41 1848.24 Q1445.41 1855.34 1447.21 1858.91 Q1449.04 1862.45 1452.65 1862.45 Q1456.29 1862.45 1458.09 1858.91 Q1459.92 1855.34 1459.92 1848.24 Q1459.92 1841.11 1458.09 1837.57 Q1456.29 1834 1452.65 1834 M1452.65 1830.3 Q1458.46 1830.3 1461.52 1834.9 Q1464.6 1839.49 1464.6 1848.24 Q1464.6 1856.96 1461.52 1861.57 Q1458.46 1866.15 1452.65 1866.15 Q1446.84 1866.15 1443.76 1861.57 Q1440.71 1856.96 1440.71 1848.24 Q1440.71 1839.49 1443.76 1834.9 Q1446.84 1830.3 1452.65 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M1955.96 1834 Q1952.35 1834 1950.52 1837.57 Q1948.72 1841.11 1948.72 1848.24 Q1948.72 1855.34 1950.52 1858.91 Q1952.35 1862.45 1955.96 1862.45 Q1959.6 1862.45 1961.4 1858.91 Q1963.23 1855.34 1963.23 1848.24 Q1963.23 1841.11 1961.4 1837.57 Q1959.6 1834 1955.96 1834 M1955.96 1830.3 Q1961.77 1830.3 1964.83 1834.9 Q1967.91 1839.49 1967.91 1848.24 Q1967.91 1856.96 1964.83 1861.57 Q1961.77 1866.15 1955.96 1866.15 Q1950.15 1866.15 1947.08 1861.57 Q1944.02 1856.96 1944.02 1848.24 Q1944.02 1839.49 1947.08 1834.9 Q1950.15 1830.3 1955.96 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M1976.13 1859.6 L1981.01 1859.6 L1981.01 1865.48 L1976.13 1865.48 L1976.13 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M1990.01 1830.92 L2012.24 1830.92 L2012.24 1832.91 L1999.69 1865.48 L1994.81 1865.48 L2006.61 1834.86 L1990.01 1834.86 L1990.01 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M2021.4 1830.92 L2039.76 1830.92 L2039.76 1834.86 L2025.69 1834.86 L2025.69 1843.33 Q2026.7 1842.98 2027.72 1842.82 Q2028.74 1842.64 2029.76 1842.64 Q2035.55 1842.64 2038.93 1845.81 Q2042.31 1848.98 2042.31 1854.4 Q2042.31 1859.97 2038.83 1863.08 Q2035.36 1866.15 2029.04 1866.15 Q2026.87 1866.15 2024.6 1865.78 Q2022.35 1865.41 2019.95 1864.67 L2019.95 1859.97 Q2022.03 1861.11 2024.25 1861.66 Q2026.47 1862.22 2028.95 1862.22 Q2032.95 1862.22 2035.29 1860.11 Q2037.63 1858.01 2037.63 1854.4 Q2037.63 1850.78 2035.29 1848.68 Q2032.95 1846.57 2028.95 1846.57 Q2027.07 1846.57 2025.2 1846.99 Q2023.35 1847.4 2021.4 1848.28 L2021.4 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M2523.44 1861.55 L2531.08 1861.55 L2531.08 1835.18 L2522.77 1836.85 L2522.77 1832.59 L2531.04 1830.92 L2535.71 1830.92 L2535.71 1861.55 L2543.35 1861.55 L2543.35 1865.48 L2523.44 1865.48 L2523.44 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M2552.79 1859.6 L2557.68 1859.6 L2557.68 1865.48 L2552.79 1865.48 L2552.79 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M2577.86 1834 Q2574.25 1834 2572.42 1837.57 Q2570.62 1841.11 2570.62 1848.24 Q2570.62 1855.34 2572.42 1858.91 Q2574.25 1862.45 2577.86 1862.45 Q2581.5 1862.45 2583.3 1858.91 Q2585.13 1855.34 2585.13 1848.24 Q2585.13 1841.11 2583.3 1837.57 Q2581.5 1834 2577.86 1834 M2577.86 1830.3 Q2583.67 1830.3 2586.73 1834.9 Q2589.81 1839.49 2589.81 1848.24 Q2589.81 1856.96 2586.73 1861.57 Q2583.67 1866.15 2577.86 1866.15 Q2572.05 1866.15 2568.98 1861.57 Q2565.92 1856.96 2565.92 1848.24 Q2565.92 1839.49 2568.98 1834.9 Q2572.05 1830.3 2577.86 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M2608.03 1834 Q2604.41 1834 2602.59 1837.57 Q2600.78 1841.11 2600.78 1848.24 Q2600.78 1855.34 2602.59 1858.91 Q2604.41 1862.45 2608.03 1862.45 Q2611.66 1862.45 2613.47 1858.91 Q2615.29 1855.34 2615.29 1848.24 Q2615.29 1841.11 2613.47 1837.57 Q2611.66 1834 2608.03 1834 M2608.03 1830.3 Q2613.84 1830.3 2616.89 1834.9 Q2619.97 1839.49 2619.97 1848.24 Q2619.97 1856.96 2616.89 1861.57 Q2613.84 1866.15 2608.03 1866.15 Q2602.22 1866.15 2599.14 1861.57 Q2596.08 1856.96 2596.08 1848.24 Q2596.08 1839.49 2599.14 1834.9 Q2602.22 1830.3 2608.03 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="189.154,1800.78 189.154,47.2441 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="189.154,1751.15 208.052,1751.15 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="189.154,1337.58 208.052,1337.58 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="189.154,924.012 208.052,924.012 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="189.154,510.442 208.052,510.442 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="189.154,96.8724 208.052,96.8724 "></polyline>
<path clip-path="url(#clip250)" d="M61.4965 1736.95 Q57.8854 1736.95 56.0567 1740.51 Q54.2512 1744.06 54.2512 1751.19 Q54.2512 1758.29 56.0567 1761.86 Q57.8854 1765.4 61.4965 1765.4 Q65.1307 1765.4 66.9363 1761.86 Q68.765 1758.29 68.765 1751.19 Q68.765 1744.06 66.9363 1740.51 Q65.1307 1736.95 61.4965 1736.95 M61.4965 1733.25 Q67.3067 1733.25 70.3622 1737.85 Q73.4409 1742.44 73.4409 1751.19 Q73.4409 1759.91 70.3622 1764.52 Q67.3067 1769.1 61.4965 1769.1 Q55.6864 1769.1 52.6077 1764.52 Q49.5521 1759.91 49.5521 1751.19 Q49.5521 1742.44 52.6077 1737.85 Q55.6864 1733.25 61.4965 1733.25 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M81.6584 1762.55 L86.5427 1762.55 L86.5427 1768.43 L81.6584 1768.43 L81.6584 1762.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M106.728 1736.95 Q103.117 1736.95 101.288 1740.51 Q99.4824 1744.06 99.4824 1751.19 Q99.4824 1758.29 101.288 1761.86 Q103.117 1765.4 106.728 1765.4 Q110.362 1765.4 112.168 1761.86 Q113.996 1758.29 113.996 1751.19 Q113.996 1744.06 112.168 1740.51 Q110.362 1736.95 106.728 1736.95 M106.728 1733.25 Q112.538 1733.25 115.593 1737.85 Q118.672 1742.44 118.672 1751.19 Q118.672 1759.91 115.593 1764.52 Q112.538 1769.1 106.728 1769.1 Q100.918 1769.1 97.8389 1764.52 Q94.7834 1759.91 94.7834 1751.19 Q94.7834 1742.44 97.8389 1737.85 Q100.918 1733.25 106.728 1733.25 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M136.89 1736.95 Q133.279 1736.95 131.45 1740.51 Q129.644 1744.06 129.644 1751.19 Q129.644 1758.29 131.45 1761.86 Q133.279 1765.4 136.89 1765.4 Q140.524 1765.4 142.329 1761.86 Q144.158 1758.29 144.158 1751.19 Q144.158 1744.06 142.329 1740.51 Q140.524 1736.95 136.89 1736.95 M136.89 1733.25 Q142.7 1733.25 145.755 1737.85 Q148.834 1742.44 148.834 1751.19 Q148.834 1759.91 145.755 1764.52 Q142.7 1769.1 136.89 1769.1 Q131.079 1769.1 128.001 1764.52 Q124.945 1759.91 124.945 1751.19 Q124.945 1742.44 128.001 1737.85 Q131.079 1733.25 136.89 1733.25 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M62.4919 1323.38 Q58.8808 1323.38 57.0521 1326.94 Q55.2465 1330.49 55.2465 1337.62 Q55.2465 1344.72 57.0521 1348.29 Q58.8808 1351.83 62.4919 1351.83 Q66.1261 1351.83 67.9317 1348.29 Q69.7604 1344.72 69.7604 1337.62 Q69.7604 1330.49 67.9317 1326.94 Q66.1261 1323.38 62.4919 1323.38 M62.4919 1319.68 Q68.302 1319.68 71.3576 1324.28 Q74.4363 1328.87 74.4363 1337.62 Q74.4363 1346.34 71.3576 1350.95 Q68.302 1355.53 62.4919 1355.53 Q56.6817 1355.53 53.603 1350.95 Q50.5475 1346.34 50.5475 1337.62 Q50.5475 1328.87 53.603 1324.28 Q56.6817 1319.68 62.4919 1319.68 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M82.6538 1348.98 L87.538 1348.98 L87.538 1354.86 L82.6538 1354.86 L82.6538 1348.98 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M101.751 1350.93 L118.07 1350.93 L118.07 1354.86 L96.126 1354.86 L96.126 1350.93 Q98.788 1348.17 103.371 1343.54 Q107.978 1338.89 109.158 1337.55 Q111.404 1335.02 112.283 1333.29 Q113.186 1331.53 113.186 1329.84 Q113.186 1327.08 111.242 1325.35 Q109.32 1323.61 106.218 1323.61 Q104.019 1323.61 101.566 1324.38 Q99.1352 1325.14 96.3574 1326.69 L96.3574 1321.97 Q99.1815 1320.83 101.635 1320.26 Q104.089 1319.68 106.126 1319.68 Q111.496 1319.68 114.691 1322.36 Q117.885 1325.05 117.885 1329.54 Q117.885 1331.67 117.075 1333.59 Q116.288 1335.49 114.181 1338.08 Q113.603 1338.75 110.501 1341.97 Q107.399 1345.16 101.751 1350.93 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M127.931 1320.3 L146.288 1320.3 L146.288 1324.24 L132.214 1324.24 L132.214 1332.71 Q133.232 1332.36 134.251 1332.2 Q135.269 1332.01 136.288 1332.01 Q142.075 1332.01 145.454 1335.19 Q148.834 1338.36 148.834 1343.77 Q148.834 1349.35 145.362 1352.45 Q141.89 1355.53 135.57 1355.53 Q133.394 1355.53 131.126 1355.16 Q128.88 1354.79 126.473 1354.05 L126.473 1349.35 Q128.556 1350.49 130.779 1351.04 Q133.001 1351.6 135.478 1351.6 Q139.482 1351.6 141.82 1349.49 Q144.158 1347.38 144.158 1343.77 Q144.158 1340.16 141.82 1338.06 Q139.482 1335.95 135.478 1335.95 Q133.603 1335.95 131.728 1336.37 Q129.876 1336.78 127.931 1337.66 L127.931 1320.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M61.4965 909.81 Q57.8854 909.81 56.0567 913.375 Q54.2512 916.917 54.2512 924.046 Q54.2512 931.153 56.0567 934.718 Q57.8854 938.259 61.4965 938.259 Q65.1307 938.259 66.9363 934.718 Q68.765 931.153 68.765 924.046 Q68.765 916.917 66.9363 913.375 Q65.1307 909.81 61.4965 909.81 M61.4965 906.107 Q67.3067 906.107 70.3622 910.713 Q73.4409 915.296 73.4409 924.046 Q73.4409 932.773 70.3622 937.38 Q67.3067 941.963 61.4965 941.963 Q55.6864 941.963 52.6077 937.38 Q49.5521 932.773 49.5521 924.046 Q49.5521 915.296 52.6077 910.713 Q55.6864 906.107 61.4965 906.107 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M81.6584 935.412 L86.5427 935.412 L86.5427 941.292 L81.6584 941.292 L81.6584 935.412 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M96.7741 906.732 L115.13 906.732 L115.13 910.667 L101.056 910.667 L101.056 919.139 Q102.075 918.792 103.094 918.63 Q104.112 918.445 105.131 918.445 Q110.918 918.445 114.297 921.616 Q117.677 924.787 117.677 930.204 Q117.677 935.782 114.205 938.884 Q110.732 941.963 104.413 941.963 Q102.237 941.963 99.9685 941.593 Q97.7232 941.222 95.3158 940.482 L95.3158 935.782 Q97.3991 936.917 99.6213 937.472 Q101.844 938.028 104.32 938.028 Q108.325 938.028 110.663 935.921 Q113.001 933.815 113.001 930.204 Q113.001 926.593 110.663 924.486 Q108.325 922.38 104.32 922.38 Q102.445 922.38 100.57 922.796 Q98.7185 923.213 96.7741 924.093 L96.7741 906.732 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M136.89 909.81 Q133.279 909.81 131.45 913.375 Q129.644 916.917 129.644 924.046 Q129.644 931.153 131.45 934.718 Q133.279 938.259 136.89 938.259 Q140.524 938.259 142.329 934.718 Q144.158 931.153 144.158 924.046 Q144.158 916.917 142.329 913.375 Q140.524 909.81 136.89 909.81 M136.89 906.107 Q142.7 906.107 145.755 910.713 Q148.834 915.296 148.834 924.046 Q148.834 932.773 145.755 937.38 Q142.7 941.963 136.89 941.963 Q131.079 941.963 128.001 937.38 Q124.945 932.773 124.945 924.046 Q124.945 915.296 128.001 910.713 Q131.079 906.107 136.89 906.107 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M62.4919 496.241 Q58.8808 496.241 57.0521 499.806 Q55.2465 503.347 55.2465 510.477 Q55.2465 517.583 57.0521 521.148 Q58.8808 524.69 62.4919 524.69 Q66.1261 524.69 67.9317 521.148 Q69.7604 517.583 69.7604 510.477 Q69.7604 503.347 67.9317 499.806 Q66.1261 496.241 62.4919 496.241 M62.4919 492.537 Q68.302 492.537 71.3576 497.144 Q74.4363 501.727 74.4363 510.477 Q74.4363 519.204 71.3576 523.81 Q68.302 528.393 62.4919 528.393 Q56.6817 528.393 53.603 523.81 Q50.5475 519.204 50.5475 510.477 Q50.5475 501.727 53.603 497.144 Q56.6817 492.537 62.4919 492.537 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M82.6538 521.842 L87.538 521.842 L87.538 527.722 L82.6538 527.722 L82.6538 521.842 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M96.5426 493.162 L118.765 493.162 L118.765 495.153 L106.218 527.722 L101.334 527.722 L113.14 497.097 L96.5426 497.097 L96.5426 493.162 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M127.931 493.162 L146.288 493.162 L146.288 497.097 L132.214 497.097 L132.214 505.569 Q133.232 505.222 134.251 505.06 Q135.269 504.875 136.288 504.875 Q142.075 504.875 145.454 508.046 Q148.834 511.218 148.834 516.634 Q148.834 522.213 145.362 525.315 Q141.89 528.393 135.57 528.393 Q133.394 528.393 131.126 528.023 Q128.88 527.653 126.473 526.912 L126.473 522.213 Q128.556 523.347 130.779 523.903 Q133.001 524.458 135.478 524.458 Q139.482 524.458 141.82 522.352 Q144.158 520.245 144.158 516.634 Q144.158 513.023 141.82 510.917 Q139.482 508.81 135.478 508.81 Q133.603 508.81 131.728 509.227 Q129.876 509.643 127.931 510.523 L127.931 493.162 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M52.3067 110.217 L59.9456 110.217 L59.9456 83.8517 L51.6354 85.5183 L51.6354 81.2591 L59.8993 79.5924 L64.5752 79.5924 L64.5752 110.217 L72.214 110.217 L72.214 114.152 L52.3067 114.152 L52.3067 110.217 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M81.6584 108.273 L86.5427 108.273 L86.5427 114.152 L81.6584 114.152 L81.6584 108.273 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M106.728 82.6711 Q103.117 82.6711 101.288 86.2359 Q99.4824 89.7776 99.4824 96.9072 Q99.4824 104.014 101.288 107.578 Q103.117 111.12 106.728 111.12 Q110.362 111.12 112.168 107.578 Q113.996 104.014 113.996 96.9072 Q113.996 89.7776 112.168 86.2359 Q110.362 82.6711 106.728 82.6711 M106.728 78.9675 Q112.538 78.9675 115.593 83.5739 Q118.672 88.1572 118.672 96.9072 Q118.672 105.634 115.593 110.24 Q112.538 114.824 106.728 114.824 Q100.918 114.824 97.8389 110.24 Q94.7834 105.634 94.7834 96.9072 Q94.7834 88.1572 97.8389 83.5739 Q100.918 78.9675 106.728 78.9675 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M136.89 82.6711 Q133.279 82.6711 131.45 86.2359 Q129.644 89.7776 129.644 96.9072 Q129.644 104.014 131.45 107.578 Q133.279 111.12 136.89 111.12 Q140.524 111.12 142.329 107.578 Q144.158 104.014 144.158 96.9072 Q144.158 89.7776 142.329 86.2359 Q140.524 82.6711 136.89 82.6711 M136.89 78.9675 Q142.7 78.9675 145.755 83.5739 Q148.834 88.1572 148.834 96.9072 Q148.834 105.634 145.755 110.24 Q142.7 114.824 136.89 114.824 Q131.079 114.824 128.001 110.24 Q124.945 105.634 124.945 96.9072 Q124.945 88.1572 128.001 83.5739 Q131.079 78.9675 136.89 78.9675 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip252)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="258.539,96.8724 264.508,109.648 270.477,122.358 276.447,135.002 282.416,147.58 317.377,219.942 352.339,290.094 387.3,358.069 422.261,423.903 454.789,483.261 487.317,540.823 530.917,615.208 574.517,686.48 610.544,743.072 646.57,797.623 680.072,846.55 713.573,893.774 755.629,950.692 797.684,1005.03 835.409,1051.64 873.133,1096.26 916.313,1144.95 959.494,1191.17 991.771,1224.14 1024.05,1255.79 1065.33,1294.39 1106.62,1330.94 1144.29,1362.54 1181.97,1392.51 1224.86,1424.71 1267.74,1454.91 1301.74,1477.49 1335.73,1498.89 1377.97,1523.88 1420.2,1547.17 1452.55,1563.88 1484.89,1579.66 1530.49,1600.36 1576.09,1619.32 1610.17,1632.41 1644.25,1644.59 1721.75,1669.15 1798.51,1689.42 1882.96,1707.53 1947.47,1718.68 2028.86,1729.8 2104.15,1737.51 2181.79,1743.24 2260.49,1747.13 2342.67,1749.55 2407.41,1750.56 2554.83,1751.15 2571.37,1751.15 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="258.539,1751.15 264.508,1738.41 270.477,1725.8 276.447,1713.32 282.416,1700.97 299.897,1665.55 317.377,1631.24 334.858,1598.02 352.339,1565.87 369.819,1534.79 387.3,1504.77 404.781,1475.78 422.261,1447.82 438.525,1422.71 454.789,1398.47 471.053,1375.09 487.317,1352.56 509.117,1323.66 530.917,1296.24 552.717,1270.28 574.517,1245.74 592.53,1226.52 610.544,1208.24 628.557,1190.9 646.57,1174.47 663.321,1160 680.072,1146.3 696.822,1133.35 713.573,1121.15 734.601,1106.88 755.629,1093.73 776.657,1081.7 797.684,1070.76 816.547,1061.86 835.409,1053.79 854.271,1046.56 873.133,1040.13 894.723,1033.75 916.313,1028.38 937.903,1024.01 959.494,1020.6 975.632,1018.67 991.771,1017.26 1007.91,1016.35 1024.05,1015.94 1044.69,1016.13 1065.33,1017.09 1085.97,1018.8 1106.62,1021.25 1125.45,1024.11 1144.29,1027.54 1163.13,1031.53 1181.97,1036.07 1203.42,1041.87 1224.86,1048.34 1246.3,1055.44 1267.74,1063.16 1301.74,1076.59 1335.73,1091.41 1377.97,1111.61 1420.2,1133.62 1452.55,1151.6 1484.89,1170.44 1530.49,1198.35 1576.09,1227.61 1610.17,1250.21 1644.25,1273.35 1721.75,1327.46 1798.51,1382.16 1882.96,1442.34 1947.47,1487.43 1988.16,1515.16 2028.86,1542.14 2066.51,1566.29 2104.15,1589.53 2142.97,1612.42 2181.79,1634.06 2221.14,1654.58 2260.49,1673.54 2281.04,1682.76 2301.58,1691.5 2322.13,1699.73 2342.67,1707.42 2375.04,1718.42 2407.41,1727.98 2425.83,1732.74 2444.26,1736.99 2462.69,1740.71 2481.12,1743.89 2499.55,1746.51 2517.97,1748.57 2536.4,1750.03 2554.83,1750.9 2558.97,1751.01 2563.1,1751.09 2567.24,1751.14 2571.37,1751.15 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="258.539,1751.15 264.508,1751.12 270.477,1751.02 276.447,1750.86 282.416,1750.63 317.377,1748.02 352.339,1743.32 387.3,1736.63 422.261,1728.04 438.525,1723.43 454.789,1718.45 471.053,1713.1 487.317,1707.4 509.117,1699.21 530.917,1690.43 552.717,1681.07 574.517,1671.18 610.544,1653.69 646.57,1634.89 680.072,1616.34 713.573,1596.84 755.629,1571.17 797.684,1544.33 835.409,1519.42 873.133,1493.83 959.494,1433.46 1024.05,1387.42 1106.62,1328.55 1181.97,1275.88 1224.86,1246.78 1267.74,1218.54 1301.74,1196.9 1335.73,1176.01 1377.97,1151.25 1420.2,1128 1452.55,1111.31 1484.89,1095.69 1507.69,1085.36 1530.49,1075.63 1553.29,1066.53 1576.09,1058.08 1610.17,1046.74 1644.25,1037.02 1663.62,1032.25 1683,1028.06 1702.38,1024.46 1721.75,1021.46 1740.94,1019.11 1760.13,1017.4 1779.32,1016.33 1798.51,1015.92 1819.63,1016.26 1840.74,1017.45 1861.85,1019.51 1882.96,1022.46 1899.09,1025.33 1915.21,1028.75 1931.34,1032.72 1947.47,1037.25 1967.81,1043.79 1988.16,1051.27 2008.51,1059.7 2028.86,1069.11 2047.68,1078.7 2066.51,1089.16 2085.33,1100.5 2104.15,1112.74 2123.56,1126.32 2142.97,1140.9 2162.38,1156.49 2181.79,1173.1 2201.47,1191.01 2221.14,1210.01 2240.82,1230.11 2260.49,1251.35 2281.04,1274.75 2301.58,1299.42 2322.13,1325.39 2342.67,1352.66 2358.85,1375.09 2375.04,1398.35 2391.22,1422.47 2407.41,1447.44 2425.83,1476.93 2444.26,1507.56 2462.69,1539.35 2481.12,1572.31 2499.55,1606.46 2517.97,1641.8 2536.4,1678.37 2554.83,1716.16 2558.97,1724.82 2563.1,1733.53 2567.24,1742.31 2571.37,1751.15 "></polyline>
<polyline clip-path="url(#clip252)" style="stroke:#c271d2; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="258.539,1751.15 282.416,1751.15 422.261,1750.56 487.317,1749.55 574.517,1746.93 646.57,1743.34 713.573,1738.55 797.684,1730.2 873.133,1720.11 959.494,1705.1 1024.05,1691.17 1065.33,1680.93 1106.62,1669.59 1144.29,1658.23 1181.97,1645.86 1224.86,1630.5 1267.74,1613.71 1301.74,1599.35 1335.73,1584.02 1377.97,1563.58 1420.2,1541.54 1452.55,1523.54 1484.89,1504.53 1530.49,1475.99 1576.09,1445.32 1610.17,1420.97 1644.25,1395.36 1683,1364.67 1721.75,1332.26 1760.13,1298.43 1798.51,1262.82 1840.74,1221.54 1882.96,1177.99 1915.21,1143.17 1947.47,1106.97 1988.16,1059.27 2028.86,1009.27 2066.51,960.931 2104.15,910.538 2142.97,856.369 2181.79,799.92 2221.14,740.33 2260.49,678.302 2301.58,610.878 2342.67,540.687 2375.04,483.408 2407.41,424.351 2444.26,354.904 2481.12,283.076 2517.97,208.825 2554.83,132.111 2558.97,123.349 2563.1,114.555 2567.24,105.73 2571.37,96.8724 "></polyline>
<path clip-path="url(#clip250)" d="M270.874 364.895 L574.179 364.895 L574.179 105.695 L270.874 105.695  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="270.874,364.895 574.179,364.895 574.179,105.695 270.874,105.695 270.874,364.895 "></polyline>
<polyline clip-path="url(#clip250)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="298.114,157.535 461.554,157.535 "></polyline>
<path clip-path="url(#clip250)" d="M523.038 140.615 Q523.038 142.793 521.539 144.761 Q520.063 146.705 517.815 147.946 Q515.566 149.164 513.013 149.633 Q516.456 150.031 518.447 151.905 Q520.461 153.779 520.461 156.402 Q520.461 158.159 519.431 160.009 Q518.424 161.836 516.69 163.335 Q514.981 164.834 512.451 165.794 Q509.945 166.755 507.204 166.755 L490.082 166.755 Q489.544 166.755 489.333 166.731 Q489.122 166.708 488.958 166.591 Q488.794 166.474 488.794 166.216 Q488.794 165.747 488.958 165.537 Q489.146 165.326 489.356 165.302 Q489.567 165.279 490.082 165.279 Q491.254 165.279 491.956 165.209 Q492.659 165.138 493.104 165.045 Q493.572 164.928 493.807 164.6 Q494.064 164.272 494.181 163.991 Q494.299 163.686 494.462 163.007 L500.88 137.242 Q501.068 136.469 501.068 136.352 Q501.068 135.907 500.787 135.79 Q500.529 135.65 499.779 135.579 L497.952 135.486 Q497.39 135.486 497.156 135.462 Q496.945 135.439 496.781 135.322 Q496.617 135.205 496.617 134.947 Q496.617 134.291 496.898 134.151 Q497.203 133.987 497.999 133.987 L514.114 133.987 Q518.26 133.987 520.649 135.907 Q523.038 137.804 523.038 140.615 M518.681 140.428 Q518.681 139.538 518.447 138.741 Q518.213 137.945 517.651 137.172 Q517.112 136.399 516.035 135.954 Q514.957 135.486 513.458 135.486 L507.251 135.486 Q505.729 135.486 505.354 135.767 Q505.003 136.024 504.675 137.313 L501.7 149.188 L508.703 149.188 Q510.835 149.188 512.709 148.415 Q514.606 147.642 515.894 146.401 Q517.182 145.136 517.932 143.566 Q518.681 141.997 518.681 140.428 M515.988 155.863 Q515.988 155.161 515.871 154.481 Q515.753 153.802 515.379 153.006 Q515.004 152.209 514.418 151.624 Q513.833 151.038 512.802 150.64 Q511.795 150.242 510.483 150.242 L501.419 150.242 L498.093 163.639 Q497.859 164.506 497.859 164.74 Q497.859 164.998 497.976 165.092 Q498.116 165.162 498.491 165.209 Q498.913 165.279 499.545 165.279 L506.057 165.279 Q508.118 165.279 509.992 164.483 Q511.865 163.663 513.154 162.351 Q514.465 161.04 515.215 159.33 Q515.988 157.62 515.988 155.863 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M527.829 169.304 Q527.829 164.369 529.075 161.68 Q530.813 157.68 534.912 157.68 Q535.781 157.68 536.683 157.926 Q537.601 158.155 538.749 159.057 Q539.913 159.959 540.618 161.434 Q541.962 164.287 541.962 169.304 Q541.962 174.207 540.716 176.879 Q538.896 180.781 534.879 180.781 Q533.371 180.781 531.83 180.011 Q530.305 179.24 529.338 177.387 Q527.829 174.616 527.829 169.304 M530.617 168.894 Q530.617 173.961 530.977 175.977 Q531.387 178.158 532.502 179.109 Q533.633 180.043 534.879 180.043 Q536.224 180.043 537.339 179.043 Q538.47 178.027 538.814 175.846 Q539.191 173.698 539.175 168.894 Q539.175 164.222 538.847 162.352 Q538.404 160.172 537.224 159.303 Q536.06 158.417 534.879 158.417 Q534.437 158.417 533.961 158.549 Q533.502 158.68 532.83 159.057 Q532.158 159.434 531.633 160.369 Q531.125 161.303 530.879 162.713 Q530.617 164.533 530.617 168.894 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip250)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="298.114,209.375 461.554,209.375 "></polyline>
<path clip-path="url(#clip250)" d="M523.038 192.823 Q523.038 195.001 521.539 196.968 Q520.063 198.913 517.815 200.154 Q515.566 201.372 513.013 201.84 Q516.456 202.238 518.447 204.112 Q520.461 205.986 520.461 208.609 Q520.461 210.366 519.431 212.216 Q518.424 214.043 516.69 215.542 Q514.981 217.041 512.451 218.002 Q509.945 218.962 507.204 218.962 L490.082 218.962 Q489.544 218.962 489.333 218.939 Q489.122 218.915 488.958 218.798 Q488.794 218.681 488.794 218.423 Q488.794 217.955 488.958 217.744 Q489.146 217.533 489.356 217.51 Q489.567 217.487 490.082 217.487 Q491.254 217.487 491.956 217.416 Q492.659 217.346 493.104 217.252 Q493.572 217.135 493.807 216.807 Q494.064 216.479 494.181 216.198 Q494.299 215.894 494.462 215.215 L500.88 189.45 Q501.068 188.677 501.068 188.56 Q501.068 188.115 500.787 187.998 Q500.529 187.857 499.779 187.787 L497.952 187.693 Q497.39 187.693 497.156 187.67 Q496.945 187.646 496.781 187.529 Q496.617 187.412 496.617 187.154 Q496.617 186.499 496.898 186.358 Q497.203 186.194 497.999 186.194 L514.114 186.194 Q518.26 186.194 520.649 188.115 Q523.038 190.012 523.038 192.823 M518.681 192.635 Q518.681 191.745 518.447 190.949 Q518.213 190.153 517.651 189.38 Q517.112 188.607 516.035 188.162 Q514.957 187.693 513.458 187.693 L507.251 187.693 Q505.729 187.693 505.354 187.974 Q505.003 188.232 504.675 189.52 L501.7 201.395 L508.703 201.395 Q510.835 201.395 512.709 200.622 Q514.606 199.849 515.894 198.608 Q517.182 197.343 517.932 195.774 Q518.681 194.205 518.681 192.635 M515.988 208.071 Q515.988 207.368 515.871 206.689 Q515.753 206.01 515.379 205.213 Q515.004 204.417 514.418 203.831 Q513.833 203.246 512.802 202.847 Q511.795 202.449 510.483 202.449 L501.419 202.449 L498.093 215.847 Q497.859 216.714 497.859 216.948 Q497.859 217.205 497.976 217.299 Q498.116 217.369 498.491 217.416 Q498.913 217.487 499.545 217.487 L506.057 217.487 Q508.118 217.487 509.992 216.69 Q511.865 215.87 513.154 214.559 Q514.465 213.247 515.215 211.537 Q515.988 209.827 515.988 208.071 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M527.829 213.084 L527.829 212.035 Q531.863 212.035 533.945 209.887 Q534.519 209.887 534.617 210.018 Q534.715 210.149 534.715 210.756 L534.715 229.595 Q534.715 230.595 535.207 230.906 Q535.699 231.218 537.847 231.218 L538.913 231.218 L538.913 232.251 Q537.732 232.153 533.469 232.153 Q529.206 232.153 528.042 232.251 L528.042 231.218 L529.108 231.218 Q531.223 231.218 531.731 230.923 Q532.24 230.611 532.24 229.595 L532.24 212.199 Q530.485 213.084 527.829 213.084 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip250)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="298.114,261.215 461.554,261.215 "></polyline>
<path clip-path="url(#clip250)" d="M523.038 244.663 Q523.038 246.841 521.539 248.808 Q520.063 250.753 517.815 251.994 Q515.566 253.212 513.013 253.68 Q516.456 254.078 518.447 255.952 Q520.461 257.826 520.461 260.449 Q520.461 262.206 519.431 264.056 Q518.424 265.883 516.69 267.382 Q514.981 268.881 512.451 269.842 Q509.945 270.802 507.204 270.802 L490.082 270.802 Q489.544 270.802 489.333 270.779 Q489.122 270.755 488.958 270.638 Q488.794 270.521 488.794 270.263 Q488.794 269.795 488.958 269.584 Q489.146 269.373 489.356 269.35 Q489.567 269.327 490.082 269.327 Q491.254 269.327 491.956 269.256 Q492.659 269.186 493.104 269.092 Q493.572 268.975 493.807 268.647 Q494.064 268.319 494.181 268.038 Q494.299 267.734 494.462 267.055 L500.88 241.29 Q501.068 240.517 501.068 240.4 Q501.068 239.955 500.787 239.838 Q500.529 239.697 499.779 239.627 L497.952 239.533 Q497.39 239.533 497.156 239.51 Q496.945 239.486 496.781 239.369 Q496.617 239.252 496.617 238.994 Q496.617 238.339 496.898 238.198 Q497.203 238.034 497.999 238.034 L514.114 238.034 Q518.26 238.034 520.649 239.955 Q523.038 241.852 523.038 244.663 M518.681 244.475 Q518.681 243.585 518.447 242.789 Q518.213 241.993 517.651 241.22 Q517.112 240.447 516.035 240.002 Q514.957 239.533 513.458 239.533 L507.251 239.533 Q505.729 239.533 505.354 239.814 Q505.003 240.072 504.675 241.36 L501.7 253.235 L508.703 253.235 Q510.835 253.235 512.709 252.462 Q514.606 251.689 515.894 250.448 Q517.182 249.183 517.932 247.614 Q518.681 246.045 518.681 244.475 M515.988 259.911 Q515.988 259.208 515.871 258.529 Q515.753 257.85 515.379 257.053 Q515.004 256.257 514.418 255.671 Q513.833 255.086 512.802 254.687 Q511.795 254.289 510.483 254.289 L501.419 254.289 L498.093 267.687 Q497.859 268.554 497.859 268.788 Q497.859 269.045 497.976 269.139 Q498.116 269.209 498.491 269.256 Q498.913 269.327 499.545 269.327 L506.057 269.327 Q508.118 269.327 509.992 268.53 Q511.865 267.71 513.154 266.399 Q514.465 265.087 515.215 263.377 Q515.988 261.667 515.988 259.911 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M527.829 284.091 Q527.829 283.484 527.878 283.304 Q527.944 283.124 528.206 282.845 L534.65 275.664 Q538.175 271.696 538.175 268.236 Q538.175 265.99 536.994 264.383 Q535.83 262.776 533.683 262.776 Q532.207 262.776 530.961 263.678 Q529.715 264.58 529.141 266.187 Q529.239 266.154 529.584 266.154 Q530.42 266.154 530.879 266.679 Q531.354 267.203 531.354 267.908 Q531.354 268.81 530.764 269.253 Q530.19 269.679 529.616 269.679 Q529.387 269.679 529.075 269.63 Q528.78 269.581 528.305 269.122 Q527.829 268.646 527.829 267.81 Q527.829 265.465 529.6 263.596 Q531.387 261.727 534.109 261.727 Q537.191 261.727 539.208 263.563 Q541.241 265.383 541.241 268.236 Q541.241 269.236 540.929 270.155 Q540.634 271.056 540.224 271.761 Q539.831 272.466 538.749 273.598 Q537.667 274.729 536.798 275.532 Q535.929 276.336 533.978 278.041 L530.42 281.5 L536.47 281.5 Q539.421 281.5 539.651 281.238 Q539.978 280.763 540.388 278.254 L541.241 278.254 L540.29 284.091 L527.829 284.091 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip250)" style="stroke:#c271d2; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="298.114,313.055 461.554,313.055 "></polyline>
<path clip-path="url(#clip250)" d="M523.038 296.135 Q523.038 298.313 521.539 300.281 Q520.063 302.225 517.815 303.466 Q515.566 304.684 513.013 305.153 Q516.456 305.551 518.447 307.425 Q520.461 309.299 520.461 311.922 Q520.461 313.679 519.431 315.529 Q518.424 317.356 516.69 318.855 Q514.981 320.354 512.451 321.314 Q509.945 322.275 507.204 322.275 L490.082 322.275 Q489.544 322.275 489.333 322.251 Q489.122 322.228 488.958 322.111 Q488.794 321.994 488.794 321.736 Q488.794 321.267 488.958 321.057 Q489.146 320.846 489.356 320.822 Q489.567 320.799 490.082 320.799 Q491.254 320.799 491.956 320.729 Q492.659 320.658 493.104 320.565 Q493.572 320.448 493.807 320.12 Q494.064 319.792 494.181 319.511 Q494.299 319.206 494.462 318.527 L500.88 292.762 Q501.068 291.989 501.068 291.872 Q501.068 291.427 500.787 291.31 Q500.529 291.17 499.779 291.099 L497.952 291.006 Q497.39 291.006 497.156 290.982 Q496.945 290.959 496.781 290.842 Q496.617 290.725 496.617 290.467 Q496.617 289.811 496.898 289.671 Q497.203 289.507 497.999 289.507 L514.114 289.507 Q518.26 289.507 520.649 291.427 Q523.038 293.324 523.038 296.135 M518.681 295.948 Q518.681 295.058 518.447 294.261 Q518.213 293.465 517.651 292.692 Q517.112 291.919 516.035 291.474 Q514.957 291.006 513.458 291.006 L507.251 291.006 Q505.729 291.006 505.354 291.287 Q505.003 291.544 504.675 292.833 L501.7 304.708 L508.703 304.708 Q510.835 304.708 512.709 303.935 Q514.606 303.162 515.894 301.921 Q517.182 300.656 517.932 299.086 Q518.681 297.517 518.681 295.948 M515.988 311.383 Q515.988 310.681 515.871 310.001 Q515.753 309.322 515.379 308.526 Q515.004 307.729 514.418 307.144 Q513.833 306.558 512.802 306.16 Q511.795 305.762 510.483 305.762 L501.419 305.762 L498.093 319.159 Q497.859 320.026 497.859 320.26 Q497.859 320.518 497.976 320.612 Q498.116 320.682 498.491 320.729 Q498.913 320.799 499.545 320.799 L506.057 320.799 Q508.118 320.799 509.992 320.003 Q511.865 319.183 513.154 317.871 Q514.465 316.56 515.215 314.85 Q515.988 313.14 515.988 311.383 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip250)" d="M527.829 331.038 Q527.829 330.038 528.403 329.563 Q528.977 329.087 529.715 329.087 Q530.485 329.087 531.026 329.595 Q531.584 330.087 531.584 330.956 Q531.584 331.891 530.928 332.415 Q530.289 332.94 529.37 332.809 Q530.174 334.153 531.649 334.76 Q533.141 335.367 534.519 335.367 Q535.962 335.367 537.126 334.121 Q538.306 332.875 538.306 329.825 Q538.306 327.234 537.29 325.742 Q536.289 324.25 534.306 324.25 L532.83 324.25 Q532.322 324.25 532.174 324.201 Q532.027 324.152 532.027 323.873 Q532.027 323.545 532.535 323.48 Q533.043 323.48 533.846 323.381 Q535.798 323.316 536.83 321.627 Q537.765 320.053 537.765 317.807 Q537.765 315.757 536.781 314.905 Q535.814 314.036 534.551 314.036 Q533.371 314.036 532.076 314.528 Q530.78 315.02 530.075 316.118 Q532.158 316.118 532.158 317.807 Q532.158 318.545 531.682 319.037 Q531.223 319.512 530.453 319.512 Q529.715 319.512 529.223 319.053 Q528.731 318.577 528.731 317.774 Q528.731 315.856 530.436 314.528 Q532.158 313.2 534.683 313.2 Q537.175 313.2 539.011 314.511 Q540.864 315.823 540.864 317.84 Q540.864 319.824 539.552 321.447 Q538.241 323.07 536.158 323.742 Q538.716 324.25 540.241 325.988 Q541.766 327.71 541.766 329.825 Q541.766 332.448 539.7 334.383 Q537.634 336.301 534.617 336.301 Q531.83 336.301 529.83 334.793 Q527.829 333.284 527.829 331.038 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<p>Some important properties of the Bernstein polynomials are given in the following theorem.</p>
<div id="thm-bernstein-poly-properties" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Berstein polynomial properties)</strong></span> The Bernstein polynomials <img src="https://latex.codecogs.com/png.latex?B_i%5E%7Bn%7D(t)"> have the following properties:</p>
<ol type="1">
<li><em>Non-negativity</em>: <img src="https://latex.codecogs.com/png.latex?B_i%5E%7Bn%7D(t)%20%3E%200">, <img src="https://latex.codecogs.com/png.latex?t%5Cin(0,1)"></li>
<li><em>Symmetry</em>: <img src="https://latex.codecogs.com/png.latex?B_i%5E%7Bn%7D(t)=B_%7Bn-i%7D%5E%7Bn%7D(1-t)"></li>
<li><img src="https://latex.codecogs.com/png.latex?B_i%5E%7Bn%7D(t)"> has a root <img src="https://latex.codecogs.com/png.latex?t=0"> of multiplicity <img src="https://latex.codecogs.com/png.latex?i"> and a root <img src="https://latex.codecogs.com/png.latex?t=1"> of multiplicity <img src="https://latex.codecogs.com/png.latex?n-i"></li>
<li>The Bernstein polynomials <img src="https://latex.codecogs.com/png.latex?B_i%5E%7Bn%7D(t)"> have a unique maximum value at <img src="https://latex.codecogs.com/png.latex?t=i/n"> on <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D"></li>
<li>The Bernstein polynomials satisfy the following recursion formula: <span id="eq-bernstein-recursion-formula"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AB_i%5En(t)%20=%20(1-t)B_i%5E%7Bn-1%7D(t)%20+%20tB_%7Bi-1%7D%5E%7Bn-1%7D(t),%5Cquad%20i=0:n%0A%5Cend%7Balign*%7D%0A%5Ctag%7B6%7D"></span></li>
</ol>
</div>
<ol start="6" type="1">
<li>The Bernstein polynomials of degree <img src="https://latex.codecogs.com/png.latex?n"> form a basis for the space of polynomials of degree <img src="https://latex.codecogs.com/png.latex?%5Cleq%20n">.</li>
</ol>
<p><em>Proof.</em></p>
<p><em>Non-negativity</em>: For <img src="https://latex.codecogs.com/png.latex?t%5Cin%5B0,1%5D">, <img src="https://latex.codecogs.com/png.latex?0%3C1-t%3C1">, so <img src="https://latex.codecogs.com/png.latex?B_i%5E%7Bn%7D(t)%20%5Cgeq%200">.</p>
<p><em>Symmetry</em>: Since <img src="https://latex.codecogs.com/png.latex?%7Bn%20%5Cchoose%20k%7D%20=%20%7Bn%20%5Cchoose%20n-k%7D">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AB_k%5E%7Bn%7D(t)%20=%20%7Bn%20%5Cchoose%20k%7Dt%5Ek%20(1-t)%5E%7Bn-k%7D%20=%20%7Bn%20%5Cchoose%20(n-k)%7D%20(1-t)%5E%7Bn-k%7D%20t%5Ek%20=%20B_%7Bn-k%7D%5En(1-t)%0A"></p>
<p><em>Roots</em>. By definition, <img src="https://latex.codecogs.com/png.latex?B_k%5E%7Bn%7D(t)%20=%20%7Bn%20%5Cchoose%20k%7Dt%5Ek%20(1-t)%5E%7Bn-k%7D"> so it has a root <img src="https://latex.codecogs.com/png.latex?t=0"> with multiplicity <img src="https://latex.codecogs.com/png.latex?k"> and a root <img src="https://latex.codecogs.com/png.latex?t=1"> with multiplicity <img src="https://latex.codecogs.com/png.latex?(n-k)">.</p>
<p>Moreover, differentiating <img src="https://latex.codecogs.com/png.latex?B_k%5E%7Bn%7D(t)"> with respect to <img src="https://latex.codecogs.com/png.latex?t">, setting the first derivative equal to <img src="https://latex.codecogs.com/png.latex?0">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7Bd%7D%7Bdt%7D(B_k%5E%7Bn%7D(t))%20&amp;=%20%7Bn%20%5Cchoose%20k%7D%20kt%5E%7Bk-1%7D%20(1-t)%5E%7Bn-k%7D%20-%20(n-k)t%5Ek(1-t)%5E%7Bn-k-1%7D%20=%200%20%5C%5C%0A0%20&amp;=%20k(1-t)%20-%20(n-k)t%20%5C%5C%0A0%20&amp;=%20k%20-%20kt%20-%20nt%20+%20kt%20%5C%5C%0Ant%20&amp;=%20k%20%5C%5C%0At%20&amp;=%20%5Cfrac%7Bk%7D%7Bn%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Consider the combinatorial identity:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7Bn%20%5Cchoose%20k%7D%20=%20%7Bn-1%20%5Cchoose%20k%7D%20+%20%7Bn%20-%201%5Cchoose%20k%20-%201%7D%0A"></p>
<p>Assume that we would like to assemble team of size <img src="https://latex.codecogs.com/png.latex?k"> from a population of size <img src="https://latex.codecogs.com/png.latex?n">. There are <img src="https://latex.codecogs.com/png.latex?%7Bn%20%5Cchoose%20k%7D"> distinguishable teams. Another way to count is as follows. Label one member of the population as president. Then, there are <img src="https://latex.codecogs.com/png.latex?%7Bn%20-%201%20%5Cchoose%20k%7D"> distinguishable teams that always include the president and <img src="https://latex.codecogs.com/png.latex?%7Bn%20-%201%20%5Cchoose%20k%20-%201%7D"> distinct teams excluding the president. The sum must equal <img src="https://latex.codecogs.com/png.latex?%7Bn%20%5Cchoose%20k%7D">.</p>
<p>We can use this to prove the recursion formula:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%7Bn%20%5Cchoose%20k%7Dt%5Ek(1-t)%5E%7Bn-k%7D%20&amp;=%20%7Bn-1%20%5Cchoose%20k%7Dt%5Ek(1-t)%5E%7Bn-k%7D%20+%20%7Bn%20-%201%5Cchoose%20k%20-%201%7Dt%5Ek(1-t)%5E%7Bn-k%7D%5C%5C%0A&amp;=%20(1-t)%20%7Bn-1%20%5Cchoose%20k%7Dt%5Ek(1-t)%5E%7Bn-1-k%7D%20+%20t%7Bn%20-%201%5Cchoose%20k%20-%201%7Dt%5E%7Bk-1%7D(1-t)%5E%7B(n-1)-(k-1)%7D%5C%5C%0A&amp;=%20(1-t)B_%7Bk%7D%5E%7Bn-1%7D(t)%20+%20tB_%7Bk-1%7D%5E%7Bn-1%7D(t)%0A%5Cend%7Balign*%7D%0A"></p>
<p>To show the linear independence, we observe that if:</p>
<p><span id="eq-linear-independence"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csum_%7Bi=0%7D%5En%20a_i%20B_i%5E%7Bn%7D(t)%20&amp;%5Cequiv%200%0A%5Cend%7Balign*%7D%0A%5Ctag%7B7%7D"></span></p>
<p>for all <img src="https://latex.codecogs.com/png.latex?t%20%5Cin%20%5B0,1%5D">. Then, expanding and substituting <img src="https://latex.codecogs.com/png.latex?t=1"> in the above expression, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csum_%7Bi=0%7D%5En%20a_i%20B_i%5E%7Bn%7D(i)%20&amp;=%200%5C%5C%0Aa_0%20(1-t)%5En%20+%20a_1%20%7Bn%20%5Cchoose%201%7D%20(1-t)%5E%7Bn-1%7Dt%20+%20%5Cldots%20+%20a_n%20t%5En%20&amp;=%200%5C%5C%0Aa_n%20&amp;=%200%0A%5Cend%7Balign*%7D%0A"></p>
<p>Substituting <img src="https://latex.codecogs.com/png.latex?a_n%20=%200"> in Equation&nbsp;7, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Aa_0%20(1-t)%5En%20+%20a_1%20%7Bn%20%5Cchoose%201%7D%20(1-t)%5E%7Bn-1%7D%20t%20+%20%5Cldots%20+%20a_%7Bn-1%7D(1-t)t%5E%7Bn-1%7D%20&amp;=%200%5C%5C%0Aa_0%20(1-t)%5E%7Bn-1%7D%20+%20a_1%20%7Bn%20%5Cchoose%201%7D%20(1-t)%5E%7Bn-2%7D%20t%20+%20%5Cldots%20+%20a_%7Bn-1%7Dt%5E%7Bn-1%7D%20&amp;=%200%0A%5Cend%7Balign*%7D%0A"></p>
<p>Again, subbing <img src="https://latex.codecogs.com/png.latex?t=1">, we find that <img src="https://latex.codecogs.com/png.latex?a_%7Bn-1%7D=0">. By repeatedly dividing by <img src="https://latex.codecogs.com/png.latex?(1-t)"> and using the same argument, we find that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aa_0%20=%20a_1%20=%20%5Cldots%20=%20a_n%20=%200%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<p>The unique parametric <strong>Bezier curve</strong> corresponding to a given set of <img src="https://latex.codecogs.com/png.latex?n+1"> <strong>control points</strong> <img src="https://latex.codecogs.com/png.latex?p_i">, <img src="https://latex.codecogs.com/png.latex?i=0:n">, equals:</p>
<p><span id="eq-unique-bezier-curve"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ac(t)%20=%20%5Csum_%7Bi=0%7D%5En%20p_i%20B_i%5E%7Bn%7D(t),%20%5Cquad%20t%5Cin%5B0,1%5D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B8%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?B_i%5E%7Bn%7D(t)"> are Bernstein polynomials of degree <img src="https://latex.codecogs.com/png.latex?n">. By property 3, in Theorem&nbsp;2, the Bezier curve <em>interpolates the first and last control points</em> <img src="https://latex.codecogs.com/png.latex?p_0"> and <img src="https://latex.codecogs.com/png.latex?p_n">. Often, a curve is constructed by smoothly patching together several Bezier curves of low order.</p>
</section>
<section id="intuition" class="level3">
<h3 class="anchored" data-anchor-id="intuition">Intuition</h3>
<section id="the-case-n1" class="level4">
<h4 class="anchored" data-anchor-id="the-case-n1">The case <img src="https://latex.codecogs.com/png.latex?n=1"></h4>
<p>Imagine a particle travelling in a straight line joining the points <img src="https://latex.codecogs.com/png.latex?p_0=(x_0,y_0)"> and <img src="https://latex.codecogs.com/png.latex?p_1=(x_1,y_1)">, where the time <img src="https://latex.codecogs.com/png.latex?t%5Cin%5B0,1%5D">. Let’s compute the position <img src="https://latex.codecogs.com/png.latex?c(t)=(x(t),y(t))"> of the particle at time <img src="https://latex.codecogs.com/png.latex?t">. The point <img src="https://latex.codecogs.com/png.latex?c(t)"> divides the straight-line <img src="https://latex.codecogs.com/png.latex?p_0p_1"> in the proportion <img src="https://latex.codecogs.com/png.latex?t:(1-t)">. By the section formula, the position vector of <img src="https://latex.codecogs.com/png.latex?c(t)"> is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A(x(t),y(t))%20&amp;=%20((1-t)x_0%20+%20tx_1,%20(1-t)y_0%20+%20ty_1)%5C%5C%0A&amp;=%20(1-t)(x_0,y_0)%20+%20t(x_1,y_1)%5C%5C%0A&amp;=%20(1-t)p_0%20+%20tp_1%0A%5Cend%7Balign*%7D%0A"></p>
<p>This is the parametric equation of motion of the particle. It is the Bezier curve for <img src="https://latex.codecogs.com/png.latex?n=1">. The points <img src="https://latex.codecogs.com/png.latex?p_0"> and <img src="https://latex.codecogs.com/png.latex?p_1"> control what the straight-line path looks like, so they are called <strong>control-points</strong>.</p>
<div id="f91e0837" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Plots</span></span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">LaTeXStrings</span></span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_1</span>(t, a, b)</span>
<span id="cb2-5">    @. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b</span>
<span id="cb2-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-7"></span>
<span id="cb2-8">tvec <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)</span>
<span id="cb2-9">pts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb2-10">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>;</span>
<span id="cb2-11">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>;</span>
<span id="cb2-12">]</span>
<span id="cb2-13"></span>
<span id="cb2-14">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_1</span>(tvec, pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb2-15">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_1</span>(tvec, pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb2-16"></span>
<span id="cb2-17"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@gif</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (xVal, yVal) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zip</span>(x,y)</span>
<span id="cb2-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(x, y, line<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>path,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>dash,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>gray))</span>
<span id="cb2-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scatter!</span>([xVal], [yVal], marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>circle,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>green,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>green))</span>
<span id="cb2-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[ Info: Saved animation to C:\Data\dev\repo\quantinsights.github.io\posts\interpolation-and-approximation\tmp.gif</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<img src="https://quantdev.blog/posts/interpolation-and-approximation/data:image/gif;base64,R0lGODlhhQLMAfcQAAAAAAABAAAsAAAuAAAxAAA+AABNAABUAABYAABgAABpAABwAAB0AAB6AAB+AACAAAD/AAEFAQEKAQEYAQICAgIRAgJKAgMDAwUFBQVABQcHBwkJCQoKCgowCgo5CgsLCwsRCwsUCwwMDAwcDAwoDA4ODg43Dg8XDw8cDxAQEBApEBERERE0ERISEhMTExMsExQUFBUVFRYcFhcXFxgYGBggGBoaGhsbGxsjGxwcHB4eHh8fHyAgICAoICEhISIiIiMjIyQkJCQsJCUlJSYmJiYzJigoKCkxKSoqKisrKys0Ky0tLS0uLS01LS8vLzExMTMzMzM0MzU1NTc3Nzg4ODo6OjpCOjw8PD09PT4+PkBAQEFCQUNDQ0RMREVFRUdHR0hISEpKSkxMTExUTE1NTU9PT1BQUFFRUVNTU1VVVVdXV1lZWVpaWltcW11dXV9fX2FhYWJjYmNoY2VlZWZmZmdnZ2hoaGpqamtra21tbW9vb3FxcXNzc3R0dHd3d3h4eHp6enp7enx8fH1+fX5/foCAgIGBgYODg4WFhYaHhoiIiImJiYmKiYqLiouNi4yMjI2NjY6Ojo6Qjo+Pj4+Qj5CQkJCSkJGRkZKSkpOTk5SVlJSWlJaWlpeXl5eZl5iYmJmZmZmamZqampqbmpycnJyenJ2dnZ6enp+fn6GhoaKioqKjoqSkpKampqanpqioqKipqKmrqaqqqqurq6ysrKytrKytrK6urq+vr7CxsLKysrOzs7S0tLa2tre3t7i4uLq6uru7u7y8vL29vb2+vb+/v8DAwMHBwcLCwsPDw8TExMXFxcfHx8jIyMnJycvLy8zMzM3Nzc7Ozs/Pz9DQ0NHR0dPT09XV1dfX19jY2NnZ2dra2tvb293d3d7e3t/f3+Dg4OHh4eLi4uPj4+Tk5OXl5ebm5ufn5+jo6Onp6erq6uvr6+zs7O3t7e7u7u/v7/Dw8PHx8fLy8vPz8/T09PX19fb29vf39/j4+Pn5+fr6+vv7+/z8/P39/f7+/v/yH/C05FVFNDQVBFMi4wAwEAAAAh+QQFBQAQACwAAAAAhQLMAYcAAAAAAQAALAAALgAAMQAAPgAATQAAVAAAWAAAYAAAaQAAcAAAdAAAegAAfgAAgAAA/wABBQEBCgEBGAECAgICEQICSgIDAwMFBQUFQAUHBwcJCQkKCgoKMAoKOQoLCwsLEQsLFAsMDAwMHAwMKAwODg4ONw4PFw8PHA8QEBAQKRARERERNBESEhITExMTLBMUFBQVFRUWHBYXFxcYGBgYIBgaGhobGxsbIxscHBweHh4fHx8gICAgKCAhISEiIiIjIyMkJCQkLCQlJSUmJiYmMyYoKCgpMSkqKiorKysrNCstLS0tLi0tNS0vLy8xMTEzMzMzNDM1NTU3Nzc4ODg6Ojo6Qjo8PDw9PT0+Pj5AQEBBQkFDQ0NETERFRUVHR0dISEhKSkpMTExMVExNTU1PT09QUFBRUVFTU1NVVVVXV1dZWVlaWlpbXFtdXV1fX19hYWFiY2JjaGNlZWVmZmZnZ2doaGhqampra2ttbW1vb29xcXFzc3N0dHR3d3d4eHh6enp6e3p8fHx9fn1+f36AgICBgYGDg4OFhYWGh4aIiIiJiYmJiomKi4qLjYuMjIyNjY2Ojo6OkI6Pj4+PkI+QkJCQkpCRkZGSkpKTk5OUlZSUlpSWlpaXl5eXmZeYmJiZmZmZmpmampqam5qcnJycnpydnZ2enp6fn5+hoaGioqKio6KkpKSmpqamp6aoqKioqaipq6mqqqqrq6usrKysrayurq6vr6+wsbCysrKzs7O0tLS2tra3t7e4uLi6urq7u7u8vLy9vb29vr2/v7/AwMDBwcHCwsLDw8PExMTFxcXHx8fIyMjJycnLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHT09PV1dXX19fY2NjZ2dna2trb29vd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7/8I/wD9CRxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjypxJs6bNmzhz6tzJs6fPn0CDCh1KtKjRo0iTKl3KtKnTp1CjSp1KtarVq1izat3KtavXr2DDih1LtqzZs2jTql3Ltq3bt3Dj2mwnt67du3h/qiPyUB++vBLpAQ48OKLgwg7z5Ttq7sfDfPcQO5wn2aG8yg0vY1aI76/Rxo8jb05IeXRCzaYPok5NsDNjx4lFsyZYejbB1bb94Z7t+jPshpBzD6wtfPds46l7FwUdW7hA4rmRp5Y+WjlR5sBl54Zum/po75itw/98x6/gPM8IsTMM7pz7cecCwVcWL3JVlhiLDmZbwsOGr+dk0ABDfun9tp52trnHmnyVMYgYfSEFA0wahRz0RSL+DDPDX4eI0U85M1RTYEP8bNLEEY3oI5yC08GnG3wQihRHhQWpc4E7AiHRiz9J7CIQHYCMyNAhJCigQAd5rOiig4gxOViMIc1oUDQxDETGJ/6IcI1AirSRng3AhAnMOwjJ0IADDzgQgpLwOTmYm3lBCZKUBSlzw0BpRNLPBdwIVMkZCIEjwhmEnlGMPIgmiigIaD7wQAjqKCrppJRWaumlmGaq6aacdqooOp6GKuqopJZK6jmmpqrqqqxqimqrsMb/Kmuo7LDD6WEX0UkQNxuU508WrvhzQzMCBXKHkAttcYCjCPSAHmssmgZnXtOupA432Gar7bbcduvtt+CGu61gcn6kKz6U7aMDMv7AI8I3/qiBoT9UtIKsQuEIoYIKPahySTgJLimwT0wsAcXBCCes8MIMN+zwwxAjrEMg/pTL0S90GAEFHdD408kVAnUCRCNYwCHQMy0c8kYSzxKknkL8UOPMPv5wE8kx/UA7sHPVqoSEN0Vh4kfFLYuUjSxIyyKOP9sAM9Awh7hCs0DXJNIJmfcuxJ4/9Lwyjc5t7szTz0EPbfFOLyu09XZiR/cT2UQJTfRroSG0TtGDRftd2zrB/z2U3GfrlHZCaxOkDCbjYKb3Zj3b1ThKfgsFON5ADY5Q4bvenDNii2P2uFyfmxR5UJPT3VxC9LhCCl2Fdd4g3zmNDlTpvtW90DSQUNM67Au+DXRO+kyTyi8H0b6cgVojiFA6p+AImOuShQ6X9CTJThMnRjABqEHGX4e82sqDzTPvN1m/Uj+0iBYPLgNhsn1B3Q9l+UGYM/TN5nVB3yT5Npm/0hf28kcm1NC+9xEkfkKZn0HqtxBZoAJrctFfYajnFgqKJHLrUIUGN6iKVwwEHRzcIC0GQo4QapB9AgHHBn1UEFxoQSBPGEYBi2c2yv1EgQVh4EKcAQlr5I9/e/NJ5P/4UY4iGrEc6RjIPo5oRHUMRB9MLOI6BpIPI7KOIPvggTWUEQT8uY+Gc6vd6SSijk/gwoZokeCbgEgT/63kEHx4AyQOaMD21dB02akIP4jxL7ioETAWZEsgQeJGlZiDBitwoj/00Y5FhKEd9YDfHcWYR4twI4Bu+SO12DiTQqrkDF4SiDJ+QMofPEKSYTye7dg0vrAJ8XcyyccQkuEQBAYFhwTRoUTw0Q22aBIvg1RLMD3iyZPkAgtieIgtK/c9woWPIvQwIxrB8su7DBMt1+RIMRNyj2GYohXawAg3lqGiWk5SlWPMyB77mEZOvu6VFREFDABATwBwYRse2cc5yon/ysDlBJdUfKYlJ4Gzs1TTce6MyTYNcggAVKAACDjAAALgAnxuhA8pCEIKDsG9c3pvlRxJ3QPNctC6ZNMsJ9XIQglSDQpM4EyOegACAsAFjujiMt9IATP6OU2eAFQguryIM45B0oTuD54S6QMAEhDTmAogAOCYCD+c8DV/EAMLBXFCLXiKxwPBp6SgM+pLVjqQL0SgUU01AAB0QZFD4EEga8gEQYwxA3ZwlZJeJQk6yiEWsMYlpWQBLEbIKhAtSKCpMT0AAGZBEXPEYB7qWMEVtaEDFh7Qo/Jr5uUEyhFyTMIY+OuKX6cnVpcQ1h9wCMACEPuAAgCgYxRRgykaEYeB/3jDB8HqaCo/mk6RpG51XxntWwQrFuJa5LS4AAABELsACezAVxMphhSIsFN/hCMIqkDIMm+oWfpx1iPTeITuRFtaQPpuIv3gAgAGoIAHNAABFQjALS6yBCYMpAo0SIN+eXFXdFbyJGW8RU+hItwKlpclp/XHO8JAzwjQcwOmwEgZOjEQXyRNFuG87G4zC1KT7CMYvdxKgdtiXLCUmCIJFogw8hCGNCzCHBchBytm4Lrt+uSn/giq4g4MzPPKRBZvWIYyMZvA7i7wuyS5BgSrMmJB8thnsJQckW9p5BwieSTU6OFVmryWE3vFyxJJMUxs3BMc65gkAR4wUrgszCenRP/MLyGzT6ucyyuTZJ0Amwqb0wJmrvQZInB2iZzRRueAzoQbBA2tU/aMTTdDLsqkmzIzO/wSeuwiklFh9Fn+rBVOOyQKOiilqEdN6lKb+tSoTjWpYVAhf+LEzHbmnKPD6pN6tOPWuM61rnfN6177+tfA1rWKXH0TWOOkH8pQM1A0jdJZw4XYNjE2Tn6BiaUxhdll8TRWtG0VaNdE2jhBNGiXgu3AOvst3qYJuHHStVMs2SjlHgu3rTJvqqR7JuvOyTO0vOZzDxdGyn51oYEa65eooxhJiXdx/d2We8sk37NReFjqTRWKS8XhMYE4T9zRDEX/ROImZjhbMA4Tje/kHq7/cPdQQP4Vi0vF5VAh+UtMzhPcjXfZIneyc2TuEprzJM04d2UrhcPzlvicJ/ugNl99wvIv51wtRWfJ0XvSDR8y/elt3nnAiz3wHBc8b1jnM8C7mjymYMPqOWl6V2AOFbY7JeormTpQ2PEJAac97I3WOtnB15R1RvUmavcz3s0Cd0N2/cxC6cYkgAHdmQR+K253SuSZUviUyH0o7Z734zs9+LJUHiWXJwo1pkiTzWdl8kxBvVI+f5LQ707oxRk7XsteFWJY+yWm33bnycJ6k7jeKIovhsdTkvurqF4px0dK70vye6PYgxajuOJKik/v3Y9l+SRp/lHCe3OVUL8qyUdK/iNgv2RaP8o6gCFLYZPku9X3PpiKb9Izn+UfTyj8Sdx/1TGbxT+E0X+IUF/dqF/Lwd/YQGAICGASZEPtvBuIkGAUeF/RCGBQoGAH6GASbFvIlISENh2BggWFugRGJgU6WcLXzcRHfgUFCgUKwgUIdgRI5gUfjcSKSh5H/gVL8gRMagUiqcMD3iDLSd7/pVXY1EP2PCDsOc2ejd7fNceQOh0SziEtHcW4aALJ7gQNdgULQgUW+gTObgRO+gUSXcJt5cRWZh6T8gVX6gRYfgUisd4GnGGS9GFPkGHPLGGGdGGT1EPr6ByGCGHyJeGW4GHGKGHULFvfXIRgJgUdsgTjf+oE4R4EYYIFexwDn8oiJAnhLz1X2yThN2hiRzWW26hDOMmEYsofpiYFZFoEZM4Fc8XfaaYiqcHikVGaW9hcxFxikfxiDrBizixihXRilWxDqAgC/bwELrYf7J4FcDYWId3hWSxD8BwCc7DEMlYFL6IE9loE804EcJ4FeRgZ9c4gcvYbVsXbc/4VeVYfVG4iURYGK7QfQYxjkOxjTZhjzTRjRLxjVpBjCaIEPTIgutob+f4belYGXtUCX9nHgP5fu0YipwoGd6wePgXkEGBjzSBkTKhjxHBj13Bh6cQWhbJhQ15cQVZEYIwAzNAIwThBaJGYcIgauiQNU1oGuTAkJ7/+B4PKRK6MATroA5BsCMEAQ+3Bg4b4EO5sAW4hn8D4ZFkMZI/oZEyIZUwAYAuJhCJwAYIIQpUIBC54AVMWRBOCRb00AnhAJV1WJJRAYBQgEK10JUHQQWk4JUa0AIxEAhh6Q/mkAPP0JfTwFmINxjeUAm8kJfSopYxd5ITYQT/4Q+9gAQHcQ0iEA8CoQ500Q1DIAqBsgFP0JlQ8AuX0g7rMCukWZqmiSjswAqfIA6n2ZquqSqv8pqyOZudEpu0eZu4KSm1cisXkQUBxApbcBB7YDIGkQhrQJPO9FXcF3s5mRyKmVTH4g91ECQFgQ8zQEsGYQfRaRBj2Vf+QIxO84nN/2kaANgNLdAIi+ACUWUNGDAQtEAE+GMIh3AKeJACaCeWB8km+yB9LTKe1fGcEnENgAAI2SAQ7FAJA9ELwUAQzmAIedAIiYOcm6WO/hlERAegJZefnUgQ1oAK1eg5iPkUHAkR3RkW7hFez2ChzHmhe5ecTngQxFgL0Jh1Q5cbI/oQJUpNCSGN7HRUNWobN+oQORpcC6F4W+KjK2qjGDpzGhowC3EPx4ikSsiiTOiirJSkU6qkLTqhL+oQuyCjm1Sh4bGkPdekEQcRCbmQJhWib0emRmem4vMQgwmHayqm8+GmUgenqfFH9QALpvCh/2ankhGkDTGkXvFL0AAJDqhzP/KG3gad3pqGtVUD+xHo1jqqFvqXRSKEVNDYmzaFITKEIZKXhnBCcRgmOYmqA/yqIZni3uqEX36p4x6qawRqgsxqlwhXLiTopaapUDKqpYXqaNRYO5gCsYodqpaGLaqELgqYh7BD8CAJXnXqLUKrKAnrJvBZYsxrbTqnJl6ZJsKEv0wox6YrE9ira2HrTsmEu2QO6lKrd5apVx6pSCxDqIAphP3qZSHrr6nrpXBbNDao1AIr+TJr8znr5JRbnOKquCnr0uxrAnRrFoRb30qlGvnsKtnsNmHsLKWEpXKjgT7n99qZeGaEvewrbNoroABsRKqqV2qEtYgsCDbrQU7snX/VrIpsbC6p7JxorHmx7Gv1xKxCqgFyLN4wbIHIbFZsXnR4K4Na7R3gbTcCbRgFxPrMApH6JAhuxlSi5+uKqkYG4g7SWVfO6w3QR4RGLbK57PzR7XPcxO+AFwqqLZH0bUu47Z5oX8oOrdQaxd225R4ixcEWKzHioZ9Wxd/KxBKixUQyA/BILO7SLfkx7YBGLh3kYLeoAmYxoiSWxSJq5eWO4Cdi420SLaiGKc9YYmRe7hy8bmLu2VA0Q+jgK/kyLpx4bqh+0NA4biQG5WjOxS4W7bZOhQ6K5C2+2yUm4C5G0FEcQ/QZ1cX+bsVmLwXuLxxcY3RkFskebzoRr0iaL1+/yS9xkulUliTG3oU96C6jii+Lui9MAi+b2GR7VAJw8CwMUGVMIG/LhG8p/uqSmEPsiC3OaG/LkHALMG/EXmmTNG08lgTBswSD6wSCPyOTsoUhLu5Dsy+PzHBU3i+S8EPwuCDNxHBKkHCKMHB5lvBNHuYYztp/Qu2U5EORFvAGuyF7quD8JtJVJENTnu/NdwTKGylHgwVhBulL2HCKIHEJhHE8zrEUJGQ8HLEP3yHNwyGOdwWaLkQg1m/NMy9bsHELkuvVGEPt1CGJTzFOwHG4Pqyviqe5OuOHazCWqEN5EoRSmwSd0wSakyybJwVx3AJaloSeUwSgywSe3yzfZwV4v9wCb1gvxtRyCIBySBxyIaWyFlxD7UgCtBLyGgMiVXMhlfsS2IhDT0cyZ2cE5RMcDjbFewwC50aEpIMErHsEansdavcO17ccJ+ch6G8FlmcEfsgDY48EbPsEcXMEbUcmEFLFvwQwPypEcfMEdGsEclcx8yLFnvbEdMMzaXrwgmMumVxwdJ8yr+4y4XYy2rxyxzBu3mWEdvszt3MXcK7rmvxDTLEzbk8cuYsieicFurci+R8E9V8y2mxDvdJzAHNjfvMiv3cTnARD6NAC0YsEe+MERVtEQNtyWoBwgppxwldExktxm6xyL3wypbx0fm40MHY0AZ1FwBMCjOsEBdtETP/TREh7cRwMQ1H+hA17dEtLM8vbLb5PKu/arOVLNJ2gQ2BjBA9jdA/fWMsXVSFIQ70y7BNTdHxDNXz/K+SgcmaLNMoPRM3LceDQcpVpRphvZEq7YxbnbCbwQ6jMAt4c9URQdcPMdYKjBn8oAwzbNc8ndVlFtVl8c8DnNYxAYD3cAc7IAXEYBB5wAWQ3QgCwQ9/4ANPMF8tu8ZIXRnGcEV+fdJP3RGG8AXtsAsuAA8FQQWg0Je/8wlSkA7KsALt7LVBPbyzkWVV9dmZAdgcoQMI5w9cEGEEQQWNTRBSAAsC0QaIkNl8vNmVUaywUA+6zRDTzRlsew8BoEh68AepPQM0/yAGBeoP9ikQiPAG6bED2eINqKrMVWsbCbnTK8y1bIsOAHAYgFAHBeEM8gAPfjAE+dAPFBBil1AGgaIBPHDgPLALoTmaudnguQkqDh7hs3kNkACaEn7hrWmbGL7hsbKbm4IrE7EPF3CT/nAHhIAQ/CACIjID0iAQhUAHzI3Izj0a64AMHwuioc0RT2ALMITZBvEOGAA0YEBh/hAGRD61bd2xW8s4vL0RqTAEugAIQaAiqwAo5LAHswALVxAGOdMLNGALi0ADqJ20gv2UO1MPvjDRKlrUJ+EKbbAHEdoMmjkPifAGcdAJ6KELboAHGUbmSb7MU9oPwlAJUczCbwyRFP+c11gqDphQ0oaupfIaxjjdnwTh1Zv8Todei7VNz91Kygc9QU0uOGU+FoStjQnRDp++RjlOaH/e3vHN5Ksu6q3+tnbKDcYwzESNqZGu2ZP+6AlhD7MAi+YV6/806t6pqqTc4mGa6ab7zf675AQB3RhMa8zuzYkOzjr5EBwNYwhF7AI363lbXuKgvtQO6eUrxGSd7a9+p0atyhrt6xJxDMoeqNUO1M4Ow9CuEO0Q12req7p+7k2c7rhsERxd6F0W6sUO7oLrbN9QCcKA6xfr7Vyn8Jd7bsA+Cv2ebQj/7ZvO1bmsDWs9whs/8R3v1kN98BKPjhQvuifvD65g8PI28ir/X/JKvu4UweiO/q7mDscprOhtzBH3YAtfHfMpb5Arr7v5bhHWAAnVla9Fr27GbqKd1w6kwONOX+9aTfOA7sYjwQ8hFnJPj29Rr6Mtj6xYH9hHf81JvxHsoAqXnrJnP2dpf703iDvzDvc7j+hx7PNcjxLvcArRzXlh/3BjT6RlvxAJCWlam/eafu9CvfYfAQ6V4Aw7G/esrvWu/vMpYQ9JZHwyb/SYT+uQr+qWL+uhH+6HHxHRINH79/lQP/fhm/poSgyVoPiGW/oJf/oLL/sRgfMmPYeuL/awH78NGfSiQHpaGPyEP/w6zPsTgTuzLba4z/GOb9ujjxLxMO2cO/gZ/1f4h2rYPsz9Gcr8WKyvthAMEF/Y4s+k5C/Kzn8Rxo/8pLv+Zdr+voyxWRYNqzv9JF/9AOFP4ECCBQ0eRJhQ4UKGDR0+NDgP4kSKFS1exFhQXkaOFNuRkmWv40iKG0meRJkSIz58Kl0iNPfjYb57L23evCkR506eI0327MhvWCWRQEn+NJpUKUKWS0nGnFnT6VSnOqleNYoU68N3/baW/BrWZlOxE6E6pFlW7Umra91i1PpWLsS4c+0qJHv34NmGafX+TdgW8OCBdf/2uyTtr2HCd/M25svQb2PCgikvvizw3SlY9e4yzuz2MeHICyeHvmsZtVzQevklq+TNbuvVYf9HDy6t8HTtt6p5q6WtF9ylYPxY/557G3DuhLuRl/X9/GtwvfdosToufa3yv8wROte+NXp4qtT/jsdqnnxP7nq9HwS/fip6+UnVA+5nvOz9+mNbXn7PoPj6S4o+AnniT69yYtvvwKvauyvAggZ0kCcDK7QpQeGI028rDTHsCEK7JCSIQhBtuvDElD686x5bRFlnOhWTEnEuEgcyccaUUtTRJ/msgYQZD3tk7z/KbhQoRyJH4nFJuOr7KJn0nMSpRrmQ9EdJKjFqckuw6usnnym9dMnKt7DUkkyKulTTIRYp08erpd5s8yAz3UJTqjpJYnNPhegkbBlR2JnTT5LuXCv/T0OZXNTHCqmBJBqlAF0UUbUUbTSjPjMliFLCPpLFM6A89dPSsjDl1KJNU/WH1MFei4SbUVm1yFSxUKUVolVTdZWw4cLpqdc2bQ0L11wd2pVTYV+Vc6dlyST2K2OPZSjZTJ9tjB6csN0y2q2mpVYhaxvldjBYQs0w3Ie8xQpcdQ8ad9FyAYNVVpfmXZLdq9x9t6B4DcUXsHA4VCngHvWlit9+B/rXT4P/sm7QFRdeCOGpFKa44T0fBoyaSfZBiWMVLXYK44U1rlNkFVUGkeSlTO4X5TZZxu8dRylmykjIZEJLT5wj+jkhmv/Kh+CMhnbQZaVgfldmNZGu7sUYnwza/yClk2JaXafJhPovIIW8qOv+rjYq63C39lJsvdwBSdQvqyaIbKDMphbtLdV2jRhZLMJ7Pbl7ovtYu6nse73Cw/ubp8BzHdzJwyGGhy64C0p8p8VpbXzJx/UiBxJoHtr8ucpxupzVzIkM/a7NXnH7z8nj1pk0nvvyefLTe0z9rn6SiWQbhnLnbfSbSk/1dh2Bv2scTHoBWejXBxLeJuI5NX5G5Fu8xRnXn/cn+pemz7T6lbkX6HrUvHcJ/EbFP9F8wNZpvXzy0VdJ/UXZB9H9v6BhsNP5Y79JK65wBVgYJBVmiMIaqCGQZ6TBgWloB0xmJ5nawQ1/GNLfXwZWnML8r/8ny5jBMpQxA+0RJA+7uEYjXBDBXEABGC+soEDsZ6gLViiDELMFKKZ2w8Z4Dw6DEAgg5pAQGxzDH7nwAkNm6KcaOoiHXgtSqzzIEyrUQiCwuAJCrvEBdRyxBUbQQisSssQ9NfFAT/yLO1aRDjQCxntG+IVAemGEg7yDCZgQSDeUQQ5dwAAXCAHHBVIwyBTkQh6HRGQi27GORDbSkY+EZCQlOUlKVtKSl8TkI9GRSU520pOfBOUnzxFKUpbSlKes5ChRuUpWtpKT7GDHJbWFkSrMQiCvyIJB5FEFQBykEG6QYFTIZ0YCtREwG/FG8+DmPTr8QSB9uENB6LGFPSDED3H/CGbPhkk+KZJvI7mA0eS8Fw0Y7GIXMFggN54gEDAwQRbvFIc/TFGLZnBCBMTIJu226U1umuRrywSgTXhBhjLE0R/lGKI/9kAHhtLhGf64RRq48AZkjHGCpolh0IjZH2NiRjOnYF3Q6JcSMtZpo/XpqF6Qsrve/WykKClpm04qn5R+xiDhwA7OXnqSmKpppobr5xSPdFHdZPRnPyVPTWejm2z0a6dPIWpzjIozpIZHqXMBzT1M0Rl1PXUkPSVTVbVz1ewkhKW+o5ZXOwJWL4lVOmR9S3AGBgxlskqtHGHrltz6HLi6hTr3qIUOc3XXjOSVSntFTl/Xoh5q4JNWhMWI/2GdhNjfKBY4Qt2ZMLlHWd5YtkEVSQewMgXZi0h2SZytjWfFoiF0XIKujSKtRUxLJNSuRrVh+dA9dMEJdFQqoN2J6nemmrGg8hMj/yzVb90TXPgM92TF5R6d3GGKkNYpthWZbY9qi5rbyogj/UCGNvZ0XYpkV0fbDU13h8Q98pqFuQJybsyg+7xeYWNq3VJuhN47ofg2bb6v69U1POel9kLEvDNCb2bUOyaUTLe6+crviPZbov5q7b+TW9ZZnVTghxxYRQm+zIKvgi1xuLZDM+KwQzx8IhBTRsTluck9fvFiO0XYRhPGUYXPdmG40XgpKW7IikHU4sb4uFA9UUb8kv9m4yvhOEk6rhuPq2awY0yiGycCshKdnCUoC07KQXtYiX9RVwJleSFCxhCRCWPkSSXFRYJdcmbQXCE1D4bN9llKNSIVZwBtOU07Nm50neIOx5aZyWfyc5cZ9+Wf3RkoZlbInB1U52MyuifxQAaZpQNpi2r2eZT2qKCvko8c3lc7nM4nBfcpalZfBbmnPjSeEr1q+lraKA5Wcm1QvZdZb9bWC8NbP4oxCXBsOtaJ6vWnf92vwonDGsaWc7JfB2qVLrurx76UtG1nbXWFThuK0TW2T6VtC3I7XKGDB0hzTZhdG0TSB6K2TQPtFg2Hpt0FeTeB4r3Ueb9FeczLzL0Jku/uwbq+aeypttRhmBD4Tg9TF4WWv9l2v0luHivhW5qxbxuCJ8sBgvlsY16vFc3dAY9vpLw2Uo8qOSnFY3VN6YUw5yabGcqi5nFQ/vcYtPdNExNP+WzYnbbwyH5mvNeovK/fFw+XDcrzj/yuo0XRalM309Tl8s1L/Sj2noIzlAb5fQn0v0HmNWdp6ettavhZx+zMLnVAf7vsQuX7JP+Tl6fijco432bdcdzNJZ3bqdUvW5+9fvjdZOP4wxCZRjhfB8L/fhcaZYcWCi0A+Ke8IKb2HJU8yy92jqVh6vTV93Hthmx83mAd1qABOoHLaY5Y8zfzHVR9n0zCaQ4hk/+NmX/6z2Xr79uxZMjkwAnEa9f9nvFx38blcIHzx/e5H2TnplM/cINLzNYwyen2WnvVFB9E7zrF95C9N+ZhTO7lQv5zzmy798upRM157E+6r2vsT/z6Gdt5z+pcfa+0vnvcDmCU5upeoP4yitdazvvV4B1RYhWU5wKJKQPDLPxXRveg7FP8rGwCkHgF0GC9BB8FbCQ2cGw4MHw/cmPUDLsjbOBRMmTqRhbwLERIEHBNcHxecmTrZDFeIvRGcvu6rvgr8uzrRvcarFRpUHBu8Hxx8GkMhPuM7wh+0vyDEvyq0Lp47sYmIQKmawLJbwBkxBx/sMxYcuS8sORVcLjJsOTN8Of+70gQjZIgtFK4utDs21JEnnLqckUIEvD8FFMJSgT6HkMPmosMh/ENDARIZxAsktBwlpCEm5Jpw2YxdiENGJB1HZCJITBt16YcIqhhLHB5MLCNNvBs01C81vDk75BWK4QZQwECBGET4KkTEU0UyKUDY2UMJ7EMKtMJ3gQcHRArv6QdNCIM3EK+CuIdD+II8sDh/WAUxYANw4zVUHLpD9Lyg6YcqQznv6YQlSIZG0IHa2QMvYIY8yCJ/sAUeIAZRgAFCmUbqS7taXLuqUZ4F6h5QFIgkoER/mIK9GYh6KIGm2ocYkJQtIAWBIAM8ekcgjEdrPD24yYeiiB59oIAw9Af/PBAEgriGEhgIL0gFf4iBaRCIQ0godxNFkyJFwiGfe8BHdAAAUQmEOiAIZMiBgUiDR+gHCpANf7iEMgAkQSIkQ4qkRXKlojTKo0SkTULKpWRKU1KlpoTKqMSkp5TKqrTKRtoFZZAljMgHCrC4PAgEgrCGFBiIL0AFf2gBezwEbFrIKWzIXvTC5/EeIAgGgcgCVeiUDSi2frgBZfCHKsipNGiEVONDKvRDuBQpfPSHRcCCbmiFGZCIXagmf4gDNgiHRFgCr0iFJciGXViBciBMXTRMXjxMcVJMfRCEJ/CCEvKFXvKHeLADJjgDe+mHRXiCLajL0OTCXYxLxHQpxUyf/5OUqZR0HFOUMGocO4fEPfYCzvrZMme4vMlpBYt8HkggH3Y4BfJZBiMaQ4doBGfinjDIzef5gCysmmbAAvJBBCDqzob4TvIRT/IpT+5BT/Vkz6F6iPcMz/F8nfl8nvrknvWUMx9ohwI10ANF0EPQAwRl0AZ10AeF0AiV0Aml0Aq10Aj1glu40A3l0A710A/t0A9YBxAl0RI10RON0GCgAhRl0RZ1UQ4VhD6o0B78inTYgBXA0RzV0R39AA7Y0R8F0iAV0iEl0iI10iNF0iQlUg0oASV10ieF0iiVUii9gCm10ivF0iwt0hTQAC310i8F0yftUSTVgYXjpjNF0zRV0/81ZdM2ddM3hdM4ldM5pdM6tdM7xdM81dM95dM+9dM/hYhyuARMGD+D0IZHAIV4GAh20ARiY5VtQNTIKYhwQIVH8AU5yYZ3kgUrShVdUARfEBBNlYViEwhhUARbQLpF0YdWWIRlMAhrENVeEAhb0FRs4JR9qAZasNWDMFVUHQhraIRRoNG7KIcZ2AM9sIFmFIhoaIFCYAMmEJN48IE5AAQYgMM9mYYWIIQ2WAKdyYcYoANDSAJg8odIQAKGwoNUAYQnWIQkQISCgIcLaKhmEIhKGIJFkII8SBU12IJEyAFXKIhdaKgkEAOBEIE3YCiDahQ3MAIaGEyDsFd81Vd/WAb/FziENIiCPHwLQngDgWiDQyiINXjXfpiCAtIEMBCIPZjYRvlYgaACMRqIfhAVcggAQomEaGIVdxCBb/CHa1iBHoQHDZgQGtCedPgAZfWTa0gBbdkFJEgII7AFgzW1TPG6NXjYEiFafzDa3jKDSPCHfmCCXBgMLcipVEgigriBEgIEfV0D6/SHXnACTtEBV/WHQcBZg+AGDNCWSMCCQSAFrHMJYaAjgdABsBGIeD2ERng2f7CGFRgIKfijRhGFMBCIewiAV/SHY5gBMfEHERAERSihVLHaV3VcgYBctKyGlO2DwTACUPUHXlgCgugHDLgyf6gENPAHLfhIf4CGGeAU/w1Aq0wwg4PYBy9wTVr4g0kQAyAwU0MRoIGAglsgiHl4g0nogxSgBX8QhiEYiDD4hEw5hI4ViBSwx4J4Az4YiDeIhECIAU1gldEtiO3t3k/AhwCwyERog8F4ArFFxykoCBHYVUUApjAYBYFQBh7glBJY3EZgA4PghzcoA68riCy4hEyxBSkYiCRQ2IJIBSbwB2XQgYHYArxslEZYg4HYADiUBxFYXIIAhhh436sdCBAWYVWYXVIlBDoYjDKoYH+AhDQoCCSQVX+og14qYoFghVzKlCXYxzvwg4LoBzoIgxiiA9dcFGeYAePQhxTQvoNgBt8VBw2YJR8ohkx5Bf89qP8LUDJRoIKDCIcLaM7agF+CCONZ+oEyJmOBeAOQBYxWeAJ7qAcmyF51SASBMIQy6IdzmIEFGgYfcAd9yAL3BV8y6Ad0oAHF2IZO+Fo84ILWoQbjwIYZ4IVM6YchsKVUWCd0lBJvcAd/sAc2AGJ/uAL39YUckOBFiYcUeChCwF1/OIUWnoKDFIhyGD992IMqiOGBcIZXEIhZ9odfsGV/AIQTFgcXOMa/2Ic4mIEZqAPjUFqBiIcwyAEYKORnigEbSANFsx5xhgE+5oW4ZYcdXaA0SAEdgAFFSBVk2IEg+IESaoNF8IdaaAEdWIEwAE1/oAYiCIIcAIZUkYUZ+AEnqN2YK/BHbbABRRWIY4iBHGiBLLjmRWkEHY0jThhehFZohhYId+ACe/babBnWgYiHovhHR7uImH6Ie2heTuGHdkjVgWiHWxaITtTYPdGHVn4Id4jj/hBqeFVnQHXqp4bqqJbqqabqqrbqq8bqrNbqrebqrvbqrwbrsBbrsSbrsjbrs0brtFbrtWbrtnbrt4bruJbruabrul7rgAAAIfkEBQUAEAAsOwAUAAwACwAACGAA/3Th08ghIMIBRI0iPCgQHnuGDacN89ao2gUG0JQWO7TLWxjalhptnEgvn68QhxgkOBEto0LZ3l4QNNCII2jMtB8cECORm0oGDxoQIKXRgijTrwI4cffUQj1rL07GBAAIfkEBQUAEAAsQAAYAA0ACwAACGAAIeT7R/AfhIMIIRS7JK6gwYQQ/nWLhMwfQYgR/9V7Re0iRIcE/VnqUUOOvIMgLZFYwCBDF38oLwpZ8OCBgxPvMOJgUPMBCnIY5WRw8CCBjHYY63U5gaLHLYwI24FDGBAAIfkEBQUAEAAsRgAcAA0ACwAACGIA/wkcCKGgQQj/2OUb+O9gwX/LMJEj6FBgt0jI/DWsKLCeK1LRuIToAeshQ2cnEDhQgCKYQYEQjLFw8OABgjT+HPpiUfNBgjH9HLo7oeBBAxKOHBYkJgNFiD6xlBosl89gQAAh+QQFBQAQACxLACAADQALAAAIXQAhuPtH8B+EgwghUINUraDBhBD+qTv1ziFEhxYTYvwHTpIMEF3AHcSIh8QCBwaE8ENIEIKVBA9iqrAGEcIUBTEfvIgG0Z+kDg0eJDjRrWa/PCFOCOFVE+E+eQgDAgAh+QQFBQAQACxQACQADQALAAAIXgAhQPD3r+A/gQgFykIFz+DBhBD+PYN0zSDEiP/WfcqV7yFCh/2KXVpm5cMJQ/4wGtwm48CDBiQ2fTx4TcWDmwqiXLz2wgHOJhf54UDwsgOcixCyNQkBog9ShPcQBgQAIfkEBQUAEAAsVgAoAA0ACgAACFcAIYj7R5AghIMIu7UqaBDhQYYFHT4smM/bv4P5EDKs9ymXoxMhhDibSLAfohENHCSQ4U7jwTQIHsg00UuiPzUxZbLwZZMXiQUPEpyIJ/GgJxkgjkyDEBAAIfkEBQUAEAAsWwArAA4ACwAACGIAIQiE8G+gQYP5/ikseFBgsUviFjI8+K/bJGT+FDZcWM8VKngF7ekbKPHfM2TgpIQA0eYeSYlKDjxw4CGPv4bsUDzY2aBGQwjvTux8wADHTwhWLDho0EHM0XVnQpz4Iw1CQAAh+QQFBQAQACxhAC8ADQALAAAIXAAhCPz3T6DBgwQTFjw4UCFBhgnTmXsIkWC5Scf8QeB3TmPDf/VckUp0AsWJWh8JmhrRwMECFNwYQthj4IHNDKBkBrJg84GHVTKtoVDgIIEMdDIhADsCQoo0CAEBACH5BAUFABAALGcAMwANAAsAAAheACFA+EdQoMGD7ggWPCiQ2qNqCv8xHLjuE658Cw8S5CfMW0F06gxGJEiuCQoUUtAJHGnFwIMHFrpM3Afi5QMHIPwx9BfCwcsGJyZCkOOBAYMOVsZNxOenBo5A2iAEBAAh+QQFBQAQACxsADcADQALAAAIXQAhCPz3T6DBgwQTFjw4EBu8hAwhEKwG6RpEhATXfcKVDwK9a/IMJuxX7JKhEypOHBqocFeIBg4aoEAWEVKGBzgN+Il46ibODI4iqpOBgEGCE7kiQrjWpYYVahACAgAh+QQFBQAQACxyADsADQALAAAIXAAhQPhHUKDBg+IIFjwosNskZP4UMhxYj5c9iQwVavS3rdo+gRr/+eN1RIUKHNZAaqxiwMGDBEImQjjhwOUDFO4m4ljw4IEDEPomOiKhYEEHKTL9jWoi5FA5CAEBACH5BAUFABAALHgAPwANAAsAAAhiACH8G/gPgsGDBpflI1gQoUFgmMYRdGjwX7dJx/wNpDiw3qtT8P6xQ/btIENokAadYIFCTT+BJ0M0cPCgwymKrTw82IkgjT+HwFjsfGAgD8V7PSwoQBAiEUUI6+QcGTPNYEAAIfkEBQUAEAAsfQBDAA0ADAAACF4AIUD4R1CgwYPXCCo8KHCdMYUFGUKEKFHhO2f++kEbBk8gRHyuNB1RweKEL48Qx2R48GDBiX0MIfRgwPKBCmsxrSRg6WCEupi+UCBQ0KFLTIHFulBJpO+oQH/+DAYEACH5BAUFABAALIMARwANAAsAAAhmACH8G/gPgsGDBk/BI1gQoUFqkKoxdChw3Sdc+QZSHMgPGCZz/8zlWubPIENv10ahMKGiST2TBNmdYPDgQYY/BzUSY1HzgYIpJRFmQ9ETAZqgB/1x8ZDgQAg/FCHgU2SlzbVuEAICACH5BAUFABAALIgASwANAAwAAAhfACFA+Efwn8CDBwsWRChQ4UKGBbNde5iQYLtPuPL1I/bKW8OC/Yo1EqLCAwpLHwvKyfDgQYMT6BhCsJKg5QMWv2S2OdDSAQpsMrGdMJDAQxeZArfJGWNJH1KB/vwdDAgAIfkEBQUAEAAsjgBPAA0ACwAACGIAIfwb+A+CwYMGL4UjWBChQW+TgvUj6FBgvVen5g2sSLAau4HfVN2yZ5DhwFUnPJioMa4kwXwnGDx4cODMwY3XVMx8wABHRXkhHDh4kKCKv4p5SCAwECJPRQj+YKm5c81gQAAh+QQFBQAQACyTAFMADQALAAAIXwAhQPhH8J/AgwcLFkQokGCxcQsZEvQ2yZg/gxIJ3qM1yh0/XZmYJSxITZEQFhlUxGmo8JCHBw4coJDGEEIaBA9yZkBVs1CGnA9UGKvJrkYGBCas0KoJwV2iN6X0QQgIACH5BAUFABAALJkAVwAMAAsAAAhZACH8G/gPgsGDEB5VI1gQIYR1oG75I+jwHz9o/SgiZEiQG6ZP5wQy1OdnRIYMJ56JJHhiwYMHCZo4fIfCwUsHIBxCOMHgpYIeOkehMGAhxB2dEJzxCZQNQkAAIfkEBQUAEAAsngBbAA0ACwAACGEAIUD4R/CfwIMHb8EraBChQGiQrBV0OPDfOlC38DV0SLBfsUvh9rUSJKufQIbeHgkxYaGDlX0nC5rq8KBmB1wU+xio+cCCIYqrTPDs8IpiPiUmDJgQUokiBH2q/LjiByEgACH5BAUFABAALKQAXwANAAsAAAhYACH8GzgQgsGDECYtI1gQIQR72Rj+cyhQ4kSHDMXtwoet0CBqBhnyA1bnhAULI1yFZIhDwYMHC2T4owji5csQ9igKUeAApkyKxk5kyDBCFUWD4Sw56mYwIAAh+QQFBQAQACyqAGMADQALAAAIYgAh/Bv4D4LBgwYvjSNYEKFBb5OC9SPoUKC9V6fgDaxIEBqkbvtMyYk0zyDDduameDjgAYc8kwR/sXDw4EEGSBU1Zaj54AAcfw6RqaD5wMOjihDSqMjQQUgjpBCIRcrVz2BAACH5BAUFABAALK8AZwANAAsAAAhbACH8GzgQgsGDENARJIjQ4EKGDQkuO+avIEKC92iNcnctTxteBxdSwxPCAAISg0ISbJLgwYMGIfI1hCCjgQOXKr7N7ILg5oIT/WZ2k2EiwwlZMw3Kk3UqnMGAAAAh+QQFBQAQACy1AGsADQALAAAIZAAh/Bv4D4LBgwYhVSNYEKFBdqBk3SPoUCC/YJfeDaxIsBy+f/ksjdETziDDf/6seEBg4cQ3kwSjqXDw4IEFO/4c4jJR80GCLjkRfkPRoGaGPUERGkLh4cWRRRUNZkslrJ/BgAAAIfkEBQUAEAAsugBvAA0ACwAACF4AIfwbOBCCwYMCCRJEaHCgq2oKGQ5kB+oWvoIICfYrVikctTZdLOlrSPDbnhAHEnQYc1BhFwQPYqIQxxCCEgUxH7xgVvOOBQcPGJyQV/OdkBcmUIyqaZBfsVvlDAYEACH5BAUFABAALMAAcwANAAsAAAhfACH8GzgQgsGDECYF60cQ4UF7r075a+hwYDmC/xwKxPgPnyIrY5oZ5FhPiYcECFAgG0lw3AgHDx4g6OLPobEXMR8sEELPYb0TC2JmUKMRQq0TLFQcuVQUwrpbzmpCCAgAIfkEBQUAEAAsxQB3AA0ACwAACGYAIfz7R28ghIMID3YSV9BgQoHfKvXqN/Dfw3nz2rH6NA7jw4r0qD2qJm1Mkz3vDg4syI5QCAQKMijZp7KhHAMPcr5Q9hBClwQ5H5i41dOSBwcPGIS41nNfGBQsThDqiTAbMXYHAwIAIfkEBQUAEAAsywB7AA0ACwAACFsAIfwbOBCCwYMQQAUjWBAhBH7uGP5zKFDiRIcMr6FCV0iJFFcGJVJr0mGBAhSlDhKsF8KBgwcLhFAsh+KBzQYyKELAkcCmhTD+KD6T8UKFEnM6IeB7di0ohIAAACH5BAUFABAALNAAfwANAAsAAAhlACG8+0fwH4SDCA8+glbQYEII/9iBqoWP4EOI/gFuyTO4cOC3iZhg7YFx5huBxviu4YCAYMDMuClLFjIgoMHDzy8uojnwM0HGTxd5KWiwYMGIYRdhOAnxIsThywtheCO2ryDAQEAIfkEBQUAEAAs1gCDAA0ACwAACFsAIfwbOBCCwYMQ7hEkiNDgQoYNCfKqhe9fQ4ED+xWrxC1Qjx6G9jkk+K1KBwYLOuw5SNBfCAcPHjQ4cVFfiJgPHIDwd9GKgZgWulyEIO4IChRN0A01OK7cwYAAACH5BAUFABAALNsAhwANAAsAAAhhACGE+0eQIISDCCFUCtavYMKD/+zBMvXO4MOC0SDBs5iwoD1/55JOdFEGcSC/8ihSOAgAQpuCA1+yvCgpgVFDyFAovnAgYVAOa2hYPCAwYhTOSGgOoHiRKOkB/mN23cwIAAh+QQFBQAQACzhAIsADQALAAAIXwAh/Bs4EILBgwL/8SP4D6HBgZyK9SvocKA9WKbeNaxIkBqkZn1knGgT7yHBd106NHCQIYw/kw1lrHzwIAQ+hxBONKD54IQ8nG8y0DQwBSeEeWNAnJhyzZFRCPd+GgwIACH5BAUFABAALOcAjwANAAsAAAhYAKH9GzgQgsGDEEzJukfwH0KD/YJ9avgQwkB9FB82/OdvmRIQMlYZ3NgNRIIHC1AYO1gQl4kHMA/I8feQ1suYb2giTIdCgQMGIxJVhGAMx4kTjoYerIcwIAAh+QQFBQAQACzsAJMADQALAAAIXwAh4PtH8B+EgwghuINUraDBhBD+sRNVayBBiAT7Bbsk7uI+hA6/VQK2JwQIK94OOrS3pkODBweEJHx4ZIGDBw9UpIR4RAFOByjAQYSQyCVMGUMh9Otj0sqypAj5IQwIACH5BAUFABAALPIAlgANAAsAAAhbACEI/CewoMFg/f4pJGhQICxfCxk2/OcvosSCEfHpI1jPH8aF1y75EhICRKCBEbGFSPCgAYlSBgkue/GgZoItHg02o2mzS0MI+HAgcMBghKSfELZZ+SDDksCAAAAh+QQFBQAQACz3AJoADQALAAAIXgAhCPz3T6DBg+IIEjxo8FulYP0UMoTwzx4sU+8kHlQoDVK1gvrYGVT4j90obHpCoMDBbCBJTx0aPEggg97ELQke6GRxbGKXnDpfNJuICwUDBwdODJ1YCgeILtQgBAQAIfkEBQUAEAAs/QCeAA0ACwAACFwAIUD490+gwYPZCCo8aFChQ4YDCcLrRxCiwl+k3BU0J6+hQmqPXPVAEQINPoEO3Z1I8MCBhz7+GHJT4eDBgwVCYh40h8LmAwVNIEKgYqHBAhKhhLJrg6JHJoEBAQAh+QQFBQAQACwCAaIADQALAAAIXwAhCPz3T6DBg9AIKjwo8J0pWfcUFjz4r5+wS+IWUiT4TZO9gvKy5TMokeCeECpOwBooUZYKBw8WoBDHEEIbBA9yenhVM4+BnA9M8KpJDUWCBgdO6KoJwZiUGmOwQQgIACH5BAUFABAALAgBpgAMAAsAAAheACFA+EdQoEGDBBMeFEgQXcJ/C/5G1ULX8GDBPsJuyTu3z5s3fwNTPitEikcKlA0STeSIL4aCR48sDBmYbwTMh84OLFQXwgHMhngWAjhjYcFCkgkIoqvkBAlntoFBAAh+QQFBQAQACwNAaoADQALAAAIWQAhQPhH8J/AgweD9StoEKFAWqPaFXQ48J80VxMdMpx4bpm6gxvx2UHx4gQhgRtxjXDwwAGKZhT/GHhA00IiipYy0HzgoRRFczIOLDBw4hRFCNvQFFHTDUJAACH5BAUFABAALBMBrgANAAsAAAhgACFA+EdQoMGD6AgWPCjQXSVi/RQyHHhPFil3Cw8qlAap2r98zJbdE6jw3ztTmHC8eFHDGkmF/Y4gePAgwZGJEEA4oPkgBL6JMhjQbHACZyMSCRSQ4ILTHysrVkq1gxAQACH5BAUFABAALBkBsgANAAsAAAhbACH8G/gPgsGDBmXZI1gQocFhyxg6NMiQ4ESG6t5B8Kbr2kGG2iDJQWECRRp/AhkaG9HgwYMOryZyyuDywQE5E3GZqJkBEUqE9npkUGDhhLSJENztsSIHnMGAAAAh+QQFBQAQACweAbYADQALAAAIZAAhQPhHUKDBg9UIKjwo8J0pWfcWMvzXr1glcAUnEvxWiVg/fMBurROo8N89XM5wsDBxwhfJkmEOPHiwIIY/hhBkNJj5AIU4nEoUOHjgIAQ+nLxQHEhAYksvnBCWrenC6h6EgAAAIfkEBQUAEAAsJAG6AA0ACwAACF8AIfwb+A+CwYMGxxEciPDgQoINBQ7cho9hQ4LILoX7dy0VsH4GF4671AaFBxZK6oUkiC2EgwcPMhiKeMsEzAcJuvhrCE3FywcW8OxE6G+LBwQWToSLCEFfpjF7xhkMCAAh+QQFBQAQACwpAb4ADQALAAAIYQAhQPhH8J/Agwd99StoECEEfLVEtSvocOC/aZCqUURYsN0sfv/szQJ1TSBDguhwmMiAwpJJhm8sPHjQIAS8ikoWOJj5glnFMQh2OghxruK1ExYOkLAyqyKEb33exOIHISAAIfkEBQUAEAAsLwHCAA0ACwAACGAAIfwb+A+CwYMGCRJEePAfv2n9FjL8108WKXcDGQocSO0RtH/TKqmil5DgO1NtUGTwUKNcyYHsQDR48MBCG43MXtB8sOCIxnQnHNA8gMafRjwqDmRA4UyjwV12DJkzGBAAIfkEBQUAEAAsNAHGAA0ACwAACFkAIUD4R/CfwIMHZdkraBAhhH7CLokr6HDgP3DEKDpkWLDeKUPCDnLkJsODBRVxRBbUk+HBAwcosFXsksDlAxO1KvKx4ODliGoV1dXIYECFlYoC42Xqw0tgQAAh+QQFBQAQACw6AcoADQALAAAIYgAh/Bv4D4LBgwbZXSNYEKFBeaNo3SPoUGC/YZXCDaxIcNwlX/ycDVIkziDDe7LWoLCQ4QQ0kwT3gWjg4EECKv4cglNR80EDGTkR8kvB4MEDBFOCIvS0sqWfigapIbp0zmBAACH5BAUFABAALD8BzgANAAsAAAhZACFA+Efwn8CDB0m9K2gQ4UBq2Bg2PCixoEOJ2cLRsyQn1T6BDMctkpHhgIkp/UAWdJTBwYMHLHo5hBDnwEsHGTDN/OThJglgM/M1YWFBRZaZAvndagQUQkAAIfkEBQUAEAAsRQHSAA0ACwAACGIAIfwbOBCCwYMQKhHrR/AfQoP4aolqR/ChwH/TIFEr+JBgu1Gz8iWzg+eZv4sD+y2zhOKAARSyDDaEgILBgwcLcFjMF+LmTRAnH+JQcDNBD4sQiJ3w4AGFIKQQzKFKpc5gQAAh+QQFBQAQACxKAdYADQALAAAIWQAhQPhHkKDAgwLfFTSIUOBChggXHnMH8WDBapCoyTs0htA7hwXfdZKRAUGGHvFAEmzV4YFLD6EaQiBkweUDA3pk/lLhwKWKWjIhqFHhQcWYfkEhNPO0TGBAACH5BAUFABAALFAB2gANAAsAAAhmACH8+zdvIISDCCGYgmWvoMGEEPoVq4Rt4D+IEObNwwYJmEaMFtkl8/evmJoxsRAOdOgKBQIEKgb5O0jwYo8FDx40CDETYggHOR+gaIfRCoKcCk70w7hNhgkTJw5hPFiP1y2iEAICACH5BAUFABAALFYB3gANAAsAAAhgACH8G/gPgsGDBgkqRJjQ3q97BBkK9DesEriBEgmOw+TL3R8rcLr5E0gQn6waGRQYOBEuIUFhHRw8eGDBz0iEqjzMfIAgzc2D2FA0mGkilEQIh1CYQNGF21EI4XRVOxgQACH5BAUFABAALFsB4gANAAsAAAheACHw+0eQIISDCGuJalfwH0KE/6ZButbwIQSC7igWtNiwoLAuUxjlO9hx1AgECjyg8UfSYBQFDxw4OMHOIoQeCx7oVIHN5hsLOhWEmGfT3REVLE40snmwHzRi8g4GBAAh+QQFBQAQACxhAeYADQALAAAIZAAh/Bs4EILBgxC6HetH8B9Cg/dmjXJH8KHAf9MgTSv4kOA7U7DO6SnSxZjBhv2C4ciwAAGKZScJVlPh4MEDBGMsDmNh84ECK/4eujux4IEDD3gsQqh14gWKLp2UQpC3zNvBgAAAIfkEBQUAEAAsZgHqAA0ACwAACF0AIdj7R/AfhIMIIQyrdK6gwYQQ/o1D5xBiRIcFIWJENg0YlR5y2B106K5PCAULMjThN5IghDEIHshUUc2ilQQyH7AgZjGRBwcPFoBAZ3HfGBQvToyyiJDctHsHAwIAIfkEBQUAEAAsbAHuAA0ACwAACGQAIfwbOBCCwYMQRs26R/AfQoP9hlUCR/ChwH/gKg3r5/AhwXuzRkGQg+MIKoMN/22zkoGBAhKqDhI8h+LBAwcKmljUpsKBzQVC/D3sVyPBzQxnLEJ4hkPFiS6vlELgpy3dwYAAACH5BAUFABAALHEB8gANAAsAAAhcACHc+0fwH4SDCA/mK0gw4UGGBR1CYOgKXMOEDMdh8sXryIku2x4WxNcohIIGB2rIE2nwzgEHDx6Y2CWxDYKYDzzEkliLRIMHC1CUkwghUAgUMnIRPYgvXL+DAQEAIfkEBQUAEAAsdwH2AA0ACwAACGUAIfD7R/AfhIMIIdwS1a6gwYQQ/l2D1KwgxIj/3JG6RfBiwX7e/sV7g0KGn30HHf4bk6FBgw5/KUkeC+EgwcPGNS4KO8EzgcNTlyEEOXAAwcZrNy7GC7KiBBhelkaCuFdPYQBAQAh+QQFBQAQACx8AfoADQALAAAIWwAh/BtIEILBgwIJFkQ4sJ2qdgMRGiRIDdK0fxInDoR3ClauHiCEGNM4sF+qEAoeKDjx7WBERBYcPHiQgVNGQhZm0rSUMRqKBQ8WoMiWEcKqEydk3Cp6UN7BgAAAIfkEBQUAEAAsggH+AA0ACwAACFsAIdj7R/AfhIMIIRSr9K2gwYQQ/oWr9KwgxIj/7qmzCMEfQocE57UBASINvIMgw2Rw4CDDmIQPTzh48MBBCH4XZc60iRPimpUtm1yEIE9NCBBjlA092K8nhIAAACH5BAUFABAALIgBAQENAAsAAAhfACEI/CewoMF/CBMaLCiN1j2FCyH0K1bpG8SD/8Zh8sWP4D2M/DdEiULR4gTqAYm/OcLhIIHC1AwK4gQgqkMD3Ia2BMxlYecDwz48bewHIoEMEN4ighBmRAQNWIJDAgAIfkEBQUAEAAsjQEFAQ0ACwAACFgAIQj8J7CgQQjs/ikkeBACNUjiFjI0+E+ePYkNJUrMJ6+gxlu90oQ40eTbwIX4wmRo8ODAkYYQajB4QBOFuoY9FtB8cOJdQ0MdGjjI0ANfw36BZIRQYzIgACH5BAUFABAALJMBCQENAAsAAAhiACFA+PdPoMGDwvoRJHjQ4C1R7BY2FPivGiRpEhsSdEdK1r2C5PIZXNiPWCVeMlCE6ONv4MJ/3k4oeNCAxKqJvEw82IlgzMRhLHY+QNCm5cF6OA44UBCC0EQI3bqEEFJLYEAAIfkEBQUAEAAsmAENAQ0ACwAACFsAIQj890+gwYP3CCo8KBCeP4UEGUKAuJChQn+XphF0163fQIXwTrUac0KFDGYfCfaLQ8CBAwUy8klsouCBzRfSJFpJYPOBim0Sa5FQ0CBDE4kCVwmp0WYdhIAAACH5BAUFABAALJ4BEQENAAsAAAhiACFA+EdQoEGDsOwRLHhQoLJK3xb+azgw3CVh/RgeJIiPFiuC+a6ZMyiR3j9iMlSgCKNPoER7MhQ8eOBhkL+Gz17MfKCgCcVtKhzMTLDl5kF/UjIwUDAiD0UI7+TgiIJLYEAAIfkEBQUAEAAsowEVAQ0ACwAACF8AIUD4R1CgwYMEE/47KJCgv34KGRI0V+lbQYkEw10SBlGcM3kNE+K79WkMihcnXPkbqDBQBwcPGJxAxxBClwQPcprQVfPNgZwPXiyrCQ0FggUWkNirCWHZFiFy1kEICAAh+QQFBQAQACypARkBDQALAAAIXwAhQPhHUKBBg6LYEVx4UOA1SM0W/ms40B0pZQwbEvSnbyG9ZdL6CZRI8JgMFiqErBu50N8JBQ8eWEjjr6E4FDEfNJBBkd4JBzEVHKnZsE0HBQlGuKEIQR+jJlZ0CQwIACH5BAUFABAALK4BHQENAAwAAAhmACFA+Efwn8CDB/f5K2gQ4UBmotoxdEiwGiRpBB0OJOiOlCx7/67xCnewYD9lkMKgMIFikL+NBTN1cPDAAYppGuUcoPkgQyeNhyzwNIFLYzkZBhRkqMFKIwRvb6zoWedUoL+XAgMCACH5BAUFABAALLQBIQEMAAwAAAhfACFA+EdQoEGBkboRXHgQQrhL4hb+a/ivnz+JFCXW+xevFzB6AyXCSnSCBQsZ10IS7FdDgYMHCJoILHgvxMsHD0A0hHCiwcsFMnYmIoEAwQg1OyHQGjOGV1II/vwZDAgAIfkEBQUAEAAsuQElAQ0ACwAACGIAIUD4R/CfwIMHZdkraBChQGWRuhV0OPCfuEvC+jV0SBAfLVHtIEBT5ewgw2qT1KjwoGKMP4EMgal4QFMFLpgND1lwQNNAH4qsPNB84METxXo9MiTIIOMSRQjxCI0J5A5CQAAh+QQFBQAQACy/ASkBDQALAAAIWQAhQPhHUKDBg/wIKjwoUKFDhgMJ+oNXkKFCfZeE9XPnKlW5hgrx3SJ0woQHFL5AKjyS4MGDBTIgQgDhwOUDFO4gClHgskEKfxB1oTBwAIUkoBCh2XlDDGhAACH5BAUFABAALMUBLQENAAsAAAhiACH8G/gPgsGDBkWxI1gQocFrkJoRdGjw3ztSsuwNpDiwXzFZA5FNurWvIsN/b1RkMHHEnsmB0FQ4cPDAgyOKqDw82IkgjT+HyFTsfJCBEEV/VkwcyCDjEEUI/FDFYQTPYEAAIfkEBQUAEAAsygExAQ0ACwAACFwAIUD4R/CfwIMHCxZEKJAgvngLGRIsBylaxIQE4Z16ZY/dJ0bTGhb0pwzQiQwZUFgSWXALggcPGoDAxxACDgYwH7ywVrPLy5gh7NWsdtIAikPtakIgh6gPMoEBAQAh+QQFBQAQACzQATUBDQALAAAIXAAh/Bv4D4LBgwYjcSNYEKFBcph88SPoUCA+XM8oOmRIMFggTfAMcvz3RoWFDDLOiST4bYQDBw8syKn4i8WDmwqo+HP4DQXMmHF2OsRDwoIHGYUqGhwm6JM8gwEBACH5BAUFABAALNUBOQENAAsAAAhhACFA+Efwn8CDB9nZK2gQ4cBolb4VdDjwn7hLwvoRdFgQ3y1Q7NQxsqPrIMNrgk5kMKBCjj+BDNsYePDAAYpvFJsooPmARS6KcizQdBAiHMV0NTxYQJFmFEUI9FAdaiYwIAAh+QQFBQAQACzbAT0BDQALAAAIZgAh/Ps37x+EgwgPQmpGcKDBhBDerVJXcCBECPMyoss476LDgt/47ZLjx9vBj/90eSFxwMIJaScbxgvhwMEDBF38Qaz2wuaDBT10JrQXgsGDBwa6XITgCUUGDzIuLYWATVOrjhACAgAh+QQFBQAQACzgAUEBDQALAAAIYgAhQPhH8J/AgwdFsStoEOHAa5CaMXRIEN6pV/YIUiToT1kkbukCpcmUTyBDcZpkWEDgoUo/kwUDWXDw4MGLYw4hjEFQ84GHVTkdeajpYMSznPiavMiAQo2knBD6AStFTWBAACH5BAUFABAALOYBRQENAAsAAAhcACH8GzgQgsGDEFgRJIjQ4EKGDQnq01Yw4kB8pmDZm4WmDTKHBP0p60ICAQIUs0AO7AeiwYMHCoQ0hMAOxcsHDlL4mylDwUsEVmZCEHbChAkZ24RCWDdrVz2DAQEAIfkEBQUAEAAs6wFJAQ0ACwAACGAAIUD4R/CfwIMHI3EraBDhQHGXgvEj6HDgP3y1QLGj6LBgtWL/zOGxwoedQIb/2tWwoCADDnonC2bK8KCmB1YV+Rio+cBCooq5VNR0MAJXRQhtUJhAscbRUQjWcmUTGBAAIfkEBQUAEAAs8QFNAQ0ACwAACF4AIfwbOBCCwYMCCRJEaHCgOnELGQ5MdykYv38ME/7Dt4sTulZbrKzy15DgNTIkEiQgYejgwhMNHjxocCKjPxAOZD4IoS9jFAQyExzJCEFbDRYvalgjCgEfMmP3DAYEACH5BAUFABAALPYBUQEOAAsAAAhgACGk+0eQIISDCA9CalbwX8KE70y9smfwIQSC/pJtK2jxYsN/5N4UQZMN4Ud5MiwsOHBinMmCsDw8mGnhUMdMGWY6MHDHn8VpKBo8cECCU0cIiUawGNHG0lEI6I6JQxgQACH5BAUFABAALPwBVQENAAsAAAhiACH8GzgQgsGDArOxI/gPocF/2CBFI+hQ4L93pl7ZK4iQoD9lkbitalJk0L2HBMepIaFAgQc1/lA27LHAwQMHIexVlNHggU8U5iqqseAzgYyKENo1QfGihimkEPxtk6bPYEAAIfkEBQUAEAAsAgJZAQ0ACwAACFsAIfwbOBCCwYMQLgXrR/AfQoP4gM1r+FBgw4IPLy7rlgZHFGIGLwpDYaFBAhTOQhI0xsLBgwcH4Ph7iMvEywcJxlREd2LBAwckCFWEcOvEixBuQA7FZ63dwYAAACH5BAUFABAALAcCXQENAAsAAAhiACHY+0fwH4SDCCEgm+StoMGEEP6NuwSMX0GIBPHdAsXuYUKH1iBJQyVERht1Bx2+G0RCQQMLTRBetJLggU0V3CBCaKLApoMX03QS8uDgQYIT5nTqSxNCBY5XOhHCA+fvYEAAIfkEBQUAEAAsDQJhAQ0ACwAACFsAIfwbOBCCwYMQihEsiNDgQoINBQ6Ul4zfv4gE9d0CZW1MChyhHC6sJsOAgwUkWh0keE2FgwcOEliJCO3Fg5sKovhriE9GApgdGEWEAK0HChBy+A01iA7fwYAAACH5BAUFABAALBICZQENAAsAAAhkACGw+0fwH4SDCCFcg9SsoMGEEP69M/XKHkGIEf/5MzYp3MWEDsdd+1eqBggr1w46/NcLBQMHCGrQQ3gxTQIHDx6wIAbR35ibOVn8wuiKRIMHCkBIwwiBUIgTPXIxPdhPHsKAAAAh+QQFBQAQACwXAmkBDgALAAAIXQAhQPhHkKDAgwcLKkSY8N+2aQUZDiQY79Qre/8kTvznT1mkZV1ApNjDryFBcjgsOGjQgRBCg+tQPJi5oIfGdDJnMujhT6MSAw8cdAjUU6I4KyBAyNmn8WC+ohACAgAh+QQFBQAQACwdAm0BDQAKAAAIVQAhcPtHkCCEgwghYPLFr2DCg/w3QIFz+DDgtjSOcSXsGDBUidC4BgG0WOyEQweKDhBDqFBPQYeyPSw6iGEPTFnsrLZDMUClSB42YTgSgYIIcAgBAQAIfkEBQUAEAAsIwJwAQ0ACwAACF8AIQj8J7CgQQj/EiY8OPBYN4UED/4jhwkYv4US/+HD9WkdwXv5CkK8BsmXlRAhxMAbqBDeEQsOHGRI4++gvhAPcjo4wZBfCAc5G/BkiCaDgwYeujCEIO9NiBN4oEEICAAh+QQFBQAQACwoAnQBDQALAAAIWwAhCPz3T6DBg838ESR40OCpV/wWFjz4zx+1fQsbQpCYsZ+5fgYl+puV6QSKE6EGSqwVgsEDBiieaWyU4YFNC4U0aqppM4MjjeFOJHCQIEQrjRCYNUmhpBiEgAAAIfkEBQUAEAAsLgJ4AQ0ACwAACGAAIUD4R1CgwYPrCBY8KNAaJGgK/zEcCO/UK3sLDxL0d2xSN4nryhmMOA6TLisnUBzxJjAivi4WHjw40GQihBMOHMg8QW+ijAY6HYTQN3FQhwUNPDRhyZDfIRw19HSDEBAAIfkEBQUAEAAsNAJ8AQ0ACwAACFsAIUD490+gwYPFCCo8aFCbQoIMBT5cyFChuVv1/tm79s6gQn/HJjk68SKEHokPmYVg8MCBilgRV3l4QBNBm4i6TNB8YGCPP4bycBxgkODEtYgQvo2pYSWZwIAAACH5BAUFABAALDkCgAENAAsAAAhgACFA+EdQoMGD3QgWPCiwXCZf/BQyHJgP16d1Cw8qtAYJG8Fu0/IJVPgPHjp5VVC8kLFsJEk5GR48UCCj38QeDGQ+ULFtYhMFMh2MYDfRFQoFCzwcYTYRgqwoQvycgxAQACH5BAUFABAALD8ChAENAAsAAAheACFA+EdQoEGDBBP+O4hQYUGGBJ0F4/fwIEF8uD6t+wcPmbaGBK9BOnSCBYou+QQq9AaCwQMHHhAxhACMxYObCazMnKbi5gMEafwx7BclgwIEKJ7NhABvj5IuywQGBAAh+QQFBQAQACxEAogBDQALAAAIXgAhQPhHUKDBg838ESx4EAI8VKvmLWw40N+xSesYHlyYzt7CacHWCVy40B4VFSxOsBpJMlAGBw8YnHBHcYqCBzhZFKM4BgHOByiyUXx2AoECD0J6UYTwbMwUQvAgBAQAIfkEBQUAEAAsSgKMAQwACwAACF4AIUD4R1CgQYEEE/47iFAWNIUM/8E75apewYME/R2b1O1ful3H+A1MWC6ToBMmXghhN5LgPBALHjyw8IZhtRcOZC7owXDdiZwPElhhCGFNhwQITuwhus/SljTOzAUEACH5BAUFABAALE8CkAENAAsAAAhcACFA+Efwn8CDB33xK2gQIYR8uD71K+hw4L9zDCsyLOgvWatsBxnmu9TkhQcUgQRuNOTBwQMHKK5VHIPggU0PrCr2sWDzAYljFcfJsJDAQw9dFSGMy9OFkT0IAQEAIfkEBQUAEAAsVQKUAQ0ACwAACGQAIfwb+A+CwYMGNXUjWBChwXKZfPEj6FBgPlyf1g2sSPAaJGj/yrGSFc8gQ3inCp3wYELGNZME/clY8OABAiv+HKpDUfOBgxQ5EfYL0aCmAiEVISQiccDAiDhJIfBqIweawYAAACH5BAUFABAALFoCmAENAAsAAAhZACFA+Efwn8CDB3kVJIjwoLuFDBFCLNhwYTdQ6/z5wkTs4MJrjZqoyKBijD+BC0l1eMBSxa+GEPYYYPnAgiKYnzywdNDhFkx6PTIc8HBEH0wI9B692XQPQkAAIfkEBQUAEAAsYAKcAQ0ACwAACGEAIfwb+A+CwYMGITXzR7AgQgjxUK2aR/ChQH/IJnUbaJEgOUzV/oW7VOmbwYb67g07kSHDiV8nG/ZQ8OCBAhwW44GoWROEO4s4Fjh4sECGRQi4UFiwgELWUQjV/PSpZjAgADs=">
</div>
</div>
</section>
</section>
<section id="the-case-n2" class="level3">
<h3 class="anchored" data-anchor-id="the-case-n2">The case <img src="https://latex.codecogs.com/png.latex?n=2"></h3>
<p>Assume that, we have 3 points <img src="https://latex.codecogs.com/png.latex?p_0=(0.0,%201.0)">, <img src="https://latex.codecogs.com/png.latex?p_1=(1.3,%201.3)"> and <img src="https://latex.codecogs.com/png.latex?p_2=(1.0,%200.0)">. Imagine a red particle <img src="https://latex.codecogs.com/png.latex?p_R"> moving from <img src="https://latex.codecogs.com/png.latex?p_0"> towards <img src="https://latex.codecogs.com/png.latex?p_1"> on a straight-line, a blue particle <img src="https://latex.codecogs.com/png.latex?p_B"> moving from <img src="https://latex.codecogs.com/png.latex?p_1"> towards <img src="https://latex.codecogs.com/png.latex?p_2">. Suppose, a third green particle <img src="https://latex.codecogs.com/png.latex?p_G"> moves along the straight-line joining the blue and green particles instantaneously:</p>
<div id="b0cbc7ce" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_2</span>(t, a, b, c)</span>
<span id="cb4-2">    @. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> c</span>
<span id="cb4-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb4-4"></span>
<span id="cb4-5">pts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb4-6">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>;</span>
<span id="cb4-7">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span>;</span>
<span id="cb4-8">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>;</span>
<span id="cb4-9">]</span>
<span id="cb4-10"></span>
<span id="cb4-11">xRed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_1</span>(tvec, pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-12">yRed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_1</span>(tvec, pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb4-13"></span>
<span id="cb4-14">xBlue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_1</span>(tvec, pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-15">yBlue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_1</span>(tvec, pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb4-16"></span>
<span id="cb4-17">xGreen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_2</span>(tvec, pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-18">yGreen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_2</span>(tvec, pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], pts[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb4-19"></span>
<span id="cb4-20"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@gif</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> ((xr, yr),(xb,yb),(xg,yg)) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zip</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zip</span>(xRed,yRed),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zip</span>(xBlue,yBlue),<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">zip</span>(xGreen,yGreen))</span>
<span id="cb4-21">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(xRed, yRed, line<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>path,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>dash,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>gray))</span>
<span id="cb4-22">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scatter!</span>([xr], [yr], marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>circle,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>red,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>red))</span>
<span id="cb4-23">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot!</span>(xBlue, yBlue, line<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>path,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>dash,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>gray))</span>
<span id="cb4-24">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scatter!</span>([xb], [yb], marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>circle,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>blue,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>blue))</span>
<span id="cb4-25">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_1</span>(tvec, xr, xb)</span>
<span id="cb4-26">        y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bezier_1</span>(tvec, yr, yb)</span>
<span id="cb4-27">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot!</span>(x, y, line<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>path,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>dash,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>gray))</span>
<span id="cb4-28">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot!</span>(xGreen, yGreen, line<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>path,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>solid,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>gray))</span>
<span id="cb4-29">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scatter!</span>([xg], [yg], marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>circle,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>green,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>green))</span>
<span id="cb4-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>[ Info: Saved animation to C:\Data\dev\repo\quantinsights.github.io\posts\interpolation-and-approximation\tmp.gif</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<img src="https://quantdev.blog/posts/interpolation-and-approximation/data:image/gif;base64,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/ADkIHEiwoMGDCBMqXMiwocOHECNKnEixosWLGDNq3Mixo8ePIA/++2fPlL6QKFOqXMmypcuXMGPKnNlx5L9svkbS3Mmzp8+fQIMKHerRpq5uNokqXcq0qdOnUH/aTDrynql8OqNq3cq1q9evPrNymEqWgywOK35sEwu2rdu3cON+JTtVYNKCxVosgCAixzy5gAMLHky4aN2xdP811CPiyxMIM5T1K0y5suXLcRPfbViP3WQO8FyByhTJzZMRM5B9xsy6tevXLTXbPbywnzdpyHTBGpXK1j2B/eL186V3RIIc8WArX868eULashfmY9dtGjJe7wTqG7bsGrh3+xKS/8phIso05+jTqyesWbFDfezyDcR1ypQsXsqofeNH8ff6/wAGqFRiA9HF0DrYMOOLLKiMAks5A8njn4AUVmihU2K1V1s85WTTjDDdDMSMMdFw8009F6ao4oo8aTibewf1Iw89A0XTCiiu4ELMM9vQyOKPQAYJUlkv0oYQPdtEUwwuorUSzUDzyLOakFRWaSVELipkjzrd4ObMQNwIw0w24wh35ZlopumikQXd85dA5chSCiq09NKdOmnmqSeV8/T5pp+A9plQPEkao4sspphyy0DvlAPPnpBGmmKWCO3zDjjXMENMeBy0swsy03TDzoSSlmpqc1P1Q497Bhok42f22P+SCo66kNjNlKfmqitrGZKlKowGqaONM8TYcqMryXHQzzo+7urss+xFh9hB9aBTKDvA8UKMM9ucIyW04Ib7FpGIkTuQPScJhIxoqdQiZjakiivvvFxRWpA81SGzi5yocDMQO+hwSu/ABA8lLZvwfUONMv4K5Ax++rGTbsEUV7zTZpTuI59A29CCSimyfDoNthaXbHJM9hKUT4fMCFPLrMYMFI869pxs881DttqqsvKcs40zzwzUDS7FRLMNOs3irPTSFN1l78YcsMMkKK3Ysu03TGettURZsrVON9EYKporn91Tjplbp602QfOQSyAH91A3jTL+yVOLL8x4B97afPf/XW7bRk7Mzy+ynHKKLL0oc43Afje+9MEjvSkPpsz04nEpeAo0zqiOd34zdAQGN042zGTOAS+1StMNzZ63bjOl/awWjbE4Eh1Nsq7nTvHb5eqUj7XREDO1NAOl4y2uuicPbq8E1qMONyXW6O6YZyOv/PW7di3WOLqNQifeEGIv/vJE0tU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">
</div>
</div>
<p>How might we compute the trajectory of the green particle? By a double-application of the section formula, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ap_G(t)%20&amp;=%20(1-t)%5Ccdot%20p_R(t)%20+%20t%5Ccdot%20p_B(t)%5C%5C%0A&amp;=%20(1-t)((1-t)p_0%20+%20tp_1)%20+%20t((1-t)p_1%20+%20t%20p_2)%5C%5C%0A&amp;=%20(1-t)%5E2%20p_0%20+2t(1-t)p_1%20+%20t%5E2%20p_2%0A%5Cend%7Balign*%7D%0A"></p>
<p>Thus, the trajectory of the green particle is a <em>quadratic Bezier curve</em> with <img src="https://latex.codecogs.com/png.latex?n+1=3"> control points. The quadratic Bezier curve interpolates between the points <img src="https://latex.codecogs.com/png.latex?p_0"> and <img src="https://latex.codecogs.com/png.latex?p_2">, whereas <img src="https://latex.codecogs.com/png.latex?p_1"> is an off-curve point.</p>
<p>Computer graphics(CG) aficionados reserve the term <strong>control point</strong> for an <em>off-curve</em> point such as <img src="https://latex.codecogs.com/png.latex?p_1"> and refer to the <em>on-curve</em> points, as <em>anchor points</em>. In CG editors such as Adobe Illustrator, not all control points are known in advance. The shape of the quadratic curve is controlled by moving around the control points using the Pen tool (Bezier tool) until the curve has the desired shape. Thus, using the Bernstein basis to represent degree 2 polynomials is advantageous. Moving <img src="https://latex.codecogs.com/png.latex?p_1"> has a direct and intuitive effect on the curve.</p>
<p>The <strong>Bezier polygon</strong> is the closed piecewise linear curve connecting the control points <img src="https://latex.codecogs.com/png.latex?p_i"> and <img src="https://latex.codecogs.com/png.latex?p_%7Bi+1%7D">, <img src="https://latex.codecogs.com/png.latex?i=0:n-1"> and finally <img src="https://latex.codecogs.com/png.latex?p_n"> and back to <img src="https://latex.codecogs.com/png.latex?p_0">. This polygon provides a rough idea of the shape of the curve. From the definition(Equation&nbsp;8) of the Bezier curve, it follows that for all <img src="https://latex.codecogs.com/png.latex?t%5Cin%5B0,1%5D">, the curve <img src="https://latex.codecogs.com/png.latex?c(t)"> is a convex combination of the control points. Therefore, <img src="https://latex.codecogs.com/png.latex?c(t)"> lies within the <a href="https://mathworld.wolfram.com/ConvexHull.html">convex hull</a> of the control points.</p>
<div id="thm-tangency-property" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3</strong></span> The Bezier curve <img src="https://latex.codecogs.com/png.latex?c(t)"> is tangent to <img src="https://latex.codecogs.com/png.latex?p_1-%20p_0"> and <img src="https://latex.codecogs.com/png.latex?p_n%20-%20p_%7Bn-1%7D"> for <img src="https://latex.codecogs.com/png.latex?t=0"> and <img src="https://latex.codecogs.com/png.latex?t=1"> respectively.</p>
</div>
<p><em>Proof.</em></p>
</section>
</section>
<section id="spline-functions" class="level2">
<h2 class="anchored" data-anchor-id="spline-functions">Spline Functions</h2>
<p>The mathematical concept of spline functions was introduced in 1946 by <a href="https://en.wikipedia.org/wiki/Isaac_Jacob_Schoenberg">Schoenberg</a>. The importance of the B-spline basis for approximation was also first appreciated by Schoenberg. Today, B-Splines enable the mathematical representation of surfaces far beyond hand-techniques. In aircraft design computations, they may involve more than <img src="https://latex.codecogs.com/png.latex?50,000"> data points.</p>
<section id="linear-and-cubic-splines" class="level3">
<h3 class="anchored" data-anchor-id="linear-and-cubic-splines">Linear and Cubic Splines</h3>
<p>We start by formally defining a spline function of order <img src="https://latex.codecogs.com/png.latex?k%20%5Cgeq%201">.</p>
<div id="def-spline-function-of-order-k" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1</strong></span> A spline function <img src="https://latex.codecogs.com/png.latex?S(x)"> of order <img src="https://latex.codecogs.com/png.latex?k%20%5Cgeq%201"> (degree <img src="https://latex.codecogs.com/png.latex?k-1%20%5Cgeq%200">), on a grid</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5CDelta%20=%20%5C%7Ba=x_0%20%3C%20x_1%20%3C%20%5Cldots%20%3C%20x_n%20=%20b%5C%7D%0A"></p>
<p>of distinct knots is a real function <img src="https://latex.codecogs.com/png.latex?s"> with the following properties:</p>
<ol type="a">
<li>For <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5Bx_i,%20x_%7Bi+1%7D%5D">, <img src="https://latex.codecogs.com/png.latex?i=0:m-1">, <img src="https://latex.codecogs.com/png.latex?S(x)"> is a polynomial of degree <img src="https://latex.codecogs.com/png.latex?%3Ck">.</li>
</ol>
</div>


<!-- -->

</section>
</section>

 ]]></description>
  <category>Numerical Methods</category>
  <guid>https://quantdev.blog/posts/interpolation-and-approximation/</guid>
  <pubDate>Wed, 13 Nov 2024 00:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/interpolation-and-approximation/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Numerical Integration</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/numerical-integration/</link>
  <description><![CDATA[ 





<section id="interpolatory-quadrature-rules" class="level2">
<h2 class="anchored" data-anchor-id="interpolatory-quadrature-rules">Interpolatory Quadrature Rules</h2>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>We are interested in an approximate calculation of the definite integral</p>
<p><span id="eq-definite-integral"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AI%5Bf%5D%20=%20%5Cint_%7Ba%7D%5E%7Bb%7Df(x)dx%0A%5Cend%7Balign*%7D%0A%5Ctag%7B1%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?f(x)"> is a given function and <img src="https://latex.codecogs.com/png.latex?%5Ba,b%5D"> is a finite interval. This problem is often called <strong>numerical quadrature</strong>, since it relates to the ancient problem of the quadrature of a circle i.e.&nbsp;constructing a square with equal area to that of a circle. The computation of the above quantity is equivalent to solving the IVP:</p>
<p><span id="eq-IVP"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ay'(x)%20=%20f(x),%20%5Cquad%20y(a)=0,%20%5Cquad%20x%20%5Cin%5Ba,b%5D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B2%7D"></span></p>
<p>for <img src="https://latex.codecogs.com/png.latex?y(b)=I%5Bf%5D">.</p>
<p>As is well known, even many relatively simple integrals cannot be expressed in finite terms of elementary functions, and thus must be evaluated by numerical methods. Even when a closed form analytical solution exists, it may be preferable to use a numerical quadrature formula.</p>
<p>Since <img src="https://latex.codecogs.com/png.latex?I%5Bf%5D"> is a linear functional, numerical integration is a special case of the problem of approximating a linear functional. We shall consider formulas of the form:</p>
<p><span id="eq-quadrature-rules"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AI%5Bf%5D%20%5Capprox%20%5Csum_%7Bi=1%7D%5En%20w_if(x_i)%0A%5Cend%7Balign*%7D%0A%5Ctag%7B3%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?x_1%20%3C%20x_2%20%3C%20%5Cldots%20%3C%20x_n"> are distinct <strong>nodes</strong> and <img src="https://latex.codecogs.com/png.latex?w_1">, <img src="https://latex.codecogs.com/png.latex?w_2">, <img src="https://latex.codecogs.com/png.latex?%5Cldots">, <img src="https://latex.codecogs.com/png.latex?w_n"> the <strong>corresponding weights</strong>. Often (but not always) all nodes lie in <img src="https://latex.codecogs.com/png.latex?%5Ba,b%5D">.</p>
<div id="def-quadrature-rule-of-order-of-accuracy-d" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Order of accuracy of a Quadrature Rule)</strong></span> A quadrature rule (Equation&nbsp;3) has <strong>order of accuracy</strong> (or degree of exactness) equal to <img src="https://latex.codecogs.com/png.latex?d">, iff it is exact for all polynomials of degree <img src="https://latex.codecogs.com/png.latex?%5Cleq%20d">, that is, for all <img src="https://latex.codecogs.com/png.latex?p%5Cin%5Cmathcal%7BP%7D_%7Bd+1%7D">.</p>
</div>
</section>
<section id="some-classical-formulas" class="level3">
<h3 class="anchored" data-anchor-id="some-classical-formulas">Some Classical Formulas</h3>
<p>Interpolatory quadrature formulas, where the nodes are constrained to be equally spaced, are called <strong>Newton-Cotes</strong> formulas. These are especially suited for integrating a tabulated function, a task that was more common before the computer age. The midpoint, the trapezoidal and the Simpson’s rules, to be described here, are all special cases of (unweighted) Newton-Cotes formulas.</p>
<p>The <strong>trapezoidal</strong> rule is based on the linear interpolation of <img src="https://latex.codecogs.com/png.latex?f(x)"> at <img src="https://latex.codecogs.com/png.latex?x_1%20=%20a"> and <img src="https://latex.codecogs.com/png.latex?x_2%20=%20b">, that is, <img src="https://latex.codecogs.com/png.latex?f(x)"> is approximated by :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ap(x)%20=%20f(a)%20+%20(x-a)%5Ba,b%5Df%20=%20f(a)%20+%20(x%20-%20a)%5Cfrac%7Bf(b)%20-%20f(a)%7D%7Bb%20-%20a%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>The integral of <img src="https://latex.codecogs.com/png.latex?p(x)"> equals the area of a trapezoid with base <img src="https://latex.codecogs.com/png.latex?(b-a)"> times the average height <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D(f(a)%20+%20f(b))">. Hence,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cint_%7Ba%7D%5E%7Bb%7D%20f(x)dx%20%5Capprox%20%5Cfrac%7B(b-a)%7D%7B2%7D(f(a)%20+%20f(b))%0A"></p>
<p>To increase the accuracy, we subdivide the interval <img src="https://latex.codecogs.com/png.latex?%5Ba,b%5D"> and assume that <img src="https://latex.codecogs.com/png.latex?f_i%20=%20f(x_i)"> is known on a grid of equidistant points:</p>
<p><span id="eq-grid-points"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ax_0%20=%20a,%20%5Cquad%20x_i%20=%20x_0%20+%20ih,%20%5Cquad%20x_n%20=%20b%0A%5Cend%7Balign*%7D%0A%5Ctag%7B4%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?h%20=%20(b%20-%20a)/n"> is the <strong>step length</strong>. The trapezoidal approximation for the <img src="https://latex.codecogs.com/png.latex?i">th subinterval is:</p>
<p><span id="eq-trapezoidal-approx-in-ith-subinterval"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cint_%7Bx_i%7D%5E%7Bx_%7Bi+1%7D%7D%20f(x)dx%20=%20T(h)%20+%20R_i,%20%5Cquad%20T(h)%20=%20%5Cfrac%7Bh%7D%7B2%7D(f_i%20+%20f_%7Bi+1%7D)%0A%5Cend%7Balign*%7D%0A%5Ctag%7B5%7D"></span></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?p_2(x)%5Cin%5Cmathcal%7BP%7D_2"> be the unique interpolating polynomial (Newton polynomial) passing through the points <img src="https://latex.codecogs.com/png.latex?(x_i,f_i)"> and <img src="https://latex.codecogs.com/png.latex?(x_%7Bi+1%7D,f_%7Bi+1%7D)">, that is, <img src="https://latex.codecogs.com/png.latex?p_2(x_i)=f(x_i)"> and <img src="https://latex.codecogs.com/png.latex?p_2(x_%7Bi+1%7D)%20=%20f(x_%7Bi+1%7D)">. The exact remainder in Newton’s interpolation formula is given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af(x)%20-%20p_2(x)%20&amp;=%20%5Bx_i,x_%7Bi+1%7D,x%5Df%5Ccdot%20%5CPhi_2(x)%5C%5C%0A&amp;=%5Bx_i,x_%7Bi+1%7D,x%5Df%20%5Ccdot%20(x%20-%20x_%7Bi+1%7D)%5CPhi_1(x)%5C%5C%0A&amp;=%5Bx_i,x_%7Bi+1%7D,x%5Df%20%5Ccdot%20(x%20-%20x_%7Bi+1%7D)(x%20-%20x_%7Bi%7D)%5CPhi_0%5C%5C%0A&amp;=%5Bx_i,x_%7Bi+1%7D,x%5Df%20%5Ccdot%20(x%20-%20x_%7Bi+1%7D)(x%20-%20x_%7Bi%7D)%0A%5Cend%7Balign*%7D%0A"></p>
<p>So, we have:</p>
<p><span id="eq-remainder-term"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AR_i%20&amp;=%20%5Cint_%7Bx_i%7D%5E%7Bx_%7Bi+1%7D%7D%20(f(x)%20-%20p_2(x))dx%20=%20%5Cint_%7Bx_i%7D%5E%7Bx_%7Bi+1%7D%7D(x%20-%20x_i)(x%20-%20x_%7Bi+1%7D)%5Bx_i,x_%7Bi+1%7D,x%5Df%20dx%0A%5Cend%7Balign*%7D%0A%5Ctag%7B6%7D"></span></p>
<p>By the theorem on the remainder term for interpolation, we can write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Bx_1,%5Cldots,x_n,x_%7Bn+1%7D%5Df%20=%20%5Cfrac%7Bf%5E%7B(n)%7D(%5Cxi)%7D%7Bn!%7D%0A"></p>
<p>Consequently,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Bx_i,x_%7Bi+1%7D,x%5Df%20=%20%5Cfrac%7Bf''(%5Cxi)%7D%7B2%7D%0A"></p>
<p>So, we have:</p>
<p><span id="eq-remainder-term-2"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AR_i%20&amp;=%20%5Cfrac%7Bf''(%5Cxi)%7D%7B2%7D%5Cint_%7Bx_i%7D%5E%7Bx_%7Bi+1%7D%7D%20(x%20-%20x_i)(x%20-%20x_%7Bi+1%7D)dx%0A%5Cend%7Balign*%7D%0A%5Ctag%7B7%7D"></span></p>
<p>Setting <img src="https://latex.codecogs.com/png.latex?x%20=%20x_i%20+%20ht">, <img src="https://latex.codecogs.com/png.latex?dx%20=%20hdt"> such that the limits of integration are from <img src="https://latex.codecogs.com/png.latex?t=0"> to <img src="https://latex.codecogs.com/png.latex?t=1">, $we get:</p>
<p><span id="eq-error-in-subinterval"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AR_i%20&amp;=%20%20%5Cfrac%7Bf''(%5Cxi)%7D%7B2%7D%20%5Cint_%7B0%7D%5E%7B1%7D(ht)(x_i%20+%20ht%20-%20x_%7Bi+1%7D)h%20dt%5C%5C%0A&amp;=%20%5Cfrac%7Bf''(%5Cxi)%7D%7B2%7D%20%5Cint_%7B0%7D%5E%7B1%7D(ht)(ht%20-%20h)h%20dt%5C%5C%0A&amp;=%20%5Cfrac%7Bf''(%5Cxi)%7D%7B2%7D%20%5Cint_%7B0%7D%5E%7B1%7D(ht)(ht%20-%20h)h%20dt%5C%5C%0A&amp;=%20%5Cfrac%7Bf''(%5Cxi)%20h%5E3%7D%7B2%7D%20%5Cint_%7B0%7D%5E%7B1%7D(t%5E2%20-%20t)%20dt%5C%5C%0A&amp;=%20%5Cfrac%7Bf''(%5Cxi)%20h%5E3%7D%7B2%7D%20%5Cleft%5B%5Cfrac%7Bt%5E3%7D%7B3%7D%20-%20%5Cfrac%7Bt%5E2%7D%7B2%7D%5Cright%5D_%7B0%7D%5E%7B1%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7Bf''(%5Cxi)%20h%5E3%7D%7B2%7D%20%5Cleft%5B%5Cfrac%7B1%7D%7B3%7D%20-%20%5Cfrac%7B1%7D%7B2%7D%5Cright%5D%20%5C%5C%0A&amp;=%20-%5Cfrac%7B1%7D%7B12%7Dh%5E3%20f''(%5Cxi)%0A%5Cend%7Balign*%7D%0A%5Ctag%7B8%7D"></span></p>
<p>Summing the contributions for each subinterval <img src="https://latex.codecogs.com/png.latex?%5Bx_i,x_%7Bi+1%7D%5D">, <img src="https://latex.codecogs.com/png.latex?i=0...n">, gives:</p>
<p><span id="eq-composite-trapezoidal-rule"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cint_%7Ba%7D%5E%7Bb%7Df(x)dx%20=%20T(h)%20+%20R_T,%20%5Cquad%20T(h)%20=%20%5Cfrac%7Bh%7D%7B2%7D(f_0%20+%20f_n)%20+%20h%5Csum_%7Bi=1%7D%5E%7Bn-1%7Df_i%0A%5Cend%7Balign*%7D%0A%5Ctag%7B9%7D"></span></p>
<p>which is the <strong>composite trapezoidal rule</strong>. The global truncation error is:</p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>Numerical Methods</category>
  <guid>https://quantdev.blog/posts/numerical-integration/</guid>
  <pubDate>Mon, 11 Nov 2024 00:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/numerical-integration/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Template Programming</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/template-programming/</link>
  <description><![CDATA[ 





<p>C++11 introduced <a href="https://timsong-cpp.github.io/cppwp/n4868/temp.variadic">variadic templates</a> which permit functions to accept a variable number of arguments. They also permit template types such as <code>std::tuple</code> that can hold a variable number of elements. The main language mechanism enabling variadic templates is <em>parameter packs</em>, which hold an arbitrary number of values or types. Some things are easier to do with parameter packs - for instance passing the values they comprise to a function. Other tasks are a bit trickier to accomplish, such as iterating over a parameter pack or extracting specific elements. However, these things can generally be accomplished through various idioms, some more unwieldy then others.</p>
<p>Between C++11 and C++20, the language gained several improvements to variadic templates. Improvements to other features, such as concepts and lambdas, have also created new options for manipulating parameter packs in C++20. Ideally, cataloging these tricks make it easier for people to do what they need with variadic templates.</p>
<section id="an-overview-of-variadic-templates" class="level2">
<h2 class="anchored" data-anchor-id="an-overview-of-variadic-templates">An overview of variadic templates</h2>
<p>A <em>template parameter pack</em> is a template parameter that accepts zero or more template arguments. A <em>function parameter pack</em> is a function parameter that accepts zero or more function arguments. A variadic template is template that captures a <em>parameter pack</em> in its template arguments or function arguments. A parameter pack is captured by introducing an identifier prefixed by an ellipsis, as in <code>...X</code>. Once captured, a parameter pack can later be used in a <em>pattern</em> expanded by an ellipsis (<code>...</code>), generally to the right of the pattern, as in <code>X...</code>. Pack expansion is conceptually equivalent to having one copy of the pattern for each element of the parameter pack.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb1-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb1-4">T sum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb1-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span> Args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb1-9">T sum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> Args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span> args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb1-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> sum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>Args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...&gt;(</span>args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...);</span></span>
<span id="cb1-11"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-14"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>   </span>
<span id="cb1-15">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span> result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-16">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"result = "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span>  result<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-18"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><a href="https://godbolt.org/z/v1cM4anWY">Compiler Explorer</a></p>
<p>The <code>sum()</code> function takes one or more arguments. The first argument is always captured by the parameter <code>x</code> and the rest of the arguments are captured by the pack <code>...args</code> on line 9.</p>
</section>
<section id="expanding-parameter-packs" class="level2">
<h2 class="anchored" data-anchor-id="expanding-parameter-packs">Expanding parameter packs</h2>
<p>When using a variadic template, we often use a recursive logic with two overloads : one for the general case and one for ending the recursion.</p>
<p>The below code snip is a minimalistic example of tuple. The first class is the primary template. The primary template tuple has two member variables : <code>first</code> of type <code>Type</code> and <code>rest</code> of type <code>Types...</code> . This means that a template of <code>N</code> elements will contain the first element, and another tuple; this second tuple in turn contains the second element and yet another tuple; so on and so forth.</p>
<p>A captured parameter pack must be used in a <em>pattern</em> that is expanded with an ellipsis (<code>...</code>). A <em>pattern</em> is a set of tokens containing the identifiers of one or more parameter packs. On line 11, we capture a parameter pack <code>rest</code> consisting of a sequence of values <code>rest[i]</code> each of type <code>Types[i]</code> for the i-th position in parameter pack <code>Types</code>. On line 13, we expand the pattern <code>rest</code>.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Variadic class templates and parameter pack expansion</span></span>
<span id="cb2-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;functional&gt;</span></span>
<span id="cb2-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;utility&gt;</span></span>
<span id="cb2-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> Type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span> Types<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb2-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb2-8">    Type <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">first_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-9">    tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>Types<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rest_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-10"></span>
<span id="cb2-11">    tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Type first<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> Types<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span> rest<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span id="cb2-12">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">first_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>first<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-13">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rest_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>rest<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...)</span></span>
<span id="cb2-14">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span></span>
<span id="cb2-15"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb2-16"></span>
<span id="cb2-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb2-18"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">struct</span> tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;{</span></span>
<span id="cb2-19">    T <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">first_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-20"></span>
<span id="cb2-21">    tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T first<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">first_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>first<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span></span>
<span id="cb2-22"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb2-23"></span>
<span id="cb2-24"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb2-25"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>   </span>
<span id="cb2-26">    tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb2-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-28"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><a href="https://godbolt.org/z/cqsYjrYT8">Compiler Explorer</a></p>
<p>When a pattern contains more than one parameter pack, all packs must have the same length. This length determines the number of times the pattern is conceptually replicated in the expansion, once for each position in the expanded pack(s). Consider the following code snippet:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// An example with two parameter packs</span></span>
<span id="cb3-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb3-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;type_traits&gt;</span></span>
<span id="cb3-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;tuple&gt;</span></span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>same_as<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;...</span> C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb3-7"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> expand<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span> c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb3-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>tuple<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...&gt;</span> tpl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...);</span></span>
<span id="cb3-10"></span>
<span id="cb3-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">char</span> msg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>toupper<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))...,</span> <span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\0</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb3-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Do something</span></span>
<span id="cb3-13"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-14"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb3-15"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>   </span>
<span id="cb3-16">    expand<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'t'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'e'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'p'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'l'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'a'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'t'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'e'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb3-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-18"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>On line 7, <code>tuple&lt;C...&gt;</code> expands the pack <code>C</code> in the <em>template-argument list</em>, while <code>tpl(c...)</code> expands <code>c</code> in an <em>initializer list</em> (which, not to be confused with <code>std::initializer_list</code> is the C++ grammar for comma-separated lists of expressions passed as arguments to function calls and constructors).</p>
<p>On line 9, we expand the pattern <code>C(std::toupper(c))</code> in another initializer list. This is an example of a pattern with two packs, <code>C</code> and <code>c</code>, both of which have the same length and are expanded in lockstep. (<code>std::toupper()</code> returns an <code>int</code> rather than a <code>char</code> so requires a cast).</p>
<p>In most cases, an expanded pattern is conceptually equivalent to the number of copies of the pattern equal to the size of the parameter pack. Unless otherwise noted, a pattern is expanded by appending an ellipsis (<code>...</code>). Here is a list of <a href="https://timsong-cpp.github.io/cppwp/n4868/temp.variadic#5">contexts</a> in which a pattern can be expanded:</p>
<ul>
<li>In <em>initializer-lists</em> (as shown above), including pack expansion in the arguments to a function call. Conceptually, such a pack expansion is equivalent to a comma-separated list of instances of the pattern.</li>
<li>In <em>base specifier lists</em>, to specify one base class for each member of a type parameter pack e.g.:</li>
</ul>


<!-- -->

</section>

 ]]></description>
  <category>C++</category>
  <guid>https://quantdev.blog/posts/template-programming/</guid>
  <pubDate>Sun, 10 Nov 2024 00:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/template-programming/cpp.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>A hitchhiker’s guide to move semantics and perfect forwarding</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/move-semantics/</link>
  <description><![CDATA[ 





<section id="motivation-for-move-semantics" class="level2">
<h2 class="anchored" data-anchor-id="motivation-for-move-semantics">Motivation for Move Semantics</h2>
<p>To understand the basic principles of move semantics, let’s look at the execution of a small piece of code. I’ve written a toy <code>Vector</code> class. I choose the manage the memory myself, so I will follow the <a href="https://en.wikipedia.org/wiki/Rule_of_three_%28C++_programming%29">rule of three</a>. I will supply a copy-constructor, copy-assignment operator and a destructor. I have also overloaded <code>operator+()</code> to support element-wise addition of two vectors.</p>
<section id="value-semantics" class="level3">
<h3 class="anchored" data-anchor-id="value-semantics">Value Semantics</h3>
<p>Assume that we have the following program:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//basics/copy_semantics.cpp</span></span>
<span id="cb1-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb1-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;stdexcept&gt;</span></span>
<span id="cb1-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;initializer_list&gt;</span></span>
<span id="cb1-5"></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb1-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Vector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">private</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb1-10">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-11">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-12">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb1-15">    Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">},</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">},</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nullptr</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span></span>
<span id="cb1-16">    Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">},</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">new</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">},</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span></span>
<span id="cb1-17">    Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> T data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-18">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-19">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-20">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-21"></span>
<span id="cb1-22">    Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>initializer_list<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> list<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-23">        clear<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb1-24">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> elem <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> list<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-25">            push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>elem<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-26">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-27"></span>
<span id="cb1-28">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Destructor</span></span>
<span id="cb1-29">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-30">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-31">        clear<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb1-32">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-33"></span>
<span id="cb1-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Copy constructor</span></span>
<span id="cb1-35">    Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-36">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-37">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-38">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-39"></span>
<span id="cb1-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-41">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-42">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">new</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-43"></span>
<span id="cb1-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-45">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-46">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-47"></span>
<span id="cb1-48">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Copy assignment operator</span></span>
<span id="cb1-49">    Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-50">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-51">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-52">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-53">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[]</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-54">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nullptr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-55"></span>
<span id="cb1-56">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-57">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-58">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">new</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-59"></span>
<span id="cb1-60">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-61">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-62">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-63"></span>
<span id="cb1-64">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-65">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-66"></span>
<span id="cb1-67">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[](</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-68">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-69">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-70">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-71">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb1-72">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">throw</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>out_of_range<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Index out of bounds."</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-73">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-74"></span>
<span id="cb1-75">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[](</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span></span>
<span id="cb1-76">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-77">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-78">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-79">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb1-80">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">throw</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>out_of_range<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Index out of bounds."</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-81">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-82"></span>
<span id="cb1-83">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> reserve<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-84">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-85">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-86"></span>
<span id="cb1-87">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nullptr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-88">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-89">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-90">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-91">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-92"></span>
<span id="cb1-93">        T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bufferNew <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">new</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-94">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">unsigned</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> l_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>min<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-95">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> l_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-96">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-97">            bufferNew<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-98">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-99"></span>
<span id="cb1-100">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nullptr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-101">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[]</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-102"></span>
<span id="cb1-103">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> bufferNew<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-104">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-105">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-106"></span>
<span id="cb1-107">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> clear<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-108">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-109">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nullptr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-110">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[]</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-111">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nullptr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-112">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-113">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-114">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-115"></span>
<span id="cb1-116">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span></span>
<span id="cb1-117">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-118">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-119">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-120"></span>
<span id="cb1-121">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> capacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-122">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-123">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-124">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-125"></span>
<span id="cb1-126">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> elem<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-127">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-128">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-129">            reserve<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Double the capacity</span></span>
<span id="cb1-130">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-131"></span>
<span id="cb1-132">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> elem<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-133">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-134"></span>
<span id="cb1-135">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> pop_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-136">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-137">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-138">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-139"></span>
<span id="cb1-140">    T front<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-141">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-142">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-143">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-144">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb1-145">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">throw</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>out_of_range<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Index out of bounds."</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-146">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-147"></span>
<span id="cb1-148">    T back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-149">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-150">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-151">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span></span>
<span id="cb1-152">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb1-153">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">throw</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>out_of_range<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Index out of bounds."</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-154">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-155"></span>
<span id="cb1-156">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> getRawPointer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-157">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-158">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-159">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-160"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb1-161"></span>
<span id="cb1-162"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb1-163">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span> v1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span> v2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-164"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-165">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> v2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">())</span></span>
<span id="cb1-166">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">throw</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>logic_error<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vector lengths must be equal."</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-167">    Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> result<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-168">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> v1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-169">        result<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> v2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]);</span></span>
<span id="cb1-170"></span>
<span id="cb1-171">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> result<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-172"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-173"></span>
<span id="cb1-174">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> createAndInsert<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-175"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-176">    Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> pts<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-177">    pts<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>reserve<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-178">    Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb1-179">    pts<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-180">    pts<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-181">    pts<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb1-182">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> pts<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-183"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-184"></span>
<span id="cb1-185"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-186"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-187">    Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> createAndInsert<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb1-188">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-189"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><a href="https://godbolt.org/z/hEMKd99s5">Compiler Explorer</a></p>
<p>Let us look at the individual steps of the program (inspecting both stack and the heap) when we compile this program with a C++ compiler.</p>
<p>First in <code>main</code>, we create the empty vector <code>pts</code> which will be used to store points in the euclidean space <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E2">:</p>
<pre><code>Vector&lt;Vector&lt;double&gt;&gt; pts;</code></pre>
<p>which is placed on the stack as an object that has <code>size_ = 0</code>, <code>capacity_ = 0</code> and no memory allocated for elements.</p>
<p>Then, we call</p>
<pre><code>pts.reserve(3);</code></pre>
<p>This allocates memory for <code>3</code> elements on the heap. The member <code>pts_-&gt;capacity_</code> equals <code>3</code>, <code>pts-&gt;size_</code> equals <code>0</code> and <code>pts_-&gt;ptr_</code> contains the address to heap block. The allocated memory is not initialized, because the number of elements is still <code>0</code>.</p>
<p>Then, we create a <img src="https://latex.codecogs.com/png.latex?2">-tuple to hold the cartesian coordinates of a point <img src="https://latex.codecogs.com/png.latex?(1.0,1.0)">. We create a <code>Vector&lt;double&gt;</code> initialized to <code>{1.0,1.0}</code>. Essentially, we create an object <code>x</code> on the stack with its members <code>x-&gt;size_ = 2</code>, <code>x-&gt;capacity_ = 5</code> and a pointer <code>x-&gt;ptr_</code> containing the address of newly allocated memory on the heap for <code>5</code> elements. Further, <code>x-&gt;ptr_[0]=1.0</code>, <code>x-&gt;ptr_[1]=1.0</code>.</p>
<pre><code>Vector&lt;double&gt; x{1.0, 1.0};</code></pre>
<p>After this statement, the program has the following state: we have two objects on the stack : <code>pts</code> and <code>x</code>. Both of them have memory allocated on the heap.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_00.png" class="img-fluid figure-img"></p>
<figcaption>Checkpoint #1</figcaption>
</figure>
</div>
<p>The next step is the command to insert <code>x</code> into the <code>pts</code> vector.</p>
<pre><code>pts.push_back(x);</code></pre>
<p>My toy <code>Vector</code> class is said to have value semantics, which means it creates copies of the values passed to it. As a result, we get a first element in the vector, which is a full(deep) copy of the passed value/object <code>x</code>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_01.png" class="img-fluid figure-img"></p>
<figcaption>Checkpoint #2</figcaption>
</figure>
</div>
<p>The current state is that we have a vector <code>pts</code> and two copies of <code>x={1.0,1.0}</code>, one of which is the first element in <code>pts</code>.</p>
<p>Let’s now look at the next statement, which creates a new temporary vector and again inserts it into the <code>pts</code> vector:</p>
<pre><code>pts.push_back(x + x);</code></pre>
<p>This statement is performed in three steps:</p>
<p><em>Step 1</em>. We create a temporary <code>Vector&lt;double&gt;</code> object <code>x + x</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_02.png" class="img-fluid figure-img"></p>
<figcaption>Step #1</figcaption>
</figure>
</div>
<p><em>Step 2</em>. <code>x+x</code> is a temporary. The <code>Vector&lt;T&gt;::push_back(const T&amp;)</code> function accepts a reference-to-<code>const</code> as an argument. Since <code>x+x</code> is a temporary, it cannot be modified and binds to a reference-to-<code>const</code>. Moreover, being a temporary object, it is likely to die soon. Referencing it extends the lifetime of the temporary <code>x + x={2.0,2.0}</code>.</p>
<p>Now, the statement <code>pts_[size++] = elem</code> will invoke the copy-assignment operator on the yet uninitialized second element <code>pts[1]</code> which is of type <code>Vector&lt;double&gt;</code>. This will force a full (deep) copy of <code>x + x={2.0,2.0}</code>. At this time, two copies of <code>{2.0,2.0}</code> exist on the heap. One of these is assigned to <code>pts[1]</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_03.png" class="img-fluid figure-img"></p>
<figcaption>Step #2</figcaption>
</figure>
</div>
<p><em>Step 3</em>. When <code>push_back(const T&amp;)</code> returns, the temporary <code>x + x</code> will die and its destructor is called and the memory allocated on the heap is freed. You can see this on <a href="https://cppinsights.io/s/3f814c34">cppinsights</a>.</p>
<p>Our code is clearly not performing well: we create a copy of the temporary <code>x + x</code> and destroy the source of the copy immediately afterwards, which means we unnecessarily allocate and free memory that we could have just moved from source to the copy.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_04.png" class="img-fluid figure-img"></p>
<figcaption>Step #3</figcaption>
</figure>
</div>
<p>With the next statement, again we insert <code>x</code> into <code>pts</code>:</p>
<pre><code>pts.push_back(x)</code></pre>
<p>Again, <code>pts</code> copies <code>x</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_05.png" class="img-fluid figure-img"></p>
<figcaption>Checkpoint #3</figcaption>
</figure>
</div>
<p>This is also something to improve. Because the value of <code>x</code> is no longer needed, some optimization could use the memory of <code>x</code> as the memory for the new element instead.</p>
<p>At the end of <code>createAndInsert()</code> we come to the return statement:</p>
<pre><code>return pts;</code></pre>
<p>Here, the behaviour of the program is a bit more complicated. We return by value (the return type is not a reference), which should be a copy of the value in the <code>return</code> statement. Creating a copy of <code>pts</code> means that we have create a deep copy of the whole vector with all of its elements. Thus, we have to allocate heap memory for the array of elements in the <code>pts</code> and heap memory for the value of each 2-tuple. Here, we would have to allocate memory 4 times.</p>
<p>However, since at the same time <code>pts</code> is destroyed because we leave the scope where it is declared, the compiler is allowed to perform <em>named return value optimization (NRVO)</em>. This means that the compiler can generate code so that <code>pts</code> is used as the return value.</p>
<p>Let us assume that we have the named return value optimization. In that case, at the end of the <code>return</code> statement, <code>pts</code> simply becomes the return value and the destructor of <code>x</code> is called, which frees the memory allocated when it was declared.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_06.png" class="img-fluid figure-img"></p>
<figcaption>Return statement</figcaption>
</figure>
</div>
<p>Finally, we come to the assignment of the return value to <code>result</code>:</p>
<pre><code>result = createAndInsert()</code></pre>
<p>Here, we really get behavior that can be improved: the usual assignment operator has the goal of giving <code>result</code> the same value as the source value that is assigned. In general, any source(assigned) value should not be modified and should independent from the object that the value was assigned to. So, the assignment operator will create a deep-copy of the whole return value:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_07.png" class="img-fluid figure-img"></p>
<figcaption>Return statement</figcaption>
</figure>
</div>
<p>However, right after that we no longer need the temporary return value and we destroy it:</p>
<p>Again, we create a copy of a temporary object and destroy the source of the copy immediately afterwards, which means that we again unnecessarily allocate and free memory. This time it applies to four allocations</p>
<p>For the state of the program after this assignment in <code>main()</code>, we allocated memory numerous times and released it. Unnecessary memory allocations were caused by:</p>
<ul>
<li>Inserting a temporary object into <code>pts</code>.</li>
<li>Inserting an object into <code>pts</code> where we no longer need the value.</li>
<li>Assigning a temporary vector with all its elements.</li>
</ul>
<p>We can more or less avoid these performance pennalties.</p>
</section>
</section>
<section id="copy-elison" class="level2">
<h2 class="anchored" data-anchor-id="copy-elison">Copy elison</h2>
<p>Copy-elison is based on the fact that the compiler is allowed to follow the <a href="https://en.cppreference.com/w/cpp/language/as_if">as-if</a> rule. The compiler is allowed to generate any code which has the same effect as the code you told it to add. The standard actually says, that if the compiler is told to copy something, but the copy is not really necessary, because the original is not going to be used again, then the compiler is allowed to elide(omit) the copy. The compiler is allowed to elide copies, where the results are <em>as-if</em> copies were made.</p>
<p>Consider the function below:</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb10-1"></span>
<span id="cb10-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;cmath&gt;</span></span>
<span id="cb10-3"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span> discountFactor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb10-4">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span> result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(-</span>r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb10-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> result<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb10-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb10-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb10-10">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span> df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>discountFactor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)};</span></span>
<span id="cb10-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb10-12"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>How many parameters are passed to the function <code>discountFactor(double, double)</code>? C++ programmers answer <img src="https://latex.codecogs.com/png.latex?2">, assembly-language programmers answer <img src="https://latex.codecogs.com/png.latex?3">. Why? At a low-level, when we have a return-value, we have to tell the generated code, where to put the return value. The function is passed the address where the results should be written.</p>
<p>Alright, so this is what’s going on. Our function <code>main()</code> is going to call <code>discountFactor(double, double)</code> in order to populate a local <code>df</code>. The stack frame for the function <code>main()</code> looks like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_08.png" class="img-fluid figure-img"></p>
<figcaption>Stack frame for main()</figcaption>
</figure>
</div>
<p>Now, we are going to call the function <code>discountFactor(double, double)</code>. When we call <code>discountFactor(double, double)</code>, we have to create the stack-frame for <code>discountFactor(double, double)</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_09.png" class="img-fluid figure-img"></p>
<figcaption>Call to discountFactor()</figcaption>
</figure>
</div>
<p>Okay, now we execute the function <code>discountFactor(double, double)</code> and now the return value is now stored directly at the address given by <code>&amp;df</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_10.png" class="img-fluid figure-img"></p>
<figcaption>Return statement</figcaption>
</figure>
</div>
<p>So, this is going to elide the copy. This form of copy elison is called <em>Return Value Optimization</em>(RVO). The calling function allocates space for the return value on the stack, and passes the address of that memory to the callee. The callee can then construct a return value directly into that space, which eliminates the need to copy from the inside to the outside.</p>
<p>Also, although the compiler is normally required to make a copy when a function parameter is passed by value (so modifications to the parameter inside the function can’t affect the caller), it is allowed to elide the copy, when the source is a temporary.</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb11-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb11-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb11-3">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb11-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//some code</span></span>
<span id="cb11-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb11-7"></span>
<span id="cb11-8"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> g<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb11-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb11-10">    f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb11-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-12"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>This is how it actually works. We are going to create our temporary - the string <code>"A"</code> in the place, where we would have actually copied it, that is, in the local variable <code>a</code> in the stack frame of <code>f(std::string)</code>.</p>
</section>
<section id="copy-and-swap-idiom" class="level2">
<h2 class="anchored" data-anchor-id="copy-and-swap-idiom">Copy and swap idiom</h2>
<p>Any class which manages resources (a wrapper like a <em>smart pointer</em>) needs to implement <a href="https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three">The Big Three</a>. While the goals of the copy constructor and destructor are straightforward, the copy-assignment operator is arguably the most nuanced and difficult. What pitfalls need to be avoided?</p>
<p>Consider our naive implementation of the assignment operator:</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Copy assignment operator</span></span>
<span id="cb12-2">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb12-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb12-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//(1)</span></span>
<span id="cb12-5">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb12-6">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[]</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//(2)</span></span>
<span id="cb12-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nullptr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb12-8"></span>
<span id="cb12-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//(2)</span></span>
<span id="cb12-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//(2)</span></span>
<span id="cb12-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">new</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//(2)</span></span>
<span id="cb12-12"></span>
<span id="cb12-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb12-14">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span>                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//(3)</span></span>
<span id="cb12-15">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb12-16"></span>
<span id="cb12-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb12-18"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>While this manages the heap memory without leaks, it suffers from three problems, marked sequentially in the code as <code>(n)</code>.</p>
<ol type="1">
<li>The first is the self-assignment test. This check is an easy way to prevent us from running needless code on self-assignment. But, in all other cases, it merely serves to slow down the program and acts as noise in the code; self-assignment rarely occurs, so most of the time this check is a waste.</li>
<li>The seond is, it only provides a basic exception guarantee. If <code>new T[capacity_]</code> fails, <code>*this</code> will have been modified. Namely, the <code>size_</code> and <code>capacity_</code> are wrong and the old data referenced by <code>ptr_</code> is gone! For a strong exception guarantee, we need something akin to:</li>
</ol>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Copy assignment operator</span></span>
<span id="cb13-2">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb13-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb13-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//(1)</span></span>
<span id="cb13-5">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb13-6">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// get the new data ready, before we replace the old data</span></span>
<span id="cb13-7">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> newCapacity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-8">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> newSize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-9">        T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">newPtr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">new</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>newCapacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]();</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//(2)</span></span>
<span id="cb13-10"></span>
<span id="cb13-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb13-12">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">newPtr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">];</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//(3)</span></span>
<span id="cb13-13"></span>
<span id="cb13-14">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//replace the old data (all are non-throwing)</span></span>
<span id="cb13-15">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[]</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-16">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> newSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>       </span>
<span id="cb13-17">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">newCapacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>           </span>
<span id="cb13-18">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> newPtr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>                      </span>
<span id="cb13-19">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb13-20"></span>
<span id="cb13-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-22"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<ol start="3" type="1">
<li>Our code has expanded! This leads us to the third problem: code duplication.</li>
</ol>
<p>In our case, the core of it is only two lines (the allocation and the copy), but with more complex resources, this code bloat can be quite a hassle. What if my class manages more than one resource?</p>
<p>The <em>copy-and-swap</em> idiom is the solution, and elegantly assists the assignment operator in achieving two things: avoiding code duplication and providing a strong exception guarantee.</p>
<p>While, the <em>rule-of-three</em> successfully entails our copy-constructor, assignment and destructor, it should really be called <em>The Big Three and A Half</em>: any time your class manages a resource, it also makes sense to provide a <code>swap</code> function.</p>
<p>A swap function is a <em>non-throwing</em> function that swaps two objects of a class member-for-member.</p>
<p>We need to add <code>swap</code> functionality to our class, and we do that as follows:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb14-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">noexcept</span></span>
<span id="cb14-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb14-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb14-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb14-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb14-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb14-7"></span>
<span id="cb14-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">friend</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> lhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">noexcept</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb14-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>lhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb14-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>lhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">capacity_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb14-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>lhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ptr_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb14-12"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>Now, this is extremely efficient, it merely swaps pointers and sizes rather than allocating and copying entire arrays. We are now ready to implement the copy-and-swap idiom.</p>
<p>Our assignment operator is:</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb15-1">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>Vector other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> </span>
<span id="cb15-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb15-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//(2)</span></span>
<span id="cb15-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb15-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<section id="why-does-it-work" class="level3">
<h3 class="anchored" data-anchor-id="why-does-it-work">Why does it work?</h3>
<p>We first notice an important choice : the parameter argument is taken <em>by-value</em>. While one could just as easily do the following(and indeed many naive implementations of the idiom do):</p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb16-1">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb16-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb16-3">    Vector temp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span> </span>
<span id="cb16-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb16-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb16-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>We lose an important optimization opportunity - if a temporary is passed, the compiler will not perform copy elison. Not only that, but this choice is critical in C++ 11, which is discussed later. (On a general note, a remarkably useful guideline is as follows: if you’re going to make a copy of something in a function, let the compiler do it in the parameter list).</p>
<p>Either way, this method of obtaining our resource is key to eliminating code duplication: we get to use the code from the copy-constructor to make the copy, and never need to repeat any bit of it. Now that, the copy is made, we are ready to swap.</p>
<p>Observe that upon entering the function, the new data is already allocated, copied and ready to be used. This is what gives us a strong exception guarantee: we won’t even enter the function if the construction of the copy fails, and therefore it’s not possible to alter the state of <code>*this</code>. The assignment operator guarantees that the operations call will be fully rolled back in case of an error, as if the error never happened.</p>
<p>Conceptually, it works by using the copy-constructor’s functionality to create a local copy of the data, then takes the copied data with a <code>swap()</code> function swapping the old data with the new data.</p>
<p>To summarize: in order to use the copy-and-swap idiom, we need three things: a working copy-constructor, working destructor (both are the basis of any wrapper, so should be complete anyway), and a <code>swap</code> function.</p>
</section>
</section>
<section id="value-categories" class="level2">
<h2 class="anchored" data-anchor-id="value-categories">Value Categories</h2>
<p>In C++, every expression is either an <em>lvalue</em> or an <em>rvalue</em>. Consider an object that owns some resources(file-descriptors, sockets, memory buffer).</p>
<ul>
<li><p>An <em>lvalue</em> denotes an object whose resources cannot be reused. The object is an <em>lvalue</em>, if you can’t take the guts(resources) out of this object and donate it to someone else. <em>lvalue</em>s include expressions that designate objects by their name. For example, in the expression <code>double y = f(x)</code>, <code>y</code> is an <em>lvalue</em>. Moreover, <em>lvalue</em>s have persistent storage and an identifiable memory address. For instance, if I declare <code>std::vector&lt;double&gt; v{1.0,2.0,3.0,4.0,5.0};</code>, then <code>v[0]</code> is an <em>lvalue</em>.</p></li>
<li><p>An <em>rvalue</em> denotes an object whose resources can be reused. The object is an <em>rvalue</em>, if you can take the guts(resources) out of it and donate it to another object. <em>rvalue</em>s typically include temporary objects as they can’t manipulated at the place they are created and are likely to be destroyed soon. For instance, if declare <code>int x = 5;</code>, <code>5</code> is an <em>rvalue</em>. Moreover, in the statement <code>double y = f(x);</code>, the expression <code>f(x)</code> is an <em>rvalue</em>.</p></li>
</ul>
</section>
<section id="moving-data" class="level2">
<h2 class="anchored" data-anchor-id="moving-data">Moving data</h2>
<p>As seen earlier, C++ sometimes performs unnecessary copying.</p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb17-1">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-2">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">double</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;({</span></span>
<span id="cb17-3">        <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> </span>
<span id="cb17-4">        <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.0</span></span>
<span id="cb17-5">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">});</span></span></code></pre></div>
<p><a href="https://cppinsights.io/s/230e7f56">cppinsights</a> produces the following annotations:</p>
<pre><code>Vector&lt;double&gt; x = Vector&lt;double&gt;();
const double __temporary179_5[10] = {
    1.0, 2.0, 3.0, 4.0, 5.0, 
    6.0, 7.0, 8.0, 9.0, 10.0
};
const Vector&lt;double&gt; __temporary179_6 = Vector&lt;double&gt;(Vector&lt;double&gt;(std::initializer_list&lt;double&gt;{__temporary179_5, 10}));
x.operator=(__temporary179_6);
__temporary179_6.~Vector();
/* __temporary179_5 // lifetime ends here */</code></pre>
<p>In the above code snippet, the temporary vector of reals <img src="https://latex.codecogs.com/png.latex?%5C%7B1.0,2.0,3.0,%5Cldots,10.0%5C%7D"> is copied element-wise to <code>x</code> and then destroyed immediately after. We’ve wasted a lot of energy in deep-copying.</p>
<p>Similarly, appending to a full vector causes much copying before the append. That is not what we want to do.</p>
<p>What we really want to do is, transfer the contents of <code>__temporary19_6</code> vector to <code>x</code> in a very simple way. Firstly, we copy the pointers; we cannot stop there, because at this point there are two <code>Vector&lt;T&gt;</code> objects owning the same memory resource.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_11.png" class="img-fluid figure-img"></p>
<figcaption>Step 1. Copy the pointers</figcaption>
</figure>
</div>
<p>The second step is, of course to set the pointers of the temporary vector to <code>nullptr</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_12.png" class="img-fluid figure-img"></p>
<figcaption>Step 2. Zero out the members of __temp</figcaption>
</figure>
</div>
<p>That looks great and this is cheap! We are doing the minimum amount of work to transfer the contents of the temporary into <code>x</code>.</p>
<p>At the end of the assignment operation, the temporary goes out of scope and the vector <img src="https://latex.codecogs.com/png.latex?%5C%7B1,2,3,%5Cldots,10%5C%7D"> is in <code>x</code>. How do we implement this logic programmatically?</p>
<p>In addition to the copy-constructor, we write a move constructor. A move constuctor simply moves the data by taking ownership of the pointer that refers to the data, leaving the data itself where it resides.</p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// move constructor</span></span>
<span id="cb19-2">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">noexcept</span></span>
<span id="cb19-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb19-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Just swap the memory pointers</span></span>
<span id="cb19-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb19-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<section id="rvalue-references-in-detail" class="level3">
<h3 class="anchored" data-anchor-id="rvalue-references-in-detail"><em>rvalue</em> references in detail</h3>
<p>The constructor takes an argument of the type <em>rvalue</em> reference. <em>rvalue</em> references are declared two ampersands. <em>lvalue</em>s bind to <em>lvalue</em> references. When taking a reference to a temporary object, an <em>rvalue</em>, you have two choices. <em>rvalue</em>s can bind to:</p>
<ul>
<li>A <code>const</code> <em>lvalue</em> reference.</li>
<li>A mutable <em>rvalue</em> reference.</li>
</ul>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb20-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> r1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span>    </span>
<span id="cb20-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> r2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span> r3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb20-5">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;&amp;</span> r4<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span></code></pre></div>
<p>All these references have the semantics of - <em>we can steal/modify the resources of the object we refer to, provided the state of the object remains a valid state</em>. Technically, these semantics are not checked by compilers, so we can modify an <em>rvalue</em> reference as we can do with any non-<code>const</code> object of the type. We might also decide not to modify the value.</p>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb21-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> r1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>    </span>
<span id="cb21-2">r1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb21-3"></span>
<span id="cb21-4">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;&amp;</span> r2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb21-5">r2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span></code></pre></div>
<p>And it’s a logic error to take a mutable <em>lvalue</em> reference to a temporary, so this is disallowed in the language:</p>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// std::string&amp; r1 = "hello";    //error: this is not possible</span></span>
<span id="cb22-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// r1 += "world"; </span></span>
<span id="cb22-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Vector&lt;int&gt;&amp; r2 {1,2,3,4,5};</span></span>
<span id="cb22-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// r2.push_back(6);</span></span></code></pre></div>
<p>Assigning a temporary to a reference extends the lifetime of the temporary so that it matches the lifetime of the reference. So, this is legal:</p>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb23-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb23-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb23-3">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb23-4">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb23-5">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>endl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//the temporary to which s refers is still alive</span></span>
<span id="cb23-6">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb23-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//but now it's destroyed</span></span>
<span id="cb23-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>    </span>
<span id="cb23-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>And so is this:</p>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb24-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"foo"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;};</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//function that returns a string</span></span>
<span id="cb24-2"></span>
<span id="cb24-3"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> bar<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// extends the lifetime as before</span></span>
<span id="cb24-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb24-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span>    </span>
<span id="cb24-6"></span>
<span id="cb24-7"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb24-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb24-9">    bar<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">());</span>     </span>
<span id="cb24-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb24-11"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</section>
<section id="rvalue-references-as-parameters" class="level3">
<h3 class="anchored" data-anchor-id="rvalue-references-as-parameters"><em>rvalue</em> references as parameters</h3>
<p>When we declare a parameter to be an <em>rvalue</em> reference, it has exactly the behavior and semantics as introduced above:</p>
<ul>
<li>The parameter can only bind to a temporary object or an <em>rvalue</em>.</li>
<li>According to the semantics of <em>rvalue</em> references:
<ul>
<li>The caller claims that it is no longer interested in the object. Therefore, you can steal the guts of object, take ownership of its resources.</li>
<li>However, the caller might still be interested in using the object. Therefore, any modification should keep the referenced object in a valid state.</li>
</ul></li>
</ul>
</section>
</section>
<section id="stdmove" class="level2">
<h2 class="anchored" data-anchor-id="stdmove"><code>std::move()</code></h2>
<p>Hey, this is cool! Why don’t we apply these ideas to the below example?</p>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb25-1">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> v1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb25-2">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> v2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>v1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span></code></pre></div>
<p>Well, in this case, we would have a problem. <code>v1</code> has a name, it has a persistent storage location and a memory address, it is an <em>lvalue</em>. You can’t steal the contents of <code>v1</code>.</p>
<p>But, we can do something about this. If indeed you are interested to transfer the contents of <code>v1</code> into <code>v2</code>, then all we need to do is use <code>std::move</code>.</p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb26-1">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> v1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb26-2">Vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> v2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)};</span></span></code></pre></div>
<p><code>std::move()</code> is a function that you can think of as performing an unconditional cast of its argument to an <em>rvalue</em> reference. <code>std::move(v1)</code> marks <code>v1</code> to be movable. It does not physically move anything. It signals, that the object <code>v1</code> may be <em>moved from</em>.</p>
<p>If you have an <em>lvalue</em>, an object for which the lifetime does not end when you use it, you can mark it with <code>std::move()</code> to express <em>I no longer need this object here</em>. <code>std::move</code> does not move; it only sets a temporary marker in the context where the expression is used:</p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb27-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> foo1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//binds to the passed object without modifying it</span></span>
<span id="cb27-2"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> foo1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> rv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//binds to the passed object and might steal/modify its contents</span></span>
<span id="cb27-3"></span>
<span id="cb27-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb27-5"></span>
<span id="cb27-6">foo1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>                             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls the first foo(), s keeps its value</span></span>
<span id="cb27-7">foo1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span>                  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls the second foo(), s might lose its value</span></span>
<span id="cb27-8">                                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//semantically s no longer legal to access</span></span></code></pre></div>
<p>Objects marked with <code>std::move()</code> can still be passed to a function that takes an ordinary <code>const</code> <em>lvalue</em> reference. Consider another code snippet:</p>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb28-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> foo2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> lr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//binds to the passed object without modifying it</span></span>
<span id="cb28-2">                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//no other overload of foo2()</span></span>
<span id="cb28-3">foo2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>                            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// calls foo2(), s keeps its value</span></span>
<span id="cb28-4">foos<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))</span>                  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// calls foo2(), s keeps its value because we know that</span></span>
<span id="cb28-5">                                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// foo2() can't modify or take ownership of the contents of s.</span></span></code></pre></div>
<p>Semantically, <code>s</code> is still legal to access after the execution of the last line. Because there’s overload of <code>foo2(const std::string&amp;&amp;)</code>, there is no ways its contents can be modified or transferred.</p>
<p>Note that, an object marked with <code>std::move()</code> cannot be passed to a non-<code>const</code> <em>lvalue</em> reference.</p>
<section id="header-file-for-stdmove" class="level3">
<h3 class="anchored" data-anchor-id="header-file-for-stdmove">Header file for <code>std::move()</code></h3>
<p><code>std::move()</code> is defined as a function in the C++ standard library. To use it, you have to include the header file <code>&lt;utility&gt;</code> where it is defined:</p>
</section>
<section id="implementation-of-stdmove" class="level3">
<h3 class="anchored" data-anchor-id="implementation-of-stdmove">Implementation of <code>std::move()</code></h3>
<p><code>std::move()</code> is nothing but a <code>static_cast</code> to an <em>rvalue</em> reference. You can achieve the same effect by calling <code>static_cast</code> manually as follows:</p>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb29-1">foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">static_cast</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">decltype</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>obj<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)&amp;&amp;&gt;(</span>obj<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//same effect foo(std::move(obj))</span></span></code></pre></div>
<p>Therefore, we could also write:</p>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb30-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb30-2">foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">static_cast</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;&gt;(</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span></code></pre></div>
</section>
</section>
<section id="moved-from-objects" class="level2">
<h2 class="anchored" data-anchor-id="moved-from-objects">Moved-from objects</h2>
<p>After a <code>std::move()</code>, moved-from objects are not (partially) destroyed. They are still valid objects for which at least the destructor will be called. However, they should also be valid in the sense that they have a consistent state and all operations work as expected. The only thing you do not know is their contents.</p>
<section id="valid-but-unspecified-state" class="level3">
<h3 class="anchored" data-anchor-id="valid-but-unspecified-state">Valid but unspecified state</h3>
<p>The C++ standard library guarantees that moved-from objects are in a <em>valid but unspecified state</em>. Consider the following code:</p>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb31-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb31-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> coll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{};</span></span>
<span id="cb31-3">coll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span></code></pre></div>
<p>After passing <code>s</code> with <code>std::move()</code> you can ask for the number of characters, print out the value, or even assign a new value. However, you cannot print the first character or any other character without checking the number of characters first:</p>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb32-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb32-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;vector&gt;</span></span>
<span id="cb32-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;string&gt;</span></span>
<span id="cb32-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;utility&gt;</span></span>
<span id="cb32-5"></span>
<span id="cb32-6"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb32-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb32-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb32-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> coll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{};</span></span>
<span id="cb32-10">    coll<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//keeps in a valid but unclear state</span></span>
<span id="cb32-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Contents of s : "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//ok (don't know which value is written)</span></span>
<span id="cb32-12">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"size : "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//ok (rites the number of characters)</span></span>
<span id="cb32-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// std::cout &lt;&lt; "[0] = " &lt;&lt; s[0] &lt;&lt; "\n"; //error (potentially undefined behavior)</span></span>
<span id="cb32-14">    s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"new value"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// ok</span></span>
<span id="cb32-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-16"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><a href="https://godbolt.org/z/MY4Y576n1">Compiler Explorer</a></p>
<p>stdout</p>
<pre><code>Contents of s : 
size : 0</code></pre>
</section>
<section id="reusing-moved-from-objects" class="level3">
<h3 class="anchored" data-anchor-id="reusing-moved-from-objects">Reusing moved-from objects</h3>
<p>We might wonder why moved-from objects are still valid objects and are not (partially) destroyed. The reason is that there are useful applications of move semantics, where it makes sense to use moved-from objects again.</p>
<p>For example, consider code where we read chunks of data from a network socket or read strings line-by-line from a file stream and move them into a vector:</p>
<div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb34-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>vector<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> allRows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-3"></span>
<span id="cb34-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>getline<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>myStream<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)){</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//read next line into row</span></span>
<span id="cb34-5">    allRows<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>push_back<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>row<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//and move it to somewhere</span></span>
<span id="cb34-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>Each time after we read a line into <code>row</code>, we use <code>std::move()</code> to move the value of <code>row</code> into the vector of all rows. Then, <code>std::getline()</code> uses the moved-from object <code>row</code> again to read the next line into it.</p>
<p>As a second example, consider a generic function that swaps two values:</p>
<div class="sourceCode" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb35-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb35-2"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb35-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb35-4">    T tmp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)};</span></span>
<span id="cb35-5">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//assign new value to moved-from a</span></span>
<span id="cb35-6">    b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//assign new value to moved-from b</span></span>
<span id="cb35-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>Here, we move the value of <code>a</code> into a temporary object to be able t move-assign the value of <code>b</code> afterwards. The moved-from object <code>b</code> then receives the value of <code>tmp</code>, which is the former value of <code>a</code>.</p>
<p>Code like this is used in sorting algorithms for example, sorting a vector of buy/sell orders in the order book by the bid/ask prices.</p>
</section>
<section id="move-assignments-of-objects-to-themselves" class="level3">
<h3 class="anchored" data-anchor-id="move-assignments-of-objects-to-themselves">Move assignments of objects to themselves</h3>
<p>The rule that moved-from objects are in a <em>valid but unspecified state</em> usually also applies to objects after a direct or indirect self-move.</p>
<p>For example, after the following statement, the object <code>x</code> is usually valid without its value being known:</p>
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb36-1">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//afterwards x is valid but has an unclear value</span></span></code></pre></div>
</section>
</section>
<section id="the-canonical-move-constructor-and-move-assignment-operator" class="level2">
<h2 class="anchored" data-anchor-id="the-canonical-move-constructor-and-move-assignment-operator">The canonical move constructor and move assignment operator</h2>
<p>Consider the below <code>Widget</code> class as an example. The canonical move constructor and move assignment operators are written as follows:</p>
<div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb37-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb37-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">private</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb37-3">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb37-4">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{};</span></span>
<span id="cb37-5">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> resource<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Owning pointer</span></span>
<span id="cb37-6"></span>
<span id="cb37-7">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb37-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Move constructor</span></span>
<span id="cb37-9">    Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">noexcept</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Phase 1: member-wise swap</span></span>
<span id="cb37-10">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)}</span></span>
<span id="cb37-11">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)}</span></span>
<span id="cb37-12">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> resource<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resource<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)}</span></span>
<span id="cb37-13">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb37-14">        rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resource <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nullptr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Phase 2: reset the move-from object</span></span>
<span id="cb37-15">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb37-16"></span>
<span id="cb37-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Move assignment operator</span></span>
<span id="cb37-18">    Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb37-19">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb37-20">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span> resource<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Phase 1: Cleanup</span></span>
<span id="cb37-21">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Phase 2: Member-wise move</span></span>
<span id="cb37-22">        src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>resource <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nullptr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Phase 3: Reset</span></span>
<span id="cb37-23">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb37-24">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb37-25"></span>
<span id="cb37-26">    Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>Widget src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb37-27"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>An owning-pointer such <code>int*</code> is special, and it has to be dealt with separately.</p>
<p>Raw pointers are bad (especially owning raw pointers). In this case, the declaration doesn’t indicate whether it points to an element or an array.</p>
<p>If instead, we have a smart-pointer, then what I can do is omit is phase 2.</p>
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb38-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb38-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">private</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb38-3">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb38-4">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{};</span></span>
<span id="cb38-5">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> resource<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>      </span>
<span id="cb38-6"></span>
<span id="cb38-7">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb38-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Move constructor</span></span>
<span id="cb38-9">    Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">noexcept</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Phase 1: member-wise swap</span></span>
<span id="cb38-10">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)}</span></span>
<span id="cb38-11">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)}</span></span>
<span id="cb38-12">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> resource<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>rhs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>resource<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)}</span></span>
<span id="cb38-13">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span></span>
<span id="cb38-14"></span>
<span id="cb38-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Move assignment operator</span></span>
<span id="cb38-16">    Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb38-17">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb38-18">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> </span>
<span id="cb38-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb38-20">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb38-21"></span>
<span id="cb38-22">    Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>Widget src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb38-23"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>I would like to show you one more thing. The canonical copy assignment operator also doubles up as a move-assignment operator.</p>
<div class="sourceCode" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Copy/Move assignment operator</span></span>
<span id="cb39-2">Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>Widget src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Copy/move constructor called </span></span>
<span id="cb39-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb39-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>swap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>src<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> </span>
<span id="cb39-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">this</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb39-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb39-7"></span>
<span id="cb39-8"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb39-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb39-10">    Widget w1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">new</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)),</span></span>
<span id="cb39-11">    Widget w2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> w1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//copy/move assignment operator called</span></span>
<span id="cb39-12">    Widget w3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>w1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//copy/move assignment operator called</span></span>
<span id="cb39-13"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>In the assignment statement <code>Widget w2 = w1;</code>, first the copy constructor is called and the contents of <code>w1</code> are copied to <code>src</code>, before the control enters the body of <code>operator=(Widget)</code>. Whereas the assignment statement <code>Widget w3 = std::move(w1)</code> results in the invocation of the move constructor and the contents of <code>w1</code> are transferred to <code>w3</code> before we execute the body of the assignment operator.</p>
</section>
<section id="avoiding-unnecessary-stdmove" class="level2">
<h2 class="anchored" data-anchor-id="avoiding-unnecessary-stdmove">Avoiding unnecessary <code>std::move()</code></h2>
<p>As we saw, returning a local object by value automatically uses move semantics if supported. However, to be safe, programmers might try to force this with an explicit <code>std::move()</code>:</p>
<div class="sourceCode" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb40-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb40-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb40-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb40-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// do something</span></span>
<span id="cb40-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// ...</span></span>
<span id="cb40-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Bad, don't do this</span></span>
<span id="cb40-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>Remember that <code>std::move()</code> is just a <code>static_cast</code> to an <em>rvalue</em> reference. Therefore, <code>std::move</code> is an expression that yields the type <code>std::string&amp;&amp;</code>. However, this no longer matches the return type and therefore disables <em>return value optimization</em>, which usually allows the returned object to be used as a return value. For types where move semantics is not implemented, this might even force the copying of the return value instead of just using the returned object as the return value.</p>
</section>
<section id="value-categories-in-detail" class="level2">
<h2 class="anchored" data-anchor-id="value-categories-in-detail">Value categories in detail</h2>
<p>To compile an expression or statement it does not only matter whether the involved types fit. For example, you cannot assign an <code>int</code> to an <code>int</code>, when on the left hand side of the assignment, an <code>int</code> literal is used.</p>
<div class="sourceCode" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb41-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{};</span></span>
<span id="cb41-2">i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">88</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Ok</span></span>
<span id="cb41-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//88 = i;   //Error</span></span></code></pre></div>
<p>For this reason, each expression in C++ has a value category. Besides the type, the value category is essential to decide what you can do with an expression.</p>
<section id="value-categories-since-c11" class="level3">
<h3 class="anchored" data-anchor-id="value-categories-since-c11">Value categories since C++11</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_14.png" class="img-fluid figure-img"></p>
<figcaption>Value Categories</figcaption>
</figure>
</div>
<p>We have the following primary categories:</p>
<ul>
<li><em>lvalue</em> (Locator Value)</li>
<li><em>prvalue</em> (Pure Readable Value)</li>
<li><em>xvalue</em> (Expiring Value)</li>
</ul>
<p>The composite categories are: - <em>glvalue</em> (generalized <em>lvalue</em>) as a common term for <em>lvalue</em> or <em>xvalue</em> - <em>rvalue</em> as a common term for <em>xvalue</em> or <em>prvalue</em></p>
<p>Intuitively, it’s easy to understand the primary value categories, if you look at the following diagram:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/move-semantics/move_semantics_15.png" class="img-fluid figure-img"></p>
<figcaption>Value Categories</figcaption>
</figure>
</div>
<p>For example,</p>
<div class="sourceCode" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb42-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb42-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb42-3"></span>
<span id="cb42-4">X v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb42-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> X c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb42-6"></span>
<span id="cb42-7">f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//passes a modifiable lvalue</span></span>
<span id="cb42-8">f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//passes a non-modifiable lvalue</span></span>
<span id="cb42-9">f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">());</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//passes a prvalue (old syntax of creating a temporary)</span></span>
<span id="cb42-10">f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{});</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//passes a prvalue (new syntax of creating a temporary)</span></span>
<span id="cb42-11">f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//passes an xvalue</span></span></code></pre></div>
<p>Roughly speaking, as a rule of thumb:</p>
<ul>
<li>All names used as expressions are <em>lvalues</em>.</li>
<li>All string literals used as expressions are <em>lvalues</em>.</li>
<li>All non-string literals used as expressions are <em>prvalues</em>.</li>
<li>All temporaries without a name (especially objects returned by value) are <em>prvalues</em>.</li>
<li>All objects marked with a <code>std::move</code> are <em>xvalues</em>.</li>
</ul>
</section>
<section id="copy-elison-since-c17" class="level3">
<h3 class="anchored" data-anchor-id="copy-elison-since-c17">Copy Elison since C++17</h3>
<p>C++17 added mandates to the standard, formally known as :</p>
<ul>
<li>Guaranteed copy elison</li>
<li>Guraranteed return value optimization</li>
<li>Copy evasion</li>
</ul>
<p>If, in an initialization of an object, when the initializer expression is <em>prvalue</em> of the same class type as the variable type, copy elison is guaranteed.</p>
<div class="sourceCode" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb43-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb43-2"></span>
<span id="cb43-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb43-4">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb43-5">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c'tor T()</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb43-6">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c'tor T(const T&amp; t)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb43-7">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c'tor T(T&amp;&amp; t)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb43-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span></code></pre></div>
<div class="sourceCode" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb44-1">T x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}};</span></span></code></pre></div>
<p>In C++17, this is equivalent to <code>T x{};</code>. The default constructor is invoked only once.</p>
<p>Similarly, if, in a <code>return</code> statement the operand is a <em>prvalue</em> of the same class type as the function return type, copy elison is guaranteed.</p>
<div class="sourceCode" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb45-1">T func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb45-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb45-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{};</span></span>
<span id="cb45-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb45-5"></span>
<span id="cb45-6">T x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()};</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Only one default construction of T allowed here</span></span></code></pre></div>
<p>Under the rules of C++17, under the hood, a <em>prvalue</em> will be used only as <em>unmaterialized</em> recipe of an object, until actual materialization is required.</p>
<p>A <em>prvalue</em> is an expression whose evaluation <em>initializes/materializes</em> an object. This is called as <em>temporary materialization conversion</em>.</p>
<div class="sourceCode" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb46-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span>  T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb46-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb46-3">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb46-4">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c'tor T()</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb46-5">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb46-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//delete move and copy constructors</span></span>
<span id="cb46-7">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb46-8">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> other<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb46-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb46-10"></span>
<span id="cb46-11">T make<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb46-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Creates the first temporary (pre C++17)</span></span>
<span id="cb46-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{};</span></span>
<span id="cb46-14"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb46-15"></span>
<span id="cb46-16"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb46-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Construct the second temporary (pre C++17)</span></span>
<span id="cb46-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Copy/move temporary into N using the = operator (pre C++17)</span></span>
<span id="cb46-19">    T t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> make<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb46-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb46-21"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>Pre C++17, the function <code>make()</code> would construct a temporary within its scope. This temporary would then be copied/moved into another temporary within the <code>main</code> scope. Finally, the <code>operator=</code> would build <code>t</code> via copy/move construction. All of this temporary business would be elided by (RVO) by any decent compiler resulting in <code>make()</code> constructing a single object within <code>t</code>. However, this elison is somewhat optional, so the compiler must also demand that copy and move constructors exist, just in case. The above code does not compile with any pre C++17 compiler.</p>
<p>Post C++17, <code>make()</code> creates an object of type <code>T</code> within <code>t</code>. Avoiding excessive use of temporary objects is now a language feature and the reliance on compiler optimization is removed. The above code does compiler with a post C++17 compiler.</p>
</section>
<section id="value-categories-since-c17" class="level3">
<h3 class="anchored" data-anchor-id="value-categories-since-c17">Value Categories since C++17</h3>
<p>C++17 has the same value categories but clarified the semantic meaning of the value categories as described in the figure above.</p>
<p>The key approach for explaining value categories now is that in general, we have two major kinds of expressions:</p>
<ul>
<li><em>glvalues</em>: expressions for locations of long-living objects or functions.</li>
<li><em>prvalues</em>: expressions for short-living values for initializations.</li>
</ul>
<p>An <em>xvalue</em> is then considered a special location, representing a (long-living) object, whose resources/values are no longer needed.</p>
<p>Loosely speaking, <em>prvalues</em> themselves do not exist somewhere in memory, they do not denote objects. They are used for initialization. In C++17, <em>prvalues</em> are not moved from. It doesn’t make sense to talk about whether you can steal it’s resources.</p>
</section>
</section>
<section id="perfect-forwarding" class="level2">
<h2 class="anchored" data-anchor-id="perfect-forwarding">Perfect Forwarding</h2>
<section id="motivation-for-perfect-forwarding" class="level3">
<h3 class="anchored" data-anchor-id="motivation-for-perfect-forwarding">Motivation for perfect forwarding</h3>
<p>Consider a function that declares the parameter as <em>rvalue</em> reference:</p>
<div class="sourceCode" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb47-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb47-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb47-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Do something</span></span>
<span id="cb47-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"string s : "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>As we’ve learned, we can only pass <em>rvalue</em>s to this function:</p>
<div class="sourceCode" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb48-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hello"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb48-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// f(s);                // Error : passing an lvalue to an rvalue ref</span></span>
<span id="cb48-3">f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span>        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// okay, passing an xvalue</span></span>
<span id="cb48-4">f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// okay, passing a prvalue</span></span></code></pre></div>
<p>However, when we use the parameter <code>s</code> inside the function <code>f(std::string&amp;&amp;)</code>, we are dealing with an object that has a name. This means that we use <code>s</code> as an <em>lvalue</em>. We can do only what we are allowed to do with an <em>lvalue</em>. This means that we cannot call our function recursively.</p>
<div class="sourceCode" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb49-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb49-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb49-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Do something</span></span>
<span id="cb49-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"string s : "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// f(s);    // Error: passing an lvalue to an rvalue reference</span></span>
<span id="cb49-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>We have to mark <code>s</code> with <code>std::move()</code> again:</p>
<div class="sourceCode" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb50-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb50-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb50-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Do something</span></span>
<span id="cb50-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"string s : "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb50-5">    f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Ok, passing an xvalue</span></span>
<span id="cb50-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>This is the formal specification of the rule that <strong>move semantics is not passed through</strong>.</p>
<p>To forward an object that is passed with move semantics to a function, it not only has to be bound to an <em>rvalue</em> reference; you have to use <code>std::move()</code> again to forward its move semantics to another function.</p>
<p>For example:</p>
<div class="sourceCode" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb51-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb51-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// ...</span></span>
<span id="cb51-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb51-4"></span>
<span id="cb51-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//forward declarations</span></span>
<span id="cb51-6"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;);</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//for constant values (read-only access)</span></span>
<span id="cb51-7"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;);</span>           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//for variable values (out parameters)</span></span>
<span id="cb51-8"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;);</span>          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//for values that are no longer used(move semantics)</span></span></code></pre></div>
<p>We have the following rules when calling these functions:</p>
<div class="sourceCode" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb52-1">X v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb52-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> X c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb52-3"></span>
<span id="cb52-4">foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(X&amp;)</span></span>
<span id="cb52-5">foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(const X&amp;)</span></span>
<span id="cb52-6">foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{});</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(X&amp;&amp;)</span></span>
<span id="cb52-7">foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(X&amp;&amp;)</span></span>
<span id="cb52-8">foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(const X&amp;)</span></span></code></pre></div>
<p>Now, assume that we want to call <code>foo()</code> for the same arguments indirectly via a helper function <code>callFoo()</code>. That helper function would also need the three overloads.</p>
<div class="sourceCode" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb53-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//arg binds to all const objects</span></span>
<span id="cb53-2">    foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(const X&amp;)</span></span>
<span id="cb53-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb53-4"></span>
<span id="cb53-5"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span>            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//arg binds to lvalues</span></span>
<span id="cb53-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb53-7">    foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(&amp;)</span></span>
<span id="cb53-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb53-9"></span>
<span id="cb53-10"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span>          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//arg binds to rvalues</span></span>
<span id="cb53-11">    foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span>        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//needs std::move() to call foo(X&amp;&amp;)</span></span>
<span id="cb53-12"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>In all cases, <code>arg</code> is used as an <em>lvalue</em> (being an object with a name). The first version forwards it as a <code>const</code> object, but the other two cases implement two different ways to forward the non-<code>const</code> argument.</p>
<ul>
<li>Arguments declared as <em>lvalue</em> references (that bind to objects that do not have move semantics) are passed as they are.</li>
<li>Arguments declared as <em>rvalue</em> references (that bind to objects that have move semantics) are passed with <code>std::move</code>.</li>
</ul>
<p>This allows us to forward move semantics perfectly: for any argument that is passed with move semantics, we keep the move semantics; but we do not add move semantics when we get an argument that does not have it.</p>
<p>Only with this implementation is the use of <code>callFoo</code> to call <code>foo</code> transparent.</p>
<div class="sourceCode" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb54-1">X v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb54-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> X c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb54-3"></span>
<span id="cb54-4">callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(X&amp;)</span></span>
<span id="cb54-5">callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(const X&amp;)</span></span>
<span id="cb54-6">callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{});</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(X&amp;&amp;)</span></span>
<span id="cb54-7">callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(X&amp;&amp;)</span></span>
<span id="cb54-8">callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls foo(const X&amp;)</span></span></code></pre></div>
<p>Remember that an <em>rvalue</em> passed to an <em>rvalue</em> reference becomes an <em>lvalue</em> when used, which means that we need <code>std::move()</code> to pass it as an <em>rvalue</em> again. However, we cannot use <code>std::move()</code> everywhere. For the other overloads, using <code>std::move()</code> would call the overload of <code>foo()</code> for <em>rvalue</em> references when an <em>lvalue</em> is passed.</p>
<p>For <em>perfect forwarding</em> in generic code, we would always need all these overloads for each parameter. To support all combinations, this means having <img src="https://latex.codecogs.com/png.latex?3%5E2%20=%209"> overloads for <img src="https://latex.codecogs.com/png.latex?2"> generic arguments and <img src="https://latex.codecogs.com/png.latex?3%5E3%20=%2027"> overloads for <img src="https://latex.codecogs.com/png.latex?3"> generic arguments.</p>
<p>Therefore, C++11 introduced a special way to <em>perfectly forward</em> without any overloads but still keeping the type and the value category.</p>
</section>
<section id="implementing-perfect-forwarding" class="level3">
<h3 class="anchored" data-anchor-id="implementing-perfect-forwarding">Implementing perfect forwarding</h3>
<p>To avoid overloading functions for parameters with different value categories, C++ introduced the mechanism of perfect forwarding. You need three things:</p>
<ol type="1">
<li>Take the call parameter as a pure <em>rvalue</em> reference (delcared with <code>&amp;&amp;</code> but without <code>const</code> or <code>volatile</code>)</li>
<li>The type of the parameter has to be a template parameter of the function.</li>
<li>When forwarding the parameter to another function, use a helper function called <code>std::forward&lt;&gt;()</code> which is declared in <code>&lt;utility&gt;</code>.</li>
</ol>
<p>You have to implement a function that perfectly forwards an argument as follows:</p>
<div class="sourceCode" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb55-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb55-2"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb55-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb55-4">    foo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>forward<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span>arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb55-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><code>std::forward&lt;&gt;()</code> is defined as a conditional <code>std::move()</code>, so that we get the same behavior as the three (or four) overloads of <code>callFoo()</code> above:</p>
<ul>
<li>If we pass an <em>rvalue</em> to <code>arg</code>, we have the same effect as calling <code>foo(std::move(arg))</code>.</li>
<li>If we pass an <em>lvalue</em> to <code>arg</code>, we have the same effect as calling <code>foo(arg)</code>.</li>
</ul>
<p>What exactly is happening here, is pretty tricky and needs a careful explanation.</p>
</section>
<section id="universal-and-forwarding-references" class="level3">
<h3 class="anchored" data-anchor-id="universal-and-forwarding-references">Universal and Forwarding references</h3>
<p>First note that we declare <code>arg</code> as an <em>rvalue</em> reference parameter:</p>
<div class="sourceCode" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb56-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb56-2"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<p>This might give the impression that the rules of <em>rvalue</em> references apply. However, that is not the case. An <em>rvalue</em> reference (not qualified with <code>const</code> or <code>volatile</code>) of a <em>function template parameter</em> does not follow the rules of ordinary <em>rvalue</em> references. It is a different thing.</p>
<section id="two-terms-universal-and-forwarding-reference" class="level4">
<h4 class="anchored" data-anchor-id="two-terms-universal-and-forwarding-reference">Two terms : Universal and Forwarding Reference</h4>
<p>Such a reference is called a <strong>universal reference</strong>. Unfortunately, there is also another term for it that is mainly used in the C++ standard: <em>forwarding reference</em>. There is no difference between these two terms, it is just that we have a historical mess here with two established terms that mean the same thing. Both terms describe basic aspects of universal/forwarding references:</p>
<ul>
<li>They can universally bind to objects of all types(<code>const</code> and non-<code>const</code>) and value categories.</li>
<li>They are usually used to forward arguments; but note that this is not the only use (one reason for me to prefer the term <em>universal reference</em>)</li>
</ul>
</section>
<section id="universal-references-bind-to-all-value-categories" class="level4">
<h4 class="anchored" data-anchor-id="universal-references-bind-to-all-value-categories">Universal references bind to all value categories</h4>
<p>The important feature of universal references is that they can bind to objects and expressions of any value category:</p>
<div class="sourceCode" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb57-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb57-2"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//arg is universal/forwarding reference</span></span>
<span id="cb57-3"></span>
<span id="cb57-4">X v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb57-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> X c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb57-6">callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//ok</span></span>
<span id="cb57-7">callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//ok</span></span>
<span id="cb57-8">callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{});</span>           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//ok</span></span>
<span id="cb57-9">callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//ok</span></span>
<span id="cb57-10">callFoo<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//ok</span></span></code></pre></div>
<p>In addition, they preserve the <code>const</code>-ness and value category (whether we have an <em>rvalue</em> or an <em>lvalue</em>) of the object they are bound to:</p>
<div class="sourceCode" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb58-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb58-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;type_traits&gt;</span></span>
<span id="cb58-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{};</span></span>
<span id="cb58-4"></span>
<span id="cb58-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb58-6"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> arg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb58-7">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>boolalpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-8"></span>
<span id="cb58-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>is_same<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;,</span> Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;::</span>value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb58-10">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb58-11">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T&amp;&amp; = Widget&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-12">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb58-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>is_same<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;,</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&gt;::</span>value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb58-14">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb58-15">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T&amp;&amp; = const Widget&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-16">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb58-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>is_same<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;,</span> Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;&gt;::</span>value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb58-18">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb58-19">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T&amp;&amp; = Widget&amp;&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-20">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb58-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>is_same<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;,</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Widget<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;&gt;::</span>value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb58-22">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb58-23">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"T&amp;&amp; = const Widget&amp;&amp;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-24">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb58-25"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb58-26"></span>
<span id="cb58-27"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb58-28"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb58-29">    Widget w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> Widget cw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-31"></span>
<span id="cb58-32">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Calling f(w)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb58-33">    f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb58-34">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Calling f(cw)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb58-35">    f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>cw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb58-36">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Calling f(std::move(w))</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb58-37">    f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb58-38">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Calling f(std::move(cw))</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb58-39">    f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>cw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span></span>
<span id="cb58-40">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-41"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><a href="https://godbolt.org/z/759ebbErr">Compiler Explorer</a></p>
<p>stdout:</p>
<pre><code>Calling f(w)
T&amp;&amp; = Widget&amp;
Calling f(cw)
T&amp;&amp; = const Widget&amp;
Calling f(std::move(w))
T&amp;&amp; = Widget&amp;&amp;
Calling f(std::move(cw))
T&amp;&amp; = const Widget&amp;&amp;</code></pre>
<p>By rule, the template parameter type <code>T</code>, is deduced to be:</p>
<ul>
<li>An <em>lvalue</em> reference if we pass an <em>lvalue</em>.</li>
<li>An <em>rvalue</em> reference if we pass to an <em>rvalue</em>.</li>
</ul>
<p>Note that, a generic <em>rvalue</em> reference that is qualified with <code>const</code> (or <code>volatile</code>) is <strong>not</strong> a universal reference.</p>
<p>The rules of <em>reference collapsing</em> are now applied:</p>
<ul>
<li><code>Widget&amp; &amp;&amp;</code> becomes <code>Widget&amp;</code></li>
<li><code>Widget&amp;&amp; &amp;</code> becomes <code>Widget&amp;</code></li>
<li><code>Widget&amp; &amp;&amp;</code> becomes <code>Widget &amp;</code></li>
<li><code>Widget&amp;&amp; &amp;&amp;</code> becomes <code>Widget&amp;&amp;</code></li>
</ul>
<p>In the function call <code>f( w )</code>, we are passing an <em>lvalue</em>, so the template parameter <code>T</code> is deduced to be an <em>lvalue reference</em>, <code>Widget&amp;</code>. Therefore, <code>T&amp;&amp;</code> is <code>Widget&amp; &amp;&amp;</code> and by the rules of reference collapsing, this collapses to <code>Widget&amp;</code>.</p>
<p>Similarly, in the function call <code>f( Widget{} )</code>, we are passing an <em>rvalue</em>, so the template parameter <code>T</code> is deduced to be an <em>rvalue reference</em>, <code>Widget&amp;&amp;</code>. Therefore, <code>T&amp;&amp;</code> is <code>Widget&amp;&amp; &amp;&amp;</code> which collapses to <code>Widget&amp;&amp;</code>.</p>
</section>
<section id="stdforward" class="level4">
<h4 class="anchored" data-anchor-id="stdforward"><code>std::forward&lt;&gt;()</code></h4>
<p><code>std::forward&lt;&gt;()</code> conditionally casts its input into an <em>rvalue</em> reference.</p>
<ul>
<li>If the given input expression is an <em>lvalue</em>, it is cast to an <em>lvalue</em> reference.</li>
<li>If the given input expression is an <em>rvalue</em>, it is cast to an <em>rvalue</em> reference.</li>
</ul>
<p><code>std::forward</code> does not forward anything.</p>
<p>A really cool use-case of perfect forwarding is the <code>std::make_unique()</code> function. <code>std::make_unique&lt;T&gt;()</code> must invoke the underlying constructor. However, whilst doing so, it must preserve the const-ness and the value category of the arguments passed to the constructor.</p>
<p>Here is a quick code snippet:</p>
<div class="sourceCode" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb60-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Let's say that we would like to implement the make_unique()</span></span>
<span id="cb60-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// function that invokes the underlying constructor - either move</span></span>
<span id="cb60-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// or copy based on the arguments</span></span>
<span id="cb60-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;memory&gt;</span></span>
<span id="cb60-5"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb60-6"></span>
<span id="cb60-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb60-8">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb60-9">        X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){}</span></span>
<span id="cb60-10">        X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"copy c'tor</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;}</span></span>
<span id="cb60-11">        X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"move c'tor</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb60-12"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb60-13"></span>
<span id="cb60-14"></span>
<span id="cb60-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">template</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">typename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span> Args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb60-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>unique_ptr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> make_unique<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>Args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;...</span> args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">){</span></span>
<span id="cb60-17">    T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">ptr_t</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">new</span> T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>forward<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>Args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span>args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)...);</span></span>
<span id="cb60-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>unique_ptr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">ptr_t</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb60-19"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb60-20"></span>
<span id="cb60-21"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb60-22"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb60-23">    X x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{};</span></span>
<span id="cb60-24">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>unique_ptr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> x2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>make_unique<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span>x1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)};</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls X(const X&amp;)</span></span>
<span id="cb60-25">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>unique_ptr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> x3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>make_unique<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;(</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{})};</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//calls X(X&amp;&amp;)</span></span>
<span id="cb60-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb60-27"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>


<!-- -->

</section>
</section>
</section>

 ]]></description>
  <category>C++</category>
  <guid>https://quantdev.blog/posts/move-semantics/</guid>
  <pubDate>Fri, 25 Oct 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/move-semantics/cpp.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Concurrent programming - A Primer (Part I)</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/concurrent-programming-a-quick-primer-part-I/</link>
  <description><![CDATA[ 





<section id="basic-thread-management" class="level2">
<h2 class="anchored" data-anchor-id="basic-thread-management">Basic Thread Management</h2>
<p>A thread <code>std::thread</code> represents an executable unit. This executable unit, which the thread immediately starts, gets its work-package as a <em>callable unit</em>. A thread is not copy-constructible or copy-assignable, but move-constructible and move-assignable. A <em>callable unit</em> is any entity that behaves like a function, so this could be a function, a function pointer, a lambda function or <code>std::function</code> (function) object.</p>
<p>For example:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb1-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb1-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;thread&gt;</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> do_some_work<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Performing some work in a separate thread..."</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb1-10"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb1-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">main() thread"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-12">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>do_some_work<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Spawn a new thread</span></span>
<span id="cb1-13">    t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb1-14">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Exiting main() thread"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-16"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>stdout:</p>
<pre><code>main() thread
Performing some work in a separate thread...
Exiting main() thread</code></pre>
<p>Once you’ve started your thread, you need to explicitly decide whether to wait for it to finish(by joining with it) or leave it to run on its own (by detaching it). If you don’t decide before the <code>std::thread</code> object goes out of scope and is destroyed, then your program is terminated (the <code>std::thread</code> destructor calls <code>std::terminate()</code>). So, ensure that the thread is correctly joined or detached. You only have to make this decision before the <code>std::thread</code> object is destroyed - the thread itself may well have finished before you join with it or detach it, and if you detach it, then if the thread is still running, it will continue to do so, and may continue running long after the <code>std::thread</code> object is destroyed; it will only stop running when it finally returns from the thread function.</p>
<p>Passing arguments is easy. If the function signature is <code>void func(int arg1, std::vector&lt;double&gt; arg2, char arg3)</code>, you just specify the comma separated list in the <code>std::thread()</code> constructor, as <code>std::thread my_thread(func, arg1, arg2, arg3)</code>. This copies the value of the parameters <code>arg1</code>, <code>arg2</code> and <code>arg3</code> onto the thread stack. It’s a <em>pass-by-value</em>. To pass by reference, you <code>std::ref()</code> the arguments, so for example, if the function signature is <code>void func(int arg1, std::vector&lt;double&gt;&amp; arg2, char arg3)</code>, while spawning a new thread, you’d write <code>std::thread my_thread(func, arg1, std::ref(arg2), arg3)</code>.</p>
<p>If you don’t wait for the thread to finish in the <code>main()</code> thread, you need to ensure that the data accessed by the thread is valid until the thread is finished with it. This isn’t a new problem - even in single threaded code it’s undefined behavior to access an object after it’s been destroyed - but the use of threads provides another opportunity to encounter such lifetime issues.</p>
<p>One situation in which you can encounter such problems is when the thread function holds pointers or references to local variables and the thread hasn’t finished when the function exits.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb3-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb3-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;thread&gt;</span></span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> do_some_work<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb3-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">The value of i is = "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//Potential access to dangling reference</span></span>
<span id="cb3-7">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Incrementing the value of i"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-8">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">The new value of i = "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-10"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb3-13"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb3-14">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">main() thread"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-15">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb3-16">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread my_thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>do_some_work<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>ref<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">));</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Spawn a new thread</span></span>
<span id="cb3-17">    my_thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>detach<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// Don't wait for the thread to finish</span></span>
<span id="cb3-18">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Exiting main() thread"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//New thread might still be running</span></span>
<span id="cb3-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-20"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>stdout:</p>
<pre><code>main() thread
Exiting main() thread</code></pre>
<p>In this case, the new thread associated with <code>my_thread</code> is still running when <code>main()</code> exits, because you explicitly decided not to wait for it by calling <code>detach()</code>. If the thread is still running, the statements in <code>do_some_work(int&amp; )</code> will access an already destroyed variable <code>i</code>. This is like normal single-threaded code - allowing a pointer or reference to a local variable to persist beyond the function exit, which is never a good idea. But, it’s easier to make this mistake with multi-threaded code, because it isn’t immediately apparent that this has happened.</p>
<section id="waiting-for-a-thread-to-complete" class="level3">
<h3 class="anchored" data-anchor-id="waiting-for-a-thread-to-complete">Waiting for a thread to complete</h3>
<p>If you need to wait for a thread to complete, you do this by calling <code>join()</code> on the associated <code>std::thread</code> instance. In the previous listing, replacing the call to <code>my_thread.detach()</code> by <code>my_thread.join()</code> would therefore be sufficient to ensure that the thead was finished before the function was exited and thus before the local variables were destroyed. In real code, the original thread would either have work to do or would have launched several threads to do useful work before waiting for them to complete.</p>
<p><code>join()</code> is a simple and brute-force technique - either you wait for a thread to finish or you don’t. If you need more fine-grained control over waiting for a thread, such as to check whether a thread is finished, or wait only a certain period of time, then you have to use alternative mechanisms such as condition variables and futures.</p>
</section>
<section id="waiting-in-exceptional-circumstances" class="level3">
<h3 class="anchored" data-anchor-id="waiting-in-exceptional-circumstances">Waiting in exceptional circumstances</h3>
<p>You need to ensure that you’ve called either <code>join()</code> or <code>detach()</code> before a <code>std::thread</code> object is destroyed. If you’re detaching a thread, you can usually call <code>detach()</code> immediately after the thread has been started, so this isn’t a problem. But, if you’re intending to wait for a thread, you need to carefully pick the place in the code where you call <code>join()</code>. This means that the call to <code>join()</code> is liable to be skipped if an exception is thrown after the thread has been started but before the call to <code>join()</code>.</p>
<p>To avoid your application being terminated when an exception is thrown, you need to make a decision about what to do in this case. In general, if you were intending to call <code>join()</code> in a non-exceptional case, you also need to call <code>join()</code> in the presence of an exception to avoid accidental lifetime problems.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb5-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb5-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;thread&gt;</span></span>
<span id="cb5-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;stdexcept&gt;</span></span>
<span id="cb5-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;string&gt;</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb5-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-8">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb5-9"></span>
<span id="cb5-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">auto</span> my_func <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[&amp;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](){</span></span>
<span id="cb5-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;++</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-12">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-13">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-14">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb5-15">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">t's work package is complete."</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>flush<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-16"></span>
<span id="cb5-17">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb5-18"></span>
<span id="cb5-19">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"main thread"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>flush<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-20">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>my_func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb5-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span></span>
<span id="cb5-22">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-23">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"abc"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">).</span>substr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// throws std::out_of_range</span></span>
<span id="cb5-24">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb5-25">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">catch</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>exception<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> e<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-26">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-27">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> e<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>what<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb5-28">        t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb5-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">throw</span> e<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// copy-initializes a new exception object of type std::exception</span></span>
<span id="cb5-30">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb5-31"></span>
<span id="cb5-32">    t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb5-33">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-34"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>stdout:</p>
<pre><code>main thread
invalid string position
t's work package is complete.</code></pre>
<p>The code in the listing above uses <code>try/catch</code> block to ensure that a thread with access to the local state is finished before the main thread exits normally, or by an exception.</p>
<p>A more structured way of doing is to use the standard Resource Aquisition is Initialization(RAII) idiom and provide a wrapper class that does the <code>join()</code> in its destructor, as in the following listing:</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//thread_guard.cpp</span></span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb7-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;thread&gt;</span></span>
<span id="cb7-5"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;stdexcept&gt;</span></span>
<span id="cb7-6"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;string&gt;</span></span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> thread_guard</span>
<span id="cb7-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">private</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">m_t</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-12"></span>
<span id="cb7-13">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb7-14">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">explicit</span> thread_guard<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">m_t</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{}</span></span>
<span id="cb7-15">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>thread_guard<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb7-16">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">m_t</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>joinable<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()){</span></span>
<span id="cb7-18">            <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">m_t</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb7-19">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-20">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-21"></span>
<span id="cb7-22">    thread_guard<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> thread_guard<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> _tg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-23">    thread_guard<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span>thread_guard<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> _tg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-24"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb7-25"></span>
<span id="cb7-26"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb7-27"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-28">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb7-29"></span>
<span id="cb7-30">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">auto</span> my_func <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[&amp;</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](){</span></span>
<span id="cb7-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;++</span>j<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-32">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-33">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-34">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-35">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">t's work package is complete."</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>flush<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-36"></span>
<span id="cb7-37">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb7-38"></span>
<span id="cb7-39">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"main thread"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>flush<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-40">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>my_func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb7-41">    thread_guard g<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb7-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span></span>
<span id="cb7-43">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-44">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"abc"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">).</span>substr<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// throws std::out_of_range</span></span>
<span id="cb7-45">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-46">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">catch</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>exception<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> e<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-47">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb7-48">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> e<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>what<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb7-49">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">throw</span> e<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">// copy-initializes a new exception object of type std::exception</span></span>
<span id="cb7-50">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb7-51"></span>
<span id="cb7-52">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-53"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>When the execution of the main thread reaches the end, the local objects are destroyed in the reverse order of their construction. Consequently, the <code>thread_guard</code> object id object <code>g</code> is destroyed first, and the thread is joined with, which is a blocking call in the destructor. This happens even if there is an exception in the main thread.</p>
<p>The copy constructor and copy-assignment operators are marked <code>=delete</code> to ensure that they’re not automatically provided by the compiler. Copying or assigning such an object would be dangerous, because it might outlive the scope of the thread it was joining. By declaring them as as deleted, any attempt to copy a <code>thread_guard</code> object will generate a compilation error.</p>
<p>If you don’t need to wait for a thread to finish, you can avoid this exception-safety by detaching from it. This breaks the association of the thread with the <code>std::thread</code> object and ensures that <code>std::terminate()</code> won’t be called when the <code>std::thread</code> object is destroyed, even though the thread is still running in the background. Note that, the <code>std::thread</code> destructor checks if the thread is joinable, and if this condition is true, it invokes <code>std::terminate</code>.</p>
</section>
<section id="running-threads-in-background" class="level3">
<h3 class="anchored" data-anchor-id="running-threads-in-background">Running threads in background</h3>
<p>Calling <code>detach()</code> on a <code>std::thread</code> object leaves the thread to run in the background with no direct means of communicating with it. It’s no longer possible to wait for that thread to complete; if a thread becomes detached, it isn’t possible to obtain a <code>std::thread</code> object that references it, so it can no longer be joined. Detached threads truly run in the background; ownership and control are passed over to the C++ runtime library, which ensures that the resources associated with the thread are correctly reclaimed when the thread exits.</p>
<p>Detached threads are often called <em>daemon threads</em> after the UNIX concept of a <em>daemon process</em> that runs in the background without any explicit user interface. Such threads are typically long-running; they run for almost the entire lifetime of the application, performing a background task such as monitoring the filesystem, clearing unused entries out of object caches, or optimizing data-structures. At the other extreme, it may make sense to use a detached thread where there’s another mechanism for identifying when the thread has completed or where the thread is used for a fire-and-forget task.</p>
<p>As we’ve seen earlier, we detach a thread by calling <code>detach()</code> member function of the <code>std::thread</code> object. After the call completes, the <code>std::thread</code> object is no longer associated with the actual thread of execution and is therefore no longer joinable.</p>
<p>In order to detach the thread from a <code>std::thread</code> object, there must be a thread to detach: you can’t call <code>detach()</code> on a <code>std::thread</code> object with no associated thread of execution. This is exactly the same requirement for <code>join()</code>, and you can check it in the same way - you can call <code>t.detach()</code> for a <code>std::thread</code> object <code>t</code> when <code>t.joinable()</code> returns <code>true</code>.</p>
<p>Consider an application such as a word-processor that can edit multiple documents at once. There are many ways to handle this, both at the UI level and internally. One way that’s increasingly common at the moment is to have multiple, independent, top-level windows, one for each document being edited. Although these windows appear to be completely independent, each with its own menus, they’re running within the same instance of the application. One way to handle this internally is to run each document-editing window in its own thread; each thread runs the same code but with different data relating to the document being edited. Opening a new document therefore requires starting a new thread. The thread handling the request isn’t going to care about waiting for that other thread to finish, because it’s working on an unrelated document, so this makes it a prime candidate for running a detached thread.</p>
</section>
<section id="passing-arguments-to-a-thread-function" class="level3">
<h3 class="anchored" data-anchor-id="passing-arguments-to-a-thread-function">Passing arguments to a thread function</h3>
<p>Passing arguments to the callable object or function is fundamentally as simple as passing additional arguments to the <code>std::thread</code> constructor. But, its important to bear in mind that the arguments are copied into internal storage, where they can be accessed by the newly created thread of execution and then passed to the callable function or object as <code>rvalue</code>s as if they were temporaries.</p>
<p>Therefore, if you want to pass an object’s member function as a work-package to a thread, you pass the member-function pointer as the function, and an object pointer as the first argument:</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb8-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;thread&gt;</span></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb8-4">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span> do_lengthy_work<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb8-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb8-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb8-9">    X x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb8-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(&amp;</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>do_length_work<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb8-11">    t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb8-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb8-13"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p>You can also supply arguments to such a member-function call: the third argument to the <code>std::thread</code> constructor will be the first argument to the function, and so forth. <code>std::thread</code> is a variadic template.</p>
<p>Another interesting scenario for supplying arguments is where the arguments cannot be copied but can only be moved: the data held within one object is transferred over to another, leaving the original object empty. An example of such a type is <code>std::unique_ptr&lt;T&gt;</code>, which provides automatic memory management for dynamically allocated objects. Only one <code>std::unique_ptr&lt;T&gt;</code> instance can point to a given object at a time, and when that instance is destroyed, the pointed-to-object is also deleted. The <em>move constructor</em> and the <em>move assignment</em> operator allow the ownership of an object to be transferred around between <code>std::unique_ptr&lt;T&gt;</code> instances. Such a transfer leaves the source object with a <code>nullptr</code>. This moving of values allows objects of this type to be accepted as function parameters or returned from functions. When the source object is temporary, the move is automatic, but where the source is a named value, the transfer must be requested directly by invoking <code>std::move()</code>.</p>
<p>Several of the classes in the C++ standard library exhibit the same ownership semantics as <code>std::unique_ptr&lt;T&gt;</code>, and <code>std::thread</code> is one of them. Though <code>std::thread</code> instances don’t own a dynamic object in the same way as the <code>std::unique_ptr&lt;T&gt;</code> does, they do own a resource: each instance is responsible for managing a thread of execution. This ownership can be transferred between instances, because instances of <code>std::thread</code> are moveable, even though they aren’t copyable. This ensures, that only one object is associated with a particular thread of execution at any time while allowing programmers the option of transferring ownership between objects.</p>
</section>
</section>
<section id="transferring-the-ownership-of-a-thread" class="level2">
<h2 class="anchored" data-anchor-id="transferring-the-ownership-of-a-thread">Transferring the ownership of a thread</h2>
<p>Suppose you want to write a function that creates a thread to run in the background, but passes ownership of the new thread back to the calling function rather than waiting for it to complete; or maybe you want to do the reverse: create a thread and pass the ownership in to some function that should wait for it to complete. In either case, you need to transfer the ownership from one place to another.</p>
<p>This is where the move support of <code>std::thread</code> comes in. Many resource-owing types in the C++ standard library, such as <code>std::ifstream</code> and <code>std::unique_ptr&lt;T&gt;</code> are movable but not copyable, and <code>std::thread</code> is one of them. This means that the ownership of a particular thread of execution can be moved between <code>std::thread</code> instances, as in the following example. The example shows the creation of two threads of execution and the transfer of ownership of those threads among three <code>std::thread</code> instances <code>t1</code>, <code>t2</code> and <code>t3</code>:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb9-1"></span>
<span id="cb9-2"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;thread&gt;</span></span>
<span id="cb9-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> some_function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb9-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Some function"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb9-8"></span>
<span id="cb9-9"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">void</span> some_other_function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb9-10"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb9-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Some other function"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-12"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb9-13"></span>
<span id="cb9-14"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb9-15"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb9-16">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>some_function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb9-17">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>t1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb9-18">    t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>some_other_function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb9-19">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb9-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//t1 = std::move(t3)    //this assignment will terminate the program</span></span>
<span id="cb9-21">    t1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb9-22">    t3<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb9-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-24"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><a href="https://godbolt.org/z/fdrq5YTnP" target="_blank">Compiler Explorer</a></p>
<p>stdout:</p>
<pre><code>Some other function
Some function</code></pre>
<p>First, a new thread is started and associated with <code>t1</code>. Ownership is then transferred over to <code>t2</code> when <code>t2</code> is constructed by invoking <code>std::move()</code> to explicitly move ownership. At this point, <code>t1</code> no longer has an associated thread of execution; the thread running <code>some_function</code> is now associated with <code>t2</code>.</p>
<p>Then, a new thread is started with a temporary <code>std::thread</code> object. The subsequent transfer of ownership into <code>t1</code> doesn’t require a call to <code>std::move()</code> to explicitly move ownership, because the owner is a temporary object - moving from temporaries is automatic and implicit.</p>
<p>After all these moves, <code>t1</code> is associated with the thread running <code>some_other_function</code> and <code>t3</code> is associated with the thread running <code>some_function</code>.</p>
<p>The commented line transfers the ownership of the thread running <code>some_function</code> back to <code>t1</code>, where it started. But, in this case <code>t1</code> already had an associated thread (which was running <code>some_other_function</code>) that is joinable, so <code>std::terminate()</code> will be called in this move assignment. This is done for consistency with the <code>std::thread</code> destructor.</p>
<p>The move support in <code>std::thread</code> means that ownership can be readily transferred out of a function.</p>
<section id="lifetime-issues-of-threads" class="level3">
<h3 class="anchored" data-anchor-id="lifetime-issues-of-threads">Lifetime issues of threads</h3>
<p>Let’s look at an example of the erroneous moving of threads.</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//threadMoved.cpp</span></span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb11-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;thread&gt;</span></span>
<span id="cb11-5"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;utility&gt;</span></span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb11-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb11-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">([](){</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>this_thread::get_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();});</span></span>
<span id="cb11-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">([](){</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>this_thread::get_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();});</span></span>
<span id="cb11-11">    t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb11-12">    t1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb11-13">    t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb11-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-15"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><a href="https://godbolt.org/z/WeTndM81s" target="_blank">Compiler Explorer</a></p>
<p>Both threads <code>t1</code> and <code>t2</code> are meant to do their simple job : printing their IDs. In addition to that, thread <code>t2</code> is moved to <code>t1</code>. In the main thread takes care of its children and waits for them. But, the result is very different from my expectations:</p>
<p>stdout:</p>
<pre><code>terminate called without an active exception
Program terminated with signal: SIGSEGV</code></pre>
<p>What is going wrong? We have two issues:</p>
<ol type="1">
<li>By moving the thread <code>t2</code>, <code>t1</code> gets a new work package and its move assignment operator calls the destructor to free up any resources it holds. As a result, <code>t1</code>’s destructor calls <code>std::terminate</code>, because it is still joinable.</li>
<li>Thread <code>t2</code> has no associated callable unit. The invocation of join on a thread without a callable unit leads to the exception <code>std::system_error</code>.</li>
</ol>
<p>Knowing this fixing errors is straightforward:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//threadMoveFixed.cpp</span></span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;iostream&gt;</span></span>
<span id="cb13-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;thread&gt;</span></span>
<span id="cb13-5"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include</span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;utility&gt;</span></span>
<span id="cb13-6"></span>
<span id="cb13-7"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb13-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb13-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">([](){</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Thread id="</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>this_thread::get_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();});</span></span>
<span id="cb13-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">([](){</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Thread id="</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>this_thread::get_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();});</span></span>
<span id="cb13-11">    t1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb13-12">    t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb13-13">    t1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb13-14"></span>
<span id="cb13-15">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-16">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>cout <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>boolalpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t2.joinable() = "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;</span> t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>joinable<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb13-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-18"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><a href="https://godbolt.org/z/f44Mfdf3r" target="_blank">Compiler Explorer</a></p>
</section>
<section id="scoped_thread-by-anthony-williams" class="level3">
<h3 class="anchored" data-anchor-id="scoped_thread-by-anthony-williams"><code>scoped_thread</code> by Anthony Williams</h3>
<p>One benefit of the move support of <code>std::thread</code> is that you can build on the <code>thread_guard</code> class and have it take ownership of the thread. Anthony Williams in his excellent book <em>Concurrency in action</em> has written a <code>scoped_thread</code> class. This avoids any unpleasant consequences should the <code>thread_guard</code> object outlive the thread it was referencing, and it also means that no one else can join or detach the thread once ownership has been transferred into the object. Because, this would primarily be aimed at ensuring that threads are completed before a scope is exited, it’s called <code>scoped_thread</code>. Here is the implementation:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode cpp code-with-copy"><code class="sourceCode cpp"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//scoped_thread.cpp</span></span>
<span id="cb14-2"></span>
<span id="cb14-3"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;thread&gt;</span></span>
<span id="cb14-4"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;utility&gt;</span></span>
<span id="cb14-5"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">#include </span><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">&lt;stdexcept&gt;</span></span>
<span id="cb14-6"></span>
<span id="cb14-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> scoped_thread</span>
<span id="cb14-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb14-9">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">private</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-11">    </span>
<span id="cb14-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">public</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-13">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">explicit</span> scoped_thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>move<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">))</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb14-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(!</span>t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>joinable<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">())</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">throw</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>logic_error<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No thread"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);</span></span>
<span id="cb14-15">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb14-16"></span>
<span id="cb14-17">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>scoped_thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(){</span></span>
<span id="cb14-18">        t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">();</span></span>
<span id="cb14-19">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb14-20"></span>
<span id="cb14-21">    scoped_thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span>scoped_thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-22">    scoped_thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">operator</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=(</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">const</span> scoped_thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;)</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">delete</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-23"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span></span>
<span id="cb14-24"></span>
<span id="cb14-25"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> main<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">()</span></span>
<span id="cb14-26"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb14-27">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb14-28">        scoped_thread t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">std::</span>thread<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">([]{</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">(</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">};</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;++</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">);}));</span></span>
<span id="cb14-29">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb14-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-31"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
<p><a href="https://godbolt.org/z/Yfsahhddx" target="_blank">Compiler Explorer</a></p>
<p>This example is similar to <code>thread_guard.cpp</code>, but the new thread is passed into the <code>scoped_thread</code> rather than having to create a separate named variable for it. When the main thread reaches its end, the <code>scoped_thread</code> object is destroyed and then joins the thread supplied to the constructor. Whereas with the <code>thread_guard</code> class, the destructor had to check that the thread was still joinable, you can do that in the constructor and throw an exception if it’s not.</p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>C++</category>
  <guid>https://quantdev.blog/posts/concurrent-programming-a-quick-primer-part-I/</guid>
  <pubDate>Fri, 27 Sep 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/concurrent-programming-a-quick-primer-part-I/cpp.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Norms</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/norms/</link>
  <description><![CDATA[ 





<section id="inner-product" class="level2">
<h2 class="anchored" data-anchor-id="inner-product">Inner product</h2>
<p>Consider geometric vectors <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D,%20%5Cmathbf%7By%7D%20%5Cin%20%5Cmathbf%7BR%7D%5E2">. The scalar product(dot-product) of these two vectors is defined by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbf%7Bx%7D%20%5Ccdot%20%5Cmathbf%7By%7D%20=%20x_1%20y_1%20+%20x_2%20y_2%0A"></p>
<p>An inner-product is a mathematical generalization of the dot-product.</p>
<div class="hidden">
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnewcommand%7B%5Cnorm%7D%5B1%5D%7B%5Cleft%5ClVert#1%5Cright%5CrVert%7D%0A%5Cnewcommand%7B%5Cnormp%7D%5B2%5D%7B%5Cleft%5ClVert%5Cmathbf%7B#1%7D%5Cright%5CrVert_%7B#2%7D%7D%0A%5Cnewcommand%5Cinner%5B2%5D%7B%5Cleft%5Clangle%20#1,%20#2%20%5Cright%5Crangle%7D%0A%5Cnewcommand%7B%5Cbf%7D%5B1%5D%7B%5Cmathbf%7B#1%7D%7D%0A%5Cnewcommand%7B%5CR%7D%7B%5Cmathbf%7BR%7D%7D%0A%5Cnewcommand%7B%5CRR%7D%5B1%5D%7B%5Cmathbf%7BR%7D%5E2%7D%0A%5Cnewcommand%7B%5CRRR%7D%5B1%5D%7B%5Cmathbf%7BR%7D%5E3%7D%0A%5Cnewcommand%7B%5CC%7D%7B%5Cmathbf%7BC%7D%7D%0A%5Cnewcommand%7B%5CCC%7D%5B1%5D%7B%5Cmathbf%7BC%7D%5E2%7D%0A%5Cnewcommand%7B%5CCCC%7D%5B1%5D%7B%5Cmathbf%7BC%7D%5E3%7D%0A"></p>
</div>
<div id="def-inner-product" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Inner product)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?V"> be a vector space and <img src="https://latex.codecogs.com/png.latex?F"> be a scalar field, which is either <img src="https://latex.codecogs.com/png.latex?%5Cbf%7BR%7D"> or <img src="https://latex.codecogs.com/png.latex?%5Cbf%7BC%7D">. Let <img src="https://latex.codecogs.com/png.latex?%5Cinner%7B%5Ccdot%7D%7B%5Ccdot%7D"> be a map from <img src="https://latex.codecogs.com/png.latex?V%5Ctimes%20V%20%5Cto%20F">. Then, <img src="https://latex.codecogs.com/png.latex?%5Cinner%7B%5Ccdot%7D%7B%5Ccdot%7D"> is an inner product if for all <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bu%7D,%5Cbf%7Bv%7D,%20%5Cbf%7Bw%7D%20%5Cin%20V">, it satisfies:</p>
<section id="positive-semi-definite" class="level4">
<h4 class="anchored" data-anchor-id="positive-semi-definite">Positive semi-definite</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%20%5Cgeq%200%20%5Cquad%20%5Ctext%20%7B%20and%20%7D%20%5Cquad%20%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%20=%200%20%5CLongleftrightarrow%20%5Cbf%7Bv%7D%20=%20%5Cbf%7B0%7D%0A"></p>
</section>
<section id="additivity-in-the-first-slot" class="level4">
<h4 class="anchored" data-anchor-id="additivity-in-the-first-slot">Additivity in the first slot</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cinner%7B%5Cbf%7Bu%7D%20+%20%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bw%7D%7D%20=%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bw%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bw%7D%7D%0A"></p>
</section>
<section id="homogeneity" class="level4">
<h4 class="anchored" data-anchor-id="homogeneity">Homogeneity</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cinner%7B%5Calpha%20%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bw%7D%7D%20&amp;=%20%5Coverline%7B%5Calpha%7D%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bw%7D%7D%5C%5C%0A%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Calpha%20%5Cbf%7Bw%7D%7D%20&amp;=%20%5Calpha%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bw%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
</section>
<section id="conjugate-symmetry" class="level4">
<h4 class="anchored" data-anchor-id="conjugate-symmetry">Conjugate symmetry</h4>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bw%7D%7D%20=%20%5Coverline%7B%5Cinner%7B%5Cbf%7Bw%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%0A"></p>
</section>
</div>
<p>The most important example of inner-product is the Euclidean inner product on <img src="https://latex.codecogs.com/png.latex?%5CC%5En">. Let <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bw%7D,%5Cbf%7Bz%7D"> be (column) vectors in <img src="https://latex.codecogs.com/png.latex?%5CC%5En">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cinner%7B%5Cbf%7Bw%7D%7D%7B%5Cbf%7Bz%7D%7D%20=%20(%5Cbf%7Bw%7D%5EH%20%5Cbf%7Bz%7D)%20=%20%20%5Coverline%7Bw_1%7Dz_1%20+%20%5Coverline%7Bw_2%7Dz_2%20+%20%5Cldots%20+%20%5Coverline%7Bw_n%7D%20z_n%0A"></p>
<p>Firstly,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cinner%7B%5Cbf%7Bv%7D%20+%20%5Cbf%7Bw%7D%7D%7B%5Cbf%7Bz%7D%7D%20&amp;=%20(%5Cbf%7Bv%7D%20+%20%5Cbf%7Bw%7D)%5EH%20%5Cbf%7Bz%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;=%20(%5Cbf%7Bv%7D%5EH%20+%20%5Cbf%7Bw%7D%5EH)%5Cbf%7Bz%7D%20&amp;%20%5C%7B%20%5Coverline%7Bz_1%20+%20z_2%7D%20=%20%5Coverline%7Bz_1%7D%20+%20%5Coverline%7Bz_2%7D;%20z_1,z_2%5Cin%20%5CC%20%5C%7D%5C%5C%0A&amp;=%20%5Cbf%7Bv%7D%5EH%20%5Cbf%7Bz%7D%20+%20%5Cbf%7Bw%7D%5EH%20%5Cbf%7Bz%7D%5C%5C%0A&amp;=%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bz%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bw%7D%7D%7B%5Cbf%7Bz%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>So, it is additive in the first slot.</p>
<p>Next, let <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cin%20%5CC">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cinner%7B%5Calpha%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%20&amp;=%20(%5Calpha%20%5Cbf%7Bu%7D)%5EH%20%5Cbf%7Bv%7D%20%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Coverline%7B%5Calpha%7D%20%5Cbf%7Bu%7D%5EH%20%5Cbf%7Bv%7D%20=%20%5Coverline%7B%5Calpha%7D%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Calpha%5Cbf%7Bv%7D%7D%20&amp;=%20(%5Cbf%7Bu%7D)%5EH%20%5Cbf%7B%20%5Calpha%20v%7D%20%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Calpha%20%5Cbf%7Bu%7D%5EH%20%5Cbf%7Bv%7D%20=%20%5Calpha%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>It is homogenous.</p>
<p>Finally,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bw%7D%7D%20&amp;=%20%5Csum_%7Bi=1%7D%5En%20%5Coverline%7Bv_i%7Dw_i%5C%5C%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%5Coverline%7Bv_i%20%5Coverline%7Bw_i%7D%7D%5C%5C%0A&amp;=%20%5Coverline%7B%5Cleft(%5Csum_%7Bi=1%7D%5En%20%5Coverline%7Bw_i%7D%20v_i%5Cright)%7D%5C%5C%0A&amp;=%20%5Coverline%7B%5Cinner%7B%5Cbf%7Bw%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
</section>
<section id="norms" class="level2">
<h2 class="anchored" data-anchor-id="norms">Norms</h2>
<p>Very often, to quantify errors or measure distances one needs to compute the magnitude(length) of a vector or a matrix. Norms are a mathematical generalization(abstraction) for length.</p>
<div id="def-vector-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 (Vector norm)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?%5Cnu:V%20%5Cto%20%5Cmathbf%7BR%7D">. Then, <img src="https://latex.codecogs.com/png.latex?%5Cnu"> is a (vector) norm if for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D,%5Cmathbf%7By%7D%5Cin%20V"> and for all <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cin%20%5Cmathbf%7BC%7D">, <img src="https://latex.codecogs.com/png.latex?%5Cnu(%5Ccdot)"> satisfies:</p>
<section id="positive-semi-definiteness" class="level4">
<h4 class="anchored" data-anchor-id="positive-semi-definiteness">Positive Semi-Definiteness</h4>
<p><img src="https://latex.codecogs.com/png.latex?%5Cnu(%5Cmathbf%7Bx%7D)%20%5Cgeq%200,%20%5Cquad%20%5Cforall%20%5Cbf%7Bx%7D%5Cin%20V"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cnu(%5Cmathbf%7Bx%7D)=0%20%5CLongleftrightarrow%20%5Cmathbf%7Bx%7D=%5Cmathbf%7B0%7D"></p>
</section>
<section id="homogeneity-1" class="level4">
<h4 class="anchored" data-anchor-id="homogeneity-1">Homogeneity</h4>
<p><img src="https://latex.codecogs.com/png.latex?%5Cnu(%5Calpha%20%5Cmathbf%7Bx%7D)%20=%20%7C%5Calpha%7C%5Cnu(%5Cmathbf%7Bx%7D)"></p>
</section>
<section id="triangle-inequality" class="level4">
<h4 class="anchored" data-anchor-id="triangle-inequality">Triangle inequality</h4>
<p><img src="https://latex.codecogs.com/png.latex?%5Cnu(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7By%7D)%20%5Cleq%20%5Cnu(%5Cmathbf%7Bx%7D)%20+%20%5Cnu(%5Cmathbf%7By%7D)"></p>
</section>
</div>
<section id="the-vector-2-norm" class="level3">
<h3 class="anchored" data-anchor-id="the-vector-2-norm">The vector <img src="https://latex.codecogs.com/png.latex?2-">norm</h3>
<p>The length of a vector is most commonly measured by the <em>square root of the sum of the squares of the components of the vector</em>, also known as the <em>euclidean norm</em>.</p>
<div id="def-euclidean-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3 (Vector <img src="https://latex.codecogs.com/png.latex?2-">norm)</strong></span> The vector <img src="https://latex.codecogs.com/png.latex?2-"> norm, <img src="https://latex.codecogs.com/png.latex?%7C%7C%5Ccdot%7C%7C:%5Cmathbf%7BC%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> is defined for <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%5Cin%5Cmathbf%7BC%7D%5En"> by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Csqrt%7B%7C%5Cchi_1%7C%5E2%20+%20%7C%5Cchi_2%7C%5E2%20+%20%7C%5Cchi_n%7C%5E2%7D%20=%20%5Csqrt%7B%5Csum_%7Bi=1%7D%5En%20%7C%5Cchi_i%5E2%7C%7D%0A"></p>
<p>Equivalently, it can be defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Csqrt%7B%5Cinner%7B%5Cbf%7Bx%7D%7D%7B%5Cbf%7Bx%7D%7D%7D%20=%20%20(%5Cbf%7Bx%7D%5EH%20%5Cbf%7Bx%7D)%5E%7B1/2%7D%20=%20%5Csqrt%7B%5Coverline%7B%5Cchi_1%7D%5Cchi_1%20+%5Coverline%7B%5Cchi_2%7D%5Cchi_2+%5Cldots+%5Coverline%7B%5Cchi_n%7D%5Cchi_n%7D%0A"></p>
</div>
<p>To prove that the vector <img src="https://latex.codecogs.com/png.latex?2-">norm is indeed a valid norm(just calling it a norm, doesn’t mean it is, after all), we need a result known as the Cauchy-Schwarz inequality. This inequality relates the magnitude of the dot-product(inner-product) of two vectors to the product of their two norms : if <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D,%5Cbf%7By%7D%20%5Cin%20%5CR%5En">, then <img src="https://latex.codecogs.com/png.latex?%7C%5Cbf%7Bx%7D%5ET%20%5Cbf%7By%7D%7C%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%5Ccdot%5Cnorm%7B%5Cbf%7By%7D%7D_2">.</p>
<p>Before we rigorously prove this result, let’s review the idea of orthogonality.</p>
<div id="def-orthogonal-vectors" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4 (Orthogonal vectors)</strong></span> Two vectors <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bu%7D,%5Cbf%7Bv%7D%20%5Cin%20V"> are said to be orthogonal to each other if and only if their inner product equals zero:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%20=%200%0A"></p>
</div>
<div id="thm-pythagorean-theorem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Pythagorean Theorem)</strong></span> If <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bu%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D"> are orthogonal vectors, then</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cinner%7B%5Cbf%7Bu%7D%20+%20%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bu%7D%20+%20%5Cbf%7Bv%7D%7D%20=%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bu%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%0A"></p>
</div>
<p><em>Proof.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cinner%7B%5Cbf%7Bu%7D%20+%20%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bu%7D+%5Cbf%7Bv%7D%7D%20&amp;=%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bu%7D%20+%20%5Cbf%7Bv%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bu%7D%20+%20%5Cbf%7Bv%7D%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Additivity%20in%20the%20first%20slot%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Coverline%7B%5Cinner%7B%5Cbf%7Bu%7D%20+%20%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bu%7D%7D%7D%20+%20%5Coverline%7B%5Cinner%7B%5Cbf%7Bu%7D%20+%20%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Conjugate%20symmetry%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Coverline%7B%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bu%7D%7D%7D%20+%20%5Coverline%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bu%7D%7D%7D%20+%20%5Coverline%7B%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%20+%20%5Coverline%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%20%5C%5C%0A&amp;=%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bu%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bu%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%20%5C%5C%0A&amp;=%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bu%7D%7D%20+%200%20+%200%20+%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%20&amp;%20%5C%7B%20%5Cbf%7Bu%7D%20%5Cperp%20%5Cbf%7Bv%7D%5C%7D%5C%5C%0A&amp;=%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bu%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<p>In the special case that <img src="https://latex.codecogs.com/png.latex?V=%5CC%5En"> or <img src="https://latex.codecogs.com/png.latex?V=%5CR%5En">, the pythagorean theorem reduces to:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7Bu%7D%20+%20%5Cbf%7Bv%7D%7D_2%5E2%20=%20%5Cnorm%7B%5Cbf%7Bu%7D%7D_2%5E2%20+%20%5Cnorm%7B%5Cbf%7Bv%7D%7D_2%5E2%0A"></p>
</section>
</section>
<section id="cauchy-schwarz-inequality" class="level2">
<h2 class="anchored" data-anchor-id="cauchy-schwarz-inequality">Cauchy-Schwarz Inequality</h2>
<p>Suppose <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bu%7D,%5Cbf%7Bv%7D%5Cin%20V">. We would like to write <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bu%7D"> as a scalar multiple of <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D"> plus a vector <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bw%7D"> orthogonal to <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D">, as suggested in the picture below. Intuitively, we would like to write an orthogonal decomposition of <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bu%7D">.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>load_ext itikz</span></code></pre></div>
</div>
<div class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows,arrows.meta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb2-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>]</span>
<span id="cb2-3">    \draw [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>{Stealth[length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>]}](<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-4">    \draw [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>{Stealth[length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>]}] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-5">    \node []  at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.25</span>) {\large $\mathbf{u}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-6">    \draw [dashed] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-7">    \node [circle,fill,minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>] at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-8">    \node []  at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.40</span>) {\large $\mathbf{v}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-9">    \node []  at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.40</span>) {\large $\alpha\mathbf{v}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-10">    \node []  at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>) {\large $\mathbf{w}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-11">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/norms/index_files/figure-html/cell-3-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To discover how to write <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bu%7D"> as a scalar multiple of <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D"> plus a vector orthogonal to <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D">, let <img src="https://latex.codecogs.com/png.latex?%5Calpha"> denote a scalar. Then,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbf%7Bu%7D%20=%20%5Calpha%20%5Cbf%7Bv%7D%20+%20(%5Cbf%7Bu%7D%20-%20%5Calpha%20%5Cbf%7Bv%7D)%0A"></p>
<p>Thus, we need to choose <img src="https://latex.codecogs.com/png.latex?%5Calpha"> so that <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bw%7D%20=%20%5Cbf%7Bu%7D%20-%20%5Calpha%7Bv%7D"> are mutually orthogonal. Thus, we must set:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cinner%7B%5Cbf%7Bu%7D%20-%20%5Calpha%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%20=%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%20-%20%5Calpha%20%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%20=%200%0A"></p>
<p>The equation above shows that we choose <img src="https://latex.codecogs.com/png.latex?%5Calpha"> to be <img src="https://latex.codecogs.com/png.latex?%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D/%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D"> (assume that <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D%20%5Cneq%20%5Cbf%7B0%7D"> to avoid division by 0). Making this choice of <img src="https://latex.codecogs.com/png.latex?%5Calpha">, we can write:</p>
<p><span id="eq-orthogonal-decomposition"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbf%7Bu%7D%20=%20%5Cfrac%7B%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%5Cbf%7Bv%7D%20+%20%5Cleft(%5Cbf%7Bu%7D%20-%20%5Cfrac%7B%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%5Cbf%7Bv%7D%5Cright)%0A%5Ctag%7B1%7D"></span></p>
<p>The equation above will be used in the proof the Cauchy-Schwarz inequality, one of the most important inequalities in mathematics</p>
<div id="thm-cauchy-schwarz-inequality" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Cauchy-Schwarz Inequality)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D,%5Cbf%7By%7D%5Cin%20V">. Then</p>
<p><span id="eq-cauchy-schwarz-inequality"><img src="https://latex.codecogs.com/png.latex?%0A%7C%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7C%5E2%20%5Cleq%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bu%7D%7D%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%0A%5Ctag%7B2%7D"></span></p>
</div>
<p><em>Proof.</em></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bu%7D,%5Cbf%7Bv%7D%20%5Cin%20V">. If <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D%20=%20%5Cbf%7B0%7D">, then both sides of Equation&nbsp;2 equal <img src="https://latex.codecogs.com/png.latex?0"> and the inequality holds. Thus, we assume that <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D%5Cneq%20%5Cbf%7B0%7D">. Consider the orthogonal decomposition:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbf%7Bu%7D%20=%20%5Cfrac%7B%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%20%5Cbf%7Bv%7D%20+%20%5Cbf%7Bw%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bw%7D"> is orthogonal to <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D"> (<img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bw%7D"> is taken to be the second term on the right hand side of Equation&nbsp;1). By the Pythagorean theorem:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bu%7D%7D%20&amp;=%20%5Cinner%7B%5Cfrac%7B%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%20%5Cbf%7Bv%7D%7D%7B%5Cfrac%7B%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%20%5Cbf%7Bv%7D%7D+%5Cinner%7B%5Cbf%7Bw%7D%7D%7B%5Cbf%7Bw%7D%7D%5C%5C%0A&amp;=%20%5Coverline%7B%5Cleft(%5Cfrac%7B%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%5Cright)%7D%5Cleft(%5Cfrac%7B%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%5Cright)%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bw%7D%7D%7B%5Cbf%7Bw%7D%7D%5C%5C%0A&amp;=%20%5Cfrac%7B%5Coverline%7B%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%7B%5Coverline%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bw%7D%7D%7B%5Cbf%7Bw%7D%7D%5C%5C%0A&amp;=%20%5Cfrac%7B%7C%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7C%5E2%7D%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%20+%20%5Cinner%7B%5Cbf%7Bw%7D%7D%7B%5Cbf%7Bw%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?%5Cinner%7B%5Cbf%7Bw%7D%7D%7B%5Cbf%7Bw%7D%7D%20%5Cgeq%200">, it follows that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bu%7D%7D%20%5Cgeq%20%5Cfrac%7B%7C%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7C%5E2%7D%7B%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%7D%0A"></p>
<p>Consequently, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7C%5E2%20%5Cleq%20%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bu%7D%7D%5Cinner%7B%5Cbf%7Bv%7D%7D%7B%5Cbf%7Bv%7D%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<p>In the special case, that <img src="https://latex.codecogs.com/png.latex?V=%5CR%5En"> or <img src="https://latex.codecogs.com/png.latex?V=%5CC%5En">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%5Cinner%7B%5Cbf%7Bu%7D%7D%7B%5Cbf%7Bv%7D%7D%7C%20%5Cleq%20%5Cnorm%7B%5Cbf%7Bu%7D%7D_2%20%5Cnorm%7B%5Cbf%7Bv%7D%7D_2%0A"></p>
</section>
<section id="euclidean-norm" class="level2">
<h2 class="anchored" data-anchor-id="euclidean-norm">Euclidean Norm</h2>
<div id="prp-euclidean-norm-is-well-defined" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1 (Well-definedness of the Euclidean norm)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D:%5Cmathbf%7BC%7D%5En%20%5Cto%20%5Cmathbf%7BC%7D"> be the euclidean norm. Our claim is, it is well-defined.</p>
</div>
<p><em>Proof.</em></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bz%7D%20=%20(z_1,z_2,%5Cldots,z_n)%20%5Cin%20%5CC%5En">. Clearly, it is positive semi-definite.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7Bz%7D%7D_2%20=%20%5Cbf%7Bz%7D%5EH%20%5Cbf%7Bz%7D%20&amp;=%20%5Coverline%7Bz_1%7D%20z_1%20+%5Coverline%7Bz_2%7Dz_2%20+%20%5Cldots%20+%20%5Coverline%7Bz_n%7D%20z_n%5C%5C%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%7Cz_i%7C%5E2%20%5Cgeq%200%0A%5Cend%7Balign*%7D%0A"></p>
<p>It is also homogenous. Let <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cin%20%5CC">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Calpha%20%5Cbf%7Bz%7D%7D_2%20&amp;=%20%5Cnorm%7B(%5Calpha%20z_1,%20%5Calpha%20z_2,%5Cldots,%5Calpha%20z_n)%7D_2%5C%5C%0A&amp;=%5Csqrt%7B%5Csum_%7Bi=1%7D%5En%20%7C%5Calpha%20z_i%7C%5E2%7D%5C%5C%0A&amp;=%7C%5Calpha%7C%5Csqrt%7B%5Csum_%7Bi=1%7D%5En%20%7Cz_i%7C%5E2%7D%20%5C%5C%0A&amp;=%20%7C%5Calpha%7C%5Cnorm%7B%5Cbf%7Bz%7D%7D_2%0A%5Cend%7Balign*%7D%0A"></p>
<p>Let’s verify, if the triangle inequality is satisfied. Let <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D,%20%5Cbf%7By%7D%5Cin%5CC%5En"> be arbitrary vectors.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7Bx%7D%20+%20%5Cbf%7By%7D%7D_2%5E2%20&amp;=%20%7C(%5Cbf%7Bx%7D%20+%20%5Cbf%7By%7D)%5EH(%5Cbf%7Bx%7D%20+%20%5Cbf%7By%7D)%7C%5C%5C%0A&amp;=%20%7C(%5Cbf%7Bx%7D%5EH%20+%20%5Cbf%7By%7D%5EH)(%5Cbf%7Bx%7D%20+%20%5Cbf%7By%7D)%7C%5C%5C%0A&amp;=%20%7C%5Cbf%7Bx%7D%5EH%20%5Cbf%7Bx%7D%20+%20%5Cbf%7By%7D%5EH%20%5Cbf%7By%7D%20+%20%5Cbf%7By%7D%5EH%20%5Cbf%7Bx%7D%20+%20%5Cbf%7Bx%7D%5EH%20%5Cbf%7By%7D%7C%5C%5C%0A&amp;%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%5E2%20+%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%5E2%20+%20%7C%5Cinner%7B%5Cbf%7By%7D%7D%7B%5Cbf%7Bx%7D%7D%7C%20+%20%7C%5Cinner%7B%5Cbf%7Bx%7D%7D%7B%5Cbf%7By%7D%7D%7C%5C%5C%0A&amp;%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%5E2%20+%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%5E2%20+%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20%20+%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20&amp;%20%5C%7B%20%5Ctext%7B%20Cauchy-Schwarz%20%7D%20%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%5E2%20+%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%5E2%20+%20%202%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%5C%5C%0A&amp;=%20(%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20+%20%5Cnorm%7B%5Cbf%7By%7D%7D_2)%5E2%0A%5Cend%7Balign*%7D%0A"></p>
<p>Consequently, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bx%7D%20+%20%5Cbf%7By%7D%7D_2%20%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20+%20%5Cnorm%7B%5Cbf%7By%7D%7D_2">.</p>
</section>
<section id="the-vector-1-norm" class="level2">
<h2 class="anchored" data-anchor-id="the-vector-1-norm">The vector <img src="https://latex.codecogs.com/png.latex?1-">norm</h2>
<div id="def-the-vector-1-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5 (The vector <img src="https://latex.codecogs.com/png.latex?1-">norm)</strong></span> The vector <img src="https://latex.codecogs.com/png.latex?1">-norm, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_1%20:%20%5CC%5En%20%5Cto%20%5CR"> is defined for all <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%5Cin%5CC%5En"> by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%20%7C%5Cchi_1%7C%20+%20%7C%5Cchi_2%7C%20+%20%5Cldots%20+%20%7C%5Cchi_n%7C%20=%5Csum_%7Bi=1%7D%5En%20%7C%5Cchi_i%7C%0A"></p>
</div>
<div id="thm-1-norm-is-a-norm" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3</strong></span> The vector <img src="https://latex.codecogs.com/png.latex?1">-norm is well-defined.</p>
</div>
<p><em>Proof.</em></p>
<p><em>Positive semi-definitess.</em></p>
<p>The absolute value of complex numbers is non-negative.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%20%7C%5Cchi_1%7C%20+%20%7C%5Cchi_2%7C%20+%20%5Cldots%20+%20%7C%5Cchi_n%7C%20%5Cgeq%20%7C%5Cchi_i%7C%20%5Cgeq%200%0A"></p>
<p><em>Homogeneity.</em></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Calpha%5Cbf%7Bx%7D%7D_1%20=%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%7C%5Calpha%20%5Cchi_i%7C%20=%20%7C%5Calpha%7C%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%7C%5Cchi_i%7C%20=%20%7C%5Calpha%7C%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%0A"></p>
<p><em>Triangle Inequality.</em></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7Bx%7D%20+%20%5Cbf%7By%7D%7D%20&amp;=%20%5Cnorm%7B(%5Cchi_1%20+%20%5Cpsi_1,%20%5Cldots,%5Cchi_n%20+%20%5Cpsi_n)%7D_1%5C%5C%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%7C%5Cchi_i%20+%20%5Cpsi_i%7C%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bi=1%7D%5En%20%7C%5Cchi_i%7C%20+%20%7C%5Cpsi_i%7C%20&amp;%20%5C%7B%20%5Ctext%7B%20Triangle%20inequality%20for%20complex%20numbers%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%7C%5Cchi_i%7C%20+%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20%7C%5Cpsi_i%7C%20&amp;%20%5C%7B%20%5Ctext%7B%20Commutativity%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20+%20%5Cnorm%7B%5Cbf%7By%7D%7D_1%0A%5Cend%7Balign*%7D%0A"></p>
<p>Hence, the three axioms are satisfied. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="jensens-inequality" class="level2">
<h2 class="anchored" data-anchor-id="jensens-inequality">Jensen’s inequality</h2>
<section id="convex-functions-and-combinations" class="level3">
<h3 class="anchored" data-anchor-id="convex-functions-and-combinations">Convex functions and combinations</h3>
<p>A function <img src="https://latex.codecogs.com/png.latex?f"> is said to be <em>convex</em> on over an interval <img src="https://latex.codecogs.com/png.latex?I">, if for all <img src="https://latex.codecogs.com/png.latex?x_1,x_2%20%5Cin%20I">, and every <img src="https://latex.codecogs.com/png.latex?p%20%5Cin%20%5B0,1%5D">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(px_1%20+%20(1-p)x_2)%20%5Cleq%20pf(x_1)%20+%20(1-p)f(x_2)%0A"></p>
<p>In other words, all chords(secants) joining any two points on <img src="https://latex.codecogs.com/png.latex?f">, lie above the graph of <img src="https://latex.codecogs.com/png.latex?f">. Note that, if <img src="https://latex.codecogs.com/png.latex?0%20%5Cleq%20p%20%5Cleq%201">, then <img src="https://latex.codecogs.com/png.latex?%5Cmin(x_1,x_2)%20%5Cleq%20px_1%20+%20(1-p)x_2%20%5Cleq%20%5Cmax(x_1,x_2)">. More generally, for non-negative real numbers <img src="https://latex.codecogs.com/png.latex?p_1,%20p_2,%20%5Cldots,%20p_n"> summing to one, that is, satisfying <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=1%7D%5En%20p_i%20=%201">, and for any points <img src="https://latex.codecogs.com/png.latex?x_1,%5Cldots,x_n%20%5Cin%20I">, the point <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=1%7D%5En%20%5Clambda_i%20x_i"> is called a <em>convex combination</em> of <img src="https://latex.codecogs.com/png.latex?x_1,%5Cldots,x_n">. Since:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5Cmin(x_1,%5Cldots,x_n)%20%5Cleq%20%5Csum_%7Bi=1%7D%5En%20p_i%20x_i%20%5Cleq%20%5Cmax(x_1,%5Cldots,x_n)"></p>
<p>every convex combination of any finite number of points in <img src="https://latex.codecogs.com/png.latex?I"> is again a point of <img src="https://latex.codecogs.com/png.latex?I">.</p>
<p>Intuitively, <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=1%7D%5E%7Bn%7Dp_i%20x_i"> simply represents the center of mass of the points <img src="https://latex.codecogs.com/png.latex?x_1,%5Cldots,x_n"> with weights <img src="https://latex.codecogs.com/png.latex?p_1,%5Cldots,p_n">.</p>
</section>
<section id="proving-jensens-inequality" class="level3">
<h3 class="anchored" data-anchor-id="proving-jensens-inequality">Proving Jensen’s inequality</h3>
<p>Jensen’s inequality named after the Danish engineer <a href="https://en.wikipedia.org/wiki/Johan_Jensen_(mathematician)">Johan Jensen</a> (1859-1925) can be stated as follows:</p>
<div id="thm-jensens-inequality" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4</strong></span> Let <img src="https://latex.codecogs.com/png.latex?n%20%5Cin%20%5Cbf%7BZ%7D_+"> be a positive integer and let <img src="https://latex.codecogs.com/png.latex?f:I%20%5Cto%20%5CR"> be a convex function over the interval <img src="https://latex.codecogs.com/png.latex?I%20%5Csubseteq%20%5CR">. For any (not necessarily distinct) points <img src="https://latex.codecogs.com/png.latex?x_1,%5Cldots,x_n%20%5Cin%20I">, and non-negative real numbers <img src="https://latex.codecogs.com/png.latex?p_1,%5Cldots,p_n%20%5Cin%20%5CR"> summing to one,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(%5Csum_%7Bi=1%7D%5En%20p_i%20x_i)%20%5Cleq%20%5Csum_%7Bi=1%7D%5En%20p_i%20f(x_i)%0A"></p>
</div>
<p><em>Proof.</em></p>
<p>We proceed by induction. Since <img src="https://latex.codecogs.com/png.latex?f"> is convex, by definition, <img src="https://latex.codecogs.com/png.latex?%5Cforall%20x_1,x_2%20%5Cin%20I">, and any <img src="https://latex.codecogs.com/png.latex?p_1,p_2%5Cin%20%5CR">, such that <img src="https://latex.codecogs.com/png.latex?p_1%20+%20p_2%20=%201">, we have <img src="https://latex.codecogs.com/png.latex?f(p_1%20x_1%20+%20p_2%20x_2)%20%5Cleq%20p_1%20f(x_1)%20+%20p_2%20f(x_2)">. So, the claim is true for <img src="https://latex.codecogs.com/png.latex?n=2">.</p>
<p><em>Inductive hypothesis</em>. Assume that <img src="https://latex.codecogs.com/png.latex?%5Cforall%20x_1,%5Cldots,x_%7Bk%7D%20%5Cin%20I"> and any <img src="https://latex.codecogs.com/png.latex?p_1,%5Cldots,p_k%20%5Cin%20%5CR">, such that <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=1%7D%5Ek%20p_i%20=%201">, we have <img src="https://latex.codecogs.com/png.latex?f(%5Csum_%7Bi=1%7D%5Ek%20p_i%20x_i)%20%5Cleq%20%5Csum_%7Bi=1%7D%5Ek%20p_i%20f(x_i)">.</p>
<p><em>Claim</em>. The Jensen’s inequality holds for <img src="https://latex.codecogs.com/png.latex?k+1"> points in <img src="https://latex.codecogs.com/png.latex?I">.</p>
<p><em>Proof</em>.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?x_1,%5Cldots,x_k,%20x_%7Bk+1%7D"> be arbitrary points in <img src="https://latex.codecogs.com/png.latex?I"> and consider any convex combination of these points <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=1%7D%5E%7Bk+1%7Dp_i%20x_i">, <img src="https://latex.codecogs.com/png.latex?p_i%20%5Cin%20%5B0,1%5D,%20i%20%5Cin%20%5C%7B1,2,3,%5Cldots,k+1%5C%7D,%20%5Csum_%7Bi=1%7D%5E%7Bk+1%7Dp_i%20=%201">.</p>
<p>Define:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Az%20:=%20%5Cfrac%7Bp_1%20x_1%20+%20p_2%20x_2%20+%20%5Cldots%20+%20p_k%20x_k%7D%7B%5Csum_%7Bi=1%7D%5Ek%20p_i%7D%0A"></p>
<p>Since, <img src="https://latex.codecogs.com/png.latex?z"> is a convex combination of <img src="https://latex.codecogs.com/png.latex?%5C%7Bx_1,%5Cldots,x_k%5C%7D">, <img src="https://latex.codecogs.com/png.latex?z%20%5Cin%20I">. Moreover, by the inductive hypothesis, since <img src="https://latex.codecogs.com/png.latex?f"> is convex,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af(z)%20&amp;=%20f%5Cleft(%5Cfrac%7Bp_1%20x_1%20+%20p_2%20x_2%20+%20%5Cldots%20+%20p_k%20x_k%7D%7B%5Csum_%7Bi=1%7D%5Ek%20p_i%7D%5Cright)%5C%5C%0A&amp;%5Cleq%20%5Cfrac%7Bp_1%7D%7B%5Csum_%7Bi=1%7D%5Ek%20p_i%7Df(x_1)%20+%20%5Cfrac%7Bp_2%7D%7B%5Csum_%7Bi=1%7D%5Ek%20p_i%7Df(x_2)%20+%20%5Cldots%20+%20%5Cfrac%7Bp_k%7D%7B%5Csum_%7Bi=1%7D%5Ek%20p_i%7Df(x_k)%20%5C%5C%0A&amp;=%20%5Cfrac%7Bp_1%7D%7B1-p_%7Bk+1%7D%7Df(x_1)%20+%20%5Cfrac%7Bp_2%7D%7B1-p_%7Bk+1%7D%7Df(x_2)%20+%20%5Cldots%20+%20%5Cfrac%7Bp_k%7D%7B1-p_%7Bk+1%7D%7Df(x_k)%20%5C%5C%0A%5Cend%7Balign*%7D%0A"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?0%20%5Cleq%201%20-%20p_%7Bk+1%7D%20%5Cleq%201">, we deduce that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(1%20-%20p_%7Bk+1%7D)f(z)%20%5Cleq%20p_1%20f(x_1)%20+%20%5Cldots%20+%20p_k%20f(x_k)%0A"></p>
<p>We have: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af(p_1%20x_1%20+%20%5Cldots%20+%20p_k%20x_k%20+%20p_%7Bk+1%7D%20x_%7Bk+1%7D)%20&amp;=%20f((1-p_%7Bk+1%7D)z%20+%20p_%7Bk+1%7Dx_%7Bk+1%7D)%5C%5C%0A&amp;%5Cleq%20(1-p_%7Bk+1%7D)f(z)%20+%20p_%7Bk+1%7Df(x_%7Bk+1%7D)%20&amp;%20%5C%7B%20%5Ctext%7B%20Jensen's%20inequality%20for%20%7Dn=2%5C%7D%5C%5C%0A&amp;%5Cleq%20p_1%20f(x_1)%20+%20%5Cldots%20+%20p_k%20f(x_k)%20+%20p_%7Bk+1%7Df(x_%7Bk+1%7D)%20&amp;%20%5C%7B%20%5Ctext%7B%20Deduction%20from%20the%20inductive%20hypothesis%20%7D%5C%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
</section>
<section id="youngs-inequality" class="level2">
<h2 class="anchored" data-anchor-id="youngs-inequality">Young’s Inequality</h2>
<p>Young’s inequality is named after the English mathematician <a href="https://en.wikipedia.org/wiki/William_Henry_Young">William Henry Young</a> and can be stated as follows:</p>
<div id="thm-youngs-inequality" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5 (Young’s inequality)</strong></span> For any non-negative real numbers <img src="https://latex.codecogs.com/png.latex?a"> and <img src="https://latex.codecogs.com/png.latex?b"> and any positive real numbers <img src="https://latex.codecogs.com/png.latex?p,q"> satisfying <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Bp%7D%20+%20%5Cfrac%7B1%7D%7Bq%7D=1">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aab%20%5Cleq%20%5Cfrac%7Ba%5Ep%7D%7Bp%7D%20+%20%5Cfrac%7Bb%5Eq%7D%7Bq%7D%0A"></p>
</div>
<p><em>Proof.</em></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?f(x)%20=%20%5Clog%20x">. Since <img src="https://latex.codecogs.com/png.latex?f"> is concave, we can reverse the Jensen’s inequality. Consequently:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Clog(%5Cfrac%7Ba%5Ep%7D%7Bp%7D%20+%20%5Cfrac%7Bb%5Eq%7D%7Bq%7D)%20&amp;%5Cgeq%20%5Cfrac%7B1%7D%7Bp%7D%5Clog%20a%5Ep%20+%20%5Cfrac%7B1%7D%7Bq%7D%5Clog%20b%5Eq%5C%5C%0A&amp;=%20%5Cfrac%7B1%7D%7Bp%7D%5Ccdot%20p%20%5Clog%20a%20+%20%5Cfrac%7B1%7D%7Bq%7D%5Ccdot%20q%20%5Clog%20b%5C%5C%0A&amp;=%20%5Clog%20(ab)%0A%5Cend%7Balign*%7D%0A"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?%5Clog%20x"> is monotonic increasing,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7Ba%5Ep%7D%7Bp%7D%20+%20%5Cfrac%7Bb%5Eq%7D%7Bq%7D%20%5Cgeq%20ab%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="holders-inequality" class="level2">
<h2 class="anchored" data-anchor-id="holders-inequality">Holder’s inequality</h2>
<p>We can use Young’s inequality to prove the Holder’s inequality, named after the German mathematician <a href="https://en.wikipedia.org/wiki/Otto_H%C3%B6lder">Otto Ludwig Holder</a> (1859-1937).</p>
<div id="thm-holders-inequality" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6 (Holder’s inequality)</strong></span> For any pair of vectors <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D,%5Cbf%7By%7D%5Cin%20%5CC%5En">, and for any positive real numbers satisfying <img src="https://latex.codecogs.com/png.latex?p"> and <img src="https://latex.codecogs.com/png.latex?q">, we have <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Bp%7D%20+%20%5Cfrac%7B1%7D%7Bq%7D%20=%201"> we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csum_%7Bi=1%7D%5E%7Bn%7D%7Cx_i%20y_i%7C%20%5Cleq%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%5Cright)%5E%7B1/p%7D%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Eq%5Cright)%5E%7B1/q%7D%0A"></p>
</div>
<p><em>Proof.</em></p>
<p>Apply Young’s inequality to <img src="https://latex.codecogs.com/png.latex?a%20=%20%5Cfrac%7B%7Cx_i%7C%7D%7B%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%5Cright)%5E%7B1/p%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?b%20=%20%5Cfrac%7B%7Cy_i%7C%7D%7B%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Eq%5Cright)%5E%7B1/q%7D%7D">. We get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%7Cx_i%7C%7Cy_i%7C%7D%7B%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%5Cright)%5E%7B1/p%7D%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Eq%5Cright)%5E%7B1/q%7D%7D%20&amp;%5Cleq%20%5Cfrac%7B1%7D%7Bp%7D%20%5Cfrac%7B%7Cx_i%7C%5Ep%7D%7B%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%7D%20+%20%5Cfrac%7B1%7D%7Bq%7D%5Cfrac%7B%7Cy_i%7C%5Eq%7D%7B%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Eq%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Summing on both sides, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Csum_%7Bi=1%7D%5En%7Cx_i%20y_i%7C%7D%7B%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%5Cright)%5E%7B1/p%7D%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Eq%5Cright)%5E%7B1/q%7D%7D%20&amp;%5Cleq%20%5Cfrac%7B1%7D%7Bp%7D%20%5Cfrac%7B%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%7D%7B%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%7D%20+%20%5Cfrac%7B1%7D%7Bq%7D%5Cfrac%7B%5Csum_%7Bi=1%7D%5En%7Cy_i%7C%5Eq%7D%7B%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Eq%7D%5C%5C%0A&amp;=%20%5Cfrac%7B1%7D%7Bp%7D%20+%20%5Cfrac%7B1%7D%7Bq%7D%5C%5C%0A&amp;=%201%5C%5C%0A%5Csum_%7Bi=1%7D%5En%20%7Cx_i%20y_i%7C%20&amp;%5Cleq%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%5Cright)%5E%7B1/p%7D%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Eq%5Cright)%5E%7B1/q%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="the-vector-p-norm" class="level2">
<h2 class="anchored" data-anchor-id="the-vector-p-norm">The vector <img src="https://latex.codecogs.com/png.latex?p">-norm</h2>
<p>The vector <img src="https://latex.codecogs.com/png.latex?1">-norm and <img src="https://latex.codecogs.com/png.latex?2">-norm are special cases of the <img src="https://latex.codecogs.com/png.latex?p">-norm.</p>
<div id="def-vector-p-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6 (<img src="https://latex.codecogs.com/png.latex?p">-norm)</strong></span> Given <img src="https://latex.codecogs.com/png.latex?p%20%5Cgeq%201">, the vector <img src="https://latex.codecogs.com/png.latex?p">-norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_p%20:%20%5CC%5En%20%5Cto%20%5CR"> is defined by :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_p%20=%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7C%5Cchi_i%7C%5Ep%5Cright)%5E%7B1/p%7D%0A"></p>
</div>
<div id="thm-p-norm-is-a-norm" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7</strong></span> The vector <img src="https://latex.codecogs.com/png.latex?p">-norm is a well-defined norm.</p>
</div>
<p><em>Proof.</em></p>
<p><em>Positive semi-definite</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_p%20&amp;=%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7C%5Cchi_i%7C%5Ep%20%5Cright)%5E%7B1/p%7D%5C%5C%0A&amp;%5Cgeq%20%5Cleft(%7C%5Cchi_i%7C%5Ep%20%5Cright)%5E%7B1/p%7D%5C%5C%0A&amp;=%20%7C%5Cchi_i%7C%20%5Cgeq%200%0A%5Cend%7Balign*%7D%0A"></p>
<p><em>Homogeneity</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Calpha%20%5Cbf%7Bx%7D%7D_p%20&amp;=%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7C%5Calpha%20%5Cchi_i%7C%5Ep%20%5Cright)%5E%7B1/p%7D%5C%5C%0A&amp;=%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7C%5Calpha%7C%5Ep%20%7C%5Cchi_i%7C%5Ep%20%5Cright)%5E%7B1/p%7D%5C%5C%0A&amp;=%20%7C%5Calpha%7C%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7C%5Cchi_i%7C%5Ep%20%5Cright)%5E%7B1/p%7D%20&amp;=%20%7C%5Calpha%7C%5Cnorm%7B%5Cbf%7Bx%7D%7D_p%0A%5Cend%7Balign*%7D%0A"></p>
<p><em>Triangle Inequality</em></p>
<p>Define <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Bq%7D%20:=%201%20-%20%5Cfrac%7B1%7D%7Bp%7D">. <img src="https://latex.codecogs.com/png.latex?%5CLongrightarrow%20(p-1)q%20=%20p">.</p>
<p>By the Holder’s inequality: <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%7Cx_i%20+%20y_i%7C%5E%7Bp-1%7D%20&amp;%5Cleq%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%5Cright)%5E%7B1/p%7D%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%20+%20y_i%7C%5E%7B(p-1)q%7D%5Cright)%5E%7B1/q%7D%5C%5C%0A%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%7Cx_i%20+%20y_i%7C%5E%7Bp-1%7D%20&amp;%5Cleq%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Ep%5Cright)%5E%7B1/p%7D%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%20+%20y_i%7C%5E%7B(p-1)q%7D%5Cright)%5E%7B1/q%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Summing, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csum_%7Bi=1%7D%5En%20%7Cx_i%20+%20y_i%7C%5E%7Bp%7D%20&amp;%5Cleq%20%5Cleft%5C%7B%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%5Cright)%5E%7B1/p%7D+%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Ep%5Cright)%5E%7B1/p%7D%5Cright%5C%7D%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%20+%20y_i%7C%5E%7B(p-1)q%7D%5Cright)%5E%7B1/q%7D%5C%5C%0A&amp;=%20%5Cleft%5C%7B%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%5Cright)%5E%7B1/p%7D+%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Ep%5Cright)%5E%7B1/p%7D%5Cright%5C%7D%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%20+%20y_i%7C%5E%7Bp%7D%5Cright)%5E%7B1-%5Cfrac%7B1%7D%7Bp%7D%7D%5C%5C%0A%5CLongrightarrow%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%20+%20y_i%7C%5E%7Bp%7D%5Cright)%5E%7B1/p%7D%20&amp;%5Cleq%20%5Cleft%5C%7B%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Ep%5Cright)%5E%7B1/p%7D+%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cy_i%7C%5Ep%5Cright)%5E%7B1/p%7D%5Cright%5C%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="the-vector-infty-norm" class="level2">
<h2 class="anchored" data-anchor-id="the-vector-infty-norm">The vector <img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm</h2>
<div id="def-infinity-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 7 (<img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm)</strong></span> The vector <img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D:%5CC%5En%20%5Cto%20%5CR"> is defined for <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%20%5Cin%20%5CC%5En"> by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%20%5Cmax%5C%7B%7C%5Cchi_1%7C,%7C%5Cchi_2%7C,%5Cldots,%7C%5Cchi_n%7C%5C%7D%0A"></p>
<p>The <img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm simply measures how long the vector is by the magnitude of its largest entry.</p>
</div>
<div id="thm-infty-norm-is-a-norm" class="theorem">
<p><span class="theorem-title"><strong>Theorem 8</strong></span> The vector <img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm is well-defined.</p>
</div>
<p><em>Proof.</em></p>
<p><em>Positive semi-definiteness</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_%7B%5Cinfty%7D%20=%20%5Cmax_%7B1%5Cleq%20i%20%5Cleq%20n%7D%20%7C%5Cchi_i%7C%20%5Cgeq%20%7C%5Cxi_i%7C%20%5Cgeq%200%0A"></p>
<p><em>Homogeneity</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Calpha%20%5Cbf%7Bx%7D%7D_%7B%5Cinfty%7D%20=%20%5Cmax_%7B1%5Cleq%20i%20%5Cleq%20n%7D%7C%5Calpha%20%5Cchi_i%7C%20=%5Cmax_%7B1%5Cleq%20i%20%5Cleq%20n%7D%7C%5Calpha%7C%7C%20%5Cchi_i%7C%20=%20%7C%5Calpha%7C%20%5Cmax_%7B1%5Cleq%20i%20%5Cleq%20n%7D%7C%5Cchi_i%7C%20=%20%7C%5Calpha%7C%5Cnorm%7B%5Cbf%7Bx%7D%7D_%7B%5Cinfty%7D%0A"></p>
<p><em>Triangle Inequality</em></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7Bx%7D%20+%20%5Cbf%7By%7D%7D_%5Cinfty%20&amp;=%20%5Cmax_%7Bi=1%7D%5Em%20%7C%5Cchi_i%20+%20%5Cxi_i%7C%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7Bi=1%7D%5Em%20(%7C%5Cchi_i%7C%20+%20%7C%5Cxi_i%7C)%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7Bi=1%7D%5Em%20%7C%5Cchi_i%7C%20+%20%5Cmax_%7Bi=1%7D%5Em%20%7C%5Cxi_i%7C%5C%5C%0A&amp;=%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20+%20%5Cnorm%7B%5Cbf%7By%7D%7D_%5Cinfty%0A%5Cend%7Balign*%7D%0A"></p>
</section>
<section id="equivalence-of-vector-norms" class="level2">
<h2 class="anchored" data-anchor-id="equivalence-of-vector-norms">Equivalence of vector norms</h2>
<p>As I was saying earlier, we often measure if a vector is <em>small</em> or <em>large</em> or the distance between two vectors by computing norms. It would be unfortunate, if a vector were <em>small</em> in one norm, yet <em>large</em> in another. Fortunately, the next theorem excludes this possibility.</p>
<div id="thm-equivalence-of-vector-norms" class="theorem">
<p><span class="theorem-title"><strong>Theorem 9 (Equivalence of vector norms)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_a:%5CC%5En%20%5Cto%20%5CR"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_b:%5CC%5En%5Cto%20%5CR"> both be vector norms. Then there exist positive scalars <img src="https://latex.codecogs.com/png.latex?C_1"> and <img src="https://latex.codecogs.com/png.latex?C_2"> such that for <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%5Cin%20%5CC%5En">,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AC_1%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_b%20%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_a%20%5Cleq%20C_2%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_b%0A"></p>
</div>
<p><em>Proof.</em></p>
<p>We can prove equivalence of norms in four steps, the last which uses the extreme value theorem from Real Analysis.</p>
<section id="step-1-it-is-sufficient-to-consider-normcdot_b-normcdot_1-transitivity." class="level4">
<h4 class="anchored" data-anchor-id="step-1-it-is-sufficient-to-consider-normcdot_b-normcdot_1-transitivity.">Step 1: It is sufficient to consider <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_b%20=%20%5Cnorm%7B%5Ccdot%7D_1"> (transitivity).</h4>
<p>We will show that it is sufficient to prove that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_a"> is equivalent to <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_1"> because norm equivalence is <em>transitive</em>: if two norms are equivalent to <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_1">, then they are equivalent to each other. In particular, suppose both <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_a"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%7Ba'%7D"> are equivalent to <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_1"> for constants <img src="https://latex.codecogs.com/png.latex?0%20%5Cleq%20C_1%20%5Cleq%20C_2"> and <img src="https://latex.codecogs.com/png.latex?0%20%5Cleq%20C_1'%20%5Cleq%20C_2'"> respectively:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AC_1%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_a%20%5Cleq%20C_2%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%0A"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AC_1'%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_%7Ba'%7D%20%5Cleq%20C_2'%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%0A"></p>
<p>Then, it immediately follows that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_%7Ba'%7D%20%5Cleq%20C_2'%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20%5Cleq%20%5Cfrac%7BC_2'%7D%7BC_1%7D%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_a%0A"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_%7Ba'%7D%20%5Cgeq%20C_1'%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20%5Cgeq%20%5Cfrac%7BC_1'%7D%7BC_2%7D%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_a%0A"></p>
<p>and hence <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_a"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%7Ba'%7D"> are equivalent. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="step-2-it-is-sufficient-to-consider-only-bfx-with-normbfx_1-1." class="level4">
<h4 class="anchored" data-anchor-id="step-2-it-is-sufficient-to-consider-only-bfx-with-normbfx_1-1.">Step 2: It is sufficient to consider only <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D"> with <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%201">.</h4>
<p>We wish to show that</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AC_1%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_a%20%5Cleq%20C_2%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%0A"></p>
<p>is true for all <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%20%5Cin%20V"> for some <img src="https://latex.codecogs.com/png.latex?C_1">, <img src="https://latex.codecogs.com/png.latex?C_2">. It is trivially true for <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D=%5Cbf%7B0%7D">, so we only need to consider <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%5Cneq%5Cbf%7B0%7D">, in which case, we can divide by <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bx%7D%7D_1">, to obtain the condition:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AC_1%20%5Cleq%20%5Cnorm%7B%5Cfrac%7B%5Cbf%7Bx%7D%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20%7D%7D_a%20%5Cleq%20C_2%0A"></p>
<p>The vector <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bu%7D%20=%20%5Cfrac%7B%5Cbf%7Bx%7D%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%7D"> is a unit vector in the <img src="https://latex.codecogs.com/png.latex?1">-norm, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bu%7D%7D_1%20=%201">. So, we can write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AC_1%20%5Cleq%20%5Cnorm%7B%5Cbf%7Bu%7D%7D_a%20%5Cleq%20C_2%0A"></p>
<p>We have the desired result. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="step-3-any-norm-normcdot_a-is-continuous-under-normcdot_1." class="level4">
<h4 class="anchored" data-anchor-id="step-3-any-norm-normcdot_a-is-continuous-under-normcdot_1.">Step 3: Any norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_a"> is continuous under <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_1">.</h4>
<p>We wish to show that any norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_a"> is a continuous function on <img src="https://latex.codecogs.com/png.latex?V"> under the topology induced by <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_1">. That is, we wish to show that for any <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20%3E%200">, there exists <img src="https://latex.codecogs.com/png.latex?%5Cdelta%20%3E%200">, such that for all <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bx%7D%20-%20%5Cbf%7Bc%7D%7D_1%20%3C%20%5Cdelta">, we have <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_a%20-%20%5Cnorm%7B%5Cbf%7Bc%7D%7D_a%7D_1%20%3C%20%5Cepsilon">.</p>
<p>We prove this into two steps. First, by the triangle inequality on <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_a">, it follows that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_a%20-%20%5Cnorm%7B%5Cbf%7Bc%7D%7D_a%20&amp;=%20%5Cnorm%7B%5Cbf%7Bc%7D%20+%20(%5Cbf%7Bx%7D%20-%20%5Cbf%7Bc%7D)%7D_a%20-%20%5Cnorm%7B%5Cbf%7Bc%7D%7D_a%20%5C%5C%0A&amp;%5Cleq%20%5Cnorm%7B%5Cbf%7Bc%7D%7D_a%20+%20%5Cnorm%7B(%5Cbf%7Bx%7D%20-%20%5Cbf%7Bc%7D)%7D_a%20-%20%5Cnorm%7B%5Cbf%7Bc%7D%7D_a%5C%5C%0A&amp;=%20%5Cnorm%7B(%5Cbf%7Bx%7D%20-%20%5Cbf%7Bc%7D)%7D_a%0A%5Cend%7Balign*%7D%0A"></p>
<p>And</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7Bc%7D%7D_a%20-%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_a%20&amp;%5Cleq%20%5Cnorm%7B(%5Cbf%7Bx%7D%20-%20%5Cbf%7Bc%7D)%7D_a%0A%5Cend%7Balign*%7D%0A"></p>
<p>and hence:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%5Cnorm%7B%5Cbf%7Bx%7D%7D_a%20-%20%5Cnorm%7B%5Cbf%7Bc%7D%7D_a%7C%20%5Cleq%20%5Cnorm%7B(%5Cbf%7Bx%7D%20-%20%5Cbf%7Bc%7D)%7D_a%0A"></p>
<p>Second applying the triangle inequality again, and writing <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%20=%20%5Csum_%7Bi=1%7D%5En%20%5Calpha_i%20%5Cbf%7Be%7D_i"> and <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bc%7D%20=%20%5Csum_%7Bi=1%7D%5En%20%5Calpha_i'%20%5Cbf%7Be%7D_i"> in our basis, we obtain:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7Bx%7D-%5Cbf%7Bc%7D%7D_a%20&amp;=%20%5Cnorm%7B%5Csum_%7Bi=1%7D%5En%20(%5Calpha_i%20-%20%5Calpha_i')%5Cbf%7Be%7D_i%7D_a%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bi=1%7D%5En%20%5Cnorm%7B(%5Calpha_i%20-%20%5Calpha_i')%5Cbf%7Be%7D_i%7D_a%20&amp;%20%5C%7B%20%5Ctext%7B%20Triangle%20Inequality%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%7C(%5Calpha_i%20-%20%5Calpha_i')%7C%5Cnorm%7B%5Cbf%7Be%7D_i%7D_a%20%5C%5C%0A&amp;=%20%5Cnorm%7B%5Cbf%7Bx%7D%20-%20%5Cbf%7Bc%7D%7D_1%20%5Cleft(%5Cmax_i%20%5Cnorm%7B%5Cbf%7Be%7D_i%7D_a%20%5Cright)%0A%5Cend%7Balign*%7D%0A"></p>
<p>Therefore, if we choose:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cdelta%20=%20%5Cfrac%7B%5Cepsilon%7D%7B%5Cleft(%5Cmax_i%20%5Cnorm%7B%5Cbf%7Be%7D_i%7D_a%20%5Cright)%7D%0A"></p>
<p>it immediate follows that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7Bx%7D%20-%20%5Cbf%7Bc%7D%7D_1%20&amp;%3C%20%5Cdelta%20%5C%5C%0A%5CLongrightarrow%20%7C%5Cnorm%7B%5Cbf%7Bx%7D%7D_a%20-%20%5Cnorm%7B%5Cbf%7Bc%7D%7D_a%7C%20&amp;%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%20-%20%5Cbf%7Bc%7D%7D_a%20%5C%5C%20&amp;%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%20-%20%5Cbf%7Bc%7D%7D_1%20%5Cleft(%5Cmax_i%20%5Cnorm%7B%5Cbf%7Be%7D_i%7D_a%20%5Cright)%20%5C%5C%0A&amp;%20%5Cleq%20%5Cfrac%7B%5Cepsilon%7D%7B%5Cleft(%5Cmax_i%20%5Cnorm%7B%5Cbf%7Be%7D_i%7D_a%20%5Cright)%7D%20%5Cleft(%5Cmax_i%20%5Cnorm%7B%5Cbf%7Be%7D_i%7D_a%20%5Cright)%20=%20%5Cepsilon%0A%5Cend%7Balign*%7D%0A"></p>
<p>This proves (uniform) continuity. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="step-4-the-maximum-and-minimum-of-normcdot_a-on-the-unit-ball" class="level4">
<h4 class="anchored" data-anchor-id="step-4-the-maximum-and-minimum-of-normcdot_a-on-the-unit-ball">Step 4: The maximum and minimum of <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_a"> on the unit ball</h4>
<p>Let <img src="https://latex.codecogs.com/png.latex?K:=%5C%7B%5Cbf%7Bu%7D:%5Cnorm%7B%5Cbf%7Bu%7D%7D_1%20=%201%5C%7D">. Then, <img src="https://latex.codecogs.com/png.latex?K"> is a compact set. Since <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_a"> is continuous on <img src="https://latex.codecogs.com/png.latex?K">, by the extreme value theorem, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_a"> must achieve a supremum and infimum on the set. So, for all <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bu%7D"> with <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bu%7D%7D_1%20=%201">, there exists <img src="https://latex.codecogs.com/png.latex?C_1,C_2%20%3E%200">, such that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20C_1%20%5Cleq%20%5Cnorm%7B%5Cbf%7Bu%7D%7D_a%20%5Cleq%20C_2"></p>
<p>as required by step 2. And we are done! <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="deriving-the-constants-c_1infty-c_infty1" class="level3">
<h3 class="anchored" data-anchor-id="deriving-the-constants-c_1infty-c_infty1">Deriving the constants <img src="https://latex.codecogs.com/png.latex?C_%7B1,%5Cinfty%7D">, <img src="https://latex.codecogs.com/png.latex?C_%7B%5Cinfty,1%7D"></h3>
<p>Let’s write a python implementation of the various norms.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb3-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> itertools</span>
<span id="cb3-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb3-5"></span>
<span id="cb3-6">sns.set_style(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"whitegrid"</span>)</span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> one_norm(x):</span>
<span id="cb3-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(x))</span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> two_norm(x):</span>
<span id="cb3-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.sqrt(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> p_norm(x,p):</span>
<span id="cb3-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pow</span>(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>p),<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>p)</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> infty_norm(x):</span>
<span id="cb3-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(x))</span>
<span id="cb3-19"></span>
<span id="cb3-20"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> get_vectors_eq_norm_val(func, val, lower_bound, upper_bound):</span>
<span id="cb3-21">    x_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(lower_bound, upper_bound, </span>
<span id="cb3-22">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>((upper_bound <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> lower_bound)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb3-23">    x_2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(lower_bound, upper_bound, </span>
<span id="cb3-24">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>((upper_bound <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> lower_bound)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb3-25"></span>
<span id="cb3-26">    pts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(itertools.product(x_1, x_2)))</span>
<span id="cb3-27">    norm_arr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(func, pts)))</span>
<span id="cb3-28"></span>
<span id="cb3-29">    pts_norm_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(pts,norm_arr))</span>
<span id="cb3-30"></span>
<span id="cb3-31">    pts_with_norm_eq_val <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb3-32">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> pt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pts_norm_list:</span>
<span id="cb3-33">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> pt[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> val:</span>
<span id="cb3-34">            pts_with_norm_eq_val.append(pt[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb3-35"></span>
<span id="cb3-36">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.array(pts_with_norm_eq_val)</span></code></pre></div>
</div>
<p>Now, we can glean useful information by visualizing the set of points(vectors) with a given norm.</p>
<div class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">pts1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_vectors_eq_norm_val(</span>
<span id="cb4-2">    func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>infty_norm, val<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, lower_bound<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, upper_bound<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb4-3">)</span>
<span id="cb4-4"></span>
<span id="cb4-5">pts2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_vectors_eq_norm_val(</span>
<span id="cb4-6">    func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>one_norm, val<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, lower_bound<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, upper_bound<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span></span>
<span id="cb4-7">)</span>
<span id="cb4-8"></span>
<span id="cb4-9">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb4-10">plt.xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$x_1$"</span>)</span>
<span id="cb4-11">plt.ylabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$x_2$"</span>)</span>
<span id="cb4-12">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.scatter(pts1[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], pts1[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-13">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.scatter(pts2[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], pts2[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># c = plt.scatter(pts_with_unit_infty_norm[:,0],pts_with_unit_infty_norm[:,1],s=2)</span></span>
<span id="cb4-15"></span>
<span id="cb4-16">plt.legend(</span>
<span id="cb4-17">    (a, b), (<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$||\mathbf</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{x}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">||_\infty = 1$"</span>, <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$||\mathbf</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{x}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">||_1=2$"</span>), loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lower left"</span></span>
<span id="cb4-18">)</span>
<span id="cb4-19">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/norms/index_files/figure-html/cell-5-output-1.png" width="593" height="427" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The blue rectangle represents all vectors <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%5Cin%5CR%5E2"> with unit <img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201">. The orange rhombus represents all vectors <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D"> with <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%202">. All points on or outside the blue square represent vectors <img src="https://latex.codecogs.com/png.latex?%5Cbf%7By%7D">, such that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7By%7D%7D_%5Cinfty%20%5Cgeq%201">. Hence, if <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7By%7D%7D_1%20=%202">, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7By%7D%7D_%5Cinfty%20%5Cgeq%201">.</p>
<p>Now, pick any <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bz%7D%5Cneq%20%5Cbf%7B0%7D">. Then, <img src="https://latex.codecogs.com/png.latex?2%5Cnorm%7B%5Cfrac%7B%5Cbf%7Bz%7D%7D%7B%5Cnorm%7B%5Cbf%7Bz%7D%7D_1%7D%7D_1%20=2">. Thus, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cfrac%7B2%5Cbf%7Bz%7D%7D%7B%5Cnorm%7B%5Cbf%7Bz%7D%7D_1%7D%7D_%5Cinfty%20%5Cgeq%201">. So, it follows that if <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bz%7D%5Cin%5CR%5E2"> is any arbitrary vector, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bz%7D%7D_1%20%5Cleq%202%20%5Cnorm%7B%5Cbf%7Bz%7D%7D_%5Cinfty">.</p>
<p>In general, if <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%5Cin%5CC%5En">, then:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20&amp;=%20%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bi=1%7D%5En%20%5Cmax%5C%7B%7Cx_i%7C:i=1,2,%5Cldots,n%5C%7D%5C%5C%0A&amp;=%20n%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%0A%5Cend%7Balign*%7D%0A"></p>
<p>Next, in the below plot, the orange rhombus represents vectors <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%5Cin%5CR%5E2">, such that <img src="https://latex.codecogs.com/png.latex?%5Cnormp%7Bx%7D%7B1%7D%20=%201"> and all points on or outside the orange rhombus are such that <img src="https://latex.codecogs.com/png.latex?%5Cnormp%7By%7D%7B1%7D%20%5Cgeq%201">. The blue square represents vectors <img src="https://latex.codecogs.com/png.latex?%5Cnormp%7By%7D%7B%5Cinfty%7D%20=%201">. Consequently, if <img src="https://latex.codecogs.com/png.latex?%5Cnormp%7By%7D%7B1%7D%20=%201">, then <img src="https://latex.codecogs.com/png.latex?%5Cnormp%7By%7D%7B%5Cinfty%7D%20%5Cleq%20%5Cnormp%7By%7D%7B1%7D">. In general, if <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%5Cin%20C%5En">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnormp%7Bx%7D%7B%5Cinfty%7D%20&amp;=%20%5Cmax%5C%7B%7Cx_1%7C,%5Cldots,%7Cx_n%7C%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C=%5Cnormp%7Bx%7D%7B1%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Putting together, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnormp%7Bx%7D%7B%5Cinfty%7D%20%5Cleq%20C_%7B%5Cinfty,1%7D%20%5Cnormp%7Bx%7D%7B1%7D%20%5C%5C%0A%5Cnormp%7Bx%7D%7B1%7D%20%5Cleq%20C_%7B1,%5Cinfty%7D%20%5Cnormp%7Bx%7D%7B%5Cinfty%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?C_%7B%5Cinfty,1%7D%20=%201"> and <img src="https://latex.codecogs.com/png.latex?C_%7B1,%5Cinfty%7D=n">.</p>
<div class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">pts1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_vectors_eq_norm_val(</span>
<span id="cb5-2">    func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>infty_norm, val<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, lower_bound<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, upper_bound<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb5-3">)</span>
<span id="cb5-4"></span>
<span id="cb5-5">pts2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_vectors_eq_norm_val(</span>
<span id="cb5-6">    func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>one_norm, val<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, lower_bound<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, upper_bound<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span></span>
<span id="cb5-7">)</span>
<span id="cb5-8"></span>
<span id="cb5-9">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb5-10">plt.xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$x_1$"</span>)</span>
<span id="cb5-11">plt.ylabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$x_2$"</span>)</span>
<span id="cb5-12">a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.scatter(pts1[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], pts1[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-13">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.scatter(pts2[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], pts2[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb5-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># c = plt.scatter(pts_with_unit_infty_norm[:,0],pts_with_unit_infty_norm[:,1],s=2)</span></span>
<span id="cb5-15"></span>
<span id="cb5-16">plt.legend(</span>
<span id="cb5-17">    (a, b), (<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$||\mathbf</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{x}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">||_\infty = 1$"</span>, <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r"$||\mathbf</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{x}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">||_1=1$"</span>), loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lower left"</span></span>
<span id="cb5-18">)</span>
<span id="cb5-19">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/norms/index_files/figure-html/cell-6-output-1.png" width="600" height="427" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="deriving-the-constants-c_12-c_21" class="level3">
<h3 class="anchored" data-anchor-id="deriving-the-constants-c_12-c_21">Deriving the constants <img src="https://latex.codecogs.com/png.latex?C_%7B1,2%7D">, <img src="https://latex.codecogs.com/png.latex?C_%7B2,1%7D"></h3>
<p>We can also derive the constants <img src="https://latex.codecogs.com/png.latex?C_%7B1,2%7D"> and <img src="https://latex.codecogs.com/png.latex?C_%7B2,1%7D">. We have:</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%5Cin%5CC%5En"> be an arbitrary vector. And let <img src="https://latex.codecogs.com/png.latex?%5Cbf%7By%7D=(1+0i,%5Cldots,1+0i)">. By the Cauchy-Schwarz inequality,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%20%5Cleq%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5E2%5Cright)%5E%7B1/2%7D%5Csqrt%7Bn%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>So, our claim is <img src="https://latex.codecogs.com/png.latex?%5Cnormp%7Bx%7D%7B1%7D%20%5Cleq%20%5Csqrt%7Bn%7D%5Cnormp%7Bx%7D%7B2%7D">.</p>
<p>Also, consider the vector <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D=%5Cleft(%5Cfrac%7B1%7D%7B%5Csqrt%7Bn%7D%7D,%5Cldots,%5Cfrac%7B1%7D%7B%5Csqrt%7Bn%7D%7D%5Cright)">. <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bv%7D%7D_1%20=%20%5Csqrt%7Bn%7D%5Cnorm%7B%5Cbf%7Bv%7D%7D_2">. So, the bound is tight.</p>
<p>Moreover:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnormp%7Bx%7D%7B2%7D%5E2%20&amp;=%20%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5E2%20%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5E2%20+%20%5Csum_%7Bi%20%5Cneq%20j%7D%7Cx_i%7C%7Cx_j%7C%5C%5C%0A&amp;=%20%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5E2%20+%20%5Csum_%7Bi%20%3C%20j%7D2%7Cx_i%7C%7Cx_j%7C%5C%5C%0A&amp;=%20%5Cleft(%5Csum_%7Bi=1%7D%5En%20%7Cx_i%7C%5Cright)%5E2%0A%5Cend%7Balign*%7D%0A"></p>
<p>So, <img src="https://latex.codecogs.com/png.latex?%5Cnormp%7Bx%7D%7B2%7D%20%5Cleq%20%5Cnormp%7Bx%7D%7B1%7D">. Consider the standard basis vector <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Be%7D_1%20=%20(1,0,0,%5Cldots,0)">. <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Be%7D_1%7D_2%20=%20%5Cnorm%7B%5Cbf%7Be%7D_1%7D_1">. Hence, the bound is tight. We conclude that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnormp%7Bx%7D%7B1%7D%20%5Cleq%20C_%7B1,2%7D%20%5Cnormp%7Bx%7D%7B2%7D%5C%5C%0A%5Cnormp%7Bx%7D%7B2%7D%20%5Cleq%20C_%7B2,1%7D%20%5Cnormp%7Bx%7D%7B1%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?C_%7B1,2%7D%20=%20%5Csqrt%7Bn%7D"> and <img src="https://latex.codecogs.com/png.latex?C_%7B2,1%7D%20=%201">.</p>
</section>
<section id="deriving-the-constants-c_2infty-and-c_infty2" class="level3">
<h3 class="anchored" data-anchor-id="deriving-the-constants-c_2infty-and-c_infty2">Deriving the constants <img src="https://latex.codecogs.com/png.latex?C_%7B2,%5Cinfty%7D"> and <img src="https://latex.codecogs.com/png.latex?C_%7B%5Cinfty,2%7D"></h3>
<p>Let <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5CC%5En">. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7Bx%7D_2%5E2%20&amp;%20=%20%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%7C%5Cchi_i%7C%5E2%5C%5C%0A&amp;%5Cleq%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20(%5Cmax_%7Bi=0%7D%5E%7Bn-1%7D%7C%5Cchi_i%7C)%5E2%5C%5C%0A&amp;=%20n%20%5Cnorm%7Bx%7D_%5Cinfty%0A%5Cend%7Balign%7D%0A"></p>
<p>So, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7Bx%7D_2%20%5Cleq%20%5Csqrt%7Bn%7D%20%5Cnorm%7Bx%7D_%5Cinfty">.</p>
<p>Moreover, let <img src="https://latex.codecogs.com/png.latex?x%20=%20(1,%201,%20%5Cldots,%201)%5ET">. Then, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7Bx%7D_2%20=%20%5Csqrt%7Bn%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7Bx%7D_%5Cinfty%20=%201">, so <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7Bx%7D_2%20=%20%5Csqrt%7Bn%7D%5Cnorm%7Bx%7D_%5Cinfty">. Hence, it is a tight inequality.</p>
<p>Also, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7Bx%7D_%5Cinfty%5E2%20&amp;=%20%5Cmax%20%5C%7B%7C%5Cchi_0%7C%5E2,%7C%5Cchi_1%7C%5E2,%5Cldots,%7C%5Cchi_%7Bn-1%7D%5E2%7C%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Cmax%20%5C%7B%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%7C%5Cchi_i%7C%5E2,%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%7C%5Cchi_i%7C%5E2,%5Cldots,%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%7C%5Cchi_i%7C%5E2%7C%5C%7D%5C%5C%0A&amp;=%20%5Cnorm%7Bx%7D_2%5E2%0A%5Cend%7Balign*%7D%0A"></p>
<p>Moreover, let <img src="https://latex.codecogs.com/png.latex?x%20=%20(1,%200)">. Then, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7Bx%7D_2%20=%201"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7Bx%7D_%5Cinfty%20=%201">. So, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7Bx%7D_%5Cinfty%20=%20%5Cnorm%7Bx%7D_2">. Hence, the inequality is tight.</p>
</section>
</section>
<section id="matrix-norms" class="level2">
<h2 class="anchored" data-anchor-id="matrix-norms">Matrix Norms</h2>
<p>The analysis of matrix algorithms requires the use of matrix norms. For example, the quality of a linear system solution may be poor, if the matrix of coefficients is <em>nearly singular</em>. To quantify the notion of singularity, we need a measure of the distance on the space of matrices. Matrix norms can be used to provide that measure.</p>
<section id="definitions" class="level3">
<h3 class="anchored" data-anchor-id="definitions">Definitions</h3>
<p>Since <img src="https://latex.codecogs.com/png.latex?%5CR%5E%7Bm%20%5Ctimes%20n%7D"> is isomorphic <img src="https://latex.codecogs.com/png.latex?%5CR%5E%7Bmn%7D">, the definition of a matrix norm is equivalent to the definition of a vector norm. In particular, <img src="https://latex.codecogs.com/png.latex?f:%5CR%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> is a matrix norm, if the following three properties holds:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af(A)%20%5Cgeq%200,%20&amp;%20&amp;%20A%20%5Cin%20%5CR%5E%7Bm%20%5Ctimes%20n%7D%5C%5C%0Af(A%20+%20B)%20%5Cleq%20f(A)%20+%20f(B),%20&amp;%20&amp;%20A,B%20%5Cin%20%5CR%5E%7Bm%20%5Ctimes%20n%7D%5C%5C%0Af(%5Calpha%20A)%20=%20%7C%5Calpha%7Cf(A),%20&amp;%20&amp;%20%5Calpha%20%5Cin%20%5CR,%20A%20%5Cin%20%5CR%5E%7Bm%20%5Ctimes%20n%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>The most frequently used matrix norms in numerical linear algebra are the Frobenius norm and the <img src="https://latex.codecogs.com/png.latex?p">-norms.</p>
<div id="def-the-frobenius-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 8 (Frobenius Norm)</strong></span> The Frobenius norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_F%20:%20%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> is defined for <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5CC%5E%7Bm%20%5Ctimes%20n%7D"> by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D_F%20=%20%5Cleft(%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%20%7Ca_%7Bij%7D%7C%5E2%5Cright)%5E%7B1/2%7D%0A"></p>
</div>
<div id="thm-frobenius-norm-is-well-defined" class="theorem">
<p><span class="theorem-title"><strong>Theorem 10</strong></span> The Frobenius norm is a well-defined norm.</p>
</div>
<p><em>Proof.</em></p>
<p><em>Positive Semi-definite</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_F%20&amp;=%20%5Cleft(%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%20%7Ca_%7Bij%7D%7C%5E2%5Cright)%5E%7B1/2%7D%5C%5C%0A&amp;%5Cgeq%20%5Cleft(%20%7Ca_%7Bij%7D%7C%5E2%5Cright)%5E%7B1/2%7D%20=%20%7Ca_%7Bij%7D%7C%5C%5C%0A&amp;%5Cgeq%200%0A%5Cend%7Balign*%7D%0A"></p>
<p><em>Triangle Inequality</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%20+%20B%7D_F%5E2%20&amp;=%20%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%20%7Ca_%7Bij%7D%20+%20b_%7Bij%7D%7C%5E2%20%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%20%5Cleft(%7Ca_%7Bij%7D%7C%5E2%20+%20%7Cb_%7Bij%7D%7C%5E2%20+%202%7Ca_%7Bij%7D%7C%7Cb_%7Bij%7D%7C%5Cright)%5C%5C%0A&amp;=%20%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%20%7Ca_%7Bij%7D%7C%5E2%20+%20%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%20%7Cb_%7Bij%7D%7C%5E2%20+%202%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%7Ca_%7Bij%7D%7C%7Cb_%7Bij%7D%7C%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%20%7Ca_%7Bij%7D%7C%5E2%20+%20%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%20%7Cb_%7Bij%7D%7C%5E2%20+%202%5Cleft(%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%7Ca_%7Bij%7D%7C%5E2%5Cright)%5E%7B1/2%7D%5Cleft(%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%7Cb_%7Bij%7D%7C%5E2%5Cright)%5E%7B1/2%7D%20&amp;%20%5C%7B%5Ctext%7B%20Cauchy-Schwarz%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_F%5E2%20+%20%5Cnorm%7BB%7D_F%5E2%20+%202%5Cnorm%7BA%7D_F%20%5Cnorm%7BB%7D_F%5C%5C%0A&amp;=%20(%5Cnorm%7BA%7D_F%20+%20%5Cnorm%7BB%7D_F)%5E2%5C%5C%5C%5C%0A%5CLongrightarrow%20%5Cnorm%7BA%20+%20B%7D_F%20&amp;%5Cleq%20%5Cnorm%7BA%7D_F%20+%20%5Cnorm%7BB%7D_F%0A%5Cend%7Balign*%7D%0A"></p>
<p><em>Homogeneity</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Calpha%20A%7D_F%20&amp;=%20%5Cleft(%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%20%7C%5Calpha%20a_%7Bij%7D%7C%5E2%5Cright)%5E%7B1/2%7D%5C%5C%0A&amp;=%5Cleft(%5Csum_%7Bi=1%7D%5Em%20%5Csum_%7Bj=1%7D%5En%20%7C%5Calpha%7C%5E2%20%7Ca_%7Bij%7D%7C%5E2%5Cright)%5E%7B1/2%7D%5C%5C%0A&amp;=%20%7C%5Calpha%7C%20%5Cnorm%7BA%7D_F%0A%5Cend%7Balign*%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="def-induced-matrix-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 9 (Induced matrix norm)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cmu%20:%20%5CC%5Em%20%5Cto%20%5CR"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cnu%20:%20%5CC%5En%20%5Cto%20R"> be vector norms. Define <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%7B%5Cmu,%5Cnu%7D%20:%20%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20R"> by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D_%7B%5Cmu,%5Cnu%7D%20=%20%5Csup_%7B%5Cbf%7Bx%7D%5Cneq%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%0A"></p>
<p>Matrix norms that are defined in this way are called <em>induced</em> matrix norms.</p>
</div>
<p>Let us start by interpreting this. How <em>large</em> <img src="https://latex.codecogs.com/png.latex?A"> is, as measured by <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%7B%5Cmu,%5Cnu%7D"> is defined as the most that <img src="https://latex.codecogs.com/png.latex?A"> magnifies the length of non-zero vectors, where the length of the <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D"> is measured with the norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cnu"> and the length of the transformed vector <img src="https://latex.codecogs.com/png.latex?A%5Cbf%7Bx%7D"> is measured with the norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cmu">.</p>
<p>Two comments are in order. First,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csup_%7B%5Cbf%7Bx%7D%5Cneq%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20=%20%5Csup_%7B%5Cbf%7Bx%7D%20%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cnorm%7BA%5Cfrac%7B%5Cbf%7Bx%7D%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%7D_%5Cmu%20=%20%5Csup_%7B%5Cnorm%7B%5Cbf%7Bu%7D%7D_%5Cnu%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bu%7D%7D_%5Cmu%0A%5Cend%7Balign*%7D%0A"></p>
<p>Second, it is not immediately obvious, that there is a vector <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D"> for which a supremum is attained. The fact is there is always such a vector <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D">. The <img src="https://latex.codecogs.com/png.latex?K=%5C%7B%5Cbf%7Bu%7D:%5Cnorm%7B%5Cbf%7Bu%7D%7D_%5Cnu%20=%201%5C%7D"> is a compact set, and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cmu%20:%20%5CC%5Em%20%5Cto%20%5CR"> is a continuous function. Continuous functions preserve compact sets. So, the supremum exists and further it belongs to <img src="https://latex.codecogs.com/png.latex?%5C%7BA%5Cbf%7Bx%7D:%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%20=%201%5C%7D">.</p>
<div id="thm-the-induced-matrix-norm-is-well-defined" class="theorem">
<p><span class="theorem-title"><strong>Theorem 11</strong></span> The induced matrix norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%7B%5Cmu,%5Cnu%7D%20:%20%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> is a well-defined norm.</p>
</div>
<p><em>Proof</em></p>
<p>To prove this, we merely check if the three conditions are met:</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?A,B%20%5Cin%20%5CC%5E%7Bm%20%5Ctimes%20n%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Calpha%20%5Cin%20%5CC"> be arbitrarily chosen. Then:</p>
<p><em>Positive definite</em></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?A%20%5Cneq%200">. That means, at least one of the columns of <img src="https://latex.codecogs.com/png.latex?A"> is not a zero-vector. Partition <img src="https://latex.codecogs.com/png.latex?A"> by columns:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5B%0A%20%20%20%20%5Cbegin%7Barray%7D%7Bc%7Cc%7Cc%7Cc%7D%0A%20%20%20%20%20%20%20%20a_%7B1%7D%20&amp;%20a_2%20&amp;%20%5Cldots%20&amp;%20a_%7Bn%7D%0A%20%20%20%20%5Cend%7Barray%7D%0A%5Cright%5D%0A"></p>
<p>Let us assume that, it is the <img src="https://latex.codecogs.com/png.latex?j">-th column <img src="https://latex.codecogs.com/png.latex?a_j">, that is non-zero. Let <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Be%7D_j"> be the column of <img src="https://latex.codecogs.com/png.latex?I">(the identity matrix) indexed with <img src="https://latex.codecogs.com/png.latex?j">. Then:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_%7B%5Cmu,%5Cnu%7D%20&amp;=%20%5Csup%20%5Cfrac%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;%5Cgeq%20%5Cfrac%7B%5Cnorm%7BA%5Cbf%7Be%7D_j%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Be%7D_j%7D_%5Cnu%7D%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cnorm%7Ba_j%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Be%7D_j%7D_%5Cnu%7D%20&amp;%20%5C%7B%20A%5Cbf%7Be%7D_j%20=%20a_j%20%5C%7D%5C%5C%0A&amp;%3E%200%20&amp;%20%5C%7B%20%5Ctext%7B%20we%20assumed%20%7D%20a_j%20%5Cneq%20%5Cbf%7B0%7D%5C%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p><em>Homogeneity</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Calpha%20A%7D_%7B%5Cmu,%5Cnu%7D%20&amp;=%20%5Csup_%7B%5Cbf%7Bx%7D%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7B%5Calpha%20A%20%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Csup_%7B%5Cbf%7Bx%7D%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cfrac%7B%7C%5Calpha%7C%5Cnorm%7BA%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Homogeneity%20of%20vector%20norm%20%7D%5Cnorm%7B%5Ccdot%7D_%5Cmu%5C%7D%5C%5C%0A&amp;=%20%7C%5Calpha%7C%5Csup_%7B%5Cbf%7Bx%7D%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Algebra%20%7D%5C%7D%5C%5C%0A&amp;=%20%7C%5Calpha%7C%5Cnorm%7BA%7D_%7B%5Cmu,%5Cnu%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p><em>Triangle Inequality</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%20+%20B%7D_%7B%5Cmu,%5Cnu%7D%20&amp;=%20%5Cmax_%7B%5Cbf%7Bx%7D%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7B(A%20+%20B)%20%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cbf%7Bx%7D%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7B(A%5Cbf%7Bx%7D%20+%20B%5Cbf%7Bx%7D)%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Distribute%20%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cbf%7Bx%7D%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7B(A%5Cbf%7Bx%7D%7D_%5Cmu%20+%20%5Cnorm%7BB%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Triangle%20inequality%20for%20vector%20norms%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cbf%7Bx%7D%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cleft(%5Cfrac%7B%5Cnorm%7B(A%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20+%20%5Cfrac%7B%5Cnorm%7B(A%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20%5Cright)%20&amp;%20%5C%7B%20%5Ctext%7B%20Algebra%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cbf%7Bx%7D%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7B(A%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20+%20%5Cmax_%7B%5Cbf%7Bx%7D%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7B(A%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cnu%7D%20%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_%7B%5Cmu,%5Cnu%7D%20+%20%5Cnorm%7BB%7D_%7B%5Cmu,%5Cnu%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<p>When <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cmu"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cnu"> are the same norm, the induced norm becomes:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D_%5Cmu%20=%20%5Cmax_%7B%5Cbf%7Bx%7D%5Cneq%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_%5Cmu%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cmu%7D%0A"></p>
<p>or equivalently:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D_%5Cmu%20=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bu%7D%7D_%5Cmu%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bu%7D%7D_%5Cmu%0A"></p>
<div id="exm-p-norm-is-the-same" class="theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> Consider the vector <img src="https://latex.codecogs.com/png.latex?p">-norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_p:%5CC%5En%20%5Cto%20%5CR"> and let us denote the induced matrix norm <img src="https://latex.codecogs.com/png.latex?%7C%7C%7C%5Ccdot%7C%7C%7C:%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> by <img src="https://latex.codecogs.com/png.latex?%7C%7C%7CA%7C%7C%7C%20=%20%5Cmax_%7B%5Cbf%7Bx%7D%5Cneq%5Cbf%7B0%7D%7D%5Cfrac%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_p%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_p%7D">. Prove that <img src="https://latex.codecogs.com/png.latex?%7C%7C%7C%5Cbf%7By%7D%7C%7C%7C%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_p"> for all <img src="https://latex.codecogs.com/png.latex?%5Cbf%7By%7D%5Cin%5CC%5Em">.</p>
</div>
<p><em>Proof</em>.</p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%7C%7C%7C%5Cbf%7By%7D%7C%7C%7C%20&amp;=%20%5Cfrac%7B%5Cnorm%7B%5Cbf%7By%7Dx%7D_p%7D%7B%5Cnorm%7Bx%7D_p%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cfrac%7B%7Cx_1%7C%20%5Cnorm%7B%5Cbf%7By%7D%7D_p%7D%7B%7Cx_1%7C%7D%20&amp;%20%5C%7B%20x%20%5Ctext%7B%20has%20to%20be%20%7D%201%20%5Ctimes%201,%20%5Ctext%7B%20a%20scalar%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cnorm%7B%5Cbf%7By%7D%7D_p%0A%5Cend%7Balign*%7D%0A"></p>
<p>The last example is important. One can view a vector <img src="https://latex.codecogs.com/png.latex?%5Cbf%7By%7D%5Cin%20%5CC%5Em"> as an <img src="https://latex.codecogs.com/png.latex?m%20%5Ctimes%201"> matrix. What this last exercise tells us is that regardless of whether we view <img src="https://latex.codecogs.com/png.latex?%5Cbf%7By%7D"> as a matrix or a vector, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7By%7D_p"> is the same.</p>
<p>We already encountered the vector <img src="https://latex.codecogs.com/png.latex?p">-norms as an important class of vector norms. The matrix <img src="https://latex.codecogs.com/png.latex?p">-norm is induced by the corresponding vector norm.</p>
<div id="def-the-matrix-p-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 10 (The matrix <img src="https://latex.codecogs.com/png.latex?p">-norm)</strong></span> For any vector <img src="https://latex.codecogs.com/png.latex?p">-norm, define the corresponding matrix <img src="https://latex.codecogs.com/png.latex?p">-norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_p%20:%20%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D_p%20=%20%5Cmax_%7B%5Cbf%7Bx%7D%5Cneq%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_p%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_p%7D%20%5Cquad%20%5Ctext%7B%20or%20equivalently%20%7D%20%5Cquad%20%5Cnorm%7BA%7D_p%20=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_p%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_p%0A"></p>
</div>
<p>In practice, the matrix <img src="https://latex.codecogs.com/png.latex?2">-norm is of great theoretical importance, but difficult to evaluate, except for special matrices. The <img src="https://latex.codecogs.com/png.latex?1">-norm, the <img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm and Frobenius norms are straightforward and relatively cheap to compute.</p>
<p>Let us instantiate the definition of the vector <img src="https://latex.codecogs.com/png.latex?p">-norm where <img src="https://latex.codecogs.com/png.latex?p=2">, giving us a matrix norm induced by the vector <img src="https://latex.codecogs.com/png.latex?2">-norm or the Euclidean norm:</p>
<div id="def-the-matrix-2-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 11 (The matrix <img src="https://latex.codecogs.com/png.latex?2">-norm)</strong></span> Define the matrix <img src="https://latex.codecogs.com/png.latex?2">-norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_2:%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> by :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D_2%20=%20%5Cmax_%7B%5Cbf%7Bx%7D%5Cneq%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%7D%20=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%0A"></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The problem with the matrix <img src="https://latex.codecogs.com/png.latex?2">-norm is that it is hard to compute. In future posts, we shall find out that if <img src="https://latex.codecogs.com/png.latex?A"> is a Hermitian matrix (<img src="https://latex.codecogs.com/png.latex?A%20=%20A%5EH">), then <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%20%7C%5Clambda_1%7C"> where <img src="https://latex.codecogs.com/png.latex?%5Clambda_1"> is the eigenvalue of <img src="https://latex.codecogs.com/png.latex?A"> that is largest in magnitude.</p>
<p>Recall from basic linear algebra, that computing eigenvalues involves computing the roots of polynomials, and for polynomials of degree three or greater, this is a non-trivial task. We shall see that the matrix <img src="https://latex.codecogs.com/png.latex?2">-norm plays an important part in theory, but less so in practical computation.</p>
</div>
</div>
<div id="exm-matrix-2-norm-of-diagonal-matrix" class="theorem example">
<p><span class="theorem-title"><strong>Example 2</strong></span> Show that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%7D_2%20=%20%5Cmax(%7Cd_1%7C,%7Cd_2%7C)%0A"></p>
</div>
<p><em>Solution</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%7D_2%5E2%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7Dx_1%20%5C%5C%20x_2%5Cend%7Bbmatrix%7D%7D_2%5E2%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%7Cd_1x_1%7C%5E2%20+%20%7Cd_2%20x_2%7C%5E2%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5B%5Cmax(%7Cd_1%7C,%7Cd_2%7C)%5E2%20%7Cx_1%7C%5E2%20+%20%5Cmax(%7Cd_1%7C,%7Cd_2%7C)%5E2%20%7Cx_2%7C%5E2%5D%5C%5C%0A&amp;=%20%5Cmax(%7Cd_1%7C,%7Cd_2%7C)%5E2%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20(%7Cx_1%7C%5E2%20+%20%7Cx_2%7C%5E2)%5C%5C%0A&amp;=%20%5Cmax(%7Cd_1%7C,%7Cd_2%7C)%5E2%0A%5Cend%7Balign*%7D%0A"></p>
<p>Moreover, if we take <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%20=%20%5Cbf%7Be%7D_1"> and <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D=%5Cbf%7Be%7D_2">, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%7D_2%5E2%20%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7Dx_1%20%5C%5C%20x_2%5Cend%7Bbmatrix%7D%7D_2%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;%5Cgeq%20%20%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D1%20%5C%5C%200%5Cend%7Bbmatrix%7D%7D_2%5E2%20%5C%5C%0A&amp;=%20%7Cd_1%7C%5E2%0A%5Cend%7Balign*%7D%0A"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%7D_2%5E2%20%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7Dx_1%20%5C%5C%20x_2%5Cend%7Bbmatrix%7D%7D_2%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;%5Cgeq%20%20%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D0%20%5C%5C%201%5Cend%7Bbmatrix%7D%7D_2%20%5C%5C%0A&amp;=%20%7Cd_2%7C%5E2%0A%5Cend%7Balign*%7D%0A"></p>
<p>Consequently,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%7D_2%5E2%20%5Cgeq%20%5Cmax(%7Cd_1%7C,%7Cd_2%7C)%5E2%0A"></p>
<p>We conclude that</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0Ad_1%20&amp;%200%20%5C%5C%0A0%20&amp;%20d_2%0A%5Cend%7Bbmatrix%7D%7D_2%20=%20%5Cmax(%7Cd_1%7C,%7Cd_2%7C)%0A"></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The proof of the last example builds on a general principle: Showing that <img src="https://latex.codecogs.com/png.latex?%5Cmax_%7Bx%20%5Cin%20D%7D%20f(x)%20=%20%5Calpha"> for some function <img src="https://latex.codecogs.com/png.latex?f:D%20%5Cto%20%5CR"> can be broken down into showing that both:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmax_%7Bx%20%5Cin%20D%7D%20f(x)%20%5Cleq%20%5Calpha%0A"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmax_%7Bx%20%5Cin%20D%7D%20f(x)%20%5Cgeq%20%5Calpha%0A"></p>
<p>In turn, showing that <img src="https://latex.codecogs.com/png.latex?%5Cmax_%7Bx%20%5Cin%20D%7Df(x)%20%5Cgeq%20%5Calpha"> can often be accomplished by showing that there exists a vector <img src="https://latex.codecogs.com/png.latex?y%20%5Cin%20D"> such that <img src="https://latex.codecogs.com/png.latex?f(y)%20=%20%5Calpha"> since then</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmax_%7Bx%20%5Cin%20D%7Df(x)%20%5Cgeq%20f(y)%20=%20%5Calpha%0A"></p>
<p>We will use this technique in future proofs involving matrix norms.</p>
</div>
</div>
<div id="exr-2-norm-of-a-diag-matrix" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> Let <img src="https://latex.codecogs.com/png.latex?D%20%5Cin%20C%5E%7Bm%20%5Ctimes%20m%7D"> be a diagonal matrix <img src="https://latex.codecogs.com/png.latex?diag(d_1,d_2,%5Cldots,d_m)">. Show that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BD%7D_2%20=%20%5Cmax_%7Bj=1%7D%5E%7Bm%7D%20%7Cd_j%7C%0A"></p>
</div>
<p><em>Solution.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BD%7D_2%5E2%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Cnorm%7B%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20d_1%20%5C%5C%0A%20%20%20%20&amp;%20d_2%20%5C%5C%0A%20%20%20%20&amp;%20&amp;%20%5Cddots%5C%5C%0A%20%20%20%20&amp;%20&amp;%20&amp;%20d_m%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20x_1%5C%5C%0A%20%20%20%20x_2%5C%5C%0A%20%20%20%20%5Cvdots%5C%5C%0A%20%20%20%20x_m%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%7D_2%5E2%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;=%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Cnorm%7B%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20d_1%20x_1%5C%5C%0A%20%20%20%20d_2%20x_2%5C%5C%0A%20%20%20%20%5Cvdots%5C%5C%0A%20%20%20%20d_m%20x_m%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%7D_2%5E2%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Csum_%7Bj=1%7D%5Em%20%7Cd_j%20x_j%7C%5E2%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Csum_%7Bj=1%7D%5Em%20%5Cmax(%7Cd_1%7C,%5Cldots,%7Cd_m%7C)%5E2%20%7Cx_j%7C%5E2%5C%5C%0A&amp;=%20%5Cmax(%7Cd_1%7C,%5Cldots,%7Cd_m%7C)%5E2%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Csum_%7Bj=1%7D%5Em%20%7Cx_j%7C%5E2%20%5C%5C%0A&amp;=%20%5Cmax(%7Cd_1%7C,%5Cldots,%7Cd_m%7C)%5E2%0A%5Cend%7Balign*%7D%0A"></p>
<p>Moreover, if we take take <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%20=%20%5Cbf%7Be%7D_j">, the standard basis vector with its <img src="https://latex.codecogs.com/png.latex?j">-th coordinate equal to one, we find that</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BD%7D_2%5E2%20%5Cgeq%20%7Cd_j%7C%5E2%0A"></p>
<p>Consequently, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BD%7D_2%5E2%20%5Cgeq%20%5Cmax(%7Cd_1%7C,%5Cldots,%7Cd_m%7C)%5E2">.</p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="exr-properties-of-two-norm-1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> Let <img src="https://latex.codecogs.com/png.latex?%5Cbf%7By%7D%5Cin%5CC%5Em"> and <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%20%5Cin%20%5CC%5En">. Show that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7B%5Cbf%7By%7D%5Cbf%7Bx%7D%5EH%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%0A"></p>
</div>
<p><em>Proof</em>.</p>
<p>From the Cauchy-Schwarz inequality, we know that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7Cx%5EH%20z%7C%20%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%5EH%7D_2%20%5Cnorm%7B%5Cbf%7Bz%7D%7D_2%0A"></p>
<p>Now, <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%5EH%20%5Cin%20%5CC%5E%7B1%20%5Ctimes%20n%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bz%7D%20%5Cin%20%5CC%5E%7Bn%20%5Ctimes%201%7D">. So, <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%5EH%20%5Cbf%7Bz%7D%20%5Cin%20%5CC%5E%7B1%20%5Ctimes%201%7D">, and it is a scalar.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7By%7D%5Cbf%7Bx%7D%5EH%7D_2%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bz%7D%7D_2%20=%201%7D%20%5Cnorm%7B%5Cbf%7By%7D%5Cbf%7Bx%7D%5EH%20%5Cbf%7Bz%7D%7D_2%20%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bz%7D%7D_2%20=%201%7D%20%7C%5Cbf%7Bx%7D%5EH%20%5Cbf%7Bz%7D%7C%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20%5C%7B%20%5Cbf%7Bx%7D%5EH%5Cbf%7Bz%7D%5Ctext%7B%20is%20scalar%20%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bz%7D%7D_2%20=%201%7D%20%5Cnorm%7B%5Cbf%7Bx%7D%5EH%7D_2%20%5Cnorm%7B%5Cbf%7Bz%7D%7D_2%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20%5C%5C%0A&amp;=%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%0A%5Cend%7Balign*%7D%0A"></p>
<p>On the other hand,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7B%5Cbf%7By%7D%5Cbf%7Bx%7D%5EH%7D_2%20&amp;=%20%5Cmax_%7B%5Cbf%7Bz%7D%5Cneq%20%5Cbf%7B0%7D%7D%20%5Cfrac%7B%5Cnorm%7B%5Cbf%7By%7D%5Cbf%7Bx%7D%5EH%20%5Cbf%7Bz%7D%7D_2%7D%7B%5Cnorm%7B%5Cbf%7Bz%7D%7D_2%7D%5C%5C%0A&amp;%5Cgeq%20%5Cfrac%7B%5Cnorm%7B%5Cbf%7By%7D%5Cbf%7Bx%7D%5EH%20%5Cbf%7Bx%7D%7D_2%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%7D%20&amp;%20%5C%7B%20%5Ctext%7B%20Specific%20%7D%5Cbf%7Bz%7D%20%5C%7D%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cnorm%7B%5Cbf%7By%7D%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%5E2%7D_2%7D%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%7D%20&amp;%20%5C%7B%20%5Cbf%7Bx%7D%5EH%20%5Cbf%7Bx%7D%20=%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%5E2%5C%7D%5C%5C%0A&amp;=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%0A%5Cend%7Balign*%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="exr-properties-of-two-norm-2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3</strong></span> Let <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5CC%5E%7Bm%20%5Ctimes%20n%7D"> and <img src="https://latex.codecogs.com/png.latex?a_j"> be its column indexed with <img src="https://latex.codecogs.com/png.latex?j">. Prove that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7Ba_j%7D_2%20%5Cleq%20%5Cnorm%7BA%7D_2%0A"></p>
</div>
<p><em>Proof.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_2%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bz%7D%7D_2%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bz%7D%7D_2%20%5C%5C%0A&amp;%5Cgeq%20%20%5Cnorm%7BA%5Cbf%7Be%7D_j%7D_2%5C%5C%0A&amp;=%20%5Cnorm%7Ba_j%7D_2%0A%5Cend%7Balign*%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="exr-properties-of-two-norm-3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4</strong></span> Let <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5CC%5E%7Bm%20%5Ctimes%20n%7D">. Prove that:</p>
<ol type="i">
<li><p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D_2%20=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%7C%5Cbf%7By%7D%5EH%20A%20%5Cbf%7Bx%7D%7C%0A"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%5EH%7D_2%20=%20%5Cnorm%7BA%7D_2%0A"></p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%5EH%20A%7D_2%20=%20%5Cnorm%7BA%7D_2%5E2%0A"></p></li>
</ol>
</div>
<p><em>Claim</em>.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D_2%20=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%7C%5Cbf%7By%7D%5EH%20A%20%5Cbf%7Bx%7D%7C%0A"></p>
<p><em>Proof.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%7C%5Cbf%7By%7D%5EH%20A%20%5Cbf%7Bx%7D%7C%20&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%5Cnorm%7B%5Cbf%7By%7D%5EH%7D_2%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%20&amp;%20%5C%7B%20%5Ctext%7B%20Cauchy-Schwarz%20%7D%5C%7D%20%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20%7D%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_2%0A%5Cend%7Balign*%7D%0A"></p>
<p>On the other hand:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%7C%5Cbf%7By%7D%5EH%20A%20%5Cbf%7Bx%7D%7C%20&amp;%5Cgeq%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%7C%5Cleft(%5Cfrac%7BA%5Cbf%7Bx%7D%7D%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%7D%5Cright)%5EH%20A%20%5Cbf%7Bx%7D%7C%20&amp;%20%5C%7B%5Ctext%7B%20Specific%20vector%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Cfrac%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%5E2%7D%7B%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%7D%5C%5C%0A&amp;=%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_2%0A%5Cend%7Balign*%7D%0A"></p>
<p>We have the desired result.</p>
<p><em>Claim</em>.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%5EH%7D_2%20=%20%5Cnorm%7BA%7D_2%0A"></p>
<p><em>Proof.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%5EH%7D_2%5E2%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Cnorm%7BA%5EH%5Cbf%7Bx%7D%7D_2%5E2%20%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%7C(A%5EH%20%5Cbf%7Bx%7D)%5EH%20(A%5EH%20%5Cbf%7Bx%7D)%7C%0A%5Cend%7Balign*%7D%0A"></p>
<p><em>Claim.</em></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%5EH%7D_2%20=%20%5Cnorm%7BA%7D_2%0A"></p>
<p><em>Proof.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%5EH%7D_2%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%7C%5Cbf%7By%7D%5EH%20A%5EH%20%5Cbf%7Bx%7D%7C%20%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%7C%5Cbf%7Bx%7D%5EH%20A%20%5Cbf%7By%7D%7C%20&amp;%20%5C%7B%20%7C%5Coverline%20%5Calpha%7C%20=%20%7C%5Calpha%7C%20%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%5Cnorm%7BA%20%5Cbf%7By%7D%7D_2%20%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_2%0A%5Cend%7Balign*%7D%0A"></p>
<p><em>Claim</em></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%5EH%20A%7D_2%20=%20%5Cnorm%7BA%7D_2%5E2%0A"></p>
<p><em>Proof.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%5EH%20A%7D_2%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%7C%5Cbf%7By%7D%5EH%20A%5EH%20A%20%5Cbf%7Bx%7D%7C%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%5Cnorm%7B%5Cbf%7By%7D%5EH%20A%5EH%7D_2%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%20&amp;%20%5C%7B%20%5Ctext%7B%20Cauchy-Schwarz%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%5Cnorm%7BA%5Cbf%7By%7D%7D_2%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%20%20&amp;%20%5C%7B%20%5Cnorm%7BA%5EH%7D_2%20=%20%5Cnorm%7BA%7D_2%20%5C%7D%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_2%5E2%0A%5Cend%7Balign*%7D%0A"></p>
<p>Moreover:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%5EH%20A%7D_2%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%7C%5Cbf%7By%7D%5EH%20A%5EH%20A%20%5Cbf%7Bx%7D%7C%5C%5C%0A&amp;%5Cgeq%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%20%7C%5Cbf%7Bx%7D%5EH%20A%5EH%20A%20%5Cbf%7Bx%7D%7C%20%5C%7B%20%5Ctext%7B%20Restrict%20the%20choices%20of%20%7D%5Cbf%7By%7D%5C%7D%5C%5C%0A&amp;=%20%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%20%7C(A%5Cbf%7Bx%7D)%5EH%20(A%20%5Cbf%7Bx%7D)%7C%20%5C%5C%0A&amp;=%20%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%201%7D%20%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_2%5E2%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_2%5E2%0A%5Cend%7Balign*%7D%0A"></p>
<div id="exr-properties-of-two-norm-4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 5</strong></span> Partition</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cleft%5B%0A%20%20%20%20%5Cbegin%7Barray%7D%7Bc%7Cc%7Cc%7D%0A%20%20%20%20%20%20%20%20A_%7B1,1%7D%20&amp;%20%5Cldots%20&amp;%20A_%7B1,N%7D%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Cvdots%20&amp;%20&amp;%20%5Cvdots%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20A_%7BM,1%7D%20&amp;%20%5Cldots%20&amp;%20A_%7BM,N%7D%0A%20%20%20%20%5Cend%7Barray%7D%0A%5Cright%5D%0A"></p>
<p>Prove that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA_%7Bi,j%7D%7D_2%20%5Cleq%20%5Cnorm%7BA%7D_2">.</p>
</div>
<p><em>Proof.</em></p>
<p>By definition,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA_%7Bi,j%7D%7D_2%20=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%7C%5Cbf%7By%7D%5EH%20A_%7Bi,j%7D%20%5Cbf%7Bx%7D%7C%0A%5Cend%7Balign*%7D%0A"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201"> is a compact set, the above maximum exists. There exists <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bw%7D_i"> and <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bv%7D_j">, satisfying <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bw%7D_i%7D_2%20=%20%5Cnorm%7B%5Cbf%7Bv%7D_j%7D_2%20=%201"> such that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA_%7Bi,j%7D%7D_2%20=%20%7C%5Cbf%7Bw%7D_i%5EH%20A_%7Bi,j%7D%20%5Cbf%7Bv%7D_j%7C%0A%5Cend%7Balign*%7D%0A"></p>
<p>Next, we choose</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbf%7Bw%7D%20=%20%5Cleft%5B%0A%20%20%20%20%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%200%20%5C%5C%0A%20%20%20%20%5Chline%0A%20%20%20%200%20%5C%5C%0A%20%20%20%20%5Chline%0A%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20%5Chline%0A%20%20%20%20%5Cbf%7Bw%7D_i%5C%5C%0A%20%20%20%20%5Chline%0A%20%20%20%200%20%5C%5C%0A%20%20%20%20%5Chline%0A%20%20%20%20%5Cvdots%5C%5C%0A%20%20%20%200%0A%20%20%20%20%5Cend%7Barray%7D%0A%5Cright%5D%20%5Cquad%0A%5Cbf%7Bv%7D%20=%20%5Cleft%5B%0A%20%20%20%20%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%200%20%5C%5C%0A%20%20%20%20%5Chline%0A%20%20%20%200%20%5C%5C%0A%20%20%20%20%5Chline%0A%20%20%20%20%5Cvdots%20%5C%5C%0A%20%20%20%20%5Chline%0A%20%20%20%20%5Cbf%7Bv%7D_j%5C%5C%0A%20%20%20%20%5Chline%0A%20%20%20%200%20%5C%5C%0A%20%20%20%20%5Chline%0A%20%20%20%20%5Cvdots%5C%5C%0A%20%20%20%200%0A%20%20%20%20%5Cend%7Barray%7D%0A%5Cright%5D%0A"></p>
<p>Consider:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_2%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20=%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%201%7D%20%7C%5Cbf%7By%7D%5EH%20A%20%5Cbf%7Bx%7D%7C%5C%5C%0A&amp;%20%5Cgeq%20%7C%5Cbf%7Bw%7D%5EH%20A%20%5Cbf%7Bv%7D%7C%5C%5C%0A&amp;=%20%7C%5Cbf%7Bw%7D_j%5EH%20A_%7Bi,j%7D%20%5Cbf%7Bv%7D_i%7C%5C%5C%0A&amp;=%20%5Cnorm%7BA_%7Bi,j%7D%7D_2%0A%5Cend%7Balign*%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="computing-the-matrix-1-norm-and-infty-norm" class="level3">
<h3 class="anchored" data-anchor-id="computing-the-matrix-1-norm-and-infty-norm">Computing the matrix <img src="https://latex.codecogs.com/png.latex?1">-norm and <img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm</h3>
<p>The matrix <img src="https://latex.codecogs.com/png.latex?1">-norm and the matrix <img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm are of great importance, because, unlike the matrix <img src="https://latex.codecogs.com/png.latex?2">-norm, they are easy and relatively cheap to compute. The following exercises show how to practically compute the matrix <img src="https://latex.codecogs.com/png.latex?1">-norm and <img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm.</p>
<div id="exr-exercise-on-matrix-1-norm-1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 6</strong></span> Let <img src="https://latex.codecogs.com/png.latex?A%20=%20%5CC%5E%7Bm%20%5Ctimes%20n%7D"> and partition <img src="https://latex.codecogs.com/png.latex?A%20=%20%5Ba_1%20%7C%20a_2%20%7C%20%5Cldots%20%7C%20a_n%5D">. Prove that</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D_1%20=%20%5Cmax_%7B1%20%5Cleq%20j%20%5Cleq%20n%7D%5Cnorm%7Ba_j%7D_1%0A"></p>
</div>
<p><em>Proof</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_1%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_1%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%201%7D%20%5Cnorm%7Ba_1%20x_1%20+%20a_2%20x_2%20+%20%5Cldots%20+%20a_n%20x_n%7D_1%20&amp;%20%5C%7B%20%5Ctext%7B%20Algebra%20%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%201%7D%20%5Cnorm%7Ba_1%20x_1%7D_1%20+%20%5Cnorm%7Ba_2%20x_2%7D_1%20+%20%5Cldots%20+%20%5Cnorm%7Ba_n%20x_n%7D_1%20&amp;%20%5C%7B%20%5Ctext%7B%20Triangle%20Inequality%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%201%7D%20%7Cx_1%7C%20%5Cnorm%7Ba_1%7D_1%20+%20%7Cx_2%7C%20%5Cnorm%7Ba_2%7D_1%20+%20%5Cldots%20+%20%7Cx_n%7C%20%5Cnorm%7Ba_n%7D_1%20%20&amp;%20%5C%7B%20%5Ctext%7B%20Homogeneity%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%201%7D%20%20%7Cx_1%7C%20(%5Cmax_%7B1%20%5Cleq%20j%20%5Cleq%20n%7D%20%5Cnorm%7Ba_j%7D_1)%20+%20%7Cx_2%7C%20(%5Cmax_%7B1%20%5Cleq%20j%20%5Cleq%20n%7D%20%5Cnorm%7Ba_j%7D_1)+%20%5Cldots%20+%20%7Cx_n%7C%20(%5Cmax_%7B1%20%5Cleq%20j%20%5Cleq%20n%7D%20%5Cnorm%7Ba_j%7D_1)%5C%5C%0A&amp;=%20%5Cmax_%7B1%20%5Cleq%20j%20%5Cleq%20n%7D%20%5Cnorm%7Ba_j%7D_1%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%201%7D%20%5Csum_%7Bj=1%7D%5En%20%7Cx_j%7C%5C%5C%0A&amp;=%20%5Cmax_%7B1%20%5Cleq%20j%20%5Cleq%20n%7D%20%5Cnorm%7Ba_j%7D_1%0A%5Cend%7Balign*%7D%0A"></p>
<p>On the other hand,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_1%20%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_1%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_1%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%5C%5C%0A&amp;%5Cgeq%20%5Cnorm%7BA%5Cbf%7Be%7D_j%7D_1%20&amp;%20%5C%7B%20%5Ctext%7B%20Specific%20vector%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cnorm%7Ba_j%7D_1%0A%5Cend%7Balign*%7D%0A"></p>
<p>This concludes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="exr-exercise-on-matrix-infty-norm" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7</strong></span> Let <img src="https://latex.codecogs.com/png.latex?A%20=%20%5CC%5E%7Bm%20%5Ctimes%20n%7D"> and partition</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cleft%5B%0A%20%20%20%20%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_0%5ET%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_1%5ET%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Cvdots%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_%7Bm-1%7D%5ET%5C%5C%0A%20%20%20%20%5Cend%7Barray%7D%0A%5Cright%5D%0A"></p>
<p>Prove that</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D_%5Cinfty%20=%20%5Cmax_%7B0%5Cleq%20i%20%3C%20m%7D%20%5Cnorm%7B%5Ctilde%7Ba%7D_i%7D_1%20=%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%20(%7C%5Calpha_%7Bi,0%7D%7C%20+%20%7C%5Calpha_%7Bi,1%7D%7C%20+%20%5Cldots%20+%20%7C%5Calpha_%7Bi,n-1%7D%7C)%0A"></p>
</div>
<p>*Notice that in this exercise, <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7Ba%7D_i"> is really <img src="https://latex.codecogs.com/png.latex?(%5Ctilde%7Ba%7D_i%5ET)%5ET">, since <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7Ba%7D_i%5ET"> is the label for the <img src="https://latex.codecogs.com/png.latex?i">-th row of the matrix.</p>
<p><em>Proof</em>.</p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_%5Cinfty%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_%5Cinfty%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%20%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201%7D%20%5Cnorm%7B%5Cleft%5B%0A%20%20%20%20%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_0%5ET%20%5Cbf%7Bx%7D%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_1%5ET%20%5Cbf%7Bx%7D%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Cvdots%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_%7Bm-1%7D%5ET%20%5Cbf%7Bx%7D%5C%5C%0A%20%20%20%20%5Cend%7Barray%7D%0A%5Cright%5D%7D_%5Cinfty%20&amp;%20%5C%7B%20%5Ctext%7B%20Algebra%20%7D%5C%7D%5C%5C%0A&amp;=%20%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201%7D%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%20%7C%5Ctilde%7Ba%7D_i%5ET%20%5Cbf%7Bx%7D%7C%5C%5C%0A&amp;=%20%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201%7D%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%20%7C%5Calpha_%7Bi,0%7Dx_0%20+%20%5Cldots%20+%20%5Calpha_%7Bi,n-1%7Dx_%7Bn-1%7D%7C%5C%5C%0A&amp;%5Cleq%20%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201%7D%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%20%5Cleft(%20%7C%5Calpha_%7Bi,0%7Dx_0%20%7C%20+%20%5Cldots%20+%20%7C%5Calpha_%7Bi,n-1%7Dx_%7Bn-1%7D%7C%20%5Cright)%20&amp;%20%5C%7B%20%5Ctext%7B%20Triangle%20Inequality%20%7D%5C%7D%5C%5C%0A&amp;=%20%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201%7D%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%20%5Cleft(%20%7C%5Calpha_%7Bi,0%7D%7C%7Cx_0%20%7C%20+%20%5Cldots%20+%20%7C%5Calpha_%7Bi,n-1%7D%7C%7Cx_%7Bn-1%7D%7C%20%5Cright)%20&amp;%20%5C%7B%20%5Ctext%7B%20Algebra%20%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201%7D%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%5Cleft(%20%7C%5Calpha_%7Bi,0%7D%7C%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20+%20%5Cldots%20+%20%7C%5Calpha_%7Bi,n-1%7D%7C%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20%5Cright)%20&amp;%20%5C%7B%20%7Cx_i%7C%20%5Cleq%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%20(%20%7C%5Calpha_%7Bi,0%7D%7C%20+%20%5Cldots%20+%20%7C%5Calpha_%7Bi,n-1%7D%7C)%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201%7D%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%5C%5C%0A&amp;=%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%20(%20%7C%5Calpha_%7Bi,0%7D%7C%20+%20%5Cldots%20+%20%7C%5Calpha_%7Bi,n-1%7D%7C)%5C%5C%0A&amp;=%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%0A%5Cnorm%7B%5Ctilde%7Ba%7D_i%7D_1%0A%5Cend%7Balign*%7D%0A"></p>
<p>We also want to show that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20%5Cgeq%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%20%5Cnorm%7B%5Ctilde%7Ba%7D_i%7D_1">. Let <img src="https://latex.codecogs.com/png.latex?k"> be such that <img src="https://latex.codecogs.com/png.latex?%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%5Cnorm%7B%5Ctilde%7Ba%7D_i%7D_1%20=%20%5Cnorm%7B%5Ctilde%7Ba%7D_k%7D_1"> and pick <img src="https://latex.codecogs.com/png.latex?%5Cbf%7By%7D%20=%20%5Cleft(%5Cbegin%7Barray%7D%7Bc%7D%5Cpsi_0%5C%5C%20%5Cvdots%5C%5C%20%5Cpsi_%7Bn-1%7D%5Cend%7Barray%7D%5Cright)"> so that <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7Ba%7D_k%5ET%20%5Cbf%7By%7D%20=%20%7C%5Calpha_%7Bk,0%7D%7C%20+%20%7C%5Calpha_%7Bk,1%7D%7C%20+%20%5Cldots%20+%20%7C%5Calpha_%7Bk,n-1%7D%7C=%5Cnorm%7B%5Ctilde%7Ba%7D_k%7D_1">. This is a matter of picking <img src="https://latex.codecogs.com/png.latex?%5Cpsi_j%20=%20%7C%5Calpha_%7Bk,j%7D%7C/%5Calpha_%7Bk,j%7D">. Then, <img src="https://latex.codecogs.com/png.latex?%7C%5Cpsi_j%7C%20=%201"> and hence, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7By%7D%7D_%5Cinfty%20=%201"> and <img src="https://latex.codecogs.com/png.latex?%5Cpsi_j%20%5Calpha_%7Bk,j%7D%20=%20%7C%5Calpha_%7Bk,j%7D%7C">. Then:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_%5Cinfty%20&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201%7D%20%5Cnorm%7BA%5Cbf%7Bx%7D%7D_%5Cinfty%20&amp;%20%5C%7B%20%5Ctext%7B%20Definition%20%7D%5C%7D%20%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7B%5Cbf%7Bx%7D%7D_%5Cinfty%20=%201%7D%20%5Cnorm%7B%5Cleft%5B%0A%20%20%20%20%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_0%5ET%20%5Cbf%7Bx%7D%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_1%5ET%20%5Cbf%7Bx%7D%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Cvdots%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_%7Bm-1%7D%5ET%20%5Cbf%7Bx%7D%5C%5C%0A%20%20%20%20%5Cend%7Barray%7D%0A%5Cright%5D%7D_%5Cinfty%20&amp;%20%5C%7B%20%5Ctext%7B%20Expose%20rows%20%7D%5C%7D%5C%5C%0A&amp;%5Cgeq%20%20%5Cnorm%7B%5Cleft%5B%0A%20%20%20%20%5Cbegin%7Barray%7D%7Bc%7D%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_0%5ET%20%5Cbf%7By%7D%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_1%5ET%20%5Cbf%7By%7D%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Cvdots%5C%5C%0A%20%20%20%20%20%20%20%20%5Chline%0A%20%20%20%20%20%20%20%20%5Ctilde%7Ba%7D_%7Bm-1%7D%5ET%20%5Cbf%7By%7D%5C%5C%0A%20%20%20%20%5Cend%7Barray%7D%0A%5Cright%5D%7D_%5Cinfty%20&amp;%20%5C%7B%20%5Ctext%7B%20Specific%20vector%20%7D%5C%7D%5C%5C%0A&amp;%5Cgeq%20%7C%5Ctilde%7Ba%7D_k%5ET%20%5Cbf%7By%7D%7C%5C%5C%0A&amp;=%20%5Cnorm%7B%5Ctilde%7Ba%7D_k%7D_1%20%5C%5C%0A&amp;=%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%20%5Cnorm%7B%5Ctilde%7Ba%7D_i%7D_1%0A%5Cend%7Balign*%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="exr-computing-matrix-norms" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8</strong></span> Fill out the following table:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Barray%7D%7B%7Cc%7Cc%7Cc%7Cc%7C%7D%0A%5Chline%0AA%20&amp;%20%5Cnorm%7BA%7D_1%20&amp;%20%5Cnorm%7BA%7D_%5Cinfty%20&amp;%20%5Cnorm%7BA%7D_F%20&amp;%20%5Cnorm%7BA%7D_2%5C%5C%0A%5Chline%0A%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20&amp;%200%20%5C%5C%0A0%20&amp;%201%20&amp;%200%20%5C%5C%0A0%20&amp;%200%20&amp;%201%0A%5Cend%7Bbmatrix%7D%5C%5C%0A%5Chline%0A%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%201%20&amp;%201%5C%5C%0A1%20&amp;%201%20&amp;%201%5C%5C%0A1%20&amp;%201%20&amp;%201%5C%5C%0A1%20&amp;%201%20&amp;%201%0A%5Cend%7Bbmatrix%7D%5C%5C%0A%5Chline%0A%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%201%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%200%0A%5Cend%7Bbmatrix%7D%5C%5C%0A%5Chline%0A%5Cend%7Barray%7D%0A"></p>
</div>
<p><em>Solution</em>.</p>
<p>Let</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20&amp;%200%20%5C%5C%0A0%20&amp;%201%20&amp;%200%20%5C%5C%0A0%20&amp;%200%20&amp;%201%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>We have, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%201">, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%201">, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20=%20%5Csqrt%7B3%7D">. Since this is a diagonal matrix, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%20%5Cmax_%7B0%20%5Cleq%20i%20%5Cleq%202%7D%20%7Cd_%7Bi%7D%7C"> = 1.</p>
<p>Next, consider:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%201%20&amp;%201%5C%5C%0A1%20&amp;%201%20&amp;%201%5C%5C%0A1%20&amp;%201%20&amp;%201%5C%5C%0A1%20&amp;%201%20&amp;%201%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>We have, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%204">, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%203">, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20=%20%5Csqrt%7B12%7D">.</p>
<p>Note that, we can write</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20%5C%5C%0A1%20%5C%5C%0A1%20%5C%5C%0A1%20%5C%5C%0A%5Cend%7Bbmatrix%7D%20%5B1,%201,%201,%201%5D%20=%20%5Cbf%7Bx%7D%5Cbf%7By%7D%5EH%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%20=%20%5Cbf%7By%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20%5C%5C%0A1%20%5C%5C%0A1%20%5C%5C%0A1%20%5C%5C%0A%5Cend%7Bbmatrix%7D">. Using the property that, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Cbf%7Bx%7D%5Cbf%7By%7D%5EH%7D_2%20=%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20%5Cnorm%7B%5Cbf%7By%7D%7D_2">, we have that, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%204">.</p>
<p>Finally, if</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%201%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%200%5C%5C%0A0%20&amp;%201%20&amp;%200%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>we find that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%203">, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%201">, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20=%20%5Csqrt%7B3%7D">. Finally, let <img src="https://latex.codecogs.com/png.latex?%5Cbf%7Bx%7D%20=%20%5Cbegin%7Bbmatrix%7D1%20%5C%5C%201%20%5C%5C%201%5Cend%7Bbmatrix%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cbf%7By%7D%20=%20%5Cbegin%7Bbmatrix%7D0%20%5C%5C%201%20%5C%5C%200%5Cend%7Bbmatrix%7D">. Then, <img src="https://latex.codecogs.com/png.latex?A%20=%20%5Cbf%7Bx%7D%5Cbf%7By%7D%5EH">. So, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%20%5Cnorm%7B%5Cbf%7Bx%7D%7D_2%20%5Cnorm%7B%5Cbf%7By%7D%7D_2%20=%20%5Csqrt%7B3%7D">.</p>
</section>
<section id="equivalence-of-matrix-norms" class="level3">
<h3 class="anchored" data-anchor-id="equivalence-of-matrix-norms">Equivalence of matrix norms</h3>
<p>We saw that vector norms are equivalent in the sense that if a vector is <em>small</em> in one norm, it is small in all other norms and if it is large in one norm, it is large in all other norms. The same is true for matrix norms.</p>
<div id="thm-equivalence-of-matrix-norms" class="theorem">
<p><span class="theorem-title"><strong>Theorem 12 (Equivalence of matrix norms)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D%20:%20%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> and <img src="https://latex.codecogs.com/png.latex?%7C%7C%7C%5Ccdot%7C%7C%7C:%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> both be matrix norms. Then, there exist positive scalars <img src="https://latex.codecogs.com/png.latex?%5Csigma"> and <img src="https://latex.codecogs.com/png.latex?%5Ctau"> such that for all <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5CC%5E%7Bm%20%5Ctimes%20n%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csigma%20%5Cnorm%7BA%7D%20%5Cleq%20%7C%7C%7CA%7C%7C%7C%20%5Cleq%20%5Ctau%20%5Cnorm%7BA%7D%0A"></p>
</div>
<p><em>Proof.</em></p>
<p>The proof again builds on the fact that the supremum over a compact set is achieved and can be replaced by the maximum. We will prove that there exists <img src="https://latex.codecogs.com/png.latex?%5Ctau"> such that for all <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5CC%5E%7Bm%20%5Ctimes%20n%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%7C%7CA%7C%7C%7C%20%5Cleq%20%5Ctau%20%5Cnorm%7BA%7D%0A"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5CC%5E%7Bm%20%5Ctimes%20n%7D"> be an arbitrary matrix. Assume that <img src="https://latex.codecogs.com/png.latex?A%20%5Cneq%200"> (the zero matrix). Then:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%7C%7C%7CA%7C%7C%7C%20&amp;=%20%5Cfrac%7B%7C%7C%7CA%7C%7C%7C%7D%7B%5Cnorm%7BA%7D%7D%20%5Ccdot%20%5Cnorm%7BA%7D%20&amp;%20%5C%7B%5Ctext%7BAlgebra%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Csup_%7BZ%20%5Cneq%200%7D%20%5Cleft(%5Cfrac%7B%7C%7C%7CZ%7C%7C%7C%7D%7B%5Cnorm%7BZ%7D%7D%5Cright)%20%5Cnorm%7BA%7D%20&amp;%20%5C%7B%5Ctext%7BDefinition%20of%20supremum%7D%5C%7D%5C%5C%0A&amp;=%20%5Csup_%7BZ%20%5Cneq%200%7D%20%5Cleft(%5CBiggl%7C%5CBiggl%7C%5CBiggl%7C%5Cfrac%7BZ%7D%7B%5Cnorm%7BZ%7D%7D%5CBiggr%7C%5CBiggr%7C%5CBiggr%7C%5Cright)%20%5Cnorm%7BA%7D%20&amp;%20%5C%7B%5Ctext%7BHomogeneity%7D%5C%7D%5C%5C%0A&amp;=%20%5Cleft(%5Csup_%7B%5Cnorm%7BB%7D%20=%201%7D%20%7C%7C%7CB%7C%7C%7C%20%5Cright)%20%5Cnorm%7BA%7D%20&amp;%5C%7B%20%5Ctext%7Bchange%20of%20variables%20%7DB=Z/%5Cnorm%7BZ%7D%5C%7D%5C%5C%0A&amp;=%20%5Cleft(%5Cmax_%7B%5Cnorm%7BB%7D=1%7D%7C%7C%7CB%7C%7C%7C%5Cright)%20%5Cnorm%7BA%7D%20&amp;%20%5C%7B%5Ctext%7Bthe%20set%20%7D%5Cnorm%7BB%7D%20=%201%5Ctext%7B%20is%20compact%7D%5C%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>So, we can choose <img src="https://latex.codecogs.com/png.latex?%5Ctau%20=%20%5Cmax_%7B%5Cnorm%7BB%7D=1%7D%20%7C%7C%7CB%7C%7C%7C">.</p>
<p>Also, from the above proof, we deduce that, there exists <img src="https://latex.codecogs.com/png.latex?%5Csigma"> given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csigma%20=%20%5Cfrac%7B1%7D%7B%5Cmax_%7B%7C%7C%7CB%7C%7C%7C=1%7D%7C%7CB%7C%7C%7D%0A"></p>
<p>such that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csigma%20%5Cnorm%7BA%7D%20%5Cleq%20%7C%7C%7CA%7C%7C%7C%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="exr-matrix-2-norm-bounded-by-frobenius-norm" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9</strong></span> Given <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5CC%5E%7Bm%20%5Ctimes%20n%7D">, show that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20%5Cleq%20%5Cnorm%7BA%7D_F">. For what matrix, is the equality attained?</p>
</div>
<p><em>Solution</em>.</p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_2%5E2%20&amp;=%20%5Cmax_%7B%5Cnorm%7Bx%7D_2%20=%201%7D%20%5Cnorm%7BAx%7D_2%5E2%20%20&amp;%20%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7Bx%7D_2%20=%201%7D%20%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%0A%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20a_%7B0,j%7D%20x_j%20%5C%5C%0A%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20a_%7B1,j%7D%20x_j%20%5C%5C%0A%5Cvdots%5C%5C%0A%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20a_%7Bm-1,j%7D%20x_j%0A%5Cend%7Bbmatrix%7D%0A%7D_2%5E2%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7Bx%7D_2%20=%201%7D%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5CBiggl%7C%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20a_%7Bi,j%7D%20x_j%5CBiggr%7C%5E2%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7Bx%7D_2%20=%201%7D%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%7Ca_%7Bi,j%7D%20x_j%7C%5Cright)%5E2%20&amp;%20%5C%7B%5Ctext%7BTriangle%20Inequality%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7Bx%7D_2%20=%201%7D%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Cleft%5C%7B%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%7Ca_%7Bi,j%7D%7C%5E2%5Cright)%5E%7B1/2%7D%20%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%7Cx_j%7C%5E2%5Cright)%5E%7B1/2%7D%5Cright%5C%7D%5E2%20&amp;%20%5C%7B%5Ctext%7BCauchy-Schwarz%7D%5C%7D%5C%5C%0A&amp;=%5Cmax_%7B%5Cnorm%7Bx%7D_2%20=%201%7D%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%7Ca_%7Bi,j%7D%7C%5E2%5Cright)%20%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%7Cx_j%7C%5E2%5Cright)%20&amp;%20%5C%7B%5Ctext%7BSimplify%7D%5C%7D%5C%5C%0A&amp;=%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%7Ca_%7Bi,j%7D%7C%5E2%5Cright)%20&amp;%20%5C%7B%5Cnorm%7Bx%7D_2%20=%201%5C%7D%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_F%0A%5Cend%7Balign*%7D%0A"></p>
<p>Also, consider</p>
<p><img src="https://latex.codecogs.com/png.latex?A%20=%20%5Cbegin%7Bbmatrix%7D1%20&amp;%200%20%5C%5C%200%20&amp;%200%5Cend%7Bbmatrix%7D"></p>
<p>Then, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%20%5Cnorm%7BA%7D_F%20=%201">. So, the inequality <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20%5Cleq%20%5Cnorm%7BA%7D_F"> is tight. This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="exr-matrix-norm-equivalences" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 10</strong></span> Let <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5CC%5E%7Bm%20%5Ctimes%20n%7D">. The following table summarizes the equivalences of various matrix norms:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Barray%7D%7Bc%7Cc%7Cc%7Cc%7D%0A&amp;%20%5Cnorm%7BA%7D_1%20%5Cleq%20%5Csqrt%7Bm%7D%5Cnorm%7BA%7D_2%20&amp;%20%5Cnorm%7BA%7D_1%20%5Cleq%20m%20%5Cnorm%7BA%7D_%5Cinfty%20&amp;%20%5Cnorm%7BA%7D_1%20%5Cleq%20%5Csqrt%7Bm%7D%5Cnorm%7BA%7D_F%20%5C%5C%0A%5Chline%0A%5Cnorm%7BA%7D_2%20%5Cleq%20%5Csqrt%7Bn%7D%5Cnorm%7BA%7D_1%20&amp;%20&amp;%20%5Cnorm%7BA%7D_2%20%5Cleq%20%5Csqrt%7Bm%7D%5Cnorm%7BA%7D_%5Cinfty%20&amp;%20%5Cnorm%7BA%7D_2%20%5Cleq%20%5Cnorm%7BA%7D_F%20%5C%5C%0A%5Chline%0A%5Cnorm%7BA%7D_%5Cinfty%20%5Cleq%20n%20%5Cnorm%7BA%7D_1%20&amp;%20%5Cnorm%7BA%7D_%5Cinfty%20%5Cleq%20%5Csqrt%7Bn%7D%20%5Cnorm%7BA%7D_2%20&amp;%20&amp;%20%5Cnorm%7BA%7D_%5Cinfty%20%5Cleq%20%5Csqrt%7Bn%7D%5Cnorm%7BA%7D_F%5C%5C%0A%5Chline%0A%5Cnorm%7BA%7D_F%20%5Cleq%20%5Csqrt%7Bn%7D%20%5Cnorm%7BA%7D_1%20&amp;%20%5Cnorm%7BA%7D_F%20%5Cleq%20%5Ctau%20%5Cnorm%7BA%7D_2%20&amp;%20%5Cnorm%7BA%7D_F%20%5Cleq%20%5Csqrt%7Bm%7D%5Cnorm%7BA%7D_%5Cinfty%0A%5Cend%7Barray%7D%0A"></p>
<p>For each, prove the inequality, including that it is a tight inequality for some nonzero <img src="https://latex.codecogs.com/png.latex?A">. (Skip <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20%5Cleq%20%5Ctau%20%5Cnorm%7BA%7D_2">, we revisit it in a later post)</p>
</div>
<p><em>Solution</em>.</p>
<p><em>Claim</em>. Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20%5Cleq%20%5Csqrt%7Bm%7D%20%5Cnorm%7BA%7D_2">.</p>
<p>Partition <img src="https://latex.codecogs.com/png.latex?A%20=%20%5Ba_0%20%7C%20a_1%20%7C%20%5Cldots%20%7C%20a_%7Bn-1%7D%5D">.</p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_1%20&amp;=%20%5Cmax_%7B0%20%5Cleq%20j%20%3C%20n%7D%20%5Cnorm%7Ba_j%7D_1%20&amp;%20%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B0%20%5Cleq%20j%20%3C%20n%7D%20%5Cnorm%7B%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%5Calpha_%7B0,j%7D%5C%5C%0A%20%20%20%20%5Calpha_%7B1,j%7D%5C%5C%0A%20%20%20%20%5Cvdots%5C%5C%0A%20%20%20%20%5Calpha_%7Bm-1,j%7D%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%7D_1%5C%5C%0A&amp;=%20%5Cmax_%7B0%20%5Cleq%20j%20%3C%20n%7D%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%7C%5Calpha_%7Bi,j%7D%7C%20%5Ccdot%20%7C1%7C%5C%5C%0A&amp;=%20%5Cmax_%7B0%20%5Cleq%20j%20%3C%20n%7D%20%5Cleft(%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%7C%5Calpha_%7Bi,j%7D%7C%5E2%5Cright)%5E%7B1/2%7D%20%5Cleft(%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%7C1%7C%5E2%5Cright)%5E%7B1/2%7D%20&amp;%20%5C%7B%5Ctext%7BCauchy-Schwarz%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B0%20%5Cleq%20j%20%3C%20n%7D%20%5Cnorm%7Ba_j%7D_2%20%5Csqrt%7Bm%7D%5C%5C%0A&amp;=%20%5Cmax_%7B0%20%5Cleq%20j%20%3C%20n%7D%20%5Cnorm%7BA%7D_2%20%5Csqrt%7Bm%7D%20&amp;%20%5C%7B%5Cnorm%7BA_%7Bi,j%7D%7D_2%20%5Cleq%20%5Cnorm%7BA%7D_2%5C%7D%5C%5C%0A&amp;=%20%5Csqrt%7Bm%7D%20%5Cnorm%7BA%7D_2%0A%5Cend%7Balign*%7D%0A"></p>
<p>Moreover, consider the matrix</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D%20=%0A%5Cbegin%7Bbmatrix%7D%0A1%20%5C%5C%0A1%0A%5Cend%7Bbmatrix%7D%0A%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>We have, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%20%5Csqrt%7B2%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%202">, so <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%20%5Csqrt%7B2%7D%5Cnorm%7BA%7D_2">. Thus, the inequality is tight. This closes the proof.</p>
<p><em>Claim</em>. Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20%5Cleq%20m%20%5Cnorm%7BA%7D_%5Cinfty">.</p>
<p><em>Solution</em>.</p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7BA%7D_1%20&amp;=%20%5Cmax_%7B0%20%5Cleq%20j%20%3C%20n%7D%20%5Cnorm%7Ba_j%7D_1%20&amp;%20%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B0%20%5Cleq%20j%20%3C%20n%7D%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%7C%5Calpha_%7Bi,j%7D%7C%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%7C%5Calpha_%7Bi,j%7D%7C%20=%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%7C%5Calpha_%7Bi,j%7D%7C%20%5C%5C%0A&amp;=%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Cnorm%7B%5Ctilde%7Ba%7D_i%5ET%7D_1%5C%5C%0A&amp;=%20m%20%5Cmax_%7B0%20%5Cleq%20i%20%3C%20m%7D%20%5Cnorm%7B%5Ctilde%7Ba%7D_i%5ET%7D_1%5C%5C%0A&amp;=%20m%20%5Cnorm%7BA%7D_%5Cinfty%0A%5Cend%7Balign%7D%0A"></p>
<p>Again, consider the matrix</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%5C%5C%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%202"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%201">, so <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%202%20%5Cnorm%7BA%7D_%5Cinfty">. Hence, the inequality is tight. This closes the proof.</p>
<p><em>Claim</em>. Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20%5Cleq%20%5Csqrt%7Bm%7D%5Cnorm%7BA%7D_F">.</p>
<p><em>Solution.</em></p>
<p>We have shown that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7BA%7D_1%20&amp;%5Cleq%20%5Csqrt%7Bm%7D%5Cnorm%7BA%7D_2%20%5C%5C%0A%5Cnorm%7BA%7D_2%20&amp;%5Cleq%20%5Cnorm%7BA%7D_F%0A%5Cend%7Balign%7D%0A"></p>
<p>So, we deduce that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20%5Cleq%20%5Csqrt%7Bm%7D%5Cnorm%7BA%7D_F">. Moreover, consider</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Csqrt%7B2%7DI%0A"></p>
<p>Then, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%20%5Csqrt%7B2%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20=%202">, so <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%20%5Csqrt%7B2%7D%5Cnorm%7BA%7D_F">. Hence, the inequality is tight.</p>
<p><em>Claim.</em> Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20%5Cleq%20%5Csqrt%7Bn%7D%5Cnorm%7BA%7D_1">.</p>
<p><em>Solution.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7BA%7D_2%20&amp;=%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_2%7D%7B%5Cnorm%7Bx%7D_2%7D%20&amp;%20%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_1%7D%7B%5Cnorm%7Bx%7D_2%7D%20%20&amp;%20%5C%7B%5Cnorm%7Bz%7D_2%20%5Cleq%20%5Cnorm%7Bz%7D_1%5C%7D%20%5C%5C%0A&amp;=%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_1%7D%7B%5Cfrac%7B1%7D%7B%5Csqrt%7Bn%7D%7D%5Cnorm%7Bx%7D_1%7D%20%20&amp;%20%5C%7B%5Cnorm%7Bz%7D_1%20%5Cleq%20%5Csqrt%7Bn%7D%5Cnorm%7Bz%7D_2%5C%7D%20%5C%5C%0A&amp;=%20%5Csqrt%7Bn%7D%5Cnorm%7BA%7D_1%0A%5Cend%7Balign%7D%0A"></p>
<p>Again, consider the matrix <img src="https://latex.codecogs.com/png.latex?A%20=%20%5B1%20%7C%201%7C%20%5Cldots%20%7C%201%5D">. Then, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%20%5Csqrt%7Bn%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%201">. So, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%20%5Csqrt%7Bn%7D%5Cnorm%7BA%7D_1">.</p>
<p><em>Claim</em>. Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20%5Cleq%20%5Csqrt%7Bm%7D%20%5Cnorm%7BA%7D_%5Cinfty">.</p>
<p><em>Solution.</em></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_2%20&amp;=%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_2%7D%7B%5Cnorm%7Bx%7D_2%7D%20&amp;%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;=%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%5Ctilde%7Ba%7D_0%5ET%20%5C%5C%20%5Ctilde%7Ba%7D_1%5ET%20%5C%5C%20%5Cvdots%20%5C%5C%20%5Ctilde%7Ba%7D_%7Bm-1%7D%5ET%5Cend%7Bbmatrix%7Dx%7D_2%7D%7B%5Cnorm%7Bx%7D_2%7D%20&amp;%5C%7B%5Ctext%7BExpose%20rows%7D%5C%7D%5C%5C%0A&amp;=%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7B%5Cbegin%7Bbmatrix%7D%5Ctilde%7Ba%7D_0%5ET%20x%20%5C%5C%20%5Ctilde%7Ba%7D_1%5ET%20x%5C%5C%20%5Cvdots%20%5C%5C%20%5Ctilde%7Ba%7D_%7Bm-1%7D%5ET%20x%5Cend%7Bbmatrix%7D%7D_2%7D%7B%5Cnorm%7Bx%7D_2%7D%20&amp;%5C%7B%5Ctext%7BAlgebra%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Csqrt%7Bm%7D%5Cnorm%7BAx%7D_%5Cinfty%7D%7B%5Cnorm%7Bx%7D_2%7D%20&amp;%5C%7B%5Cnorm%7Bz%7D_2%20%5Cleq%20%5Csqrt%7Bn%7D%5Cnorm%7Bz%7D_%5Cinfty%5C%7D%5C%5C%0A&amp;%20%5Cleq%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Csqrt%7Bm%7D%5Cnorm%7BAx%7D_%5Cinfty%7D%7B%5Cnorm%7Bx%7D_%5Cinfty%7D%20&amp;%5C%7B%5Cnorm%7Bz%7D_%5Cinfty%20%5Cleq%20%5Cnorm%7Bz%7D_2%5C%7D%5C%5C%0A&amp;=%20%5Csqrt%7Bm%7D%20%5Cnorm%7BA%7D_%5Cinfty%0A%5Cend%7Balign*%7D%0A"></p>
<p>Moreover, consider the matrix</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20%5C%5C%0A1%20%5C%5C%0A%5Cvdots%20%5C%5C%0A1%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>We have <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%20%5Csqrt%7Bm%7D">, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%201">, so <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%20%5Csqrt%7Bm%7D%5Cnorm%7BA%7D_%5Cinfty">. Hence, the inequality is tight.</p>
<p><em>Claim</em>. Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20%5Cleq%20n%20%5Cnorm%7BA%7D_1">.</p>
<p><em>Solution.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_%5Cinfty%20&amp;=%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_%5Cinfty%7D%7B%5Cnorm%7Bx%7D_%5Cinfty%7D%20&amp;%20%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_1%7D%7B%5Cnorm%7Bx%7D_%5Cinfty%7D%20&amp;%20%5C%7B%5Cnorm%7Bx%7D_%5Cinfty%20%5Cleq%20%5Cnorm%7Bx%7D_1%5C%7D%5C%5C%0A&amp;%5Cleq%20%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_1%7D%7B%5Cfrac%7B1%7D%7Bn%7D%5Cnorm%7Bx%7D_1%7D%20&amp;%20%5C%7B%5Cnorm%7Bx%7D_1%20%5Cleq%20n%20%5Cnorm%7Bx%7D_%5Cinfty%5C%7D%5C%5C%0A&amp;=%20n%20%5Cnorm%7BA%7D_1%0A%5Cend%7Balign*%7D%0A"></p>
<p>Moreover, let <img src="https://latex.codecogs.com/png.latex?A%20=%20%5B1%20%7C%201%20%7C%20%5Cldots%20%7C%201%5D">. Then, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%20n"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%201">, so <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%20n%20%5Cnorm%7BA%7D_1">. Hence, the inequality is tight.</p>
<p><em>Claim.</em> Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20%5Cleq%20%5Csqrt%7Bn%7D%20%5Cnorm%7BA%7D_2">.</p>
<p><em>Solution.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cnorm%7BA%7D_%5Cinfty%20&amp;=%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_%5Cinfty%7D%7B%5Cnorm%7Bx%7D_%5Cinfty%7D%20&amp;%20%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_2%7D%7B%5Cnorm%7Bx%7D_%5Cinfty%7D%20&amp;%20%5C%7B%5Cnorm%7Bx%7D_%5Cinfty%20%5Cleq%20%5Cnorm%7Bx%7D_2%5C%7D%5C%5C%0A&amp;%5Cleq%20%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_2%7D%7B%5Cfrac%7B1%7D%7B%5Csqrt%7Bn%7D%7D%5Cnorm%7Bx%7D_2%7D%20&amp;%20%5C%7B%5Cnorm%7Bx%7D_2%20%5Cleq%20%5Csqrt%7Bn%7D%20%5Cnorm%7Bx%7D_%5Cinfty%5C%7D%5C%5C%0A&amp;=%20%5Csqrt%7Bn%7D%20%5Cnorm%7BA%7D_2%0A%5Cend%7Balign*%7D%0A"></p>
<p>Moreover, let <img src="https://latex.codecogs.com/png.latex?A%20=%20%5B1%7C1%7C%5Cldots%7C1%5D"></p>
<p>Then, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%20n">, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20=%20%5Csqrt%7Bn%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%20%5Csqrt%7Bn%7D%20%5Cnorm%7BA%7D_2">. So, the bound is tight.</p>
<p><em>Claim</em>. Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20%5Cleq%20%5Csqrt%7Bn%7D%5Cnorm%7BA%7D_F">.</p>
<p><em>Solution.</em> This is true since <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20%5Cleq%20%5Csqrt%7Bn%7D%5Cnorm%7BA%7D_2"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_2%20%5Cleq%20%5Cnorm%7BA%7D_F">.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?A%20=%20%5B1%20%7C%201%20%7C%20%5Cldots%20%7C%201%5D">. Then, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%20n"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20=%20%5Csqrt%7Bn%7D">. So, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%20%5Csqrt%7Bn%7D%5Cnorm%7BA%7D_F">. The bound is tight.</p>
<p><em>Claim</em>. Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20%5Cleq%20%5Csqrt%7Bn%7D%20%5Cnorm%7BA%7D_1">.</p>
<p><em>Solution.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7BA%7D_F%5E2%20&amp;=%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%7C%5Calpha_%7Bi,j%7D%7C%5E2%20&amp;%20%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;=%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%7C%5Calpha_%7Bi,j%7D%7C%5E2%20%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%5Cleft(%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%7C%5Calpha_%7Bi,j%7D%7C%20%5Cright)%5E2%20%5C%5C%0A&amp;=%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%5Cnorm%7Ba_j%7D_1%5E2%20%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%5Cmax_%7Bj=0%7D%5E%7Bn-1%7D%20%5Cnorm%7Ba_j%7D_1%5E2%20%5C%5C%0A&amp;=%20n%20%5Cnorm%7BA%7D_1%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>Consequently, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20%5Cleq%20%5Csqrt%7Bn%7D%5Cnorm%7BA%7D_1">. Let <img src="https://latex.codecogs.com/png.latex?A%20=%20%5B1%20%7C1%20%7C%20%5Cldots%7C%201%5D">. Then, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20=%20%5Csqrt%7Bn%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_1%20=%201">, so <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20=%20%5Csqrt%7Bn%7D%5Cnorm%7BA%7D_1">. Hence, the bound is tight.</p>
<p><em>Claim</em>. Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20%5Cleq%20%5Csqrt%7Bm%7D%20%5Cnorm%7BA%7D_%5Cinfty">.</p>
<p><em>Solution.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7BA%7D_F%5E2%20&amp;=%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%7C%5Calpha_%7Bi,j%7D%7C%5E2%20&amp;%20%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%7C%5Calpha_%7Bi,j%7D%7C%20%5Cright)%5E2%20%5C%5C%0A&amp;=%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Cnorm%7B%5Ctilde%7Ba%7D_i%5ET%7D_1%5E2%20%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%5Cmax_%7Bi=0%7D%5E%7Bm-1%7D%20%5Cnorm%7B%5Ctilde%7Ba%7D_i%5ET%7D_1%5E2%20%5C%5C%0A&amp;=%20m%20%5Cnorm%7BA%7D_%5Cinfty%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>Consequently, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20%5Cleq%20%5Csqrt%7Bm%7D%5Cnorm%7BA%7D_%5Cinfty">. Let <img src="https://latex.codecogs.com/png.latex?A%20=%20%5B1,%201,%20%5Cldots,%201%5D%5ET">. Then, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20=%20%5Csqrt%7Bm%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_%5Cinfty%20=%201">, so <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BA%7D_F%20=%20%5Csqrt%7Bm%7D%5Cnorm%7BA%7D_1">. Hence, the bound is tight.</p>
</section>
<section id="sub-multiplicative-norms" class="level3">
<h3 class="anchored" data-anchor-id="sub-multiplicative-norms">Sub-multiplicative norms</h3>
<p>There are a number of properties that we would like a matrix norm to have(but not all matrix norms do). Given a matrix norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D%20:%20%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR">, we may ask the following question. Do there exist vector norms <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cmu%20:%20C%5Em%20%5Cto%20%5CR"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D:%5CC%5En%20%5Cto%20R">, such that the matrix norm is an upper bound on how much the non-zero vector <img src="https://latex.codecogs.com/png.latex?x"> is stretched? That is, the following inequality is satisfied:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cnorm%7BAx%7D_%5Cmu%7D%7B%5Cnorm%7Bx%7D_%5Cnu%7D%20%5Cleq%20%5Cnorm%7BA%7D%0A"></p>
<p>or equivalently</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BAx%7D_%5Cmu%20%5Cleq%20%5Cnorm%7BA%7D%20%5Cnorm%7Bx%7D_%5Cnu%0A"></p>
<p>where this second formulation has the benefit that it also holds if <img src="https://latex.codecogs.com/png.latex?x%20=%200">.</p>
<div id="def-subordinate-matrix-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 12 (Subordinate matrix norm)</strong></span> A matrix norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D:%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> is said to be subordinate to vector norms <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cmu%20:%5CC%5Em%20%5Cto%20%5CR"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cnu%20:%20%5CC%5En%20%5Cto%20%5CR">, if for all, <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5CC%5En">,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BAx%7D_%5Cmu%20%5Cleq%20%5Cnorm%7BA%7D%20%5Cnorm%7Bx%7D_%5Cnu%0A"></p>
<p>If <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cmu"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cnu"> are the same norm (but perhaps for different <img src="https://latex.codecogs.com/png.latex?m"> and <img src="https://latex.codecogs.com/png.latex?n">), then <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D"> is said to be subordinate to the given vector norm.</p>
</div>
<div id="exr-matrix-2-norm-is-subordinate-to-vector-2-norm" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 11</strong></span> Prove that the matrix <img src="https://latex.codecogs.com/png.latex?2">-norm is subordinate to the vector <img src="https://latex.codecogs.com/png.latex?2">-norm.</p>
</div>
<p><em>Proof.</em></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20C%5E%7Bm%20%5Ctimes%20n%7D"> and let <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5CC%5En">. Assume that <img src="https://latex.codecogs.com/png.latex?x%20%5Cneq%200">, for if <img src="https://latex.codecogs.com/png.latex?x%20=%200">, then the inequality <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BAx%7D_2%20%5Cleq%20%5Cnorm%7BA%7D_2%20%5Cnorm%7Bx%7D_2"> is vacuously true.</p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7BAx%7D_2&amp;=%20%5Cleft(%5Cfrac%7B%5Cnorm%7BAx%7D_2%7D%7B%5Cnorm%7Bx%7D_2%7D%5Cright)%20%5Cnorm%7Bx%7D_2%20&amp;%20%5C%7Bx%20%5Cneq%200%5C%7D%20%5C%5C%0A&amp;%5Cleq%20%5Cleft(%5Cmax_%7By%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAy%7D_2%7D%7B%5Cnorm%7By%7D_2%7D%5Cright)%5Cnorm%7Bx%7D_2%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_2%20%5Cnorm%7Bx%7D_2%0A%5Cend%7Balign%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="exr-frobenius-norm-is-subordinate-to-vector-2-norm" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 12</strong></span> Prove that the Frobenius norm is subordinate to the vector <img src="https://latex.codecogs.com/png.latex?2">-norm.</p>
</div>
<p><em>Proof.</em></p>
<p>We are interested to prove the claim that, <img src="https://latex.codecogs.com/png.latex?(%5Cforall%20A%20%5Cin%20%5CC%5E%7Bm%5Ctimes%20n%7D)(%5Cforall%20x%20%5Cin%20%5CC%5En)">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5Cnorm%7BAx%7D_2%20%5Cleq%20%5Cnorm%7BA%7D_F%20%5Cnorm%7Bx%7D_2%20"></p>
<p>Again, without loss of generality, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7BAx%7D_2%5E2%20&amp;=%20%5Cnorm%7B%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%0A%20%20%20%20%20%20%20%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Calpha_%7B0,j%7D%20x_j%20%5C%5C%0A%20%20%20%20%20%20%20%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Calpha_%7B1,j%7D%20x_j%20%5C%5C%0A%20%20%20%20%20%20%20%20%5Cvdots%0A%20%20%20%20%20%20%20%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Calpha_%7Bm-1,j%7D%20x_j%0A%20%20%20%20%5Cend%7Bbmatrix%7D%0A%7D_2%5E2%20&amp;%20%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;=%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5CBiggl%7C%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Calpha_%7Bi,j%7D%20x_j%20%5CBiggr%7C%5E2%5C%5C%0A&amp;=%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%7C%5Calpha_%7Bi,j%7D%20x_j%7C%20%5Cright)%5E2%20&amp;%20%5C%7B%5Ctext%7BTriangle%20Inequality%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Cleft%5B%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%7C%5Calpha_%7Bi,j%7D%7C%5E2%20%5Cright)%20%20%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%7Cx_j%7C%5E2%5Cright)%5Cright%5D%20&amp;%20%5C%7B%5Ctext%7BCauchy-Schwarz%7D%5C%7D%5C%5C%0A&amp;=%20%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%20%7Cx_j%7C%5E2%5Cright)%20%5Cleft(%5Csum_%7Bi=0%7D%5E%7Bm-1%7D%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%7C%5Calpha_%7Bi,j%7D%7C%5E2%20%5Cright)%20%20%20&amp;%20%5C%7B%5Ctext%7BAlgebra%7D%5C%7D%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_F%5E2%20%5Cnorm%7Bx%7D_2%5E2%0A%5Cend%7Balign%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="thm-induced-matrix-norms-are-subordinate-norms" class="theorem">
<p><span class="theorem-title"><strong>Theorem 13</strong></span> Induced matrix norms, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%7B%5Cmu,%5Cnu%7D%20:%20%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> are subordinate to the norms, <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cmu"> and <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D_%5Cnu"> that induce them.</p>
</div>
<p><em>Proof</em>.</p>
<p>Without loss of generality, assume that <img src="https://latex.codecogs.com/png.latex?x%20%5Cneq%200">, otherwise the proposition is vacuously true.</p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7BAx%7D_%5Cmu%20&amp;=%20%5Cfrac%7B%5Cnorm%7BAx%7D_%5Cmu%7D%7B%5Cnorm%7Bx%7D_%5Cnu%7D%20%5Cnorm%7Bx%7D_%5Cnu%20%5C%5C%0A&amp;%5Cleq%20%5Cleft(%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_%5Cmu%7D%7B%5Cnorm%7Bx%7D_%5Cnu%7D%20%5Cright)%20%5Cnorm%7Bx%7D_%5Cnu%20%5C%5C%0A&amp;=%20%5Cleft(%5Cmax_%7By%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAy%7D_%5Cmu%7D%7B%5Cnorm%7By%7D_%5Cnu%7D%20%5Cright)%20%5Cnorm%7Bx%7D_%5Cnu%20%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D%20%5Cnorm%7Bx%7D_%5Cnu%0A%5Cend%7Balign%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="cor-matrix-p-norms-are-subordinate" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 1</strong></span> Any matrix <img src="https://latex.codecogs.com/png.latex?p">-norm is subordinate to the corresponding vector norm.</p>
</div>
<p><em>Proof.</em></p>
<p>Without the loss of generality, assume that <img src="https://latex.codecogs.com/png.latex?x%20%5Cneq%200">. If <img src="https://latex.codecogs.com/png.latex?x%20=%200">, the proposition is vacuously true.</p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7BAx%7D_p%20&amp;=%20%5Cleft(%5Cfrac%7B%5Cnorm%7BAx%7D_p%7D%7B%5Cnorm%7Bx%7D_p%7D%20%5Cright)%20%5Cnorm%7Bx%7D_p%20&amp;%20%5C%7B%20x%20%5Cneq%200%5C%7D%5C%5C%0A&amp;%5Cleq%20%20%5Cleft(%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D_p%7D%7B%5Cnorm%7Bx%7D_p%7D%20%5Cright)%20%5Cnorm%7Bx%7D_p%5C%5C%0A&amp;=%20%20%5Cleft(%5Cmax_%7By%20%5Cneq%200%7D%5Cfrac%7B%5Cnorm%7BAy%7D_p%7D%7B%5Cnorm%7By%7D_p%7D%20%5Cright)%20%5Cnorm%7Bx%7D_p%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D_p%20%5Cnorm%7Bx%7D_p%0A%5Cend%7Balign%7D%0A"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<p>Another desirable property that not all norms have is that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BAB%7D%20%5Cleq%20%5Cnorm%7BA%7D%20%5Cnorm%7BB%7D%0A"></p>
<p>This requires the given norm to be defined for all matrix sizes.</p>
<div id="def-consistent-matrix-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 13 (Consistent matrix norm)</strong></span> A matrix norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D%20:%20%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> is said to be consistent matrix norm if it is defined for all <img src="https://latex.codecogs.com/png.latex?m"> and <img src="https://latex.codecogs.com/png.latex?n">, using the same formula for all <img src="https://latex.codecogs.com/png.latex?m"> and <img src="https://latex.codecogs.com/png.latex?n">.</p>
</div>
<div id="def-submulticative-matrix-norm" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 14 (Submultiplicative matrix norm)</strong></span> A consistent matrix norm <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D%20:%20%5CC%5E%7Bm%20%5Ctimes%20n%7D%20%5Cto%20%5CR"> is said to be submultiplicative if it satisfies:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BAB%7D%20%5Cleq%20%5Cnorm%7BA%7D%20%5Cnorm%7BB%7D%0A"></p>
</div>
<div id="thm-induced-matrix-norms-are-submultiplicative" class="theorem">
<p><span class="theorem-title"><strong>Theorem 14</strong></span> Let <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7B%5Ccdot%7D%20:%20%5CC%5En%20%5Cto%20%5CR"> be a vector norm defined for all <img src="https://latex.codecogs.com/png.latex?n">. Define the corresponding induced matrix norm as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cnorm%7BA%7D%20=%20%5Cmax_%7Bx%20%5Cneq%200%7D%20%5Cfrac%7B%5Cnorm%7BAx%7D%7D%7B%5Cnorm%7Bx%7D%7D%20=%20%5Cmax_%7B%5Cnorm%7Bx%7D%20=%201%7D%20%5Cnorm%7BAx%7D%0A"></p>
<p>Then, for any <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5CC%5E%7Bm%20%5Ctimes%20k%7D"> and <img src="https://latex.codecogs.com/png.latex?B%5E%7Bk%20%5Ctimes%20n%7D">, the inequality <img src="https://latex.codecogs.com/png.latex?%5Cnorm%7BAB%7D%20%5Cleq%20%5Cnorm%7BA%7D%20%5Cnorm%7BB%7D"> holds.</p>
</div>
<p>In other words, induced matrix norms are submultiplicative.</p>
<p><em>Proof.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Cnorm%7BAB%7D%20&amp;=%20%5Cmax_%7B%5Cnorm%7Bx%7D=1%7D%20%5Cnorm%7BABx%7D%20&amp;%20%5C%7B%5Ctext%7BDefinition%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmax_%7B%5Cnorm%7Bx%7D=1%7D%20%5Cnorm%7BA(Bx)%7D%20&amp;%20%5C%7B%5Ctext%7BAssociativity%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7Bx%7D=1%7D%20%5Cnorm%7BA%7D%20%5Cnorm%7BBx%7D%20&amp;%20%5C%7B%5Ctext%7BSubordinate%20property%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Cmax_%7B%5Cnorm%7Bx%7D=1%7D%20%5Cnorm%7BA%7D%20%5Cnorm%7BB%7D%20%5Cnorm%7Bx%7D%20&amp;%20%5C%7B%5Ctext%7BSubordinate%20property%7D%5C%7D%5C%5C%0A&amp;=%20%5Cnorm%7BA%7D%20%5Cnorm%7BB%7D%20&amp;%20%5C%7B%5Cnorm%7Bx%7D=1%5C%7D%0A%5Cend%7Balign%7D%0A"></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>Numerical Methods</category>
  <guid>https://quantdev.blog/posts/norms/</guid>
  <pubDate>Wed, 24 Jul 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/norms/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Singular Value Decomposition(SVD)</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/singular-value-decomposition/</link>
  <description><![CDATA[ 





<p>Rectangular matrices do not have eigenvalues. However, we might look at the eigenvalues of the symmetric, positive semidefinite square Gram matrix <img src="https://latex.codecogs.com/png.latex?K=AA%5ET">. Perhaps the eigenvalues of <img src="https://latex.codecogs.com/png.latex?K"> might form an important role for general matrices. They were first studied by the German mathematician <a href="https://en.wikipedia.org/wiki/Erhard_Schmidt">Erhard Schmidt</a> in early days of the 20th century.</p>
<div id="def-singular-values" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Singular Values)</strong></span> The <em>singular values</em> <img src="https://latex.codecogs.com/png.latex?%5Csigma_1,%5Cldots,%5Csigma_r"> of a rectangular matrix <img src="https://latex.codecogs.com/png.latex?A%5Cin%20%5Cmathbf%7BR%7D%5E%7Bm%20%5Ctimes%20n%7D"> are the positive square roots, <img src="https://latex.codecogs.com/png.latex?%5Csigma_i%20=%20%5Csqrt%7B%5Clambda_i%7D%20%3E%200"> of the non-zero eigenvalues of the Gram matrix <img src="https://latex.codecogs.com/png.latex?K%20=%20AA%5ET">. The corresponding eigenvectors of <img src="https://latex.codecogs.com/png.latex?K"> are known as the <em>singular</em> vectors of <img src="https://latex.codecogs.com/png.latex?A">.</p>
</div>
<p>Since <img src="https://latex.codecogs.com/png.latex?K=AA%5ET"> is necessarily positive semi-definite, its eigenvalues are necessarily non-negative, <img src="https://latex.codecogs.com/png.latex?%5Clambda_i%20%5Cgeq%200">, which justifies the positivity of the singular values of <img src="https://latex.codecogs.com/png.latex?A"> - independently of whether <img src="https://latex.codecogs.com/png.latex?A"> itself has positive, negative or even complex eigenvalues, or is rectangular and has no eigenvalues at all. I will follow the standard convention, and always label the singular values in decreasing order, so that <img src="https://latex.codecogs.com/png.latex?%5Csigma_1%20%5Cgeq%20%5Csigma_2%20%5Cgeq%20%5Cldots%20%5Cgeq%20%5Csigma_r">.</p>
<p>In the special case of symmetric matrices, there is a direct connection between their singular values and their (necessarily real) eigenvalues.</p>
<div id="prp-singular-values-of-a-symmetric-matrix" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1</strong></span> If <img src="https://latex.codecogs.com/png.latex?A%20=%20A%5ET"> is a symmetric matrix, its singular values are the absolute values of its nonzero eigenvalues : <img src="https://latex.codecogs.com/png.latex?%5Csigma_i%20=%20%7C%5Clambda_i%7C%20%3E%200">; its singular vectors coincide with its non-null eigenvectors.</p>
</div>
<p><em>Proof.</em></p>
<p>When <img src="https://latex.codecogs.com/png.latex?A"> is symmetric, <img src="https://latex.codecogs.com/png.latex?K=A%5ET%20A%20=%20A%5E2">. So, if</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20%5Cmathbf%7Bv%7D%20=%20%5Clambda%20%5Cmathbf%7Bv%7D%0A"></p>
<p>then</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AK%20%5Cmathbf%7Bv%7D%20=%20A%5E2%20%5Cmathbf%7Bv%7D%20=%20A(A%20%5Cmathbf%7Bv%7D)%20=%20A(%5Clambda%20%5Cmathbf%7Bv%7D)%20=%20%5Clambda%20A%20%5Cmathbf%7Bv%7D%20=%20%5Clambda%5E2%20%5Cmathbf%7Bv%7D%0A"></p>
<p>Thus, every eigenvector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D"> of <img src="https://latex.codecogs.com/png.latex?A"> is also an eigenvector of <img src="https://latex.codecogs.com/png.latex?K"> with eigenvalue <img src="https://latex.codecogs.com/png.latex?%5Clambda%5E2">. So, the eigenvector basis of <img src="https://latex.codecogs.com/png.latex?A"> is also an eigenvector basis for <img src="https://latex.codecogs.com/png.latex?K">, and forms a complete system of singular vectors for <img src="https://latex.codecogs.com/png.latex?A">. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<section id="svd-factorization" class="level2">
<h2 class="anchored" data-anchor-id="svd-factorization">SVD Factorization</h2>
<p>The generalization of the <a href="https://quantinsights.github.io/posts/spectral_theorem/">spectral theorem</a> to non-symmetric matrices is known as the <em>singular value decomposition</em>, commonly abbreviated SVD. Unlike the former, which applies to only symmetric matrices, every nonzero matrix possesses a SVD factorization.</p>
<div id="thm-svd-factorization" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (SVD Factorization)</strong></span> Every non-zero real <img src="https://latex.codecogs.com/png.latex?m%20%5Ctimes%20n"> matrix <img src="https://latex.codecogs.com/png.latex?A"> of rank <img src="https://latex.codecogs.com/png.latex?r%20%3E%200"> can be factored:</p>
<p><img src="https://latex.codecogs.com/png.latex?%20A%20=%20U%20%5CSigma%20V%5ET%20"></p>
<p>into the product of an <img src="https://latex.codecogs.com/png.latex?m%20%5Ctimes%20r"> matrix <img src="https://latex.codecogs.com/png.latex?U">, the <img src="https://latex.codecogs.com/png.latex?r%20%5Ctimes%20r"> diagonal matrix <img src="https://latex.codecogs.com/png.latex?%5CSigma%20=%20diag(%5Csigma_1,%5Cldots,%5Csigma_r)"> and an <img src="https://latex.codecogs.com/png.latex?r%20%5Ctimes%20n"> matrix <img src="https://latex.codecogs.com/png.latex?V%5ET">, such that <img src="https://latex.codecogs.com/png.latex?U"> and <img src="https://latex.codecogs.com/png.latex?V"> are orthonormal matrices.</p>
</div>
<p><em>Proof.</em></p>
<p>Let’s begin by writing the desired factorization as <img src="https://latex.codecogs.com/png.latex?AQ%20=%20P%20%5CSigma">. The individual columns</p>


<!-- -->

</section>

 ]]></description>
  <category>Linear Algebra</category>
  <guid>https://quantdev.blog/posts/singular-value-decomposition/</guid>
  <pubDate>Tue, 23 Jul 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/singular-value-decomposition/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Eigenthingies and Diagonalizability</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/diagonalization/</link>
  <description><![CDATA[ 





<p>Each square matrix possesses a collection of one or more complex scalars, called <em>eigenvalues</em> and associated vectors called <em>eigenvectors</em>. A <em>matrix</em> is a concrete realization of a linear transformation on a vector space. The eigenvectors indicate the directions of pure stretch and the eigenvalues the extent of stretching.</p>
<section id="eigenvalues-and-eigenvectors" class="level2">
<h2 class="anchored" data-anchor-id="eigenvalues-and-eigenvectors">Eigenvalues and Eigenvectors</h2>
<div id="def-eigenvalue-and-eigenvector" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Eigenvalue and Eigenvector)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?A"> be an <img src="https://latex.codecogs.com/png.latex?n%20%5Ctimes%20n"> matrix. A scalar <img src="https://latex.codecogs.com/png.latex?%5Clambda"> is called an eigenvalue of <img src="https://latex.codecogs.com/png.latex?A"> if there exists a non-zero vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D%20%5Cneq%20%5Cmathbf%7B0%7D"> such that</p>
<p><span id="eq-eigenvalue-equation"><img src="https://latex.codecogs.com/png.latex?%0AA%5Cmathbf%7Bv%7D%20=%20%5Clambda%20%5Cmathbf%7Bv%7D%0A%5Ctag%7B1%7D"></span></p>
</div>
<p>In geometric terms, the matrix <img src="https://latex.codecogs.com/png.latex?A"> has the effect of stretching the eigenvector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D"> by an amount specified by the eigenvalue <img src="https://latex.codecogs.com/png.latex?%5Clambda">.</p>
<p>The eigenvalue equation (Equation&nbsp;1) is a system of linear equations is a system of linear equations for the entries of the eigenvector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D">, provided that the eigenvaluen <img src="https://latex.codecogs.com/png.latex?%5Clambda"> is specified in advance. But, Gaussian elimination per se cannot solve the problem of determining two unknowns <img src="https://latex.codecogs.com/png.latex?%5Clambda"> and <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D">. We can rewrite the equation in the form:</p>
<p><span id="eq-linear-system-for-eigenvector"><img src="https://latex.codecogs.com/png.latex?%0A(A-%20%5Clambda%20I)%5Cmathbf%7Bv%7D%20=%20%5Cmathbf%7B0%7D%0A%5Ctag%7B2%7D"></span></p>
<p>This is a homogenous system of linear equations. It has the trivial solution <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D=0">. But, we are specifically seeking a non-zero solution. The homogenous system <img src="https://latex.codecogs.com/png.latex?R%5Cmathbf%7Bx%7D=%5Cmathbf%7B0%7D"> has a non-trivial solution, if and only if, <img src="https://latex.codecogs.com/png.latex?R"> is singular, <img src="https://latex.codecogs.com/png.latex?rank(R)%20%3C%20n"> or equivalently <img src="https://latex.codecogs.com/png.latex?det(R)%20=%200">. Consequently, we desire</p>
<p><span id="eq-characteristic-equation"><img src="https://latex.codecogs.com/png.latex?%0Adet(A-%5Clambda%20I)%20=%200%0A%5Ctag%7B3%7D"></span></p>
<p>This is called the characteristic equation and <img src="https://latex.codecogs.com/png.latex?p(%5Clambda)%20=%20det(A-%5Clambda%20I)"> is called the characteristic polynomial.</p>
<p>In practice, one first solves the characteristic equation (Equation&nbsp;3) to obtain a set of eigenvalues. Then, for each eigenvalue, we use standard linear algebra methods e.g.&nbsp;Gaussian elimination to solve the correponding linear system Equation&nbsp;2 for the associated eigenvector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D">.</p>
</section>
<section id="emhe" class="level2">
<h2 class="anchored" data-anchor-id="emhe">EMHE</h2>
<div id="thm-every-matrix-has-atleast-one-eigenvalue" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1</strong></span> Every matrix has atleast one eigenvalue, and a corresponding eigenvector.</p>
</div>
<p><em>Proof.</em></p>
<p>This is just the FTA(Fundamental Theorem of Algebra), but it’s still worth enumerating as a theorem.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5Cmathbb%7BC%7D%5E%7Bn%20%5Ctimes%20n%7D"> and the scalar field <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BF%7D=%20%5Cmathbb%7BR%7D">.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D"> be any non-zero vector in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BC%7D%5En">. Consider the list <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cmathbf%7Bv%7D,A%5Cmathbf%7Bv%7D,%5Cldots,A%5En%20%5Cmathbf%7Bv%7D%5C%7D">. These are <img src="https://latex.codecogs.com/png.latex?n+1"> vectors and this must be a linearly dependent set. There exists <img src="https://latex.codecogs.com/png.latex?a_0,%20%5Cldots,%20a_n"> not all zero, such that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aa_n%20A%5En%20%5Cmathbf%7Bv%7D%20+%20a_%7Bn-1%7DA%5E%7Bn-1%7D%5Cmathbf%7Bv%7D%20+%20%5Cldots%20+%20a_1%20A%20%5Cmathbf%7Bv%7D%20+%20a_0%20I%20%5Cmathbf%7Bv%7D%20=%20%5Cmathbf%7B0%7D%0A"></p>
<p>Since this holds for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D%5Cneq%20%5Cmathbf%7B0%7D">, the linear operator <img src="https://latex.codecogs.com/png.latex?a_n%20A%5En%20+%20%5Cldots%20+%20a_1%20A%20+%20a_0%20I"> must be the zero transformation.</p>
<p>By FTA, the polynomial equation with complex coefficients of degree <img src="https://latex.codecogs.com/png.latex?n">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap(x)%20=%20a_0%20+%20a_1%20x%20+%20a_2%20x%5E2%20+%20%5Cldots%20+%20a_%7Bn%7Dx%5En%0A"></p>
<p>can be factorized as :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap(x)%20=%20(x%20-%20%5Clambda_1)(x%20-%20%5Clambda_2)%5Ccdots(x%20-%20%5Clambda_n)%0A"></p>
<p>Putting it all together,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ap(A)%5Cmathbf%7Bv%7D%20&amp;=%20(A%20-%20%5Clambda_1%20I)(A%20-%20%5Clambda_2%20I)%5Ccdots%20(A%20-%20%5Clambda_n%20I)%5Cmathbf%7Bv%7D%20=%20%5Cmathbf%7B0%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cforall%20%5Cmathbf%7Bv%7D%20%5Cneq%20%5Cmathbf%7B0%7D">.</p>
<p>So, the composition of the factors <img src="https://latex.codecogs.com/png.latex?(A-%5Clambda_1%20I)%5Ccdots%20(A%20-%20%5Clambda_n%20I)"> has a non-trivial null space.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aker((A-%5Clambda_1%20I)(A-%5Clambda_2%20I)%5Ccdots%20(A%20-%20%5Clambda_n%20I))%20%5Cneq%20%5C%7B%5Cmathbf%7B0%7D%5C%7D%0A"></p>
<p>So, atleast one of the factors must fail to be injective. There exists <img src="https://latex.codecogs.com/png.latex?%5Clambda_i">, such that <img src="https://latex.codecogs.com/png.latex?(A-%5Clambda_i%20I)%5Cmathbf%7Bv%7D=%5Cmathbf%7B0%7D"> such that <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D%5Cneq%20%5Cmathbf%7B0%7D">. Thus, <img src="https://latex.codecogs.com/png.latex?A"> has atleast one eigenvalue and one eigenvector. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="eigenvectors-as-the-basis-of-a-vector-space" class="level2">
<h2 class="anchored" data-anchor-id="eigenvectors-as-the-basis-of-a-vector-space">Eigenvectors as the basis of a vector space</h2>
<div id="lem-linear-independence-of-eigenvectors" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 1</strong></span> If <img src="https://latex.codecogs.com/png.latex?%5Clambda_1%20%5Cgeq%20%5Clambda_2%20%5Cgeq%20%5Cldots%20%5Cgeq%20%5Clambda_n"> are <img src="https://latex.codecogs.com/png.latex?n"> distinct eigenvalues of a matrix <img src="https://latex.codecogs.com/png.latex?A">, <img src="https://latex.codecogs.com/png.latex?%5Clambda_i%20%5Cneq%20%5Clambda_j">, <img src="https://latex.codecogs.com/png.latex?%5Cforall%20i%20%5Cneq%20j">, then the corresponding eigenvectors <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cmathbf%7Bv%7D_1,%5Cldots,%5Cmathbf%7Bv%7D_n%5C%7D"> are linearly independent.</p>
</div>
<p><em>Proof</em>.</p>
<p>We use induction on the number of eigenvalues. The case <img src="https://latex.codecogs.com/png.latex?k=1"> is immediate, since an eigenvector cannot be zero. Assume that we know that the result is valid for <img src="https://latex.codecogs.com/png.latex?(k-1)"> eigenvalues. Our claim is that <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cmathbf%7Bv%7D_1,%5Cldots,%5Cmathbf%7Bv%7D_%7Bk-1%7D,%5Cmathbf%7Bv%7D_k%5C%7D"> are linearly independent.</p>
<p>Suppose we have a vanishing linear combination:</p>
<p><span id="eq-vanishing-linear-combination"><img src="https://latex.codecogs.com/png.latex?%0Ac_1%20%5Cmathbf%7Bv%7D_1%20+%20c_2%20%5Cmathbf%7Bv%7D_2%20+%20%5Cldots%20+%20c_%7Bk%7D%20%5Cmathbf%7Bv%7D_k%20=%20%5Cmathbf%7B0%7D%0A%5Ctag%7B4%7D"></span></p>
<p>Let us multiply this equation by the matrix <img src="https://latex.codecogs.com/png.latex?A">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ac_1%20A%5Cmathbf%7Bv%7D_1%20+%20c_2%20A%5Cmathbf%7Bv%7D_2%20+%20%5Cldots%20+%20c_%7Bk%7D%20A%5Cmathbf%7Bv%7D_k%20&amp;=%20%5Cmathbf%7B0%7D%5C%5C%0A%5CLongrightarrow%20c_1%20%5Clambda_1%20%5Cmathbf%7Bv%7D_1%20+%20c_2%20%5Clambda_2%20%5Cmathbf%7Bv%7D_2%20+%20%5Cldots%20+%20c_k%20%5Clambda_k%20%5Cmathbf%7Bv%7D_k%20&amp;=%20%5Cmathbf%7B0%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>On the other hand if we multiply the original Equation&nbsp;4 by <img src="https://latex.codecogs.com/png.latex?%5Clambda_k">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ac_1%20%5Clambda_k%20%5Cmathbf%7Bv%7D_1%20+%20c_2%20%5Clambda_k%20%5Cmathbf%7Bv%7D_2%20+%20%5Cldots%20+%20c_%7Bk%7D%20%5Clambda_k%20%5Cmathbf%7Bv%7D_k%20=%20%5Cmathbf%7B0%7D%0A"></p>
<p>Upon subtracting this from the previous equation, we obtain:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ac_1%20(%5Clambda_1%20-%20%5Clambda_k)%20%5Cmathbf%7Bv%7D_1%20+%20c_2%20(%5Clambda_2%20-%20%5Clambda_k)%5Cmathbf%7Bv%7D_2%20+%20%5Cldots%20+%20c_%7Bk-1%7D%20(%5Clambda_%7Bk-1%7D%20-%20%5Clambda_k)%5Cmathbf%7Bv%7D_%7Bk-1%7D%20=%20%5Cmathbf%7B0%7D%0A"></p>
<p>This is a vanishing linear combination of the first <img src="https://latex.codecogs.com/png.latex?(k-1)"> eigenvectors, and so, by our induction hypothesis, it can only happen if all the coefficients are zero:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ac_1(%5Clambda_1%20-%20%5Clambda_k)%20=%20c_2(%5Clambda_2%20-%20%5Clambda_k)%20=%20%5Cldots%20=%20c_%7Bk-1%7D(%5Clambda_%7Bk-1%7D%20-%20%5Clambda_k)%20=%200%0A"></p>
<p>The eigenvalues were assumed to be distinct, and consequently <img src="https://latex.codecogs.com/png.latex?c_1%20=%20c_2%20=%20%5Cldots%20=%20c_%7Bk-1%7D%20=%200">. Substituting these values back into Equation&nbsp;4, we find that <img src="https://latex.codecogs.com/png.latex?c_k%20%5Cmathbf%7Bv%7D_k%20=%200">, and so <img src="https://latex.codecogs.com/png.latex?c_k%20=%200"> also, since <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D_k%20%5Cneq%20%5Cmathbf%7B0%7D">. Thus, we have proved that, if Equation&nbsp;4 holds, then <img src="https://latex.codecogs.com/png.latex?c_1%20=%20%5Cldots%20=%20c_k%20=%200">. Thus, <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cmathbf%7Bv%7D_1,%5Cldots,%5Cmathbf%7Bv%7D_k%5C%7D"> is a linearly independent set. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="thm-eigenbasis" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> If the <img src="https://latex.codecogs.com/png.latex?n%20%5Ctimes%20n"> real matrix <img src="https://latex.codecogs.com/png.latex?A"> has <img src="https://latex.codecogs.com/png.latex?n"> distinct real eigenvalues <img src="https://latex.codecogs.com/png.latex?%5Clambda_1,%5Clambda_2,%5Cldots,%5Clambda_n">, then the corresponding real eigenvectors <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D_1,%5Cldots,%5Cmathbf%7Bv%7D_n"> form a basis of <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5En">. If <img src="https://latex.codecogs.com/png.latex?A"> (which may be either real or complex-valued matrix) has <img src="https://latex.codecogs.com/png.latex?n"> distinct complex eigenvalues, then the corresponding eigenvectors <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D_1,%5Cldots,%5Cmathbf%7Bv%7D_n"> form a basis of <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BC%7D%5En">.</p>
</div>
</section>
<section id="diagonalization" class="level2">
<h2 class="anchored" data-anchor-id="diagonalization">Diagonalization</h2>
<p>Consider a square matrix <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5Cmathbb%7BR%7D%5E%7Bn%20%5Ctimes%20n%7D"> with <img src="https://latex.codecogs.com/png.latex?n"> distinct eigenvalues. We can then write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%5Cbegin%7Bbmatrix%7D%5Cmathbf%7Bv%7D_1%20%5C%5C%20%5Cmathbf%7Bv%7D_2%20%5C%5C%20%5Cvdots%20%5C%5C%20%5Cmathbf%7Bv%7D_n%5Cend%7Bbmatrix%7D%20=%0A%5Cbegin%7Bbmatrix%7D%0A%5Clambda_1%20%5C%5C%0A&amp;%20%5Clambda_2%20%5C%5C%0A&amp;%20&amp;%20%5Cddots%20%5C%5C%0A&amp;%20&amp;%20&amp;%20%5Clambda_n%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%5Cmathbf%7Bv%7D_1%20%5C%5C%20%5Cmathbf%7Bv%7D_2%20%5C%5C%20%5Cvdots%20%5C%5C%20%5Cmathbf%7Bv%7D_n%5Cend%7Bbmatrix%7D%0A"></p>
<p>Define <img src="https://latex.codecogs.com/png.latex?P"> as <img src="https://latex.codecogs.com/png.latex?(%5Cmathbf%7Bv%7D_1,%5Cmathbf%7Bv%7D_2,%5Cldots,%5Cmathbf%7Bv%7D_n)%5ET">. So, we can write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AAP%20&amp;=%20%5CLambda%20P%5C%5C%0AA%20&amp;%20=%20P%5E%7B-1%7D%5CLambda%20P%0A%5Cend%7Balign*%7D%0A"></p>
<p>or equivalently <img src="https://latex.codecogs.com/png.latex?A=P%5CLambda%20P%5E%7B-1%7D">, where <img src="https://latex.codecogs.com/png.latex?%5CLambda%20=%20diag(%5Clambda_1,%5Cldots,%5Clambda_n)"> is a diagonal matrix. Consequently, if the matrix <img src="https://latex.codecogs.com/png.latex?A"> has <img src="https://latex.codecogs.com/png.latex?n"> distinct eigenvalues, then <img src="https://latex.codecogs.com/png.latex?A"> is said to be <em>diagonalizable</em>.</p>
<div id="def-diagonalizability" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2</strong></span> A square matrix <img src="https://latex.codecogs.com/png.latex?A"> is said to be diagonalizable, if and only if, there exists a non-singular matrix <img src="https://latex.codecogs.com/png.latex?P">, such that <img src="https://latex.codecogs.com/png.latex?A"> has a matrix factorization:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20P%5CLambda%20P%5E%7B-1%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5CLambda=diag(%5Clambda_1,%5Cldots,%5Clambda_n)"> .</p>
</div>
</section>
<section id="gershgorin-circle-theorem" class="level2">
<h2 class="anchored" data-anchor-id="gershgorin-circle-theorem">Gershgorin-Circle Theorem</h2>
<p>In pratice, precisely computing the eigenvalues of a matrix is done using a numerical algorithm. In certain theoretical applications, we may not require numerical values, but only their approximate locations. The <em>Gershgorin circle theorem</em>, due to early 20th century Russian mathematician <a href="https://en.wikipedia.org/wiki/Semyon_Aranovich_Gershgorin">Semyon Gershgorin</a>, serves to restrict the eigenvalues to a certain well-defined region in the complex plane.</p>
<div id="def-gershgorin-disk" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3</strong></span> Let <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5Cmathbb%7BC%7D%5E%7Bn%20%5Ctimes%20n%7D"> be a square matrix. For each <img src="https://latex.codecogs.com/png.latex?1%20%5Cleq%20i%20%5Cleq%20n"> , define the <img src="https://latex.codecogs.com/png.latex?i"> th Gershgorin disk</p>
<p><span id="eq-gershgorin-disk"><img src="https://latex.codecogs.com/png.latex?%0AD_i%20=%20%5C%7B%7Cz%20-%20a_%7Bii%7D%7C%3Cr_i:z%5Cin%5Cmathbb%7BC%7D%5C%7D,%20%5Cquad%20r_i%20=%20%5Csum_%7Bj,j%5Cneq%20i%7D%20%7Ca_%7Bij%7D%7C%0A%5Ctag%7B5%7D"></span></p>
<p>The <em>Gershgorin domain</em> <img src="https://latex.codecogs.com/png.latex?D_A%20=%20%5Cbigcup_%7Bi=1%7D%5En%20D_i%20%5Csubset%20%5Cmathbb%7BC%7D"> is the union of the Gershgorin disks.</p>
</div>
<p>Thus, the <img src="https://latex.codecogs.com/png.latex?i">th Gershgorin disk <img src="https://latex.codecogs.com/png.latex?D_i"> is centered at the <img src="https://latex.codecogs.com/png.latex?i">-th diagonal entry of <img src="https://latex.codecogs.com/png.latex?A"> and is an open ball of radius <img src="https://latex.codecogs.com/png.latex?r_i"> equal to the sum of the absolute values of the off-diagonal entries that are in it’s <img src="https://latex.codecogs.com/png.latex?i">-th row.</p>
<p><em>Proof</em></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D"> be an eigenvector of <img src="https://latex.codecogs.com/png.latex?A"> with eigenvalue <img src="https://latex.codecogs.com/png.latex?%5Clambda">. Let <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bu%7D=%5Cmathbf%7Bv%7D/%7C%7Cv%7C%7C_%7B%5Cinfty%7D"> be the corresponding unit eigenvector with respect to the <img src="https://latex.codecogs.com/png.latex?%5Cinfty">-norm, so that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%7C%7Cu%7C%7C_%7B%5Cinfty%7D%20=%20%5Cmax%5C%7B%7Cu%7C_1,%7Cu%7C_2,%5Cldots,%7Cu%7C_n%5C%7D%20=%201%0A"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?u_i"> be an entry of <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bu%7D"> that achieves the maximum: <img src="https://latex.codecogs.com/png.latex?%7Cu_i%7C=1">. Writing out the <img src="https://latex.codecogs.com/png.latex?i">-th component of the eigenvalue equation <img src="https://latex.codecogs.com/png.latex?A%5Cmathbf%7Bu%7D=%5Clambda%20%5Cmathbf%7Bu%7D">, we obtain:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csum_%7Bj=1%7D%5E%7Bn%7D%20a_%7Bij%7Du_j%20&amp;=%20%5Clambda%20u_i%20%5C%5C%0A%5Csum_%7Bj%20%5Cneq%20i%7D%20a_%7Bij%7Du_j%20&amp;=%20(%5Clambda%20-%20a_%7Bii%7D)%20u_i%0A%5Cend%7Balign*%7D%0A"></p>
<p>Therefore, since all <img src="https://latex.codecogs.com/png.latex?%7Cu_j%7C%20%5Cleq%201">, while <img src="https://latex.codecogs.com/png.latex?%7Cu_i%7C=1">, the distance between <img src="https://latex.codecogs.com/png.latex?%5Clambda"> and <img src="https://latex.codecogs.com/png.latex?a_%7Bii%7D"> can be bounded from above as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%7C%5Clambda%20-%20a_%7Bii%7D%7C%20&amp;=%20%5CBigg%7C%5Csum_%7Bj%20%5Cneq%20i%7D%20a_%7Bij%7Du_j%20%5CBigg%7C%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bj%20%5Cneq%20i%7D%20%7Ca_%7Bij%7D%7C%7Cu_j%7C%20&amp;%20%5C%7B%5Ctext%7B%20Triangle%20Inequality%20%7D%5C%7D%5C%5C%0A&amp;%5Cleq%20%5Csum_%7Bj%20%5Cneq%20i%7D%20%7Ca_%7Bij%7D%7C%20&amp;%20%5C%7B%20%7Cu_j%7C%20%5Cleq%201%20%5C%7D%5C%5C%0A&amp;=%20r_i%0A%5Cend%7Balign*%7D%0A"></p>
<p>This immediately implies that <img src="https://latex.codecogs.com/png.latex?%5Clambda%20%5Cin%20D_i%20%5Csubset%20D_A"> belongs to the <img src="https://latex.codecogs.com/png.latex?i">th Gershgorin disk.</p>


<!-- -->

</section>

 ]]></description>
  <category>Linear Algebra</category>
  <guid>https://quantdev.blog/posts/diagonalization/</guid>
  <pubDate>Mon, 22 Jul 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/diagonalization/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>The Spectral Theorem</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/spectral_theorem/</link>
  <description><![CDATA[ 





<section id="spectral-theorem" class="level1">
<h1>Spectral Theorem</h1>
<p>Every real, symmetric matrix is orthogonally diagonalizable.</p>
<div id="thm-spectral-theorem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Spectral Theorem)</strong></span> Every real symmetric matrix is diagonalizable.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?A"> be a <img src="https://latex.codecogs.com/png.latex?n%20%5Ctimes%20n"> real symmetric matrix. Then,</p>
<ol type="1">
<li>The eigenvalues of <img src="https://latex.codecogs.com/png.latex?A"> are real.</li>
<li>There exists an orthonormal basis <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cmathbf%7Bq%7D_1,%5Cldots,%5Cmathbf%7Bq%7D_n%5C%7D"> for <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5En"> consisting of the eigenvectors of <img src="https://latex.codecogs.com/png.latex?A">. That is, there is an orthogonal matrix <img src="https://latex.codecogs.com/png.latex?Q"> so that <img src="https://latex.codecogs.com/png.latex?A%20=%20QAQ%5E%7B-1%7D">.</li>
</ol>
</div>
<div id="tip-spectrum" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;1: Spectral values
</div>
</div>
<div class="callout-body-container callout-body">
<p>The term <em>spectrum</em> refers to the eigenvalues of a matrix, or more, generally a linear operator. In Physics, the spectral energy lines of atoms (e.g.&nbsp;Balmer lines of the Hydrogen atom), are characterized as the eigenvalues of the governing quantum mechanical Schrodinger operator.</p>
</div>
</div>
<p><em>Proof.</em></p>
<p><em>Claim.</em> The eigenvalues of <img src="https://latex.codecogs.com/png.latex?A"> are real.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Clangle%20A%5Cmathbf%7Bx%7D,%20%5Cmathbf%7By%7D%20%5Crangle%20&amp;=%20(A%20%5Cmathbf%7Bx%7D)'%20%5Cmathbf%7By%7D%5C%5C%0A&amp;=%20%5Cmathbf%7Bx%7D'A'%20%5Cmathbf%7By%7D%5C%5C%0A&amp;=%20%5Clangle%20%5Cmathbf%7Bx%7D,A'%5Cmathbf%7By%7D%5Crangle%0A%5Cend%7Balign*%7D%0A"></p>
<p>Since, for a symmetric matrix <img src="https://latex.codecogs.com/png.latex?A">, <img src="https://latex.codecogs.com/png.latex?A%20=%20A'">, it follows that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clangle%20A%5Cmathbf%7Bx%7D,%5Cmathbf%7By%7D%5Crangle%20=%20%5Clangle%20%5Cmathbf%7Bx%7D,%20A%5Cmathbf%7By%7D%20%5Crangle%0A"></p>
<p>Or using the dot-product notation, we could write:</p>
<p><span id="eq-dot-product-symmetric"><img src="https://latex.codecogs.com/png.latex?%0A(A%5Cmathbf%7Bx%7D)%5Ccdot%20%5Cmathbf%7By%7D%20=%20%5Cmathbf%7Bx%7D%5Ccdot%20(A%5Cmathbf%7By%7D)%0A%5Ctag%7B1%7D"></span></p>
<p>Suppose <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D%5Cneq%5Cmathbf%7B0%7D"> is a non-zero vector in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5En"> such that there exists a complex scalar <img src="https://latex.codecogs.com/png.latex?%5Clambda">, satisfying:</p>
<p><span id="eq-eigenvalue-equation"><img src="https://latex.codecogs.com/png.latex?%0AA%20%5Cmathbf%7Bv%7D%20=%20%5Clambda%20%5Cmathbf%7Bv%7D%0A%5Ctag%7B2%7D"></span></p>
<p>We can now take the complex conjugate of the eigenvalue equation. Remember that <img src="https://latex.codecogs.com/png.latex?A"> is a real matrix, so <img src="https://latex.codecogs.com/png.latex?%5Cbar%7BA%7D%20=%20A">. Thus, we have the conjugated version of the eigenvalue equation:</p>
<p><span id="eq-complex-conjugate"><img src="https://latex.codecogs.com/png.latex?%0A%5Coverline%7B(A%5Cmathbf%7Bv%7D)%7D=%5Coverline%7BA%7D%5Coverline%7B%5Cmathbf%7Bv%7D%7D%20=%20A%5Coverline%7B%5Cmathbf%7Bv%7D%7D%20=%20%5Coverline%7B%5Clambda%20%5Cmathbf%7Bv%7D%7D%20=%20%5Coverline%7B%5Clambda%7D%5Coverline%7B%5Cmathbf%7Bv%7D%7D%0A%5Ctag%7B3%7D"></span></p>
<p>Using the eigenvalue equation (Equation&nbsp;2), we can write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(A%20%5Cmathbf%7Bv%7D)%5Ccdot%20%5Coverline%7B%5Cmathbf%7Bv%7D%7D%20=%20(%5Clambda%20%5Cmathbf%7Bv%7D)%20%5Ccdot%20%5Coverline%7B%5Cmathbf%7Bv%7D%7D%20=%20%5Clambda%20(%5Cmathbf%7Bv%7D%20%5Ccdot%20%5Coverline%7B%5Cmathbf%7Bv%7D%7D)%0A"></p>
<p>Alternatively, using Equation&nbsp;1 and Equation&nbsp;3, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(A%20%5Cmathbf%7Bv%7D)%5Ccdot%20%5Coverline%7B%5Cmathbf%7Bv%7D%7D%20=%20%5Cmathbf%7Bv%7D%20%5Ccdot%20(A%5Coverline%7B%5Cmathbf%7Bv%7D%7D)%20=%20%5Cmathbf%7Bv%7D%20%5Ccdot%20(%5Coverline%7B%5Clambda%7D%20%5Coverline%7B%5Cmathbf%7Bv%7D%7D)%20=%20%5Coverline%7B%5Clambda%7D%20(%5Cmathbf%7Bv%7D%20%5Ccdot%20%5Coverline%7B%5Cmathbf%7Bv%7D%7D)%0A"></p>
<p>Consequently,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Clambda%20-%20%5Coverline%7B%5Clambda%7D)(%5Cmathbf%7Bv%7D%5Ccdot%20%5Coverline%7B%5Cmathbf%7Bv%7D%7D)%20=%200%0A"></p>
<p>Since, <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D%20%5Cneq%20%5Cmathbf%7B0%7D">, <img src="https://latex.codecogs.com/png.latex?%5Clambda%20=%20%5Coverline%7B%5Clambda%7D">. Therefore, <img src="https://latex.codecogs.com/png.latex?%5Clambda%20%5Cin%20%5Cmathbb%7BR%7D">.</p>
<p><em>Claim.</em> <img src="https://latex.codecogs.com/png.latex?A"> is orthogonally diagonalizable.</p>
<p>We proceed by induction.</p>
<p>For <img src="https://latex.codecogs.com/png.latex?n=1">, <img src="https://latex.codecogs.com/png.latex?A"> and <img src="https://latex.codecogs.com/png.latex?v"> are scalars, so <img src="https://latex.codecogs.com/png.latex?Av%20=%20%5Clambda%20v">, where <img src="https://latex.codecogs.com/png.latex?%5Clambda%20=%20A">. Thus, we can pick any non-zero scalar <img src="https://latex.codecogs.com/png.latex?v"> to form a basis in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D">. And <img src="https://latex.codecogs.com/png.latex?A=P%5E%7B-1%7D%5CLambda%20P">, where <img src="https://latex.codecogs.com/png.latex?P=I"> and <img src="https://latex.codecogs.com/png.latex?%5CLambda%20=%20A">.</p>
<p><em>Inductive hypotheis</em>. Every <img src="https://latex.codecogs.com/png.latex?k%20%5Ctimes%20k"> matrix is diagonalisable for <img src="https://latex.codecogs.com/png.latex?k=1,2,3,%5Cldots,n-1">.</p>
<p><em>Claim.</em> Let <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5Cmathbf%7BR%7D%5E%7Bn%20%5Ctimes%20n%7D"> be symmetric. Then, we are interested to prove that <img src="https://latex.codecogs.com/png.latex?A"> is diagonalizable. We break the induction part into 3 steps.</p>
<p>Every square matrix <img src="https://latex.codecogs.com/png.latex?A"> has atleast one eigenvalue. Suppose <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B1%7D"> is an eigenvalue of the matrix <img src="https://latex.codecogs.com/png.latex?A"> and has a corresponding eigenvector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D_1">. By part (I), we know that <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B1%7D%5Cin%5Cmathbf%7BR%7D">. We can normalize <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D_1"> as <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bq%7D_%7B1%7D%20=%20%5Cmathbf%7Bv%7D_1/%7C%7C%5Cmathbf%7Bv%7D_1%7C%7C">, so that it is an eigenvector with eigenvalue <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B1%7D">. (Obviously, this is no problem, since if <img src="https://latex.codecogs.com/png.latex?A%5Cmathbf%7Bv%7D_1%20=%20%5Clambda_1%20%5Cmathbf%7Bv%7D_1">, it implies <img src="https://latex.codecogs.com/png.latex?A%20(%5Cmathbf%7Bv%7D_1/%7C%7C%5Cmathbf%7Bv%7D_1%7C%7C)%20=%20%5Clambda_1%20(%5Cmathbf%7Bv%7D_1/%7C%7C%5Cmathbf%7Bv%7D_1%7C%7C)">. It follows that, <img src="https://latex.codecogs.com/png.latex?A%20%5Cmathbf%7Bq%7D_1%20=%20%5Clambda_1%20%5Cmathbf%7Bq%7D_1">. )</p>
<p>Now, we can extend this to a basis <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cmathbf%7Bq%7D_%7B1%7D,%5Cmathbf%7Bw%7D_%7B2%7D,%5Cldots,%5Cmathbf%7Bw%7D_%7Bn%7D%5C%7D"> of <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5En">. By the Gram-Schmidt orthogonalization algorithm, given the basis <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cmathbf%7Bq%7D_%7B1%7D,%5Cmathbf%7Bw%7D_%7B2%7D,%5Cldots,%5Cmathbf%7Bw%7D_%7Bn%7D%5C%7D">, we can find a corresponding orthonormal basis <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cmathbf%7Bq%7D_%7B1%7D,%5Cmathbf%7Bq%7D_%7B2%7D,%5Cldots,%5Cmathbf%7Bq%7D_%7Bn%7D%5C%7D"> of <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5En">.</p>
<p>Now, we huddle these basis vectors together as column-vectors of a matrix and formulate the matrix <img src="https://latex.codecogs.com/png.latex?P">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AP%20&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bcccc%7D%0A%5Cmathbf%7B%5Cmathbf%7Bq%7D_%7B1%7D%7D%20&amp;%20%5Cmathbf%7Bq%7D_%7B2%7D%20&amp;%20%5Cldots%20&amp;%20%5Cmathbf%7Bq%7D_%7Bn%7D%5Cend%7Barray%7D%5Cright%5D%0A%5Cend%7Balign*%7D%0A"></p>
<p>By definition, <img src="https://latex.codecogs.com/png.latex?P"> is an orthogonal matrix. So, <img src="https://latex.codecogs.com/png.latex?P%5E%7B-1%7D%20=%20P%5ET">.</p>
<p>Define</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AB%20&amp;%20=P%5E%7B-1%7DAP%0A%5Cend%7Balign*%7D%0A"></p>
<p><em>Step I</em>. <img src="https://latex.codecogs.com/png.latex?B"> is symmetric.</p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AB%5E%7BT%7D%20&amp;%20=(P%5E%7B-1%7DAP)%5E%7BT%7D%5C%5C%0A&amp;%20=(P%5E%7BT%7DAP)%5E%7BT%7D%20&amp;%20%5C%7BP%5E%7B-1%7D=P%5E%7BT%7D%5C%7D%5C%5C%0A&amp;%20=P%5E%7BT%7DA%5E%7BT%7D(P%5E%7BT%7D)%5E%7BT%7D%5C%5C%0A&amp;%20=P%5E%7BT%7DA%5E%7BT%7DP%5C%5C%0A&amp;%20=P%5E%7BT%7DAP%20&amp;%20%5C%7BA%5Ctext%7B%20is%20symmetric%7D%5C%7D%5C%5C%0A&amp;%20=B%0A%5Cend%7Balign*%7D%0A"></p>
<p>We are now going to try and write <img src="https://latex.codecogs.com/png.latex?B"> in the block form to try to see the structure that this matrix must have and hope that it looks like, it is going to be diagonal.</p>
<p><em>Step II.</em> The structure of <img src="https://latex.codecogs.com/png.latex?B">.</p>
<p>The way we do this, is to consider the matrix <img src="https://latex.codecogs.com/png.latex?B"> post-multiplied by <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Be%7D_%7B1%7D">. Consider <img src="https://latex.codecogs.com/png.latex?B%5Cmathbf%7Be%7D_%7B1%7D">. This should actually give us the first column of <img src="https://latex.codecogs.com/png.latex?B">. Now, we also know that <img src="https://latex.codecogs.com/png.latex?B=P%5E%7BT%7DAP">. So, we could actually say, well,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AP%5E%7BT%7DAP%5Cmathbf%7Be%7D_%7B1%7D%20&amp;%20=P%5E%7BT%7DA%5Cmathbf%7Bq%7D_%7B1%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Now, remember that <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bq%7D_%7B1%7D"> is the normalized eigenvector corresponding to the eigenvalue <img src="https://latex.codecogs.com/png.latex?%5Clambda_%7B1%7D">. So, <img src="https://latex.codecogs.com/png.latex?A%5Cmathbf%7Bq%7D_%7B1%7D=%5Clambda_%7B1%7D%5Cmathbf%7Bq%7D_%7B1%7D">. That means, this is equal to:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AP%5E%7BT%7DA%5Cmathbf%7Bq%7D_%7B1%7D%20&amp;%20=P%5E%7BT%7D%5Clambda_%7B1%7D%5Cmathbf%7Bq%7D_%7B1%7D%5C%5C%0A&amp;%20=%5Clambda_%7B1%7DP%5E%7Bt%7D%5Cmathbf%7Bq%7D_%7B1%7D%5C%5C%0A&amp;%20=%5Clambda_%7B1%7D%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D%0A%5Cmathbf%7Bq%7D_%7B1%7D%5E%7BT%7D%5C%5C%0A%5Cmathbf%7Bq%7D_%7B2%7D%5E%7BT%7D%5C%5C%0A%5Cvdots%5C%5C%0A%5Cmathbf%7Bq%7D_%7Bn%7D%5E%7BT%7D%0A%5Cend%7Barray%7D%5Cright%5D%5Cmathbf%7Bq%7D_%7B1%7D%5C%5C%0A&amp;%20=%5Clambda_%7B1%7D%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D%0A%5Cmathbf%7Bq%7D_%7B1%7D%5E%7BT%7D%5Cmathbf%7Bq%7D_%7B1%7D%5C%5C%0A%5Cmathbf%7Bq%7D_%7B2%7D%5E%7BT%7D%5Cmathbf%7Bq%7D_%7B1%7D%5C%5C%0A%5Cvdots%5C%5C%0A%5Cmathbf%7Bq%7D_%7Bn%7D%5E%7BT%7D%5Cmathbf%7Bq%7D_%7B1%7D%0A%5Cend%7Barray%7D%5Cright%5D%5C%5C%0A&amp;%20=%5Clambda_%7B1%7D%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D%0A1%5C%5C%0A0%5C%5C%0A%5Cvdots%5C%5C%0A0%0A%5Cend%7Barray%7D%5Cright%5D%5C%5C%0A&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D%0A%5Clambda_%7B1%7D%5C%5C%0A0%5C%5C%0A0%5C%5C%0A0%0A%5Cend%7Barray%7D%5Cright%5D%0A%5Cend%7Balign*%7D"></p>
<p>This is the first column of the matrix <img src="https://latex.codecogs.com/png.latex?B">. Since <img src="https://latex.codecogs.com/png.latex?B=B%5E%7BT%7D">, the first row should also be</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0A%5Clambda_1%20&amp;%200%20&amp;%200%20&amp;%20%5Cldots%20&amp;%200%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>So, we can write the matrix <img src="https://latex.codecogs.com/png.latex?B"> in the block form:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AB%20&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A%5Clambda_%7B1%7D%20&amp;%20O%5C%5C%0AO%20&amp;%20C%0A%5Cend%7Barray%7D%5Cright%5D%0A%5Cend%7Balign*%7D"></p>
<p>The first row and the first column are satisying the need to be diagonal.</p>
<p><em>Step III.</em></p>
<p>We know that <img src="https://latex.codecogs.com/png.latex?C"> is a <img src="https://latex.codecogs.com/png.latex?n-1%5Ctimes%20n-1"> symmetric matrix. By the induction hypothesis, there exists an orthogonal matrix <img src="https://latex.codecogs.com/png.latex?Q"> such that <img src="https://latex.codecogs.com/png.latex?D=Q%5E%7B-1%7DCQ%20=%20Q%5ET%20C%20Q">.</p>
<p>Now, define the matrix <img src="https://latex.codecogs.com/png.latex?R"> as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Bequation%7D%0AR:=P%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%0A%5Cend%7Barray%7D%5Cright%5D%0A%5Cend%7Bequation%7D"></p>
<p><em>Claim</em>. Our claim is that <img src="https://latex.codecogs.com/png.latex?R"> is orthogonal and <img src="https://latex.codecogs.com/png.latex?R%5E%7B-1%7DAR"> is diagonal.</p>
<ol type="i">
<li>We have:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AR%5E%7B-1%7D%20&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%5E%7B-1%7D%0A%5Cend%7Barray%7D%5Cright%5DP%5E%7B-1%7D%20&amp;%20%5C%7B%5Ctext%7BReverse%20order%20law%7D%5C%7D%5C%5C%0A&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%5E%7BT%7D%0A%5Cend%7Barray%7D%5Cright%5DP%5E%7BT%7D%20&amp;%20%5C%7BP%5Ctext%7B%20and%20%7DQ%5Ctext%7B%20are%20orthogonal%7D%5C%7D%0A%5Cend%7Balign*%7D"></p>
<p>But,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AR%5E%7BT%7D%20&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%5E%7BT%7D%0A%5Cend%7Barray%7D%5Cright%5DP%5E%7BT%7D%0A%5Cend%7Balign*%7D"></p>
<p>So,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AR%5E%7BT%7D%20&amp;%20=R%5E%7B-1%7D%0A%5Cend%7Balign*%7D"></p>
<p>Thus, <img src="https://latex.codecogs.com/png.latex?R"> is orthogonal.</p>
<ol start="2" type="i">
<li>Well, let’s compute <img src="https://latex.codecogs.com/png.latex?R%5E%7B-1%7DAR">.</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AR%5E%7B-1%7DAR%20&amp;%20=R%5E%7BT%7DAR%20&amp;%20%5C%7BR%5Ctext%7B%20is%20orthogonal%7D%5C%7D%5C%5C%0A&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%5E%7BT%7D%0A%5Cend%7Barray%7D%5Cright%5DP%5E%7BT%7DAP%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%0A%5Cend%7Barray%7D%5Cright%5D%5C%5C%0A&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%5E%7BT%7D%0A%5Cend%7Barray%7D%5Cright%5DB%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%0A%5Cend%7Barray%7D%5Cright%5D%5C%5C%0A&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%5E%7BT%7D%0A%5Cend%7Barray%7D%5Cright%5D%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A%5Clambda_%7B1%7D%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20C%0A%5Cend%7Barray%7D%5Cright%5D%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%0A%5Cend%7Barray%7D%5Cright%5D%5C%5C%0A&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A%5Clambda_%7B1%7D%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%5E%7BT%7DC%0A%5Cend%7Barray%7D%5Cright%5D%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A1%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%0A%5Cend%7Barray%7D%5Cright%5D%5C%5C%0A&amp;%20=%5Cleft%5B%5Cbegin%7Barray%7D%7Bcc%7D%0A%5Clambda_%7B1%7D%20&amp;%200_%7B1%5Ctimes%20n-1%7D%5C%5C%0A0_%7Bn-1%5Ctimes1%7D%20&amp;%20Q%5E%7BT%7DCQ%0A%5Cend%7Barray%7D%5Cright%5D%0A%5Cend%7Balign*%7D"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?Q%5E%7BT%7DCQ"> is diagonal, it follows that <img src="https://latex.codecogs.com/png.latex?R%5E%7B-1%7DAR"> is diagonal. This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>


<!-- -->

</section>

 ]]></description>
  <category>Linear Algebra</category>
  <guid>https://quantdev.blog/posts/spectral_theorem/</guid>
  <pubDate>Mon, 22 Jul 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/spectral_theorem/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Ito Calculus</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/ito_calculus/</link>
  <description><![CDATA[ 





<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<div id="exr-a-strange-martingale" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> (A strange martingale) Let <img src="https://latex.codecogs.com/png.latex?(B_t,t%5Cgeq%200)"> be a standard Brownian motion. Consider the process:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AM_t%20=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B1-t%7D%7D%5Cexp%5Cleft(%5Cfrac%7B-B_t%5E2%7D%7B2(1-t)%7D%5Cright),%20%5Cquad%20%5Ctext%7B%20for%20%7D0%20%5Cleq%20t%20%3C%201%0A"></p>
<ol type="a">
<li>Show that <img src="https://latex.codecogs.com/png.latex?M_t"> can be represented by:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0AM_t%20=%201%20+%20%5Cint_0%5Et%20%5Cfrac%7B-B_s%20M_s%7D%7B1-s%7DdB_s,%20%5Cquad%20%5Ctext%7B%20for%20%7D%200%20%5Cleq%20t%20%5Cleq%201%0A"></p>
<ol start="2" type="a">
<li><p>Deduce from the previous question that <img src="https://latex.codecogs.com/png.latex?(M_s,s%20%5Cleq%20t)"> is a martingale for <img src="https://latex.codecogs.com/png.latex?t%20%3C%201"> and for the Brownian filtration.</p></li>
<li><p>Show that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BM_t%5D%20=%201"> for all <img src="https://latex.codecogs.com/png.latex?t%20%3C%201">.</p></li>
<li><p>Prove that <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bt%20%5Cto%201%5E-%7D%20M_t%20=%200"> almost surely.</p></li>
</ol>
</div>
<p><em>Solution</em>.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?f(t,x)%20=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B1-t%7D%7De%5E%7B-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%7D">. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20&amp;=%20%5Cfrac%7B%5Csqrt%7B1-t%7D%5Ccdot%20e%5E%7B-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%7D%5Ccdot%20%5Cfrac%7Bx%5E2%7D%7B2(1-t)%5E2%7D%5Ccdot%20(-1)%20-%20e%5E%7B-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%7D%5Ccdot%20%5Cfrac%7B1%7D%7B2%5Csqrt%7B1-t%7D%7D%5Ccdot(-1)%7D%7B(1-t)%7D%5C%5C%0A&amp;=%5Cfrac%7Be%5E%7B-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%7D%7D%7B(1-t)%7D%5Cleft(%20-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%5E%7B3/2%7D%7D+%5Cfrac%7B1-t%7D%7B2(1-t)%5E%7B3/2%7D%7D%5Cright)%5C%5C%0A&amp;=%20%5Cfrac%7Be%5E%7B-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%7D((1-t)%20-%20x%5E2)%7D%7B2(1-t)%5E%7B5/2%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Also, the first and second derivatives with respect to the space variable <img src="https://latex.codecogs.com/png.latex?x"> are:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D%20&amp;=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B1-t%7D%7D%5Cexp%5Cleft(-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%5Cright)%5Cleft(-%5Cfrac%7Bx%7D%7B(1-t)%7D%5Cright)%5C%5C%0A&amp;=%20-%5Cfrac%7Bx%7D%7B(1-t)%5E%7B3/2%7D%7D%20%5Cexp%5Cleft(-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%5Cright)%0A%5Cend%7Balign*%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%20&amp;=%20-%20%5Cfrac%7B1%7D%7B(1-t)%5E%7B3/2%7D%7D%5Cleft%5C%7B%5Cexp%5Cleft(-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%5Cright)%20+%20x%5Cexp%5Cleft(-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%5Cright)%5Cleft(-%5Cfrac%7Bx%7D%7B(1-t)%7D%5Cright)%5Cright%5C%7D%5C%5C%0A&amp;=%20-%20%5Cfrac%7B1%7D%7B(1-t)%5E%7B3/2%7D%7D%5Cexp%5Cleft(-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%5Cright)%20%5Cleft%5C%7B1%20-%20%5Cfrac%7Bx%5E2%7D%7B(1-t)%7D%5Cright%5C%7D%5C%5C%0A&amp;=%20%5Cfrac%7B(x%5E2%20-%20(1-t))%7D%7B(1-t)%5E%7B5/2%7D%7D%5Cexp%5Cleft(-%5Cfrac%7Bx%5E2%7D%7B2(1-t)%7D%5Cright)%0A%5Cend%7Balign*%7D%0A"></p>
<p>By Ito’s formula:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Adf(t,B_t)%20&amp;=%20(f_t%20+%20%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D)dt%20+%20f_x%20dB_t%5C%5C%0AdM_t%20&amp;=%20-%5Cfrac%7BB_t%7D%7B(1-t)%7D%20%5Cfrac%7Be%5E%7B-%5Cfrac%7BB_t%5E2%7D%7B2(1-t)%7D%7D%7D%7B%5Csqrt%7B1-t%7D%7D%5C%5C%0A&amp;=%20-%5Cfrac%7BB_t%20M_t%7D%7B(1-t)%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>where in the second step, we used the fact that <img src="https://latex.codecogs.com/png.latex?f_t%20+%20%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D%20=%200">, so the <img src="https://latex.codecogs.com/png.latex?dt"> term is zero.</p>
<p>In the integral form:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AM_t%20-%20M_0%20&amp;=%20%5Cint%20%5Cfrac%7B-%20B_s%20M_s%7D%7B1%20-%20s%7DdB_s%5C%5C%0AM_t%20&amp;=%201%20+%20%5Cint%20%5Cfrac%7B-%20B_s%20M_s%7D%7B1%20-%20s%7DdB_s%0A%5Cend%7Balign*%7D%0A"></p>
<ol start="2" type="a">
<li><p>The Ito integral <img src="https://latex.codecogs.com/png.latex?%5Cint_0%5Et%20%5Cfrac%7B-B_s%20M_s%7D%7B1-s%7DdB_s"> is a continuous martingale with respect to the brownian filtration. Hence <img src="https://latex.codecogs.com/png.latex?(M_t,t%20%5Cgeq%200)"> is a martingale.</p></li>
<li><p>The expectation of an Ito integral is zero. Hence, <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BM_t%5D%20=%201"> for all <img src="https://latex.codecogs.com/png.latex?t%20%3C%201">.</p></li>
<li><p>Using Markov’s inequality followed by (concave) Jensen’s inequality, because we know that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BB_t%5E2%5D=t">, <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BB_t%5E4%5D=3t%5E2"> and <img src="https://latex.codecogs.com/png.latex?Var(B_t%5E2)%20=%202t%5E2"> for any <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20%3E%200">:</p></li>
</ol>


<!-- -->

</section>

 ]]></description>
  <category>Stochastic Calculus</category>
  <guid>https://quantdev.blog/posts/ito_calculus/</guid>
  <pubDate>Thu, 11 Jul 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/ito_calculus/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>The Markov Property</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/the_markov_property/</link>
  <description><![CDATA[ 





<section id="the-markov-property-for-diffusions" class="level2">
<h2 class="anchored" data-anchor-id="the-markov-property-for-diffusions">The Markov Property for Diffusions</h2>
<p>Let’s start by exhibiting the Markov property of Brownian motion. To see this, consider <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t,t%5Cgeq%200)">, the natural filtration of the Brownian motion <img src="https://latex.codecogs.com/png.latex?(B_t,t%5Cgeq%200)">. Consider <img src="https://latex.codecogs.com/png.latex?g(B_t)"> for some time <img src="https://latex.codecogs.com/png.latex?t"> and bounded function <img src="https://latex.codecogs.com/png.latex?g">. (For example, <img src="https://latex.codecogs.com/png.latex?g"> could be an indicator function.) Consider also a random variable <img src="https://latex.codecogs.com/png.latex?W"> that is <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_s"> measurable for <img src="https://latex.codecogs.com/png.latex?s%20%3C%20t">. (For example, <img src="https://latex.codecogs.com/png.latex?W"> could be <img src="https://latex.codecogs.com/png.latex?B_s"> or <img src="https://latex.codecogs.com/png.latex?1_%7BB_s%20%3E%200%7D">.) Let’s compute <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5Bg(B_t)W%5D">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Bg(B_t)W%5D%20&amp;=%20%5Cmathbb%7BE%7D%5B%5Cmathbb%7BE%7D%5BWg(B_t%20-%20B_s%20+%20B_s)%7C%5Cmathcal%7BF%7D_s%5D%5D%0A%5Cend%7Balign*%7D"></p>
<p>The random variable <img src="https://latex.codecogs.com/png.latex?(B_t%20-%20B_s)"> follows a <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BN%7D(0,t-s)"> distribution. By LOTUS,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Bg(B_t)W%5D%0A&amp;=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%20%5Cmathbb%7BE%7D%5BW%20g(y%20+%20B_s)%7C%5Cmathcal%7BF_s%7D%5Df_%7B(B_t%20-%20B_s)%7CB_s%7D(y)%20dy%5C%5C%0A&amp;=%20%5C%7B%5Ctext%7B%20Using%20the%20fact%20that%20%7DB_t%20-%20B_s%20%5Cperp%20B_s%5C%7D%5C%5C%0A&amp;=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%20%5Cmathbb%7BE%7D%5BW%20g(y%20+%20B_s)%5Df_%7B(B_t%20-%20B_s)%7D(y)dy%5C%5C%0A&amp;=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%20%5Cmathbb%7BE%7D%5BW%20g(y%20+%20B_s)%5D%5Cfrac%7Be%5E%7B-%5Cfrac%7By%5E2%7D%7B2(t-s)%7D%7D%7D%7B%5Csqrt%7B2%5Cpi(t-s)%7D%7Ddy%0A%5Cend%7Balign*%7D"></p>
<p>By Fubini’s theorem, the integral and the expectation operator can be interchanged, and since <img src="https://latex.codecogs.com/png.latex?W"> is <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_s"> measurable, it follows from the definition of conditional expectations that:</p>
<p><span id="eq-conditional-expectation-of-function-brownian-motion"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Bg(B_t)%7C%5Cmathcal%7BF%7D_s%5D%20&amp;=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%20g(y%20+%20B_s)%20%5Cfrac%7Be%5E%7B-%5Cfrac%7By%5E2%7D%7B2(t-s)%7D%7D%7D%7B%5Csqrt%7B2%5Cpi(t-s)%7D%7Ddy%0A%5Cend%7Balign*%7D%0A%5Ctag%7B1%7D"></span></p>
<p>We make two important observations. First, the right hand side is a function of <img src="https://latex.codecogs.com/png.latex?s,t"> and <img src="https://latex.codecogs.com/png.latex?B_s"> only (and not of the Brownian motion before time s). In particular, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5Bg(B_t)%7C%5Cmathcal%7BF%7D_s%5D%20=%20%5Cmathbb%7BE%7D%5Bg(B_t)%7CB_s%5D%0A"></p>
<p>This holds for any bounded function <img src="https://latex.codecogs.com/png.latex?g">. In particular, it holds for all indicator functions. This implies that the conditional distribution of <img src="https://latex.codecogs.com/png.latex?B_t"> given <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_s"> depends solely on <img src="https://latex.codecogs.com/png.latex?B_s">, and not on other values before time <img src="https://latex.codecogs.com/png.latex?s">. Second, the right-hand side is <em>time-homogenous</em> in the sense that it depends on the time difference <img src="https://latex.codecogs.com/png.latex?t-s">.</p>
<p>We have just shown that Brownian motion is a <em>time-homogenous Markov process</em>.</p>
<div id="def-markov-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Markov process.)</strong></span> Consider a stochastic process <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)"> and its natural filtration <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t,t%5Cgeq%200)">. It is said to be a <em>Markov process</em> if and only if for any (bounded) function <img src="https://latex.codecogs.com/png.latex?g:%20%5Cmathbb%7BR%7D%20%5Cto%20%5Cmathbb%7BR%7D">, we have:</p>
<p><span id="eq-markov-process"><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5Bg(X_t)%20%7C%20%5Cmathcal%7BF%7D_s%5D%20=%20%5Cmathbb%7BE%7D%5Bg(X_t)%20%7C%20X_s%5D,%20%5Cquad%20%5Cforall%20t%20%5Cgeq%200,%20%5Cforall%20s%20%5Cleq%20t%0A%5Ctag%7B2%7D"></span></p>
</div>
<p>This implies that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5Bg(X_t)%7C%5Cmathcal%7BF%7D_s%5D"> is an explicit function of <img src="https://latex.codecogs.com/png.latex?s">, <img src="https://latex.codecogs.com/png.latex?t"> and <img src="https://latex.codecogs.com/png.latex?X_s">. It is said to be <em>time-homogenous</em>, if it is a function of <img src="https://latex.codecogs.com/png.latex?t-s"> and <img src="https://latex.codecogs.com/png.latex?X_s">. Since the above holds for all bounded <img src="https://latex.codecogs.com/png.latex?g">, the conditional distribution of <img src="https://latex.codecogs.com/png.latex?X_t"> given <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_s"> is the same as the conditional distribution of <img src="https://latex.codecogs.com/png.latex?X_t"> given <img src="https://latex.codecogs.com/png.latex?X_s">.</p>
<p>One way to compute the conditional distribution of <img src="https://latex.codecogs.com/png.latex?X_t"> given <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_s"> is to compute the conditional MGF given <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_s">, that is:</p>
<p><span id="eq-conditional-mgf-of-xt"><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5Be%5E%7Ba%20X_t%7D%7C%5Cmathcal%7BF%7D_s%5D,%20%5Cquad%20a%20%5Cgeq%200%0A%5Ctag%7B3%7D"></span></p>
<p>The process would be Markov, if the conditional MGF is an explicit function of <img src="https://latex.codecogs.com/png.latex?s">, <img src="https://latex.codecogs.com/png.latex?t"> and <img src="https://latex.codecogs.com/png.latex?X_s">.</p>
<div id="exm-brownian-motion-is-markov" class="theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> (Brownian Motion is Markov) Let <img src="https://latex.codecogs.com/png.latex?(B_t,t%5Cgeq%200)"> be a standard brownian motion. Our claim is that the brownian motion is a markov process.</p>
</div>
<p><em>Proof.</em></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Be%5E%7Ba%20B_t%7D%7C%5Cmathcal%7BF%7D_s%5D%20&amp;=%20%5Cmathbb%7BE%7D%5Be%5E%7Ba%20(B_t%20-%20B_s%20+%20B_s)%7D%7C%5Cmathcal%7BF%7D_s%5D%5C%5C%0A&amp;%20%5C%7B%20%5Ctext%7B%20since%20%7DB_s%20%5Ctext%7B%20is%20%7D%5Cmathcal%7BF%7D_s-%5Ctext%7B%20measurable%20%7D%5C%7D%5C%5C%0A&amp;=%20e%5E%7Ba%20B_s%7D%20%5Cmathbb%7BE%7D%5Be%5E%7Ba%20(B_t%20-%20B_s)%7D%7C%5Cmathcal%7BF%7D_s%5D%5C%5C%0A&amp;%20%5C%7B%20%5Ctext%7B%20since%20%7DB_t%20-%20B_s%20%5Cperp%20%5Cmathcal%7BF%7D_s%20%5C%7D%5C%5C%0A&amp;=%20e%5E%7Ba%20B_s%7D%20%5Cmathbb%7BE%7D%5Be%5E%7Ba%20(B_t%20-%20B_s)%7D%5D%5C%5C%0A&amp;=%20e%5E%7Ba%20B_s%7D%20e%5E%7B%5Cfrac%7B1%7D%7B2%7Da%5E2(t-s)%7D%0A%5Cend%7Balign*%7D"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<p>An equivalent (but more symmetric) way to express the Markov property is to say that <em>the future of the process is independent of the past, when conditioned on the present</em>. Concretely, this means that for any <img src="https://latex.codecogs.com/png.latex?r%20%3C%20s%3C%20t">, we have that <img src="https://latex.codecogs.com/png.latex?X_t"> is independent of <img src="https://latex.codecogs.com/png.latex?X_r">, when we condition on <img src="https://latex.codecogs.com/png.latex?X_s">.</p>
<p>The conditional distribution of <img src="https://latex.codecogs.com/png.latex?X_t"> given <img src="https://latex.codecogs.com/png.latex?X_s"> is well described using <em>transition probabilities</em>. We will more interested in a case well these probabilities admit a density <img src="https://latex.codecogs.com/png.latex?f_%7BX_t%7CX_s=x%7D(y)">. More precisely, for such a Markov process, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Bg(X_t)%7CX_s%20=%20x%5D%20&amp;=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%20g(y)%20f_%7BX_t%7CX_s=x%7D(y)%20dy%5C%5C%0A&amp;=%5Cint_%7B%5Cmathbb%7BR%7D%7D%20g(y)%20p(y,t%7Cx,s)%20dy%0A%5Cend%7Balign*%7D%0A"></p>
<p>Here, we explicitly write the left-hand side as a function of space, that is, the position <img src="https://latex.codecogs.com/png.latex?X_s">, by fixing <img src="https://latex.codecogs.com/png.latex?X_s%20=%20x">. In words, the <em>transition probability density</em> <img src="https://latex.codecogs.com/png.latex?p(y,t%7Cx,s)"> represents the probability density that starting from <img src="https://latex.codecogs.com/png.latex?X_s%20=%20x"> at time <img src="https://latex.codecogs.com/png.latex?s">, the process ends up at <img src="https://latex.codecogs.com/png.latex?X_t%20=%20y"> at time <img src="https://latex.codecogs.com/png.latex?t%20%3E%20s">. If the process is time-homogenous, this only depends on the time difference <img src="https://latex.codecogs.com/png.latex?(t-s)"> and we write <img src="https://latex.codecogs.com/png.latex?p(y,t%7Cx,s)">. From Equation&nbsp;1, we can write: <img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5Bg(B_t)%7CB_s%20=%20x%5D%20=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%20g(u%20+%20x)%20%5Cfrac%7Be%5E%7B-%5Cfrac%7Bu%5E2%7D%7B2(t-s)%7D%7D%7D%7B%5Csqrt%7B2%5Cpi(t-s)%7D%7D%20du%0A"></p>
<p>In the above expression, the random variable <img src="https://latex.codecogs.com/png.latex?B_t%20-%20B_s"> takes some value <img src="https://latex.codecogs.com/png.latex?u%20%5Cin%20%5Cmathbb%7BR%7D"> and <img src="https://latex.codecogs.com/png.latex?B_s%20=%20x"> is fixed. Then, <img src="https://latex.codecogs.com/png.latex?B_t"> takes the value <img src="https://latex.codecogs.com/png.latex?u%20+%20x">. Let <img src="https://latex.codecogs.com/png.latex?y%20=%20u%20+%20x">. Then, <img src="https://latex.codecogs.com/png.latex?u%20=%20y%20-%20x">. Consequently, we may write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5Bg(B_t)%7CB_s%20=%20x%5D%20=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%20g(y)%20%5Cfrac%7Be%5E%7B-%5Cfrac%7B(y-x)%5E2%7D%7B2(t-s)%7D%7D%7D%7B%5Csqrt%7B2%5Cpi(t-s)%7D%7D%20dy%0A"></p>
<p>So, the transition density function for standard Brownian motion is:</p>
<p><span id="eq-brownian-motion-transition-density-function"><img src="https://latex.codecogs.com/png.latex?%0Ap(y,t%7Cx,0)=%20%5Cfrac%7Be%5E%7B-%5Cfrac%7B(y-x)%5E2%7D%7B2s%7D%7D%7D%7B%5Csqrt%7B2%5Cpi%20s%7D%7D,%20%5Cquad%20s%3E0,%20x,y%5Cin%5Cmathbb%7BR%7D%0A%5Ctag%7B4%7D"></span></p>
<p>This function is sometimes called the <em>heat kernel</em>, as it relates to the <em>heat equation</em>.</p>
<p>The Markov property is very convenient to compute quantities, as we shall see throughout the chapter. As a first example, we remark that it is easy to express joint probabilities of a markov process <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)"> at different times. Consider the functions <img src="https://latex.codecogs.com/png.latex?f%20=%20%5Cmathbf%7B1%7D_A"> and <img src="https://latex.codecogs.com/png.latex?g%20=%20%5Cmathbf%7B1%7D_B"> from <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%20%5Cto%20%5Cmathbb%7BR%7D">, where <img src="https://latex.codecogs.com/png.latex?A"> and <img src="https://latex.codecogs.com/png.latex?B"> are two intervals in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D">. Let’s compute <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(X_%7Bt_1%7D%20%5Cin%20A,%20X_%7Bt_2%7D%20%5Cin%20B)%20=%20%5Cmathbb%7BE%7D%5B%5Cmathbf%7B1%7D_%7BA%7D%20%5Cmathbf%7B1%7D_%7BB%7D%5D%20=%20%5Cmathbb%7BE%7D%5Bf(X_%7Bt_1%7D)%20g(X_%7Bt_2%7D)%5D"> for <img src="https://latex.codecogs.com/png.latex?t_1%20%3C%20t_2">. By the properties of conditional expectation and the Markov property, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(X_%7Bt_1%7D%20%5Cin%20A,%20X_%7Bt_2%7D%20%5Cin%20B)%20&amp;=%20%5Cmathbb%7BE%7D%5Bf(X_%7Bt_1%7D)g(X_%7Bt_2%7D)%5D%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5Bf(X_%7Bt_1%7D)%5Cmathbb%7BE%7D%5Bg(X_%7Bt_2%7D)%7C%5Cmathcal%7BF%7D_%7Bt_1%7D%5D%5D%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5Bf(X_%7Bt_1%7D)%5Cmathbb%7BE%7D%5Bg(X_%7Bt_2%7D)%7CX_%7Bt_1%7D%5D%5D%0A%5Cend%7Balign*%7D"></p>
<p>Assuming that the process is time-homogenous and admits a transition density <img src="https://latex.codecogs.com/png.latex?p(y,t%7Cx,0)"> as for Brownian motion, this becomes:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(X_%7Bt_1%7D%20%5Cin%20A,%20X_%7Bt_2%7D%20%5Cin%20B)%20&amp;=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%20f(x_1)%20%5Cleft(%5Cint_%7B%5Cmathbb%7BR%7D%7D%20g(x_2)%20p(x_2,t_2%7Cx_1,t_1)%20dx_2%20%5Cright)%20p(x_1,t_1%7Cx_0,0)%20dx_1%5C%5C%0A&amp;=%20%5Cint_%7BA%7D%20%5Cleft(%5Cint_%7BB%7D%20p(x_2,t_2%7Cx_1,t_1)%20dx_2%20%5Cright)%20p(x_1,t_1%7Cx_0,0)%20dx_1%0A%5Cend%7Balign*%7D"></p>
<p>This easily generalizes to any finite-dimensional distribution of <img src="https://latex.codecogs.com/png.latex?(X_t,%20t%5Cgeq%200)">.</p>
<div id="exm-markov-versus-martingale" class="theorem example">
<p><span class="theorem-title"><strong>Example 2</strong></span> (Markov versus Martingale.) Martingales are not markov processes in general and markov processes are not martingales in general. There are processes such as brownian motion that enjoy both. An example of a markov process that is not a martingale is a Brownian motion with a drift <img src="https://latex.codecogs.com/png.latex?(X_t,%20t%20%5Cgeq%200)">, where <img src="https://latex.codecogs.com/png.latex?X_t%20=%20%5Csigma%20B_t%20+%20%5Cmu%20t">. Conversely, take <img src="https://latex.codecogs.com/png.latex?Y_t%20=%20%5Cint_0%5Et%20X_s%20dB_s">, where <img src="https://latex.codecogs.com/png.latex?X_s%20=%20%5Cint_0%5Es%20B_u%20dB_u">. The integrand <img src="https://latex.codecogs.com/png.latex?X_s"> depends on whole Brownian motion path upto time <img src="https://latex.codecogs.com/png.latex?s"> and not just on <img src="https://latex.codecogs.com/png.latex?B_s">.</p>
</div>
<div id="nte-functions-of-markov" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note&nbsp;1: Functions of Markov Processes
</div>
</div>
<div class="callout-body-container callout-body">
<p>It might be tempting to think that if <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)"> is a Markov process, then the process defined by <img src="https://latex.codecogs.com/png.latex?Y_t%20=%20f(X_t)"> for some reasonable function <img src="https://latex.codecogs.com/png.latex?f"> is also Markov. Indeed, one could hope to write for an arbitrary bounded function <img src="https://latex.codecogs.com/png.latex?g">:</p>
<p><span id="eq-functions-of-markov-process"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Bg(Y_t)%7C%5Cmathcal%7BF%7D_s%5D%20=%20%5Cmathbb%7BE%7D%5Bg(f(X_t))%7C%5Cmathcal%7BF%7D_s%5D%20=%20%5Cmathbb%7BE%7D%5Bg(f(X_t))%7C%5Cmathcal%7BX%7D_s%5D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B5%7D"></span></p>
<p>by using the Markov property of <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)">. The flaw in this reasoning is that the Markov property should hold for the natural fitration <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t%5EY,t%5Cgeq%200)"> of the process <img src="https://latex.codecogs.com/png.latex?(Y_t,t%5Cgeq%200)"> and not the one of <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)">, <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t%5EX,t%5Cgeq%200)">. It might be that the filtration <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t%5EY,t%5Cgeq%200)"> has less information that <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t%5EX,t%5Cgeq%200)">, especially, if the function <img src="https://latex.codecogs.com/png.latex?f"> is not one-to-one. For example, if <img src="https://latex.codecogs.com/png.latex?f(x)=x%5E2">, then <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t%5EY"> has less information than <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t%5EX"> as we cannot recover the sign of <img src="https://latex.codecogs.com/png.latex?X_t"> knowing <img src="https://latex.codecogs.com/png.latex?Y_t">. In other words, the second equality may not hold. In some cases, a function of a Brownian motion might be Markov, even when <img src="https://latex.codecogs.com/png.latex?f"> is not one-to-one.</p>
</div>
</div>
<p>It turns out that diffusions such as the Ornstein-Uhlenbeck process and the Brownian bridge are Markov processes.</p>
<div id="thm-diffusions-are-markov-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Diffusions are Markov processes.)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B_t,t%5Cgeq%200)"> be a standard Brownian motion. Let <img src="https://latex.codecogs.com/png.latex?%5Cmu%20:%20%5Cmathbb%7BR%7D%20%5Cto%20%5Cmathbb%7BR%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Csigma:%20%5Cmathbb%7BR%7D%20%5Cto%20%5Cmathbb%7BR%7D"> be differentiable functions with bounded derivatives on <img src="https://latex.codecogs.com/png.latex?%5B0,T%5D">. Then, the diffusion with the SDE</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Cmu(X_t)%20dt%20+%20%5Csigma(X_t)dB_t,%20%5Cquad%20X_0%20=%20x_0%0A"></p>
<p>defines a time-homogenous markov process on <img src="https://latex.codecogs.com/png.latex?%5B0,T%5D">.</p>
</div>
<p>An analogous statement holds for time-inhomogenous diffusions. The proof is generalization of the Markov property of Brownian motion. We take advantage of the independence of Brownian increments.</p>
<p><em>Proof.</em></p>
<p>By the <a href="https://quantinsights.github.io/posts/ito-processes-and-stochastic-diff-eqs/#existence-and-uniqueness-of-sdes">existence and uniqueness theorem</a>, this stochastic initial value problem(SIVP) defines a unique continous adapted process <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cleq%20T)">. Let <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t%5EX,t%5Cgeq%200)"> be the natural filtration of <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cleq%20T)">. For a fixed <img src="https://latex.codecogs.com/png.latex?t%20%3E%200">, consider the process <img src="https://latex.codecogs.com/png.latex?W_s%20=%20B_%7Bt+s%7D%20-%20B_t,%20s%20%5Cgeq%200">. Let <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t,t%20%5Cgeq%200)"> be the natural filtration of <img src="https://latex.codecogs.com/png.latex?(B_t,t%20%5Cgeq%200)">. It turns out that the process <img src="https://latex.codecogs.com/png.latex?(W_s,s%20%5Cgeq%200)"> is a standard brownian motion independent of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t"> (Exercise&nbsp;1). For <img src="https://latex.codecogs.com/png.latex?s%20%5Cgeq%200">, we consider the SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdY_s%20=%20%5Cmu%20(Y_s)%20ds%20+%20%5Csigma(Y_s)%20dW_s,%20%5Cquad%20Y_0%20=%20X_t%0A"></p>
<p>Again by the <a href="https://quantinsights.github.io/posts/ito-processes-and-stochastic-diff-eqs/#existence-and-uniqueness-of-sdes">existence and uniqueness theorem</a>, there exists a unique solution to the SIVP that is adapted to the natural filtration of <img src="https://latex.codecogs.com/png.latex?W">. Note that, the shifted process <img src="https://latex.codecogs.com/png.latex?(X_%7Bt+s%7D,s%5Cgeq%200)"> is <em>the</em> solution to this SIVP since:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AX_%7Bt+s%7D%20&amp;=%20X_%7Bt%7D%20+%20%5Cint_%7Bt%7D%5E%7Bt+s%7D%5Cmu(X_u)%20du%20+%20%5Cint_%7Bt%7D%5E%7Bt+s%7D%5Csigma(X_u)%20dB_u%0A%5Cend%7Balign*%7D"></p>
<p>Perform a change of variable <img src="https://latex.codecogs.com/png.latex?v%20=%20u%20-%20t">. Then, <img src="https://latex.codecogs.com/png.latex?dv%20=%20du">, <img src="https://latex.codecogs.com/png.latex?dB_u%20=%20B(u_2)%20-%20B(u_1)=%20B(t%20+%20v_2)%20-%20B(t%20+%20v_1)%20=%20W(v_2)%20-%20W(v_1)%20=%20dW_v">. So,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AX_%7Bt+s%7D%20&amp;=%20X_%7Bt%7D%20+%20%5Cint_%7B0%7D%5E%7Bs%7D%5Cmu(X_%7Bt+v%7D)%20dv%20+%20%5Cint_%7B0%7D%5E%7Bs%7D%5Csigma(X_%7Bt+v%7D)%20dW_v%0A%5Cend%7Balign*%7D"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?Y_v=%20X_%7Bt+v%7D">, <img src="https://latex.codecogs.com/png.latex?Y_0%20=%20X_t">. Then,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AY_s%20&amp;=%20Y_0%20+%20%5Cint_%7B0%7D%5E%7Bs%7D%5Cmu(Y_v)%20dv%20+%20%5Cint_%7B0%7D%5E%7Bs%7D%5Csigma(Y_v)%20dW_v%0A%5Cend%7Balign*%7D"></p>
<p>Thus, we conclude that for any interval <img src="https://latex.codecogs.com/png.latex?A">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BP%7D(X_%7Bt+s%7D%20%5Cin%20A%7C%5Cmathcal%7BF%7D_t%5EX)%20=%20%5Cmathbb%7BP%7D(Y_s%20%5Cin%20A%20%7C%20%5Cmathcal%7BF%7D_t%5EX)%0A"></p>
<p>But, since <img src="https://latex.codecogs.com/png.latex?(Y_s,s%20%5Cgeq%200)"> depends on <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t%5EX"> only through <img src="https://latex.codecogs.com/png.latex?X_t"> (because <img src="https://latex.codecogs.com/png.latex?(W_s,s%20%5Cgeq%200)"> is independent of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t">), we conclude that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(X_%7Bt+s%7D%20%5Cin%20A%7C%5Cmathcal%7BF%7D_t%5EX)%20=%20%5Cmathbb%7BP%7D(X_%7Bt+s%7D%20%5Cin%20A%7CX_t)">, so <img src="https://latex.codecogs.com/png.latex?(X_t,t%20%5Cgeq%200)"> is a time-homogenous markov process. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="the-strong-markov-property" class="level2">
<h2 class="anchored" data-anchor-id="the-strong-markov-property">The Strong Markov Property</h2>
<p>The Doob’s Optional Stopping theorem extended some properties of martingales to stopping times. The Markov property can also be extended to stopping times for certain processes. These processes are called <em>strong Markov processes</em>.</p>
<p>We know, that the sigma-algebra <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t"> represents the set of all observable events upto time <img src="https://latex.codecogs.com/png.latex?t">. What is the sigma-algebra of observable events at a random stopping time <img src="https://latex.codecogs.com/png.latex?%5Ctau">?</p>
<div id="def-sigma-algebra-of-the-past" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 (<img src="https://latex.codecogs.com/png.latex?%5Csigma">-algebra of <img src="https://latex.codecogs.com/png.latex?%5Ctau">-past)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(%5COmega,%5Cmathcal%7BF%7D,%5C%7B%5Cmathcal%7BF%7D_t%5C%7D_%7Bt%5Cgeq%200%7D,%5Cmathbb%7BP%7D)"> be a filtered probability space. The sigma-algebra at the stopping time <img src="https://latex.codecogs.com/png.latex?%5Ctau"> is then:</p>
<p><span id="eq-sigma-algebra-of-the-past"><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathcal%7BF%7D_%7B%5Ctau%7D%20=%20%5C%7BA%20%5Cin%20%5Cmathcal%7BF%7D_%5Cinfty%20:%20A%20%5Ccap%20%5C%7B%5Ctau%20%5Cleq%20t%5C%7D%20%5Cin%20%5Cmathcal%7BF%7D_t,%20%5Cforall%20t%20%5Cgeq%200%20%5C%7D%0A%5Ctag%7B6%7D"></span></p>
</div>
<p>In words, an event <img src="https://latex.codecogs.com/png.latex?A"> is in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%5Ctau">, if we can determine if <img src="https://latex.codecogs.com/png.latex?A"> and <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Ctau%20%5Cleq%20t%5C%7D"> both occurred or not based on the information <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t"> known at any arbitrary time <img src="https://latex.codecogs.com/png.latex?t">. You should be able to tell the value of the random variable <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7B1%7D_A%20%5Ccdot%20%5Cmathbf%7B1%7D_%7B%5C%7B%5Ctau%20%5Cleq%20t%5C%7D%7D"> given <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t"> for any arbitrary time <img src="https://latex.codecogs.com/png.latex?t%20%5Cgeq%200">.</p>
<p>For example, if <img src="https://latex.codecogs.com/png.latex?%5Ctau%20%3C%20%5Cinfty">, the event <img src="https://latex.codecogs.com/png.latex?%5C%7BB_%5Ctau%20%3E%200%5C%7D"> is in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%5Ctau">. However, the event <img src="https://latex.codecogs.com/png.latex?%5C%7BB_1%20%3E%200%5C%7D"> is not in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%5Ctau"> in general, since <img src="https://latex.codecogs.com/png.latex?A%20%5Ccap%20%5C%7B%5Ctau%20%5Cleq%20t%5C%7D"> is not in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t"> for <img src="https://latex.codecogs.com/png.latex?t%20%3C%201">. Roughly speaking, a random variable that is <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%5Ctau">-measurable should be thought of as an explicit function of <img src="https://latex.codecogs.com/png.latex?X_%5Ctau">. With this new object, we are ready to define the <em>strong markov property</em>.</p>
<div id="def-strong-markov-property" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3 (Strong Markov Property)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)"> be a stochastic process and let <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t,t%5Cgeq%200)"> be its natural filtration. The process <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)"> is said to be <em>strong markov</em> if for any stopping time <img src="https://latex.codecogs.com/png.latex?%5Ctau"> for the filtration of the process and any bounded function <img src="https://latex.codecogs.com/png.latex?g">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5Bg(X_%7Bt+%5Ctau%7D)%7C%5Cmathcal%7BF%7D_%5Ctau%5D%20=%20%5Cmathbb%7BE%7D%5Bg(X_%7Bt+%5Ctau%7D)%7CX_%5Ctau%5D%0A"></p>
</div>
<p>This means that <img src="https://latex.codecogs.com/png.latex?X_%7Bt+%5Ctau%7D"> depends on <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%5Ctau"> solely through <img src="https://latex.codecogs.com/png.latex?X_%5Ctau"> (whenever <img src="https://latex.codecogs.com/png.latex?%5Ctau%20%3C%20%5Cinfty">). It turns out that Brownian motion is a strong markov process. In fact a stronger statement holds which generalizes Exercise&nbsp;1.</p>
<div id="thm-shifted-brownian-motion-about-a-stopping-time" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2</strong></span> Let <img src="https://latex.codecogs.com/png.latex?%5Ctau"> be a stopping time for the filtration of the Brownian motion <img src="https://latex.codecogs.com/png.latex?(B_t,t%5Cgeq%200)"> such that <img src="https://latex.codecogs.com/png.latex?%5Ctau%20%3C%20%5Cinfty">. Then, the process:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(B_%7Bt+%5Ctau%7D%20-%20B_%7B%5Ctau%7D,t%5Cgeq%200)%0A"></p>
<p>is a standard brownian motion independent of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%5Ctau">.</p>
</div>
<div id="exm-brownian-motion-is-strong-markov" class="theorem example">
<p><span class="theorem-title"><strong>Example 3</strong></span> (Brownian motion is strong Markov) To see this, let’s compute the conditional MGF as in Equation&nbsp;3. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Be%5E%7BaB_%7Bt+%5Ctau%7D%7D%7C%5Cmathcal%7BF%7D_%5Ctau%5D%20&amp;=%20%5Cmathbb%7BE%7D%5Be%5E%7Ba(B_%7Bt+%5Ctau%7D%20-%20B_%5Ctau%20+%20B_%5Ctau)%7D%7C%5Cmathcal%7BF%7D_%5Ctau%5D%5C%5C%0A&amp;=%20e%5E%7BaB_%5Ctau%7D%20%5Cmathbb%7BE%7D%5Be%5E%7Ba(B_%7Bt+%5Ctau%7D%20-%20B_%5Ctau)%7D%7C%5Cmathcal%7BF%7D_%5Ctau%5D%5C%5C%0A&amp;%20%5C%7B%20B_%5Ctau%20%5Ctext%7B%20is%20%7D%5Cmathcal%7BF%7D_%5Ctau-%5Ctext%7Bmeasurable%20%7D%5C%7D%5C%5C%0A&amp;=%20e%5E%7BaB_%5Ctau%7D%5Cmathbb%7BE%7D%5Be%5E%7Ba(B_%7Bt+%5Ctau%7D%20-%20B_%5Ctau)%7D%5D%5C%5C%0A&amp;%20%5C%7B%20(B_%7Bt+%5Ctau%7D%20-%20B_%5Ctau)%20%5Cperp%20%5Cmathcal%7BF%7D_%5Ctau%5C%7D%5C%5C%0A&amp;=%20e%5E%7BaB_%5Ctau%7De%5E%7B%5Cfrac%7B1%7D%7B2%7Da%5E2%20t%7D%5C%5C%0A%5Cend%7Balign*%7D%0A"></p>
<p>Thus, the conditional MGF is an explicit function of <img src="https://latex.codecogs.com/png.latex?B_%5Ctau"> and <img src="https://latex.codecogs.com/png.latex?t">. This proves the proposition. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</div>
<p><em>Proof</em> of Theorem&nbsp;2.</p>
<p>We first consider for fixed <img src="https://latex.codecogs.com/png.latex?n"> the discrete valued stopping time:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctau_n%20=%20%5Cfrac%7Bk%20+%201%7D%7B2%5En%7D,%20%5Cquad%20%5Ctext%7B%20if%20%7D%20%5Cfrac%7Bk%7D%7B2%5En%7D%20%5Cleq%20%5Ctau%20%3C%20%5Cfrac%7Bk+1%7D%7B2%5En%7D,%20k%5Cin%20%5Cmathbb%7BN%7D%0A"></p>
<p>In other words, if <img src="https://latex.codecogs.com/png.latex?%5Ctau"> occurs in the interval <img src="https://latex.codecogs.com/png.latex?%5B%5Cfrac%7Bk%7D%7B2%5En%7D,%5Cfrac%7Bk+1%7D%7B2%5En%7D)">, we stop at the next dyadic <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bk+1%7D%7B2%5En%7D">. By construction <img src="https://latex.codecogs.com/png.latex?%5Ctau_n"> depends only on the process in the past. Consider the process <img src="https://latex.codecogs.com/png.latex?W_t%20=%20B_%7Bt%20+%20%5Ctau_n%7D%20-%20B_%7B%5Ctau_n%7D,%20t%20%5Cgeq%200">. We show it is a standard brownian motion independent of <img src="https://latex.codecogs.com/png.latex?%5Ctau_n">. This is feasible as we can decompose over the discrete values taken by <img src="https://latex.codecogs.com/png.latex?%5Ctau_n">. More, precisely, take <img src="https://latex.codecogs.com/png.latex?E%20%5Cin%20%5Cmathcal%7BF%7D_%7B%5Ctau_n%7D">, and some generic event <img src="https://latex.codecogs.com/png.latex?%5C%7BW_t%20%5Cin%20A%5C%7D"> for the process <img src="https://latex.codecogs.com/png.latex?W">. Then, by decomposing over the values of <img src="https://latex.codecogs.com/png.latex?%5Ctau_n">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(%5C%7BW_t%20%5Cin%20A%5C%7D%20%5Ccap%20E)%20&amp;=%20%5Csum_%7Bk=0%7D%5E%5Cinfty%20%5Cmathbb%7BP%7D%5Cleft(%5C%7BW_t%20%5Cin%20A%5C%7D%20%5Ccap%20E%20%5Ccap%20%5C%7B%5Ctau_n%20=%20%5Cfrac%7Bk%7D%7B2%5En%7D%5C%7D%5Cright)%5C%5C%0A&amp;=%20%5Csum_%7Bk=0%7D%5E%5Cinfty%20%5Cmathbb%7BP%7D%5Cleft(%5C%7B(B_%7Bt+k/2%5En%7D%20-%20B_%7Bk/2%5En%7D)%20%5Cin%20A%5C%7D%20%5Ccap%20E%20%5Ccap%20%5C%7B%5Ctau_n%20=%20%5Cfrac%7Bk%7D%7B2%5En%7D%5C%7D%5Cright)%5C%5C%0A&amp;=%20%5Csum_%7Bk=0%7D%5E%5Cinfty%20%5Cmathbb%7BP%7D%5Cleft(%5C%7B(B_%7Bt+k/2%5En%7D%20-%20B_%7Bk/2%5En%7D)%20%5Cin%20A%5C%7D%5Cright)%20%5Ctimes%20%5Cmathbb%7BP%7D%5Cleft(%20E%20%5Ccap%20%5C%7B%5Ctau_n%20=%20%5Cfrac%7Bk%7D%7B2%5En%7D%5C%7D%5Cright)%0A%5Cend%7Balign*%7D%0A"></p>
<p>since <img src="https://latex.codecogs.com/png.latex?(B_%7Bt+k/2%5En%7D%20-%20B_%7Bk/2%5En%7D)"> is independent of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%7Bk/2%5En%7D"> by Exercise&nbsp;1 and since <img src="https://latex.codecogs.com/png.latex?E%20%5Ccap%20%5C%7B%5Ctau_n%20=%20%5Cfrac%7Bk%7D%7B2%5En%7D%5C%7D%20%5Cin%20%5Cmathcal%7BF%7D_%7Bk/2%5En%7D"> by definition of stopping time. But, given <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Ctau_n%20=%20k/2%5En%5C%7D">, the event <img src="https://latex.codecogs.com/png.latex?%5C%7B(B_%7Bt+k/2%5En%7D%20-%20B_%7Bk/2%5En%7D)%20%5Cin%20A%5C%7D"> is the same as <img src="https://latex.codecogs.com/png.latex?%5C%7BB_t%20%5Cin%20A%5C%7D%20=%20%5C%7BW_t%20%5Cin%20A%5C%7D">, since this process is now a standard brownian motion. Thus, <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D%5C%7B(B_%7Bt+k/2%5En%7D%20-%20B_%7Bk/2%5En%7D)%20%5Cin%20A%5C%7D%20=%20%5Cmathbb%7BP%7D%5C%7BB_t%20%5Cin%20A%5C%7D%20=%20%5Cmathbb%7BP%7D%5C%7BW_t%20%5Cin%20A%5C%7D">, dropping the dependence on <img src="https://latex.codecogs.com/png.latex?k">. The sum over <img src="https://latex.codecogs.com/png.latex?k"> then yields:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BP%7D%5Cleft(%5C%7BW_t%20%5Cin%20A%5C%7D%5Ccap%20E%5Cright)%20=%20%5Cmathbb%7BP%7D(W_t%20%5Cin%20A)%20%5Cmathbb%7BP%7D(E)%0A"></p>
<p>as claimed. The extension to <img src="https://latex.codecogs.com/png.latex?%5Ctau"> is done by using continuity of paths. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20B_%7Bt%20+%20%5Ctau_n%7D%20-%20B_%7B%5Ctau_n%7D%20=%20B_%7Bt+%5Ctau%7D%20-%20B_%7B%5Ctau%7D%20%5Ctext%7B%20almost%20surely%7D%0A"></p>
<p>Note, that this only uses right continuity! Moreover, this implies that <img src="https://latex.codecogs.com/png.latex?B_%7Bt+%5Ctau%7D%20-%20B_%5Ctau"> is independent of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%7B%5Ctau_n%7D"> for all <img src="https://latex.codecogs.com/png.latex?n">. Again by (right-)continuity this extends to independence of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%5Ctau">. The limiting distribution of the process is obtained by looking at the finite dimensional distributions of the increments of <img src="https://latex.codecogs.com/png.latex?B_%7Bt+%5Ctau_n%7D%20-%20B_%7B%5Ctau_n%7D"> for a finite number of <img src="https://latex.codecogs.com/png.latex?t">’s and taking the limit as above. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<p>Most diffusions also enjoy the strong markov property, as long as the functions <img src="https://latex.codecogs.com/png.latex?%5Csigma"> and <img src="https://latex.codecogs.com/png.latex?%5Cmu"> encoding the volatility and drift are nice enough. This is the case for the diffusions we have considered.</p>
<div id="thm-most-diffusions-are-strong-markov" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Most diffusions are strong markov)</strong></span> Consider a diffusion <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cleq%20T)"> as as in Theorem&nbsp;1. Then, the diffusion has strong markov property.</p>
</div>
<p>The proof follows the line of the one of Theorem&nbsp;1</p>
<p><em>Proof.</em></p>
<p>Consider the time-homogenous diffusion:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Cmu(X_t)dt%20+%20%5Csigma(X_t)dB_t%0A"></p>
<p>By the <a href="https://quantinsights.github.io/posts/ito-processes-and-stochastic-diff-eqs/#existence-and-uniqueness-of-sdes">existence and uniqueness theorem</a>, this SIVP defines a unique continuous adapted process <img src="https://latex.codecogs.com/png.latex?(X_t,t%20%5Cgeq%200)">. Let <img src="https://latex.codecogs.com/png.latex?%5Cmathfrak%7BF%7D=(%5Cmathcal%7BF%7D_t%5EX,t%20%5Cgeq%200)"> be the natural filtration of <img src="https://latex.codecogs.com/png.latex?(X_t,%20t%5Cleq%20T)">. Let <img src="https://latex.codecogs.com/png.latex?%5Ctau"> be a stopping time for the filtration <img src="https://latex.codecogs.com/png.latex?%5Cmathfrak%7BF%7D"> and consider the process <img src="https://latex.codecogs.com/png.latex?W_t%20=%20B_%7Bt+%5Ctau%7D%20-%20B_%5Ctau">. From Theorem&nbsp;2, we know that the process <img src="https://latex.codecogs.com/png.latex?(W_t,t%5Cgeq%200)"> is a standard brownian motion independent <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%5Ctau">. For <img src="https://latex.codecogs.com/png.latex?s%20%5Cgeq%200">, we consider the SDE:</p>
<p><span id="eq-diffusion-of-Y"><img src="https://latex.codecogs.com/png.latex?%0AdY_s%20=%20%5Cmu(Y_s)ds%20+%20%5Csigma(Y_s)dW_s,%20%5Cquad%20Y_0%20=%20X_%5Ctau%0A%5Ctag%7B7%7D"></span></p>
<p>Again by the <a href="https://quantinsights.github.io/posts/ito-processes-and-stochastic-diff-eqs/#existence-and-uniqueness-of-sdes">existence and uniqueness theorem</a>, there exists a unique solution to the SIVP that is adapted to the natural filtration of <img src="https://latex.codecogs.com/png.latex?W">. We claim that <img src="https://latex.codecogs.com/png.latex?(X_%7Bs+%5Ctau%7D,s%20%5Cgeq%200)"> is the solution to this equation, since:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AX_%7Bs+%5Ctau%7D%20=%20X_%5Ctau%20+%20%5Cint_%5Ctau%5E%7Bs+%5Ctau%7D%20%5Cmu(X_u)du%20+%20%5Cint_%7B%5Ctau%7D%5E%7Bs+%5Ctau%7D%20%5Csigma(X_u)dB_u%0A"></p>
<p>Perform a change of variable <img src="https://latex.codecogs.com/png.latex?v%20=%20u%20-%20%5Ctau">. Then, the limits of integration bare, <img src="https://latex.codecogs.com/png.latex?v%20=%200"> and <img src="https://latex.codecogs.com/png.latex?v%20=%20s">. And <img src="https://latex.codecogs.com/png.latex?dv%20=%20du">.</p>
<p><img src="https://latex.codecogs.com/png.latex?dB_u%20%20%5Capprox%20B_%7Bu_2%7D%20-%20B_%7Bu_1%7D%20=%20B(v_1%20+%20%5Ctau)%20-%20B(v_2%20+%20%5Ctau)%20=%20W(v_2)%20-%20W(v_1)%20=dW_v">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AX_%7Bs+%5Ctau%7D%20=%20X_%5Ctau%20+%20%5Cint_0%5E%7Bs%7D%20%5Cmu(X_%7Bv+%5Ctau%7D)dv%20+%20%5Cint_%7B0%7D%5E%7Bs%7D%20%5Csigma(X_%7Bv+%5Ctau%7D)dW_v%0A"></p>
<p>If we let <img src="https://latex.codecogs.com/png.latex?Y_0%20=%20X_%5Ctau">, <img src="https://latex.codecogs.com/png.latex?Y_v%20=%20X_%7Bv+%5Ctau%7D">, we recover the dynamics of <img src="https://latex.codecogs.com/png.latex?(Y_v,v%20%5Cgeq%200)"> in Equation&nbsp;7. So, <img src="https://latex.codecogs.com/png.latex?(X_%7Bs+%5Ctau%7D,s%5Cgeq%200)"> is the solution to the SIVP in Equation&nbsp;7. Thus, we conclude for any interval <img src="https://latex.codecogs.com/png.latex?A">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BP%7D(X_%7Bs+%5Ctau%7D%20%5Cin%20A%20%7C%20%5Cmathcal%7BF%7D_%5Ctau%5EX)%20=%20%5Cmathbb%7BP%7D(Y_v%20%5Cin%20A%7C%20%5Cmathcal%7BF%7D_%5Ctau%5EX)%0A"></p>
<p>But, since <img src="https://latex.codecogs.com/png.latex?(Y_v,v%5Cgeq%200)"> depends on <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%5Ctau%5EX"> only through <img src="https://latex.codecogs.com/png.latex?X_%5Ctau">, we conclude that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(X_%7Bs%20+%20%5Ctau%7D%20%5Cin%20A%20%7C%20%5Cmathcal%7BF%7D_%5Ctau%5EX)%20=%20%5Cmathbb%7BP%7D(X_%7Bs%20+%20%5Ctau%7D%20%5Cin%20A%7C%20X_%5Ctau)">. Consequently, <img src="https://latex.codecogs.com/png.latex?(X_t,t%20%5Cgeq%200)"> is a strong-markov process. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<div id="nte-extension-of-optional-sampling" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note&nbsp;2: Extension of optional sampling
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider a continuous martingale <img src="https://latex.codecogs.com/png.latex?(M_t,%20t%5Cleq%20T)"> for a filtration <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t,%20t%5Cgeq%200)"> and a stopping time <img src="https://latex.codecogs.com/png.latex?%5Ctau"> for the same filtration. Suppose we would like to compute for some <img src="https://latex.codecogs.com/png.latex?T">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5BM_T%20%5Cmathbf%7B1%7D_%7B%5C%7B%5Ctau%20%5Cleq%20T%5C%7D%7D%5D%0A"></p>
<p>It would be tempting to condition on <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%5Ctau"> and write <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BM_T%20%7C%5Cmathcal%7BF%7D_%5Ctau%5D%20=%20M_%5Ctau"> on the event <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Ctau%20%5Cleq%20T%5C%7D">. We would then conclude that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5BM_T%201_%7B%5C%7B%5Ctau%20%5Cleq%20T%5C%7D%7D%5D%20=%20%5Cmathbb%7BE%7D%5B1_%7B%5C%7B%5Ctau%20%5Cleq%20T%5C%7D%7D%20%5Cmathbb%7BE%7D%5BM_T%7C%5Cmathcal%7BF%7D_%5Ctau%5D%20%5D%20=%20%5Cmathbb%7BE%7D%5BM_%5Ctau%201_%7B%5C%7B%5Ctau%20%5Cleq%20T%5C%7D%7D%5D%0A"></p>
<p>In some sense, we have extended the martingale property to stopping times. This property can be proved under reasonable assumptions on <img src="https://latex.codecogs.com/png.latex?(M_t,t%5Cleq%20T)"> (for example, if it is positive). Indeed, it suffices to approximate <img src="https://latex.codecogs.com/png.latex?%5Ctau"> by discrete valued stopping time <img src="https://latex.codecogs.com/png.latex?%5Ctau_n"> as in the proof of Theorem&nbsp;2. One can then apply martingale property at a fixed time.</p>
</div>
</div>
</section>
<section id="the-heat-equation" class="level2">
<h2 class="anchored" data-anchor-id="the-heat-equation">The Heat Equation</h2>
<p>We look at more detail on how PDEs come up when computing quantities related to Markov processes.</p>
<div id="exm-heat-equation-and-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 4</strong></span> (Heat Equation and Brownian motion) Let <img src="https://latex.codecogs.com/png.latex?f(t,x)"> be a function of time and space. The heat equation in <img src="https://latex.codecogs.com/png.latex?1+1">-dimension (one dimension of time, one dimension of space) is the PDE:</p>
<p><span id="eq-heat-equation-in-2d"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20&amp;=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B8%7D"></span></p>
<p>In <img src="https://latex.codecogs.com/png.latex?1+d"> (one dimension of time, <img src="https://latex.codecogs.com/png.latex?d"> dimensions of space), the heat equation is:</p>
<p><span id="eq-heat-equation-in-d-plus-one-dims"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20&amp;=%20%5Cfrac%7B1%7D%7B2%7D%5Cnabla%5E2%20f%0A%5Cend%7Balign*%7D%0A%5Ctag%7B9%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E2"> is the Laplacian operator.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?(X_t,t%20%5Cgeq%200)"> be a brownian motion starting at <img src="https://latex.codecogs.com/png.latex?X_0%20=%20x"> with probability density:</p>
<p><span id="eq-initial-condition"><img src="https://latex.codecogs.com/png.latex?%0Af(0,x)%20=%20g(x)%0A%5Ctag%7B10%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?g"> is a function of space.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?f(t,u)"> be the probability density that the process ends up at <img src="https://latex.codecogs.com/png.latex?X_t=u"> at time <img src="https://latex.codecogs.com/png.latex?t">. By the law of total probability, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af(t,x)%20&amp;%5Capprox%20%5Csum_%7By%7D%20%5Cmathbb%7BP%7D%5Cleft%5C%7BX_0%20=%20y%20%5Cright%5C%7D%20%5Ctimes%20%5Cmathbb%7BP%7D%5Cleft%5C%7BX_t%20=%20x%20%7C%20X_0%20=%20y%20%5Cright%5C%7D%5C%5C%0A&amp;=%20%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty%20g(y)%5Ccdot%20p(x,t%7Cy,0)dy%5C%5C%0A%5Cend%7Balign*%7D%0A"></p>
<p>Observe that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Bg(X_t)%7CX_0%20=%20x%5D%20&amp;=%20%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty%20g(y)%20%5Ccdot%20p(y,t%7Cx,0)dy%5C%5C%0A&amp;=%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty%20g(y)%20%5Ccdot%20p(x,t%7Cy,0)dy%0A%5Cend%7Balign*%7D%0A"></p>
<p>Thus, the function <img src="https://latex.codecogs.com/png.latex?f"> can be represented as a specific type of space average. It can be represented as an average of <img src="https://latex.codecogs.com/png.latex?g(B_t)"> over brownian paths starting at <img src="https://latex.codecogs.com/png.latex?x">:</p>
<p><span id="eq-stochastic-representation-of-the-solution-to-the-heat-equation"><img src="https://latex.codecogs.com/png.latex?%0Af(t,x)%20=%20%5Cmathbb%7BE%7D%5Bg(B_t)%7CB_0%20=%20x%5D%0A%5Ctag%7B11%7D"></span></p>
<p>Our claim is that <img src="https://latex.codecogs.com/png.latex?f"> indeed satisfies the PDE (Equation&nbsp;8).</p>
<p>The gaussian transition probability density function (heat kernel) <img src="https://latex.codecogs.com/png.latex?p(x,t%7Cy,0)"> is given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap(x,t%7Cy,0)%20=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%20t%7D%7D%5Cexp%5Cleft(-%5Cfrac%7B(x-y)%5E2%7D%7B2t%7D%5Cright)%0A"></p>
<p>Differentiating <img src="https://latex.codecogs.com/png.latex?p"> with respect to <img src="https://latex.codecogs.com/png.latex?t">, we have:</p>
<p><span id="eq-partial-with-respect-to-time"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7D%20p(x,t%7Cy,0)%20&amp;=%20%5Cfrac%7B%5Csqrt%7B2%5Cpi%20t%7D%20%5Cexp%5Cleft(-%5Cfrac%7B(x-y)%5E2%7D%7B2t%7D%5Cright)%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7D%5Cleft(-%5Cfrac%7B(x-y)%5E2%7D%7B2t%7D%5Cright)%20-%20%5Cexp%5Cleft(-%5Cfrac%7B(x-y)%5E2%7D%7B2t%7D%5Cright)%5Csqrt%7B2%5Cpi%7D%5Cleft(%5Cfrac%7B1%7D%7B2%5Csqrt%7Bt%7D%7D%5Cright)%7D%7B2%5Cpi%20t%7D%5C%5C%0A&amp;=%5Csqrt%7B2%5Cpi%7D%5Cexp%5Cleft(-%5Cfrac%7B(x-y)%5E2%7D%7B2t%7D%5Cright)%20%5Cfrac%7B%5Cfrac%7B(x-y)%5E2%7D%7B2t%5E%7B3/2%7D%7D%20-%20%5Cfrac%7Bt%7D%7B2t%5E%7B3/2%7D%7D%7D%7B2%5Cpi%20t%7D%5C%5C%0A&amp;=%20%5Cexp%5Cleft(-%5Cfrac%7B(x-y)%5E2%7D%7B2t%7D%5Cright)%20%5Cfrac%7B(x-y)%5E2%20-%20t%7D%7B%5Csqrt%7B2%5Cpi%7D%20(2t%5E%7B5/2%7D)%20%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B12%7D"></span></p>
<p>Differentiating <img src="https://latex.codecogs.com/png.latex?p"> with respect to <img src="https://latex.codecogs.com/png.latex?x">, we have:</p>
<p><span id="eq-first-derivative-with-respect-to-space"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20x%7D%20p(x,t%7Cy,0)%20&amp;=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%20t%7D%7D%5Cexp%5Cleft%5B-%5Cfrac%7B(x-y)%5E2%7D%7B2t%7D%5Cright%5D%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20x%7D%5Cleft(-%5Cfrac%7B(x-y)%5E2%7D%7B2t%7D%5Cright)%5C%5C%0A&amp;=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%20t%7D%7D%20%5Ccdot%20%5Cleft(-%5Cfrac%7B1%7D%7B%5Ccancel%7B2%7D%20t%7D%5Cright)%20%5Cexp%5Cleft%5B-%5Cfrac%7B(x-y)%5E2%7D%7B2t%7D%5Cright%5D%20%5Ccdot%20%5Ccancel%7B2%7D(x-y)%5C%5C%0A&amp;=%20-%5Cfrac%7B1%7D%7Bt%5Csqrt%7B2%5Cpi%20t%7D%7D%20(x-y)%5Cexp%5Cleft%5B-%5Cfrac%7B(x-y)%5E2%7D%7B2t%7D%5Cright%5D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B13%7D"></span></p>
<p>Differentiating again with respect to space, we have:</p>
<p><span id="eq-second-derivative-with-respect-to-space"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20x%5E2%7D%20p(x,t%7Cy,0)%20&amp;=%20-%5Cfrac%7B1%7D%7Bt%5Csqrt%7B2%5Cpi%20t%7D%7D%20%5Cleft%5B%5Cexp%5Cleft%5C%7B-%5Cfrac%7B(x-y)%5E2%7D%7B2%7D%5Cright%5C%7D%20+%20(x-y)%5Cexp%5Cleft%5C%7B-%5Cfrac%7B(x-y)%5E2%7D%7B2%7D%5Cright%5C%7D%5Cleft(-%5Cfrac%7B2(x-y)%7D%7B2y%7D%5Cright)%5Cright%5D%5C%5C%0A&amp;=-%5Cfrac%7B1%7D%7Bt%5Csqrt%7B2%5Cpi%20t%7D%7D%5Cexp%5Cleft%5C%7B-%5Cfrac%7B(x-y)%5E2%7D%7B2%7D%5Cright%5C%7D%20%5Cleft%5B1%20-%20%5Cfrac%7B(x-y)%5E2%7D%7Bt%7D%5Cright%5D%5C%5C%0A&amp;=%5Cfrac%7B1%7D%7Bt%5Csqrt%7B2%5Cpi%20t%7D%7D%5Cexp%5Cleft%5C%7B-%5Cfrac%7B(x-y)%5E2%7D%7B2%7D%5Cright%5C%7D%20%5Cleft%5B%5Cfrac%7B(x-y)%5E2%20-%20t%7D%7Bt%7D%5Cright%5D%5C%5C%0A&amp;=%5Cfrac%7B1%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%5Cexp%5Cleft%5C%7B-%5Cfrac%7B(x-y)%5E2%7D%7B2%7D%5Cright%5C%7D%20%5Ccdot%20%5Cfrac%7B(x-y)%5E2%20-%20t%7D%7Bt%5E%7B5/2%7D%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B14%7D"></span></p>
<p>From Equation&nbsp;12 and Equation&nbsp;14, it follows that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7D%20p(x,t%7Cy,0)%20=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%20%5E2%7D%7B%5Cpartial%20x%5E2%7D%20p(x,t%7Cy,0)%0A"></p>
<p>Thus,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7D%20%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty%20g(y)%20p(x,t%7Cy,0)dy%20&amp;=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20x%5E2%7D%20%5Cint_%7B-%5Cinfty%7D%5E%5Cinfty%20g(y)%20p(x,t%7Cy,0)dy%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20t%7Df(t,x)%20&amp;=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20%7D%7B%5Cpartial%20x%5E2%7D%20f(t,x)%0A%5Cend%7Balign*%7D%0A"></p>
</div>
<section id="robert-browns-erratic-motion-of-pollen" class="level3">
<h3 class="anchored" data-anchor-id="robert-browns-erratic-motion-of-pollen">Robert Brown’s erratic motion of pollen</h3>
<p>In the summer of 1827, the Scottish botanist Robert Brown observed that microscopic pollen grains suspended in water move in an erratic, highly irregular, zigzag pattern. It was only in 1905, that Albert Einstein could provide a satisfactory explanation of Brownian motion. He asserted that Brownian motion originates in the continual bombardment of the pollen grains by the molecules of the surrounding water. As a result of continual collisions, the particles themselves had the same kinetic energy as the water molecules. Thus, he showed that Brownian motion provided a solution (in a certain sense) to Fourier’s famous heat equation</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20u%7D%7B%5Cpartial%20t%7D(t,x)%20=%20%5Ckappa%20%5Cfrac%7B%5Cpartial%5E2%20u%7D%7B%5Cpartial%20x%5E2%7D(t,x)%0A"></p>
</section>
<section id="albert-einsteins-proof-of-the-existence-of-brownian-motion" class="level3">
<h3 class="anchored" data-anchor-id="albert-einsteins-proof-of-the-existence-of-brownian-motion">Albert Einstein’s proof of the existence of Brownian motion</h3>
<p>We now summarize Einstein’s original 1905 argument. Let’s say that we are interested in the motion along the horizontal <img src="https://latex.codecogs.com/png.latex?x">-axis. Let’s say we drop brownian particles in a liquid. Let <img src="https://latex.codecogs.com/png.latex?f(t,x)"> represent the number of particles per unit volume (density) at position <img src="https://latex.codecogs.com/png.latex?x"> at time <img src="https://latex.codecogs.com/png.latex?t">. So, the number of particles in a small interval <img src="https://latex.codecogs.com/png.latex?I=%5Bx,x+dx%5D"> of width <img src="https://latex.codecogs.com/png.latex?dx"> will be <img src="https://latex.codecogs.com/png.latex?f(t,x)dx">.</p>
<p>Now, as time progresses, the number of particles in this interval <img src="https://latex.codecogs.com/png.latex?I"> will change. The brownian particles will zig-zag upon bombardment by the molecules of the liquid. Some particles will move out of the interval <img src="https://latex.codecogs.com/png.latex?I">, while other particles will move in.</p>
<p>Let’s consider a timestep of length <img src="https://latex.codecogs.com/png.latex?%5Ctau">. Einstein’s probabilistic approach was to model the distance travelled by the particles or displacement of the particles as a random variable <img src="https://latex.codecogs.com/png.latex?%5CDelta">. To determine how many particles end up in the interval <img src="https://latex.codecogs.com/png.latex?I">, we start with the area to the right of the interval <img src="https://latex.codecogs.com/png.latex?I">.</p>
<p>The density of particles at <img src="https://latex.codecogs.com/png.latex?x+%5CDelta"> is <img src="https://latex.codecogs.com/png.latex?f(t,x+%5CDelta)">; the number of particles in a small interval of length <img src="https://latex.codecogs.com/png.latex?dx"> is <img src="https://latex.codecogs.com/png.latex?f(t,x+%5CDelta)dx">. If we represent the probability density of the displacement by <img src="https://latex.codecogs.com/png.latex?%5Cphi(%5CDelta)">, then the number of particles at <img src="https://latex.codecogs.com/png.latex?x+%5CDelta"> that will move to <img src="https://latex.codecogs.com/png.latex?x"> will be <img src="https://latex.codecogs.com/png.latex?dx%20%5Ccdot%20f(t,x+%5CDelta)%5Cphi(%5CDelta)">. We can apply the same logic to the left hand side. The number of particles at <img src="https://latex.codecogs.com/png.latex?x%20-%20%5CDelta"> that will move to <img src="https://latex.codecogs.com/png.latex?x"> will be <img src="https://latex.codecogs.com/png.latex?dx%20%5Ccdot%20f(t,x-%5CDelta)%5Cphi(-%5CDelta)">. Assume that <img src="https://latex.codecogs.com/png.latex?%5Cphi(%5CDelta)%20=%20%5Cphi(-%5CDelta)">.</p>
<p>Now, if we integrate these movements across the real line, then we get the number of particles at <img src="https://latex.codecogs.com/png.latex?x"> at a short time later <img src="https://latex.codecogs.com/png.latex?t%20+%20%5Ctau">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t+%20%5Ctau,x)%20dx%20=%20dx%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20f(t,x+%5CDelta)%20%5Cphi(%5CDelta)%20d%5CDelta%0A"></p>
<p>Now, we can get rid of <img src="https://latex.codecogs.com/png.latex?dx">.</p>
<p><span id="eq-expression-for-density-at-later-time"><img src="https://latex.codecogs.com/png.latex?%0Af(t+%20%5Ctau,x)%20=%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20f(t,x+%5CDelta)%20%5Cphi(%5CDelta)%20d%5CDelta%0A%5Ctag%7B15%7D"></span></p>
<p>The Taylor’s series expansion of <img src="https://latex.codecogs.com/png.latex?f(t+%5Ctau,x)"> centered at <img src="https://latex.codecogs.com/png.latex?t"> (holding <img src="https://latex.codecogs.com/png.latex?x"> constant) is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t%20+%20%5Ctau,x)%20=%20f(t,x)%20+%20%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%5Ctau%20+%20O(%5Ctau%5E2)%0A"></p>
<p>The Taylor’s series expansion of <img src="https://latex.codecogs.com/png.latex?f(t,x+%5CDelta)"> centered at <img src="https://latex.codecogs.com/png.latex?x"> (holding <img src="https://latex.codecogs.com/png.latex?t"> constant) is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t,x+%5CDelta)%20=%20f(t,x)%20+%20%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D%5CDelta%20+%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%5CDelta%5E2%20+%20O(%5CDelta%5E3)%0A"></p>
<p>We can now substitute these into Equation&nbsp;15 to get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af(t,x)%20+%20%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%5Ctau%20&amp;=%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cleft(f(t,x)%20+%20%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D%5CDelta%20+%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%5CDelta%5E2%5Cright)%20%5Cphi(%5CDelta)d%5CDelta%5C%5C%0A&amp;=%20f(t,x)%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20%5Cphi(%5CDelta)d%5CDelta%20%5C%5C%0A&amp;+%20%5Cfrac%7B%5Cpartial%20f%7D%20%7B%5Cpartial%20x%7D%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20%5CDelta%20%5Cphi(%5CDelta)d%5CDelta%20%5C%5C%0A&amp;+%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%5CDelta%5E2%20%5Cphi(%5CDelta)d%5CDelta%0A%5Cend%7Balign*%7D%0A"></p>
<p>Now, since the probability distribution of displacement <img src="https://latex.codecogs.com/png.latex?%5Cphi(%5Ccdot)"> is symmetric around the origin, the second term is zero. And we know, that if we integrate the density over <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D">, we should get one, so the first term equals one. So, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t,x)%20+%20%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%5Ctau%20=%20f(t,x)%20+%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%5CDelta%5E2%20%5Cphi(%5CDelta)d%5CDelta%0A"></p>
<p>Now, we can cancel the <img src="https://latex.codecogs.com/png.latex?f"> on both sides and then shift <img src="https://latex.codecogs.com/png.latex?%5Ctau"> to the right hand side:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20=%20%20%5Cleft(%5Cfrac%7B1%7D%7B2%5Ctau%7D%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%5CDelta%5E2%20%5Cphi(%5CDelta)d%5CDelta%20%5Cright)%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%0A"></p>
<p>Define <img src="https://latex.codecogs.com/png.latex?D:=%20%5Cleft(%5Cfrac%7B1%7D%7B2%5Ctau%7D%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%5CDelta%5E2%20%5Cphi(%5CDelta)d%5CDelta%20%5Cright)">. Then, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20=%20%20D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%0A"></p>
<p>The microscopic interpretation of the diffusion coefficient is, that its just the average of the squared displacements. The larger the <img src="https://latex.codecogs.com/png.latex?D">, the faster the brownian particles move.</p>
</section>
</section>
<section id="kolmogorovs-backward-equation" class="level2">
<h2 class="anchored" data-anchor-id="kolmogorovs-backward-equation">Kolmogorov’s Backward Equation</h2>
<p>Think of <img src="https://latex.codecogs.com/png.latex?y"> and <img src="https://latex.codecogs.com/png.latex?t"> as being current values and <img src="https://latex.codecogs.com/png.latex?y'"> and <img src="https://latex.codecogs.com/png.latex?t'"> being future values. The transition probability density function <img src="https://latex.codecogs.com/png.latex?p(y',t'%7Cy,t)"> of a diffusion satisfies two equations - one involving derivatives with respect to a future state and time (<img src="https://latex.codecogs.com/png.latex?y'"> and <img src="https://latex.codecogs.com/png.latex?t'">) called <em>forward equation</em> and the other involving derivatives with respect to the current state and current time (<img src="https://latex.codecogs.com/png.latex?y"> and <img src="https://latex.codecogs.com/png.latex?t">) called the <em>backward equation</em>. These two equations are parabolic partial differential equations not dissimilar to the Black-Scholes equation.</p>
<div id="thm-backward-equation-with-initial-value" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4 (Backward equation with initial value)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)"> be a diffusion in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D"> with the SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Csigma(X_t)dB_t%20+%20%5Cmu(X_t)%20dt%0A"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?g%5Cin%20C%5E2(%5Cmathbb%7BR%7D)"> be such that <img src="https://latex.codecogs.com/png.latex?g"> is <img src="https://latex.codecogs.com/png.latex?0"> outside an interval. Then, the solution of the PDE with initial value</p>
<p><span id="eq-backward-equation"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D(t,x)%20&amp;=%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%20+%20%5Cmu(x)%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D%5C%5C%0Af(0,x)%20&amp;=%20g(x)%0A%5Cend%7Balign*%7D%0A%5Ctag%7B16%7D"></span></p>
<p>has the representation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t,x)%20=%20%5Cmathbb%7BE%7D%5Bg(X_t)%7CX_0%20=%20x%5D%0A"></p>
</div>
<p><em>Proof.</em></p>
<p><strong>Step 1.</strong> Let’s fix <img src="https://latex.codecogs.com/png.latex?t"> and consider the function of space <img src="https://latex.codecogs.com/png.latex?h(x)=f(t,x)=%5Cmathbb%7BE%7D%5Bg(X_t)%7CX_0=x%5D">. Applying Ito’s formula to <img src="https://latex.codecogs.com/png.latex?h">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0Adh(X_s)%20&amp;=%20h'(X_s)%20dX_s%20+%20%5Cfrac%7B1%7D%7B2%7Dh''(X_s)%20(dX_s)%5E2%5C%5C%0A&amp;=%20h'(X_s)%20(%5Csigma(X_s)dB_s%20+%20%5Cmu(X_s)%20ds)%20+%20%5Cfrac%7B%5Csigma(X_s)%5E2%7D%7B2%7Dh''(X_s)ds%5C%5C%0A&amp;=%20%5Csigma(X_s)h'(X_s)dB_s%20+%20%5Cleft(%5Cfrac%7B%5Csigma(X_s)%5E2%7D%7B2%7Dh''(X_s)%20+%20%5Cmu(X_s)h'(X_s)%5Cright)ds%0A%5Cend%7Balign%7D"></p>
<p>In the integral form this is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Ah(X_s)%20-%20h(X_0)%20&amp;=%20%5Cint_0%5Es%20%5Csigma(X_u)h'(X_u)dB_u%20%5C%5C%0A&amp;+%20%5Cint_0%5Es%20%5Cleft(%5Cfrac%7B%5Csigma(X_u)%5E2%7D%7B2%7Dh''(X_u)%20+%20%5Cmu(X_u)h'(X_u)%5Cright)du%20%5Ctag%7B1%7D%0A%5Cend%7Balign*%7D"></p>
<p><strong>Step 2.</strong> Take expectations on both sides, divide by <img src="https://latex.codecogs.com/png.latex?s"> and let <img src="https://latex.codecogs.com/png.latex?s%20%5Cto%200">. We are interested in taking the derivative with respect to <img src="https://latex.codecogs.com/png.latex?s"> at <img src="https://latex.codecogs.com/png.latex?s_0=0">.</p>
<p>The expectation of the first term on the right hand side is zero, by the properties of the Ito integral.</p>
<p>The integrand of the second term (RHS) is a conditional expectation <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B%5Cxi(X_u)%7CX_0%20=%20x%5D">, it is an average at time <img src="https://latex.codecogs.com/png.latex?u">, of the paths of the process starting at initial position <img src="https://latex.codecogs.com/png.latex?X_0%20=%20x">, so it is a function of <img src="https://latex.codecogs.com/png.latex?u"> and <img src="https://latex.codecogs.com/png.latex?x">. So, <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B%5Cxi(X_u)%7CX_0%20=%20x%5D%20=%20p(u,x)">. Suppressing the argument <img src="https://latex.codecogs.com/png.latex?x">, we have the representation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign%7D%0A%5Cint_0%5Es%20p(u)%20du%0A%5Cend%7Balign%7D"></p>
<p>Recall that, if <img src="https://latex.codecogs.com/png.latex?p"> is a continuous function, then it is Riemann integrable. Further, since integration and differentiation are inverse operations, there exists a unique antiderivative <img src="https://latex.codecogs.com/png.latex?P"> given by</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP(s)%20=%20%5Cint_%7B0%7D%5E%7Bs%7Dp(u)du%0A"></p>
<p>satisfying <img src="https://latex.codecogs.com/png.latex?P'(0)%20=%20p(0)">.</p>
<p>By the definition of the derivative:</p>
<p><img src="https://latex.codecogs.com/png.latex?P'(0)%20=%20%5Clim_%7Bs%20%5Cto%200%7D%20%5Cfrac%7BP(s)%20-%20P(0)%7D%7Bs%7D%20=%20%5Clim_%7Bs%5Cto%200%7D%20%5Cfrac%7BP(s)%7D%7Bs%7D%20=%20p(0)%20%5Cquad%20%5C%7B%20P(0)=0%20%5Ctext%7B%20by%20definition%20%7D%5C%7D"></p>
<p>Thus, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap(0,x)%20=%20%5Cmathbb%7BE%7D%5B%5Cxi(X_0)%7CX_0%20=%20x%5D%20=%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%20h''(x)%20+%20%5Cmu(x)h'(x)%0A"></p>
<p><strong>Step 3.</strong> As for the left-hand side, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Clim_%7Bs%20%5Cto%200%7D%20%5Cfrac%7B%5Cmathbb%7BE%7D%5Bh(X_s)%7CX_0%20=%20x%5D%20-%20h(X_0)%7D%7Bs%7D%20=%20%5Clim_%7Bs%20%5Cto%200%7D%20%5Cfrac%7B%5Cmathbb%7BE%7D%5Bh(X_s)%7CX_0%20=%20x%5D%20-%20f(t,x)%7D%7Bs%7D%0A"></p>
<p>To prove that this limit is <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D(t,x)">, it remains to show that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5Bh(X_s)%7CX_0%20=%20x%5D=%5Cmathbb%7BE%7D%5Bg(X_%7Bt+s%7D)%7CX_0%20=%20x%5D=f(t+s,x)">.</p>
<p>To see this, note that <img src="https://latex.codecogs.com/png.latex?h(X_s)%20=%20%5Cmathbb%7BE%7D%5Bg(X_%7Bt+s%7D)%7CX_s%5D">. We deduce:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Bh(X_s)%7CX_0%20=%20x%5D%20&amp;=%20%5Cmathbb%7BE%7D%5B%5Cmathbb%7BE%7D%5Bg(X_%7Bt+s%7D)%7CX_s%5D%7CX_0%20=%20x%5D%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5B%5Cmathbb%7BE%7D%5Bg(X_%7Bt+s%7D)%7C%5Cmathcal%7BF%7D_s%5D%7CX_0%20=%20x%5D%5C%5C%0A&amp;%20%5C%7B%20(X_t,t%5Cgeq%200)%20%5Ctext%7B%20is%20Markov%20%7D%5C%7D%20%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5Bg(X_%7Bt+s%7D)%7CX_0%20=%20x%5D%5C%5C%0A&amp;%20%5C%7B%20%5Ctext%7B%20Tower%20property%20%7D%5C%7D%20%5C%5C%0A&amp;=%20f(t+s,x)%0A%5Cend%7Balign*%7D"></p>
<p>This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<p>The backward equation (Equation&nbsp;16) can be conveniently written in terms of <em>the generator of the diffusion</em>.</p>
<div id="def-generator-of-the-diffusion" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4 (Generator of a diffusion)</strong></span> The generator of a diffusion with SDE <img src="https://latex.codecogs.com/png.latex?dX_t%20=%20%5Csigma(X_t)%20dB_t%20+%20%5Cmu(X_t)dt"> is the differential operator acting on functions of space defined by :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20x%5E2%7D%20+%20%5Cmu(x)%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20x%7D%0A"></p>
</div>
<p>With this notation, the backward equation for the function <img src="https://latex.codecogs.com/png.latex?f(t,x)"> takes the form:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D(t,x)%20=%20Af(t,x)%0A"></p>
<p>where it is understood that <img src="https://latex.codecogs.com/png.latex?A"> acts only on the space variable. Theorem&nbsp;4 gives a nice interpretation of the generator: it quantifies how much the function <img src="https://latex.codecogs.com/png.latex?f(t,x)%20=%20%5Cmathbb%7BE%7D%5Bg(X_t)%7CX_0%20=%20x%5D"> changes in a small time interval.</p>
<div id="exm-generator-of-the-ornstein-uhlenbeck-process" class="theorem example">
<p><span class="theorem-title"><strong>Example 5</strong></span> (Generator of the Ornstein Uhlenbeck Process) The SDE of the Ornstein-Uhlenbeck process is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20dB_t%20-%20X_t%20dt%0A"></p>
<p>This means that its generator is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20x%5E2%7D%20-%20x%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20x%7D%0A"></p>
</div>
<div id="exm-generator-of-geometric-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 6</strong></span> (Generator of Geometric Brownian Motion) Recall that the geometric Brownian motion</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_t%20=%20S_0%20%5Cexp(%5Csigma%20B_t%20+%20%5Cmu%20t)%0A"></p>
<p>satisfies the SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdS_t%20=%20%5Csigma%20S_t%20dB_t%20+%20%5Cleft(%5Cmu%20+%20%5Cfrac%7B%5Csigma%5E2%7D%7B2%7D%5Cright)%20S_t%20dt%0A"></p>
<p>In particular, the generator of geometric Brownian motion is :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cfrac%7B%5Csigma%5E2%20x%5E2%7D%7B2%7D%20x%20%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20x%5E2%7D%20+%20%5Cleft(%5Cmu%20+%20%5Cfrac%7B%5Csigma%5E2%7D%7B2%7D%5Cright)%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20x%7D%0A"></p>
</div>
<p>For applications, in particular in mathematical finance, it is important to solve the backward equation with terminal value instead of with initial value. The reversal of time causes the appearance of an extra minus sign in the equation.</p>
<div id="thm-backward-equation-with-terminal-value" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5 (Backward equation with terminal value)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cleq%20T)"> be a diffusion with the dynamics:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Csigma(X_t)%20dB_t%20+%20%5Cmu(X_t)dt%0A"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?g%5Cin%20C%5E2(%5Cmathbb%7BR%7D)"> be such that <img src="https://latex.codecogs.com/png.latex?g"> is <img src="https://latex.codecogs.com/png.latex?0"> outside an interval. Then, the solution of the PDE with terminal value at time <img src="https://latex.codecogs.com/png.latex?T"></p>
<p><span id="eq-backward-equation-with-terminal-value"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A-%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20&amp;=%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%20+%20%5Cmu(x)%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D%5C%5C%0Af(T,x)%20&amp;=%20g(x)%0A%5Cend%7Balign*%7D%0A%5Ctag%7B17%7D"></span></p>
<p>has the representation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t,x)%20=%20%5Cmathbb%7BE%7D%5Bg(X_T)%7CX_t%20=%20x%5D%0A"></p>
</div>
<div id="nte-functions-of-markov" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note&nbsp;3: Backward equation with terminal value appears in the martingale condition
</div>
</div>
<div class="callout-body-container callout-body">
<p>One way to construct a martingale for the filtration <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t,t%5Cgeq%200)"> is to take</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AM_t%20=%20%5Cmathbb%7BE%7D%5BY%20%7C%20%5Cmathcal%7BF%7D_t%5D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?Y"> is some integrable random variable. The martingale property then follows from the tower property of the conditional expectation. In the setup of Theorem&nbsp;5, the random variable <img src="https://latex.codecogs.com/png.latex?Y"> is <img src="https://latex.codecogs.com/png.latex?g(X_T)">. By the Markov property of diffusion, we therefore have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t,X_t)%20=%20%5Cmathbb%7BE%7D%5Bg(X_T)%7CX_t%5D%20=%20%5Cmathbb%7BE%7D%5Bg(X_T)%7C%5Cmathcal%7BF%7D_t%5D%0A"></p>
<p>In other words, the solution to the backward equation with terminal value evaluated at <img src="https://latex.codecogs.com/png.latex?X_t%20=%20x"> yields a martingale for the natural filtration of the process. This is a different point of view on the procedure we have used many times now: To get a martingale of the form <img src="https://latex.codecogs.com/png.latex?f(t,X_t)">, apply the Ito’s formula to <img src="https://latex.codecogs.com/png.latex?f(t,X_t)"> and set the <img src="https://latex.codecogs.com/png.latex?dt"> term to zero. The PDE we obtain is the backward equation with terminal value. In fact, the proof of the theorem takes this exact route.</p>
</div>
</div>
<p><em>Proof.</em></p>
<p>Consider <img src="https://latex.codecogs.com/png.latex?f(t,X_t)"> and apply Ito’s formula.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Adf(t,X_t)%20&amp;=%20%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20dt%20+%20%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdX_t%20+%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%20dX_t%20%5Ccdot%20dX_t%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20dt%20+%20%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D(%5Csigma(X_t)%20dB_t%20+%20%5Cmu(X_t)dt)%20+%20%5Cfrac%7B%5Csigma(X_t)%5E2%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%20dt%5C%5C%0A&amp;=%20%5Csigma(X_t)%20dB_t%20+%20%5Cleft(%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20+%20%5Cfrac%7B%5Csigma(X_t)%5E2%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%20+%20%5Cmu(X_t)%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D%5Cright)dt%0A%5Cend%7Balign*%7D%0A"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?f(t,x)"> is a solution to the equation, we get that the <img src="https://latex.codecogs.com/png.latex?dt"> term is <img src="https://latex.codecogs.com/png.latex?0"> and <img src="https://latex.codecogs.com/png.latex?f(t,X_t)"> is a martingale for the Brownian filtration (and thus also for the natural filtration of the diffusion, which contains less information). In particular we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t,X_t)%20=%20%5Cmathbb%7BE%7D%5Bf(T,X_T)%7C%5Cmathcal%7BF%7D_t%5D%20=%20%5Cmathbb%7BE%7D%5Bg(X_T)%7C%5Cmathcal%7BF%7D_t%5D%0A"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cleq%20T)"> is a Markov process, we finally get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t,x)%20=%20%5Cmathbb%7BE%7D%5Bg(X_T)%7CX_t%20=%20x%5D%0A"></p>
<div id="exm-martingales-of-geometric-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 7</strong></span> (Martingales of geometric Brownian motion) Let <img src="https://latex.codecogs.com/png.latex?(S_t,%20%5Cgeq%200)"> be a geometric brownian motion with SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdS_t%20=%20%5Csigma%20S_t%20dB_t%20+%20%5Cleft(%5Cmu%20+%20%5Cfrac%7B%5Csigma%5E2%7D%7B2%7D%5Cright)dt%0A"></p>
<p>As we saw in Example&nbsp;6, its generator is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cfrac%7B%5Csigma%5E2%20x%5E2%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20x%5E2%7D%20+%20x%5Cleft(%5Cmu+%5Cfrac%7B%5Csigma%5E2%7D%7B2%7D%5Cright)%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20x%7D%0A"></p>
<p>In view of Theorem&nbsp;5, if <img src="https://latex.codecogs.com/png.latex?f(t,x)"> satisfies the PDE</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20+%20%5Cfrac%7B%5Csigma%5E2%20x%5E2%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%20+%20x%5Cleft(%5Cmu+%5Cfrac%7B%5Csigma%5E2%7D%7B2%7D%5Cright)%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D%0A"></p>
<p>then processes of the form <img src="https://latex.codecogs.com/png.latex?f(t,S_t)"> will be martingales for the natural filtration.</p>
</div>
</section>
<section id="kolmogorovs-forward-equation" class="level2">
<h2 class="anchored" data-anchor-id="kolmogorovs-forward-equation">Kolmogorov’s forward equation</h2>
<p>The companion equation to the backward equation is the <em>Kolmogorov forward equation</em> or <em>forward equation</em>. It is also known as the <em>Fokker-Planck</em> equation from its physics origin. The equation is very useful as it is satisfied by the transition density function <img src="https://latex.codecogs.com/png.latex?p(y',t'%7Cy,t)"> of a time-homogenous diffusion. It involves the <em>adjoint of the generator</em>.</p>
<div id="def-adjoint-of-the-generator" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5 (Adjoint of the generator)</strong></span> The adjoint <img src="https://latex.codecogs.com/png.latex?A%5E*"> of the generator of a diffusion <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)"> with SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Csigma(X_t)dB_t%20+%20%5Cmu(X_t)dt%0A"></p>
<p>is the differential operator acting on a function of space <img src="https://latex.codecogs.com/png.latex?f(x)"> as follows:</p>
<p><span id="eq-adjoint-of-the-generator-of-a-diffusion"><img src="https://latex.codecogs.com/png.latex?%0AA%5E*f(x)%20=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20%7D%7B%5Cpartial%20x%5E2%7D%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%20f(x)%20-%20%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20x%7D%5Cmu(x)f(x)%0A%5Ctag%7B18%7D"></span></p>
</div>
<p>Note the differences with the generator in Definition&nbsp;4: there is an extra minus sign and the derivatives also act on the volatility and the drift.</p>
<div id="exm-the-generator-brownian-motion-is-self-adjoint" class="theorem example">
<p><span class="theorem-title"><strong>Example 8</strong></span> (The generator of Brownian motion is self-adjoint) In the case of standard brownian motion, it is easy to check that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%5E*%20=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20x%5E2%7D%0A"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%5E*%20=%20%5Cfrac%7B1%7D%7B2%7D%5Cnabla%5E2%0A"></p>
<p>in the multivariate case. In other words, the generator and its adjoint are the same. In this case, the operator is <em>self-adjoint</em>.</p>
</div>
<div id="exm-the-adjoint-for-geometric-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 9</strong></span> We see that the adjoint of the generator acting on <img src="https://latex.codecogs.com/png.latex?f(x)"> for geometric Brownian motion is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%5E*f(x)%20=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20x%5E2%7D%20(%5Csigma%5E2%20x%5E2%20f(x))%20-%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20x%7D%20%5Cleft(%5Cleft(%5Cmu%20+%20%5Cfrac%7B%5Csigma%5E2%7D%7B2%7D%5Cright)%20x%20f(x)%5Cright)%0A"></p>
<p>Using the product rule in differentiating we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%5E*%5Bf(x)%5D%20=%20%5Cfrac%7B%5Csigma%5E2%7D%7B2%7D%5Cleft(2x%20f(x)%20+%20x%5E2%20f''(x)%5Cright)%20-%20%5Cleft(%5Cleft(%5Cmu%20+%20%5Cfrac%7B%5Csigma%5E2%7D%7B2%7D%5Cright)%5Cleft(f(x)%20+%20x%20f'(x)%5Cright)%5Cright)%0A"></p>
</div>
<div id="exm-adjoint-for-the-ornstein-uhlenbeck-process" class="theorem example">
<p><span class="theorem-title"><strong>Example 10</strong></span> The generator for the Ornstein-Uhlenbeck process was given in Example&nbsp;5. The adjoint acting on <img src="https://latex.codecogs.com/png.latex?f"> is therefore:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AA%5E*f(x)%20&amp;=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20x%5E2%7D(f(x))%20-%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20x%7D(-%20x%20f(x))%5C%5C%0A&amp;=%20%5Cfrac%7Bf''(x)%7D%7B2%7D%20+%20(f(x)+xf'(x))%0A%5Cend%7Balign*%7D%0A"></p>
</div>
<p>The forward equation takes the following form for a function <img src="https://latex.codecogs.com/png.latex?f(t,x)"> of time and space:</p>
<p><span id="eq-forward-equation"><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20=%20A%5E*%20f%0A%5Ctag%7B19%7D"></span></p>
<p>For brownian motion, since <img src="https://latex.codecogs.com/png.latex?A%5E*%20=%20A">, the backward and forward equations are the same. As advertised earlier, the forward equation is satisfied by the transition <img src="https://latex.codecogs.com/png.latex?p_t(y',t'%7Cy,t)"> of a diffusion. Before showing this in general, we verify it in the Brownian case.</p>
<div id="exm-the-heat-kernel-as-the-solution-of-the-forward-equation" class="theorem example">
<p><span class="theorem-title"><strong>Example 11</strong></span> Recall that the transition probability density <img src="https://latex.codecogs.com/png.latex?p(y,t%7Cx,0)"> for Brownian motion, or heat kernel, is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ap(y,t%7Cx,0)%20=%20%5Cfrac%7Be%5E%7B-%5Cfrac%7B(y-x)%5E2%7D%7B2%7D%7D%7D%7B%5Csqrt%7B2%5Cpi%20t%7D%7D%0A"></p>
<p>Here, the space variable will be <img src="https://latex.codecogs.com/png.latex?y"> and <img src="https://latex.codecogs.com/png.latex?x"> will be fixed. The relevant function is thus <img src="https://latex.codecogs.com/png.latex?f(t,y)%20=%20p(y,t%7Cx,0)">. The adjoint operator acting on the space variable <img src="https://latex.codecogs.com/png.latex?y"> is <img src="https://latex.codecogs.com/png.latex?A%5E*%20=%20A%20=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20y%5E2%7D">. The relevant time and space derivatives are given by Equation&nbsp;12 and Equation&nbsp;14.</p>
<p>We conclude that <img src="https://latex.codecogs.com/png.latex?f(t,y)=p(y,t%7Cx,0)"> is a solution of the forward equation.</p>
</div>
<p>Where does the form of the adjoint operator Equation&nbsp;18 come from? In some sense, the adjoint operator plays a role similar to that of the transpose of a matrix in linear algebra. The adjoint acts on the function on the left. To see this, consider two functions <img src="https://latex.codecogs.com/png.latex?f,g"> of space on which the generator <img src="https://latex.codecogs.com/png.latex?A"> of a diffusion is well-defined. In particular, let’s assume that the functions are zero outside an interval. Consider the quantity</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cint_%7B%5Cmathbb%7BR%7D%7Dg(x)A(f(x))dx%20=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%20g(x)%5Cleft(%5Cfrac%7B%5Csigma(x)%5E2%20%7D%7B2%7Df''(x)%20+%20%5Cmu(x)f'(x)%5Cright)dx%0A"></p>
<p>This quantity can represent for example the average of <img src="https://latex.codecogs.com/png.latex?Af(x)"> over some PDF <img src="https://latex.codecogs.com/png.latex?g(x)">. In the above, <img src="https://latex.codecogs.com/png.latex?A"> acts on the function on the right. To make the operator act on <img src="https://latex.codecogs.com/png.latex?g">, we integrate by parts. This gives for the second term:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cint_%7B%5Cmathbb%7BR%7D%7D%20g(x)%5Cmu(x)f'(x)dx%20=%20g(x)%5Cmu(x)f(x)%5CBigg%7C_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D-%5Cint_%7B%5Cmathbb%7BR%7D%7Df(x)%5Cfrac%7Bd%7D%7Bdx%7D(g(x)%5Cmu(x))dx%0A"></p>
<p>The boundary term <img src="https://latex.codecogs.com/png.latex?g(x)f(x)%5Cmu(x)%5CBigg%7C_%7B-%5Cinfty%7D%5E%5Cinfty"> is <img src="https://latex.codecogs.com/png.latex?0"> by the assumptions on <img src="https://latex.codecogs.com/png.latex?f,g">. This term on <img src="https://latex.codecogs.com/png.latex?%5Csigma"> is obtained by integrating by parts twice:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cint_%7B%5Cmathbb%7BR%7D%7D%20g(x)%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7Df''(x)dx%20&amp;=%20g(x)%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7Df'(x)%5CBigg%7C_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20-%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%5Cfrac%7Bd%7D%7Bdx%7D%5Cleft(g(x)%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%5Cright)%20f'(x)dx%5C%5C%0A-%5Cint_%7B%5Cmathbb%7BR%7D%7D%20%5Cfrac%7Bd%7D%7Bdx%7D%5Cleft(g(x)%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%5Cright)f'(x)dx%20&amp;=%20-%5Cfrac%7Bd%7D%7Bdx%7D%5Cleft(g(x)%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%5Cright)f(x)%20%5CBigg%7C_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20+%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%5Cfrac%7Bd%5E2%7D%7Bdx%5E2%7D%5Cleft(g(x)%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%5Cright)f(x)dx%0A%5Cend%7Balign*%7D%0A"></p>
<p>Thus,</p>
<p><span id="eq-relation-between-generator-and-adjoint"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cint_%7B%5Cmathbb%7BR%7D%7Dg(x)%20Af(x)dx%20&amp;=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%5Cleft(%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7Bd%5E2%7D%7Bdx%5E2%7D(g(x)%20%5Csigma(x)%5E2)%20-%20%5Cfrac%7Bd%7D%7Bdx%7D(g(x)%5Cmu(x))%5Cright)f(x)dx%5C%5C%0A&amp;=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D(A%5E*g(x))f(x)dx%0A%5Cend%7Balign*%7D%0A%5Ctag%7B20%7D"></span></p>
<div id="thm-forward-equation-and-transition-probability" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6 (Forward equation and transition probability)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)"> be a diffusion with SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Csigma(X_t)dB_t%20+%20%5Cmu(X_t)dt,%20%5Cquad%20X_0%20=%20x_0%0A"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?p(x,t%7Cx_0,0)"> be the transition probability density function for a fixed <img src="https://latex.codecogs.com/png.latex?x_0">. Then, the function <img src="https://latex.codecogs.com/png.latex?f(t,y)%20=%20p(y,t%7Cx_0,0)"> is a solution of the PDE</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20=%20A%5E*%20f%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?A%5E*"> is the adjoint of <img src="https://latex.codecogs.com/png.latex?A">.</p>
</div>
<p><em>Proof.</em></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?h(x)"> be some arbitrary function of space that is <img src="https://latex.codecogs.com/png.latex?0"> outside an interval. We compute :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B1%7D%7B%5Cepsilon%7D(%5Cmathbb%7BE%7D%5Bh(X_%7Bt+%5Cepsilon%7D)%20-%20%5Cmathbb%7BE%7D%5Bh(X_t)%5D%5D)%0A"></p>
<p>two different ways and take the limit as <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20%5Cto%200">.</p>
<p>On one hand, we have by the definition of the transition density</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B1%7D%7B%5Cepsilon%7D%5Cleft(%5Cmathbb%7BE%7D%5Bh(X_%7Bt+%5Cepsilon%7D)%5D-%5Cmathbb%7BE%7D%5Bh(X_t)%5D%5Cright)%20=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%5Cfrac%7B1%7D%7B%5Cepsilon%7D(p(x,t+%5Cepsilon%7Cx,0)%20-%20p(x,t%7Cx_0,0))h(x)dx%0A"></p>
<p>By taking the limit <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20%5Cto%200"> inside the integral (assuming this is fine), we get:</p>
<p><span id="eq-fwd-equation-partial-wrt-time"><img src="https://latex.codecogs.com/png.latex?%0A%5Cint_%7B%5Cmathbb%7BR%7D%7D%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7Dp(x,t%7Cx_0,0)h(x)dx%0A%5Ctag%7B21%7D"></span></p>
<p>On the other hand, Ito’s formula implies</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Adh(X_s)%20&amp;=%20%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20x%7D%20dX_s%20+%20%5Cfrac%7B1%7D%7B2%7D%20%5Cfrac%7B%5Cpartial%5E2%20h%7D%7B%5Cpartial%20x%5E2%7D%20(dX_s)%5E2%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20x%7D%20(%5Csigma(X_s)%20dB_s%20+%20%5Cmu(X_s)ds)%20+%20%5Cfrac%7B1%7D%7B2%7D%20%5Cfrac%7B%5Cpartial%5E2%20h%7D%7B%5Cpartial%20x%5E2%7D%20(%5Csigma(X_s)%5E2%20ds)%5C%5C%0A&amp;=%20%5Csigma(X_s)%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20x%7D%20dB_s%20+%20%5Cleft(%5Cmu(X_s)%20%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20x%7D%20+%20%5Cfrac%7B%5Csigma(X_s)%5E2%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20h%7D%7B%5Cpartial%20x%5E2%7D%5Cright)ds%5C%5C%0Ah(X_%7Bt+%5Cepsilon%7D)%20-%20h(X_t)%20&amp;=%20%5Cint_%7Bt%7D%5E%7Bt+%5Cepsilon%7D%5Csigma(X_s)%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20x%7D%20dB_s%20+%20%5Cint_%7Bt%7D%5E%7Bt+%5Cepsilon%7D(Ah(x))ds%5C%5C%0A%5Cmathbb%7BE%7D%5Bh(X_%7Bt+%5Cepsilon%7D)%5D%20-%20%5Cmathbb%7BE%7D%5Bh(X_t)%5D%20&amp;=%20%5Cunderbrace%7B%5Cmathbb%7BE%7D%5Cleft%5B%5Cint_%7Bt%7D%5E%7Bt+%5Cepsilon%7D%5Csigma(X_s)%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20x%7D%20dB_s%5Cright%5D%7D_%7B0%7D%20+%20%5Cint_%7Bt%7D%5E%7Bt+%5Cepsilon%7D%5Cmathbb%7BE%7D%5BAh(X_s)%5Dds%0A%5Cend%7Balign*%7D%0A"></p>
<p>Dividing by <img src="https://latex.codecogs.com/png.latex?%5Cepsilon"> and taking the limit as <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20%5Cto%200">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Clim_%7B%5Cepsilon%20%5Cto%200%7D%20%5Cfrac%7B1%7D%7B%5Cepsilon%7D%20(%5Cmathbb%7BE%7D%5Bh(X_%7Bt+%5Cepsilon%7D)%5D%20-%20%5Cmathbb%7BE%7D%5Bh(X_t)%5D)%20&amp;=%20%5Cmathbb%7BE%7D%5BAh(X_t)%5D%5C%5C%0A&amp;=%20%5Cint_%7B%5Cmathbb%7BR%7D%7D%20p(x,t%7Cx_0,0)%20Ah(x)%20dx%0A%5Cend%7Balign*%7D%0A"></p>
<p>This can be written using Equation&nbsp;20 as,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cint_%7B%5Cmathbb%7BR%7D%7D(A%5E*%20p(x,t%7Cx_0,0))%20h(x)%20dx%0A"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?h"> is arbitrary, we conclude that:</p>
<p><span id="eq-forward-equation"><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7Dp(x,t%7Cx_0,0)%20=%20A%5E*%20p(x,t%7Cx_0,0)%0A%5Ctag%7B22%7D"></span></p>
<div id="exm-forward-equation-and-invariant-probability" class="theorem example">
<p><span class="theorem-title"><strong>Example 12</strong></span> (Forward equation and invariant probability.) The Ornstein-Uhlenbeck process converges to a stationary distribution as noted in the <a href="https://quantinsights.github.io/posts/ito-processes-and-stochastic-diff-eqs/#exm-ornstein-uhlenbeck-process">example</a> here. For example, for the SDE of the form</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20-X_t%20dt%20+%20dB_t%0A"></p>
<p>with <img src="https://latex.codecogs.com/png.latex?X_0"> a Gaussian of mean <img src="https://latex.codecogs.com/png.latex?0"> and variance <img src="https://latex.codecogs.com/png.latex?1/2">, the PDF of <img src="https://latex.codecogs.com/png.latex?X_t">, is, for all <img src="https://latex.codecogs.com/png.latex?t"> is:</p>
<p><span id="eq-pdf-of-OU-process"><img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B%5Cpi%7D%7D%20e%5E%7B-x%5E2%7D%0A%5Ctag%7B23%7D"></span></p>
<p>This <em>invariant distribution</em> can be seen from the point of view of the forward equation. Indeed since the PDF is constant in time, the forward equation simply becomes:</p>
<p><span id="eq-forward-equation-of-ou-process"><img src="https://latex.codecogs.com/png.latex?%0AA%5E*%20f%20=%200%0A%5Ctag%7B24%7D"></span></p>
</div>
<div id="exm-smoluchowski-equation" class="theorem example">
<p><span class="theorem-title"><strong>Example 13</strong></span> The SDE of the Ornstein-Uhlenbeck process can be generated as follows. Consider <img src="https://latex.codecogs.com/png.latex?V(x)">, a smooth function of space such that <img src="https://latex.codecogs.com/png.latex?%5Cint_%7B%5Cmathbb%7BR%7D%7D%20e%5E%7B-2V(x)%7Ddx%3C%5Cinfty">. The <em>Smoluchowski</em> equation is the SDE of the form:</p>
<p><span id="eq-smoluchowski-equation"><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20dB_t%20-%20V'(X_t)%20dt%0A%5Ctag%7B25%7D"></span></p>
<p>The SDE can be interpreted as follows: <img src="https://latex.codecogs.com/png.latex?X_t"> represents the position of a particle on <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D">. The position varies due to the Brownian fluctuations and also due to a force <img src="https://latex.codecogs.com/png.latex?V'(X_t)"> that depends on the position. The function <img src="https://latex.codecogs.com/png.latex?V(x)"> should then be thought of as the potential with which the particle moves, since the force (field) is the (negative) derivative of the potential function in Newtonian physics. The generator of this diffusion is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AA%20=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20x%5E2%7D%20-%20V'(x)%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20x%7D%0A"></p>
<p>This diffusion admits an invariant distribution :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(x)%20=%20Ce%5E%7B-2V(x)%7D%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?C"> is such that <img src="https://latex.codecogs.com/png.latex?%5Cint_%7B%5Cmathbb%7BR%7D%7Df(x)dx%20=%201">.</p>
</div>
</section>
<section id="the-feynman-kac-formula" class="level2">
<h2 class="anchored" data-anchor-id="the-feynman-kac-formula">The Feynman-Kac Formula</h2>
<p>We saw in Example&nbsp;4 that the solution of the heat equation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D%20=%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D%0A"></p>
<p>can be represented as an average over Brownian paths. This representation was extended to diffusions in theorem Theorem&nbsp;4 where the second derivative in the equation is replaced by the generator of the corresponding diffusion. How robust is this representation? In other words, is it possible to slightly change the PDE and still get a stochastic representation representation for the solution? The answer to this question is yes, when a term of the form <img src="https://latex.codecogs.com/png.latex?r(x)f(t,x)"> is added to the equation, where <img src="https://latex.codecogs.com/png.latex?r(x)"> is a well-behaved function of space (for example, piecewise continuous). The stochastic representation of the PDE in this case bears the name <em>Feynman-Kac</em> formula, making a fruitful collaboration between the physicist <a href="https://en.wikipedia.org/wiki/Richard_Feynman">Richard Feynman</a> and the mathematician <a href="https://en.wikipedia.org/wiki/Mark_Kac">Mark Kac</a>. By the way, you pronounce “Kac” as “cats”. His name is Polish. People who immigrated from Poland before him spelled their names as “Katz”. The case when <img src="https://latex.codecogs.com/png.latex?r(x)"> is linear will be important in the applications to mathematical finance, where it represents the contribution of the interest rate.</p>
<div id="thm-initial-value-problem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7 (Initial Value Problem)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)"> be a diffusion in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D"> with the SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Csigma(X_t)%20dB_t%20+%20%5Cmu(X_t)dt%0A"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?g%5Cin%20C%5E2(%5Cmathbb%7BR%7D)"> be such that <img src="https://latex.codecogs.com/png.latex?g"> is <img src="https://latex.codecogs.com/png.latex?0"> outside an interval. Then, the solution of the PDE with initial value</p>
<p><span id="eq-initial-value-problem"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D(t,x)%20&amp;=%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D(t,x)%20+%20%5Cmu(x)%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D(t,x)%20-%20r(x)f(x)%5C%5C%0Af(0,x)%20&amp;=%20g(x)%0A%5Cend%7Balign*%7D%0A%5Ctag%7B26%7D"></span></p>
<p>has the stochastic representation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t,x)%20=%20%5Cmathbb%7BE%7D%5Cleft%5Bg(X_t)%5Cexp%5Cleft(-%5Cint_0%5Et%20r(X_s)%20ds%5Cright)%5CBigg%7C%20X_0%20=%20x%5Cright%5D%0A"></p>
</div>
<p><em>Proof.</em></p>
<p>The proof is again based on Ito’s formula. For a fixed <img src="https://latex.codecogs.com/png.latex?t">, we consider the process:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AM_s%20=%20f(t-s,%20X_s)%20%5Cexp%5Cleft(-%5Cint_0%5Es%20r(X_u)%20du%5Cright),%20%5Cquad%20s%20%5Cleq%20t%0A"></p>
<p>Write <img src="https://latex.codecogs.com/png.latex?Z_s%20=%20%5Cexp%5Cleft(-%5Cint_0%5Es%20r(X_u)%20du%5Cright)"> and <img src="https://latex.codecogs.com/png.latex?V_s%20=%20f(t-s,X_s)">. A direct application of Ito’s formula yields:</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?R_s%20=%20-%5Cint_0%5Es%20r(X_u)%20du">. So, <img src="https://latex.codecogs.com/png.latex?dR_t%20=%20r(X_t)%20dt">. <img src="https://latex.codecogs.com/png.latex?(R_t,t%5Cgeq%200)"> is a random variable, because <img src="https://latex.codecogs.com/png.latex?r(X_s)"> depends on how <img src="https://latex.codecogs.com/png.latex?(X_s,%20s%20%5Cleq%20t)"> evolves, it is <em>stochastic</em>, but for very small intervals of time <img src="https://latex.codecogs.com/png.latex?r(X_s)"> is a constant, and hence the process <img src="https://latex.codecogs.com/png.latex?(R_t,t%5Cgeq%200)"> is said to be locally deterministic.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AZ_s%20&amp;=%20e%5E%7B-R_s%7D%5C%5C%0AdZ_s%20&amp;=%20-e%5E%7B-R_s%7D%20dR_s%20+%20%5Cfrac%7B1%7D%7B2%7De%5E%7BR_s%7D%20(dR_s)%5E2%5C%5C%0A&amp;=%20-Z_s%20r(X_s)%20ds%0A%5Cend%7Balign*%7D%0A"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AdV_s%20&amp;=%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20s%7Df(t-s,%20X_s)ds%20+%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20x%7Df(t-s,%20X_s)dX_s%20+%20%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%7D%7B%5Cpartial%20x%5E2%7Df(t-s,X_s)(dX_s)%5E2%5C%5C%0A&amp;=%20-f_s%20ds%20+%20f_x%20(%5Csigma(X_s)dB_s%20+%20%5Cmu(X_s)ds)%20+%20%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D%20%5Csigma(X_s)%5E2%20ds%20%5C%5C%0A&amp;=%20%5Csigma(X_s)%20f_x%20dB_s%20+%20%5C%5C%0A&amp;+%20%5Cleft%5C%7B-f_s%20+%20%5Cmu(X_s)f_x%20+%20%5Cfrac%7B%5Csigma(X_s)%5E2%7D%7B2%7Df_%7Bxx%7D%5Cright%5C%7Dds%0A%5Cend%7Balign*%7D%0A"></p>
<p>Recall that <img src="https://latex.codecogs.com/png.latex?t"> is fixed here, and we differentiate with respect to <img src="https://latex.codecogs.com/png.latex?s"> in time. Since <img src="https://latex.codecogs.com/png.latex?f(t,x)"> is a solution of the PDE, we can write the second equation as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdV_s%20=%20%5Csigma(X_s)%20f_x%20dB_s%20+%20r(X_s)%20f(t-s,X_s)ds%0A"></p>
<p>Now, by Ito’s product rule, we finally have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AdM_s%20&amp;=%20V_s%20dZ_s%20+%20Z_s%20dV_s%20+%20dZ_s%20dV_s%5C%5C%0A&amp;=%20-f(t-s,X_s)Z_s%20r(X_s)%20ds%20+%20Z_s%20(%5Csigma(X_s)%20f_x%20dB_s%20+%20r(X_s)%20f(t-s,X_s)ds)%20+%200%5C%5C%0A&amp;=%20%5Csigma(X_s)Z_s%20f_x%20dB_s%0A%5Cend%7Balign*%7D%0A"></p>
<p>This proves that <img src="https://latex.codecogs.com/png.latex?(M_s,%20s%20%5Cleq%20t)"> is a martingale. We conclude that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5BM_t%5D%20=%20%5Cmathbb%7BE%7D%5BM_0%5D%0A"></p>
<p>Using the definition of <img src="https://latex.codecogs.com/png.latex?M_t">, this yields:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5BM_t%5D%20=%20%5Cmathbb%7BE%7D%5Cleft%5Bf(0,X_t)%5Cexp%5Cleft(-%5Cint_0%5Et%20r(X_u)%20du%5Cright)%5Cright%5D%20=%20%5Cmathbb%7BE%7D%5Cleft%5Bg(X_t)%5Cexp%5Cleft(-%5Cint_0%5Et%20r(X_u)%20du%5Cright)%5Cright%5D%20=%20%5Cmathbb%7BE%7D%5BM_0%5D%20=%20f(t,x)%0A"></p>
<p>This proves the theorem. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
<p>As for the backward equation, it is natural to consider the terminal value problem for the same PDE.</p>
<div id="thm-terminal-value-problem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 8 (Terminal Value Problem)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(X_t,t%20%5Cleq%20T)"> be a diffusion in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D"> with the SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Csigma(X_t)%20dB_t%20+%20%5Cmu(X_t)%20dt%0A"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?g%5Cin%20C%5E2(%5Cmathbb%7BR%7D)"> be such that <img src="https://latex.codecogs.com/png.latex?g"> is <img src="https://latex.codecogs.com/png.latex?0"> outside an interval. Then, the solution of the PDE with initial value</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A-%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D(t,x)%20&amp;=%20%5Cfrac%7B%5Csigma(x)%5E2%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x%5E2%7D(t,x)%20+%20%5Cmu(x)%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D(t,x)%20-%20r(x)f(t,x)%5C%5C%0Af(T,x)%20&amp;=%20g(x)%0A%5Cend%7Balign*%7D%0A"></p>
<p>has the stochastic representation :</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Af(t,x)%20=%20%5Cmathbb%7BE%7D%5Cleft%5Bg(X_T)%5Cexp%5Cleft(-%5Cint_t%5ET%20r(X_u)%20du%5Cright)%5CBigg%7CX_t%20=%20x%5Cright%5D%0A"></p>
</div>
<p><em>Proof.</em></p>
<p>The proof is similar by considering instead</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AM_t%20=%20f(t,X_t)%5Cexp%5Cleft(-%5Cint_0%5Et%20r(X_u)%20du%5Cright)%0A"></p>
</section>
<section id="numerical-projects" class="level2">
<h2 class="anchored" data-anchor-id="numerical-projects">Numerical Projects</h2>
<section id="temperature-of-a-rod" class="level3">
<h3 class="anchored" data-anchor-id="temperature-of-a-rod">Temperature of a rod</h3>
<p>Consider the initial function <img src="https://latex.codecogs.com/png.latex?g(x)%20=%201%20-%20%7Cx%7C"> for <img src="https://latex.codecogs.com/png.latex?%7Cx%7C%20%5Cleq%201"> and <img src="https://latex.codecogs.com/png.latex?0"> if <img src="https://latex.codecogs.com/png.latex?%7Cx%7C%20%3E%201">. This function may represent the temperature of a rod at time <img src="https://latex.codecogs.com/png.latex?0">.</p>
<ol type="a">
<li>Approximate the solution <img src="https://latex.codecogs.com/png.latex?f(t,x)"> to the heat equation at time <img src="https://latex.codecogs.com/png.latex?t=0.25"> at every <img src="https://latex.codecogs.com/png.latex?0.01"> in <img src="https://latex.codecogs.com/png.latex?x"> using the representation Equation&nbsp;11. Use a sample of <img src="https://latex.codecogs.com/png.latex?100"> paths for each <img src="https://latex.codecogs.com/png.latex?x">.</li>
</ol>
<p><em>Solution.</em></p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># initial temperature of the rod as a function of position x</span></span>
<span id="cb1-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> g(x):</span>
<span id="cb1-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>:</span>
<span id="cb1-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(x)</span>
<span id="cb1-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb1-9">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb1-10"></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># helper function to generate brownian paths starting at B_0 = x_0</span></span>
<span id="cb1-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> brownian_paths(num_paths, step_size, t_0, t_n, x_0):</span>
<span id="cb1-14">    num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>((t_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> t_0) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> step_size)</span>
<span id="cb1-15">    db_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(step_size) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.random.standard_normal(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(num_paths, num_steps))</span>
<span id="cb1-16">    db_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.concatenate([np.full((num_paths, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), x_0), db_t], axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-17">    b_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cumsum(db_t, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> b_t</span>
<span id="cb1-19"></span>
<span id="cb1-20"></span>
<span id="cb1-21">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1001</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># space variable</span></span>
<span id="cb1-22">t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># time variable</span></span></code></pre></div>
</div>
<p>Now, let’s use the data from the problem to compute the specific space average.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate sample paths</span></span>
<span id="cb2-2">paths <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> brownian_paths(num_paths<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, step_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, t_0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, t_n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, x_0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># look at the value of B(t) at t=0.25 and average them</span></span></code></pre></div>
</div>
</section>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<div id="exr-shifted-brownian-motion" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> (Shifted Brownian Motion) Let <img src="https://latex.codecogs.com/png.latex?(B_t,t%5Cgeq%200)"> be a standard brownian motion. Fix <img src="https://latex.codecogs.com/png.latex?t%20%3E%200">. Show that the process <img src="https://latex.codecogs.com/png.latex?(W_s,s%20%5Cgeq%200)"> with <img src="https://latex.codecogs.com/png.latex?W_s%20=%20B_%7Bt+s%7D%20-%20B_t"> is a standard brownian motion independent of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t">.</p>
</div>
<p><em>Solution</em>.</p>
<p>At <img src="https://latex.codecogs.com/png.latex?s%20=%200">, <img src="https://latex.codecogs.com/png.latex?W(0)%20=%20B(t)%20-%20B(t)%20=%200">.</p>
<p>Consider any arbitrary times <img src="https://latex.codecogs.com/png.latex?t_1%20%3C%20t_2">. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AW(t_2)%20-%20W(t_1)%20&amp;=%20(B(t%20+%20t_2)%20-%20B(t))%20-%20(B(t%20+%20t_1)%20-%20B(t))%5C%5C%0A&amp;=%20B(t%20+%20t_2)%20-%20B(t%20+%20t_1)%0A%5Cend%7Balign*%7D"></p>
<p>Now, <img src="https://latex.codecogs.com/png.latex?B(t%20+%20t_2)%20-%20B(t%20+%20t_1)%20%5Csim%20%5Cmathcal%7BN%7D(0,t_2%20-%20t_1)">. So, <img src="https://latex.codecogs.com/png.latex?W(t_2)%20-%20W(t_1)"> is a Gaussian random variable with mean <img src="https://latex.codecogs.com/png.latex?0"> and variance <img src="https://latex.codecogs.com/png.latex?t_2%20-%20t_1">.</p>
<p>Finally, consider any finite set of times <img src="https://latex.codecogs.com/png.latex?0=t_0%20%3C%20t_1%20%3C%20t_2%20%3C%20%5Cldots%20%3C%20t_n%20=%20T">. Then, <img src="https://latex.codecogs.com/png.latex?t%20%3C%20t%20+%20t_1%20%3C%20t%20+%20t_2%20%3C%20%5Cldots%20%3C%20t%20+%20t_n">. We have that, <img src="https://latex.codecogs.com/png.latex?B(t%20+%20t_1)%20-%20B(t)">, <img src="https://latex.codecogs.com/png.latex?B(t%20+%20t_2)%20-%20B(t%20+%20t_1)">, <img src="https://latex.codecogs.com/png.latex?B(t%20+%20t_3)%20-%20B(t%20+%20t_2)">, <img src="https://latex.codecogs.com/png.latex?%5Cldots">, <img src="https://latex.codecogs.com/png.latex?B(t+T)%20-%20B(t+t_%7Bn-1%7D)"> are independent random variables. Consequently, <img src="https://latex.codecogs.com/png.latex?W(t_1)%20-%20W(0)">, <img src="https://latex.codecogs.com/png.latex?W(t_2)%20-%20W(t_1)">, <img src="https://latex.codecogs.com/png.latex?W(t_3)%20-%20W(t_2)">, <img src="https://latex.codecogs.com/png.latex?%5Cldots">, <img src="https://latex.codecogs.com/png.latex?W(t_n)%20-%20W(t_%7Bn-1%7D)"> are independent random variables. So, <img src="https://latex.codecogs.com/png.latex?(W_s,s%5Cgeq%200)"> is a standard brownian motion.</p>
<p>Also, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5BW(s)%7C%5Cmathcal%7BF%7D_t%5D%20&amp;=%20%5Cmathbb%7BE%7D%5BB(t%20+%20s)%20-%20B(t)%7C%5Cmathcal%7BF%7D_t%5D%5C%5C%0A&amp;%20%5C%7B%20B(t+s)%20-%20B(t)%20%5Cperp%20%5Cmathcal%7BF%7D_t%20%5C%7D%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5BB(t%20+%20s)%20-%20B(t)%5D%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5BW(s)%5D%0A%5Cend%7Balign*%7D"></p>
<p>Thus, <img src="https://latex.codecogs.com/png.latex?W(s)"> is independent of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t">, it does not depend upon the information available upto time <img src="https://latex.codecogs.com/png.latex?t">.</p>


<!-- -->

</section>

 ]]></description>
  <category>Stochastic Calculus</category>
  <guid>https://quantdev.blog/posts/the_markov_property/</guid>
  <pubDate>Thu, 11 Jul 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/the_markov_property/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Ito Processes and Stochastic Differential Equations</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/ito-processes-and-stochastic-diff-eqs/</link>
  <description><![CDATA[ 





<section id="ito-processes-and-stochastic-differential-equations." class="level1">
<h1>Ito Processes and Stochastic Differential Equations.</h1>
<p>Let’s start with the definition of Ito processes.</p>
<div id="def-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Ito Process)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B(t):t%5Cgeq0)"> be a standard brownian motion defined on <img src="https://latex.codecogs.com/png.latex?(%5COmega,%5Cmathcal%7BF%7D,%5Cmathbb%7BP%7D)">. An Ito process <img src="https://latex.codecogs.com/png.latex?(X(t):t%5Cgeq0)"> is of the form:</p>
<p><span id="eq-ito-process"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AX(t)%20&amp;%20=X(0)+%5Cint_%7B0%7D%5E%7Bt%7DV(s)dB(s)+%5Cint_%7B0%7D%5E%7Bt%7DD(s)ds%0A%5Cend%7Baligned%7D%20%5Ctag%7B1%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?(V(t),t%5Cgeq0)"> and <img src="https://latex.codecogs.com/png.latex?(D(t),t%5Cgeq0)"> are two adapted processes for which the integrals make sense in the sense of Ito and Riemann. We refer to <img src="https://latex.codecogs.com/png.latex?(V(t):t%5Cgeq0)"> as the <em>local volatility</em> and to <img src="https://latex.codecogs.com/png.latex?(D(t):t%5Cgeq0)"> as the <em>local drift</em>.</p>
</div>
<p>We will often denote an Ito process <img src="https://latex.codecogs.com/png.latex?(X(t):t%5Cgeq0)"> in differential form as:</p>
<p><span id="eq-ito-process-differential-form"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AdX(t)%20&amp;%20=D(t)dt+V(t)dB(t)%0A%5Cend%7Baligned%7D%20%5Ctag%7B2%7D"></span></p>
<p>This form makes no rigorous sense; when we write it, we mean Equation&nbsp;1. Nevertheless, the differential equation has two great advantages:</p>
<p>(1) It gives some intuition on what drives the variation of <img src="https://latex.codecogs.com/png.latex?X(t)">. On one hand, there is a contribution of the Brownian increments which are modulated by the volatility <img src="https://latex.codecogs.com/png.latex?V(t)">. On the other hand, there is a smoother contribution coming from the time variation which is modulated by the drift <img src="https://latex.codecogs.com/png.latex?D(t)">.</p>
<p>(2) The differential notation has computational power. In particular, evaluating Ito’s formula is reduced to computing differentials, as in classical calculus, but by doing it upto the second order.</p>
<p>An important class of Ito processes is given by processes for which the volatility and the drift are simply functions of the position of the process.</p>
<div id="def-time-homogenous-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B(t):t%5Cgeq0)"> be a standard Brownian motion. An Ito process <img src="https://latex.codecogs.com/png.latex?(X(t):t%5Cgeq0)"> of the form</p>
<p><span id="eq-time-homogenous-ito-process"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AdX(t)%20&amp;%20=%5Cmu(X(t))dt+%5Csigma(X(t))dB(t),%5Cquad%20X(0)=x%0A%5Cend%7Baligned%7D%20%5Ctag%7B3%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cmu"> and <img src="https://latex.codecogs.com/png.latex?%5Csigma"> are functions from <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D"> to <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D">, is called a time-homogenous diffusion.</p>
</div>
<div id="def-time-inhomogenous-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3</strong></span> An Ito-process <img src="https://latex.codecogs.com/png.latex?(Y(t),t%5Cgeq0)"> of the form:</p>
<p><span id="eq-time-inhomogenous-SDE"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%7B1%7D%0AdY(t)%20&amp;%20=%5Cmu(t,X(t))dt+%5Csigma(t,X(t))dB(t)%5Cquad%20Y(0)=y%0A%5Cend%7Baligned%7D%20%5Ctag%7B4%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cmu"> and <img src="https://latex.codecogs.com/png.latex?%5Csigma"> are now functions <img src="https://latex.codecogs.com/png.latex?%5B0,%5Cinfty)%5Ctimes%5Cmathbf%7BR%7D%5Cto%5Cmathbf%7BR%7D"> is called a time-inhomogenous diffusion.</p>
</div>
<p>The equations above are called <em>stochastic differential equations</em> (SDE) of the respective process <img src="https://latex.codecogs.com/png.latex?(X(t))"> and <img src="https://latex.codecogs.com/png.latex?(Y(t))">.</p>
<p>In other words, a diffusion <img src="https://latex.codecogs.com/png.latex?(X(t),t%5Cgeq%200)"> is an Ito process whose local volatility <img src="https://latex.codecogs.com/png.latex?V(t)"> and local drift <img src="https://latex.codecogs.com/png.latex?D(t)"> at time <img src="https://latex.codecogs.com/png.latex?t"> depend only on the position of the process at time <img src="https://latex.codecogs.com/png.latex?t"> and possibly on the time <img src="https://latex.codecogs.com/png.latex?t"> itself. It cannot depend on the path of the process before time <img src="https://latex.codecogs.com/png.latex?t"> or on the explicit values of the driving Brownian motion at that time (which is not the process <img src="https://latex.codecogs.com/png.latex?X(t)"> itself). The class of diffusions, and of the Ito processes in general, constitutes a huge collection of stochastic processes for stochastic modelling.</p>
<p>Note that an SDE is a generalization of ordinary differential equations or ODEs. Indeed, if there were no randomness, that is, no Brownian motion, the SDE would be reduced to</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AdX(t)%20&amp;%20=%5Cmu(X(t))dt%0A%5Cend%7Baligned%7D"></p>
<p>This can be written for <img src="https://latex.codecogs.com/png.latex?X(t)=f(t)"> as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cfrac%7Bdf%7D%7Bdt%7D%20&amp;%20=%5Cmu(f)%0A%5Cend%7Baligned%7D"></p>
<p>This is a first-order ordinary differential equation. It governs the deterministic evolution of the function <img src="https://latex.codecogs.com/png.latex?X(t)=f(t)"> in time. An SDE adds a random term to this evolution that is formally written as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cfrac%7BdX%7D%7Bdt%7D%20&amp;%20=%5Cmu(X(t))+%5Csigma(X(t))%5Cfrac%7BdB(t)%7D%7Bdt%7D%0A%5Cend%7Baligned%7D"></p>
<p>We know very well, that Brownian motion is not differentiable; hence the above is not well-defined. The ill-defined term <img src="https://latex.codecogs.com/png.latex?dB(t)/dt"> is sometimes called white noise. However, equation Equation&nbsp;3 is well-defined in the sense of the Ito process. These types of equations are well-suited to model phenomena with intrinsic randomness.</p>
<p>Here are some examples of diffusions:</p>
<div id="exm-brownian-motion-with-a-drift" class="theorem example">
<p><span class="theorem-title"><strong>Example 1</strong></span> (Brownian Motion with a drift). If we take <img src="https://latex.codecogs.com/png.latex?X(t)=%5Csigma%20B(t)+%5Cmu%20t"> for some <img src="https://latex.codecogs.com/png.latex?%5Csigma%3E0"> and <img src="https://latex.codecogs.com/png.latex?%5Cmu%5Cin%5Cmathbf%7BR%7D">, then we can write <img src="https://latex.codecogs.com/png.latex?X(t)"> as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AX(t)%20&amp;%20=%5Cint_%7B0%7D%5E%7Bt%7D%5Csigma%20dB(t)+%5Cint_%7B0%7D%5E%7Bt%7D%5Cmu%20dt,%5Cquad%20X(0)=0%0A%5Cend%7Baligned%7D"></p>
<p>In the differential form this becomes</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AdX(t)%20&amp;%20=%5Cmu%20dt+%5Csigma%20dB(t)%0A%5Cend%7Baligned%7D"></p>
<p>In this case, the local drift and the local volatility are constant.</p>
</div>
<div id="exm-geometric-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 2</strong></span> (Geometric Brownian Motion). We consider the process <img src="https://latex.codecogs.com/png.latex?S(t)=%5Cexp((%5Cmu-%5Csigma%5E%7B2%7D/2)t+%5Csigma%20B(t))">. To find the stochastic differential equation, we apply the Ito’s Lemma to</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Af(t,x)%20&amp;%20=%5Cexp((%5Cmu-%5Csigma%5E%7B2%7D/2)t+%5Csigma%20x)%0A%5Cend%7Baligned%7D"></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(t,x)%20&amp;%20=%5Cleft((%5Cmu-%5Csigma%5E%7B2%7D/2)+%5Cfrac%7B1%7D%7B2%7D%5Csigma%5E%7B2%7D%5Cright)%5Cexp((%5Cmu-%5Csigma%5E%7B2%7D/2)t+%5Csigma%20x)dt+%5Csigma%5Cexp((%5Cmu-%5Csigma%5E%7B2%7D/2)t+%5Csigma%20x)dB(t)%5C%5C%0A&amp;%20=%5Cmu%20S(t)dt+%5Csigma%20S(t)dB(t)%0A%5Cend%7Baligned%7D"></p>
<p>Note that the local drift and the local volatility are now proportional to the position. So, the higher <img src="https://latex.codecogs.com/png.latex?S(t)">, the higher the volatility and drift.</p>
</div>
<div id="exm-smooth-function-of-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 3</strong></span> (Any smooth function of Brownian motion). Ito’s formula gurarantees that any smooth function <img src="https://latex.codecogs.com/png.latex?f(t,B(t))"> of time and a Brownian motion is an Ito process with volatility <img src="https://latex.codecogs.com/png.latex?V(t)=%5Cpartial_%7Bt%7Df(t,B(t))"> and drift <img src="https://latex.codecogs.com/png.latex?D(t)=%5Cpartial_%7Bx%7Df(t,B(t))+%5Cfrac%7B1%7D%7B2%7D%5Cpartial_%7Bxx%7Df(t,B(t))">. We will see in further ahead, that, in general, any reasonable function of an Ito process remains an Ito process.</p>
</div>
<div id="exm-ito-process-that-is-not-a-diffusion" class="theorem example">
<p><span class="theorem-title"><strong>Example 4</strong></span> (An Ito process that is not a diffusion) Consider the process</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AX(t)%20&amp;%20=%5Cint_%7B0%7D%5E%7Bt%7DB%5E%7B2%7D(s)dB(s)%0A%5Cend%7Baligned%7D"></p>
<p>This is an Ito process with local volatility <img src="https://latex.codecogs.com/png.latex?V(t)=B(t)%5E%7B2%7D"> and local drift <img src="https://latex.codecogs.com/png.latex?D(t)=0">. However, it is not a diffusion, because the local volatility is not an explicit function of <img src="https://latex.codecogs.com/png.latex?X(t)">.</p>
<p>It turns out that the Brownian bridge is a time-inhomogenous diffusion and that the Ornstein-Uhlenbeck process is a time-homogenous diffusion. To understand these examples, we need to extend Ito’s formula to Ito processes.</p>
</div>
<section id="itos-formula." class="level2">
<h2 class="anchored" data-anchor-id="itos-formula.">Ito’s Formula.</h2>
<p>The first step towards a general Ito’s formula is the quadratic variation of an Ito process.</p>
<div id="prp-quadratic-variation-of-an-ito-process" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1 (Quadratic variation of an Ito process.)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B(t),t%5Cgeq0)"> be a standard Brownian motion and <img src="https://latex.codecogs.com/png.latex?(X(t):t%5Cgeq0)"> be an Ito process of the form <img src="https://latex.codecogs.com/png.latex?dX(t)=V(t)dB(t)+D(t)dt">. Then, the quadratic variation of the process <img src="https://latex.codecogs.com/png.latex?(X(t):t%5Cgeq0)"> is:*</p>
<p><span id="eq-quadratic-variation-ito-process"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%3CX,X%3E_%7Bt%7D%20&amp;%20=%5Clim_%7Bn%5Cto%5Cinfty%7D%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(X(t_%7Bj+1%7D)-X(t_%7Bj%7D))%5E%7B2%7D=%5Cint_%7B0%7D%5E%7Bt%7DV(s)%5E%7B2%7Dds%0A%5Cend%7Baligned%7D%20%5Ctag%7B5%7D"></span></p>
<p><em>for any partition <img src="https://latex.codecogs.com/png.latex?(t_%7Bj%7D,j%5Cleq%20n)"> of <img src="https://latex.codecogs.com/png.latex?%5B0,t%5D">, where the limit is in probability.</em></p>
</div>
<div id="rem-remark1" class="proof remark">
<p><span class="proof-title"><em>Remark 1</em>. </span>Note that the quadratic variation is increasing in <img src="https://latex.codecogs.com/png.latex?t">, but it is not deterministic in general! <img src="https://latex.codecogs.com/png.latex?V_t"> is a random variable. The quadratic variation is a smooth stochastic process. (It is differentiable) Observe that we recover the quadratic variation for the Brownian motion for <img src="https://latex.codecogs.com/png.latex?V(t)=1"> as expected. We also notice that the formula follows easily from the rules of Ito Calculus, thereby showing the consistency of the theory. Indeed we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Ad%3CX,X%3E_%7Bt%7D%20&amp;%20=(dX(t))%5E%7B2%7D=(V(t)dB(t)+D(t)dt)%5E%7B2%7D%5C%5C%0A&amp;%20=V(t)%5E%7B2%7D(dB(t))%5E%7B2%7D+2V(t)D(t)dB(t)%5Ccdot%20dt+D%5E%7B2%7D(t)(dt)%5E%7B2%7D%5C%5C%0A&amp;%20=V(t)%5E%7B2%7Ddt%0A%5Cend%7Baligned%7D"></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><em>Proof.</em> The proof is involved, but it reviews some important concepts of stochastic calculus. We prove the case when the process <img src="https://latex.codecogs.com/png.latex?V"> is in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D_%7Bc%7D%5E%7B2%7D(T)"> for some <img src="https://latex.codecogs.com/png.latex?T%3E0">. We write <img src="https://latex.codecogs.com/png.latex?I(t)=%5Cint_%7B0%7D%5E%7Bt%7DV(s)dB(s)"> and <img src="https://latex.codecogs.com/png.latex?R(t)=%5Cint_%7B0%7D%5E%7Bt%7DD(s)ds">. We first show that only the Ito integral contributes to the quadratic variation and the Riemann integral does not contribute, so that:</p>
<p><span id="eq-quadratic-variation-ito-process-ii"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%3CX,X%3E_%7Bt%7D%20&amp;%20=%3CI,I%3E_%7Bt%7D%0A%5Cend%7Baligned%7D%20%5Ctag%7B6%7D"></span></p>
<p>We have that the increment square of <img src="https://latex.codecogs.com/png.latex?X(t)"> is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A(X(t_%7Bj+1%7D)-X(t_%7Bj%7D))%5E%7B2%7D%20&amp;%20=(I(t_%7Bj+1%7D)-I(t_%7Bj%7D))%5E%7B2%7D+2(I(t_%7Bj+1%7D)-I(t_%7Bj%7D))(R(t_%7Bj+1%7D)-R(t_%7Bj%7D))+(R(t_%7Bj+1%7D)-R(t_%7Bj%7D))%5E%7B2%7D%0A%5Cend%7Baligned%7D"></p>
<p>The Cauchy-Schwarz inequality implies :</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(I(t_%7Bj+1%7D)-I(t_%7Bj%7D))(R(t_%7Bj+1%7D)-R(t_%7Bj%7D))%20&amp;%20%5Cleq%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(I(t_%7Bj+1%7D)-I(t_%7Bj%7D))%5E%7B2%7D%5Cright)%5E%7B1/2%7D%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(R(t_%7Bj+1%7D)-R(t_%7Bj%7D))%5E%7B2%7D%5Cright)%5E%7B1/2%7D%0A%5Cend%7Baligned%7D"></p>
<p>Therefore, to prove equation Equation&nbsp;5, it suffices to show that <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(R(t_%7Bj+1%7D)-R(t_%7Bj%7D))%5E%7B2%7D%5Cto%200"> almost surely. Since <img src="https://latex.codecogs.com/png.latex?D(s)"> is an almost surely continuous process, the stochastic process <img src="https://latex.codecogs.com/png.latex?R(t)=%5Cint_%7B0%7D%5E%7Bt%7DD(s)ds"> has continuous paths with probability <img src="https://latex.codecogs.com/png.latex?1">. Therefore:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(R(t_%7Bj+1%7D)-R(t_%7Bj%7D))%5E%7B2%7D%20&amp;%20=%5Cmax_%7B1%5Cleq%20j%5Cleq%20n%7D%7CR(t_%7Bj+1%7D)-R(t_%7Bj%7D)%7C%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(R(t_%7Bj+1%7D)-R(t_%7Bj%7D))%0A%5Cend%7Baligned%7D"></p>
<p>Since, <img src="https://latex.codecogs.com/png.latex?R(t)"> is continuous on the compact set <img src="https://latex.codecogs.com/png.latex?%5B0,t%5D">, it is uniformly continuous a.s. So, as <img src="https://latex.codecogs.com/png.latex?%7Ct_%7Bj+1%7D-t_%7Bj%7D%7C%5Cto%200">, by uniform continuity it follows that <img src="https://latex.codecogs.com/png.latex?%5Cmax%7CR(t_%7Bj+1%7D)-R(t_%7Bj%7D)%7C%5Cto%200"> a.s.</p>
<p>It remains to prove that <img src="https://latex.codecogs.com/png.latex?%3CI,I%3E_%7Bt%7D=%5Cint_%7B0%7D%5E%7Bt%7DV(s)%5E%7B2%7Dds">. We first prove the case when <img src="https://latex.codecogs.com/png.latex?V%5Cin%5Cmathcal%7BS%7D(T)"> is a simple adapted process. Consider a partition <img src="https://latex.codecogs.com/png.latex?(t_%7Bj%7D:j%5Cleq%20n)"> of <img src="https://latex.codecogs.com/png.latex?%5B0,t%5D">. Without loss of generality, we can suppose that <img src="https://latex.codecogs.com/png.latex?V"> is constant on each <img src="https://latex.codecogs.com/png.latex?%5Bt_%7Bj%7D,t_%7Bj+1%7D)"> by refining the partition. We then have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(I(t_%7Bj+1%7D)-I(t_%7Bj%7D))%5E%7B2%7D%20&amp;%20=%5Csum_%7Bj=0%7D%5E%7Bn-1%7DV(t_%7Bj%7D)%5E%7B2%7D(B(t_%7Bj+1%7D)-B(t_%7Bj%7D))%5E%7B2%7D%0A%5Cend%7Baligned%7D"></p>
<p>Now, we have seen in the proof of Ito’s formula that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5Cleft%5B%5Cleft%5C%7B%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7DV(t_%7Bj%7D)%5E%7B2%7D((B(t_%7Bj+1%7D)-B(t_%7Bj%7D))%5E%7B2%7D-(t_%7Bj+1%7D-t_%7Bj%7D)%5Cright%5C%7D%20%5E%7B2%7D%5Cright%5D%5Cto%200">, so <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bj=0%7D%5E%7Bn-1%7DV(t_%7Bj%7D)%5E%7B2%7D(B(t_%7Bj+1%7D)-B(t_%7Bj%7D))%5E%7B2%7D"> approaches <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bj=0%7D%5E%7Bn-1%7DV(t_%7Bj%7D)%5E%7B2%7D(t_%7Bj+1%7D-t_%7Bj%7D)"> in the mean square sense. As the mesh size becomes finer, the <img src="https://latex.codecogs.com/png.latex?L%5E%7B2%7D">-limit is <img src="https://latex.codecogs.com/png.latex?%5Cint_%7B0%7D%5E%7Bt%7DV(t)%5E%7B2%7Ddt">.</p>
<p>The case <img src="https://latex.codecogs.com/png.latex?V%5Cin%5Cmathcal%7BL%7D_%7Bc%7D%5E%7B2%7D(T)"> is proved by approximating <img src="https://latex.codecogs.com/png.latex?V"> by a simple process in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BS%7D(T)">. More precisely, we can find a simple process <img src="https://latex.codecogs.com/png.latex?V%5E%7B(%5Cepsilon)%7D(t)"> that is <img src="https://latex.codecogs.com/png.latex?%5Cepsilon">-close to <img src="https://latex.codecogs.com/png.latex?V"> in the sense:</p>
<p><span id="eq-sequence-of-simple-processes"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%7C%7CI%5E%7B(%5Cepsilon)%7D-I%7C%7C%20&amp;%20=%7C%7C%5Cint%20V%5E%7B%5Cepsilon%7DdB(t)-%5Cint%20VdB(t)%7C%7C=%5Cint_%7B0%7D%5E%7Bt%7D%5Cmathbb%7BE%7D%5B(V%5E%7B(%5Cepsilon)%7D(t)-V(t))%5E%7B2%7D%5Dds%3C%5Cepsilon%0A%5Cend%7Baligned%7D%20%5Ctag%7B7%7D"></span></p>
<p>To prove the claim, we need to show that for <img src="https://latex.codecogs.com/png.latex?t%5Cleq%20T">,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathbb%7BE%7D%5Cleft%5B%5Cleft%7C%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(I(t_%7Bj+1%7D)-I(t_%7Bj%7D))%5E%7B2%7D-%5Cint_%7B0%7D%5E%7Bt%7D(V(s))%5E%7B2%7Dds%5Cright%7C%5Cright%5D%20&amp;%20%5Cto0%5Cquad%5Ctext%7Bas%20%7D%5Cquad%20n%5Cto%5Cinfty%0A%5Cend%7Baligned%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?L%5E%7B1%7D">-convergence implies convergence in probability of the sequence <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(I(t_%7Bj+1%7D)-I(t_%7Bj%7D))%5E%7B2%7D">. We now introduce the <img src="https://latex.codecogs.com/png.latex?V%5E%7B(%5Cepsilon)%7D(t)"> approximation inside the absolute value as well as its corresponding integral <img src="https://latex.codecogs.com/png.latex?I%5E%7B(%5Cepsilon)%7D(t)=%5Cint_%7B0%7D%5E%7Bt%7DV%5E%7B(%5Cepsilon)%7D(s)ds">. By the triangle inequality, we have:</p>
<p><span id="eq-quadratic-variation-of-ito-process-i"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A&amp;%20%5Cmathbb%7BE%7D%5Cleft%5B%5Cleft%7C%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(I(t_%7Bj+1%7D)-I(t_%7Bj%7D))%5E%7B2%7D-%5Cint_%7B0%7D%5E%7Bt%7D(V(s))%5E%7B2%7Dds%5Cright%7C%5Cright%5D%5Cnonumber%20%5C%5C%0A=%20&amp;%20%5Cmathbb%7BE%7D%5Cleft%5B%5CBiggl%7C%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(I(t_%7Bj+1%7D)-I(t_%7Bj%7D))%5E%7B2%7D-(I%5E%7B(%5Cepsilon)%7D(t_%7Bj+1%7D)-I%5E%7B(%5Cepsilon)%7D(t_%7Bj%7D))%5E%7B2%7D+(I%5E%7B(%5Cepsilon)%7D(t_%7Bj+1%7D)-I%5E%7B(%5Cepsilon)%7D(t_%7Bj%7D))%5E%7B2%7D-%5Cint_%7B0%7D%5E%7Bt%7D(V%5E%7B(%5Cepsilon)%7D(s))%5E%7B2%7Dds%5Cright.%5Cnonumber%20%5C%5C%0A&amp;%20+%5Cint_%7B0%7D%5E%7Bt%7D(V%5E%7B(%5Cepsilon)%7D(s))%5E%7B2%7Dds-%5Cint_%7B0%7D%5E%7Bt%7D(V(s))%5E%7B2%7Dds%5CBiggr%7C%5CBiggr%5D%5Cnonumber%20%5C%5C%0A%5Cleq%20&amp;%20%5Cmathbb%7BE%7D%5Cleft%5B%5Cleft%7C%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(I(t_%7Bj+1%7D)-I(t_%7Bj%7D))%5E%7B2%7D-(I%5E%7B(%5Cepsilon)%7D(t_%7Bj+1%7D)-I%5E%7B(%5Cepsilon)%7D(t_%7Bj%7D))%5E%7B2%7D%5Cright%7C%5Cright%5D+%5Cmathbb%7BE%7D%5Cleft%5B%5Cleft%7C%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(I%5E%7B(%5Cepsilon)%7D(t_%7Bj+1%7D)-I%5E%7B(%5Cepsilon)%7D(t_%7Bj%7D))%5E%7B2%7D-%5Cint_%7B0%7D%5E%7Bt%7D(V%5E%7B(%5Cepsilon)%7D(s))%5E%7B2%7Dds%5Cright%7C%5Cright%5D%5C%5C%0A&amp;%20+%5Cmathbb%7BE%7D%5Cleft%5B%5CBiggl%7C%5Cint_%7B0%7D%5E%7Bt%7D(V%5E%7B(%5Cepsilon)%7D(s))%5E%7B2%7Dds-%5Cint_%7B0%7D%5E%7Bt%7D(V(s))%5E%7B2%7Dds%5CBiggr%7C%5Cright%5D%5Cnonumber%0A%5Cend%7Baligned%7D%20%5Ctag%7B8%7D"></span></p>
<p>We show that the first and third terms converge uniformly and that the second term goes to <img src="https://latex.codecogs.com/png.latex?0"> as <img src="https://latex.codecogs.com/png.latex?n%5Cto%5Cinfty">.</p>
<p>The second term goes to <img src="https://latex.codecogs.com/png.latex?0"> as <img src="https://latex.codecogs.com/png.latex?n%5Cto%5Cinfty"> by the argument for simple processes.</p>
<p><img src="https://latex.codecogs.com/png.latex?%3CI%5E%7B(%5Cepsilon)%7D,I%5E%7B(%5Cepsilon)%7D%3E_%7Bt%7D=%5Cint_%7B0%7D%5E%7Bt%7DV%5E%7B(%5Cepsilon)%7D(s)%5E%7B2%7Dds">.</p>
<p>For the third term, the linearity of the integral and the Cauchy Schwarz inequality (applied to <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5Cint_%7B0%7D%5E%7Bt%7D">) imply that it is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathbb%7BE%7D%5Cleft%5B%5CBiggl%7C%5Cint_%7B0%7D%5E%7Bt%7D(V%5E%7B(%5Cepsilon)%7D(s))%5E%7B2%7Dds-%5Cint_%7B0%7D%5E%7Bt%7D(V(s))%5E%7B2%7Dds%5CBiggr%7C%5Cright%5D%20&amp;%20%5Cleq%5Cmathbb%7BE%7D%5Cleft%5B%5CBiggl%7C%5Cint_%7B0%7D%5E%7Bt%7D(V%5E%7B(%5Cepsilon)%7D(s)-V(s))%5E%7B2%7Dds%5CBiggr%7C%5Cright%5D%5E%7B1/2%7D%5Cmathbb%7BE%7D%5Cleft%5B%5CBiggl%7C%5Cint_%7B0%7D%5E%7Bt%7D(V%5E%7B(%5Cepsilon)%7D(s)+V(s))%5E%7B2%7Dds%5CBiggr%7C%5Cright%5D%5E%7B1/2%7D%0A%5Cend%7Baligned%7D"></p>
<p>The first factor is smaller than the square root of <img src="https://latex.codecogs.com/png.latex?%5Cepsilon"> by Equation&nbsp;7, whereas the second factor is bounded.</p>
<p>The first term in equation Equation&nbsp;8 is handled similarly. The linearity of the Ito integral and the Cauchy-Schwarz inequality applied to <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5Cleft%5B%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cleft(%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D%5Ccdot%5Cright)%5Cright%5D"> give that the first term is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A&amp;%20%5Cmathbb%7BE%7D%5Cleft%5B%5Cleft%7C%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D(V(s))%5E%7B2%7DdB(s)-%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D(V%5E%7B%5Cepsilon%7D(s))%5E%7B2%7DdB(s)%5Cright%7C%5Cright%5D%5C%5C%0A=%20&amp;%20%5Cmathbb%7BE%7D%5Cleft%5B%5Cleft%7C%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D(V(s)-V%5E%7B%5Cepsilon%7D(s))dB(s)%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D(V(s)+V%5E%7B%5Cepsilon%7D(s))dB(s)%5Cright%7C%5Cright%5D%5C%5C%0A%5Cleq%20&amp;%20%5Cmathbb%7BE%7D%5Cleft%5B%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cleft(%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D(V(s)-V%5E%7B%5Cepsilon%7D(s))dB(s)%5Cright)%5E%7B2%7D%5Cright%5D%5E%7B1/2%7D%5Cmathbb%7BE%7D%5Cleft%5B%5CBiggl%7C%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cleft(%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D(V(s)+V%5E%7B%5Cepsilon%7D(s))dB(s)%5Cright)%5E%7B2%7D%5CBiggr%7C%5Cright%5D%5E%7B1/2%7D%0A%5Cend%7Baligned%7D"></p>
<p>By Ito isometry, the first factor in the above expression can be simplified:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathbb%7BE%7D%5Cleft%5B%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cleft(%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D(V(s)-V%5E%7B%5Cepsilon%7D(s))dB(s)%5Cright)%5E%7B2%7D%5Cright%5D%5E%7B1/2%7D%20&amp;%20=%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cmathbb%7BE%7D%5Cleft(%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D(V(s)-V%5E%7B%5Cepsilon%7D(s))dB(s)%5Cright)%5E%7B2%7D%5C%5C%0A&amp;%20=%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D%5Cmathbb%7BE%7D%5B(V(s)-V%5E%7B%5Cepsilon%7D(s))%5E%7B2%7D%5Dds%0A%5Cend%7Baligned%7D"></p>
<p>By Equation&nbsp;7, this factor is smaller than <img src="https://latex.codecogs.com/png.latex?%5Cepsilon">. The second factor equals <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cint_%7Bt_%7Bj%7D%7D%5E%7Bt_%7Bj+1%7D%7D%5Cmathbb%7BE%7D%5B(V(s)+V%5E%7B%5Cepsilon%7D(s))%5E%7B2%7D%5Dds"> by Ito-isometry and is uniformly bounded. This concludes the proof of the proposition. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</div>
<p>Note that quadratic variation <img src="https://latex.codecogs.com/png.latex?%3CI,I%3E_%7Bt%7D=%5Cint(V(s))%5E%7B2%7Dds"> is computed path-by-path and hence the result is random. On the other the variance of the Ito integral <img src="https://latex.codecogs.com/png.latex?Var(I(t))=%5Cmathbb%7BE%7D%5BI_%7Bt%7D%5E%7B2%7D%5D=%5Cint%5Cmathbb%7BE%7D%5BV_%7Bs%7D%5E%7B2%7D%5Dds"> is the mean value of all possible paths of the quadratic variation and hence is non-random. We are now ready to state Ito’s formula for Ito processes. We write the result in differential form for conciseness.</p>
<div id="thm-ito-formula-for-ito-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Ito’s formula for Ito processes)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B(t):t%5Cgeq0)"> be a standard brownian motion, and let <img src="https://latex.codecogs.com/png.latex?(X(t):t%5Cgeq0)"> be an Ito process of the form <img src="https://latex.codecogs.com/png.latex?dX(t)=V(t)dB(t)+D(t)dt">. Consider a function <img src="https://latex.codecogs.com/png.latex?f(t,x)%5Cin%5Cmathcal%7BC%7D%5E%7B1,2%7D(%5B0,T%5D%5Ctimes%5Cmathbf%7BR%7D)">. Then we have with probability one for all <img src="https://latex.codecogs.com/png.latex?t%5Cleq%20T">:*</p>
<p><em><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(t,X(t))%20&amp;%20=%5Cpartial_%7Bx%7Df(t,X(t))dX(t)+%5Cpartial_%7Bt%7Df(t,X(t))dt+%5Cfrac%7B1%7D%7B2%7D%5Cpartial_%7Bxx%7Df(t,X(t))d%3CX,X%3E_%7Bt%7D%0A%5Cend%7Baligned%7D"></em></p>
<p><em>This can also be written as:</em></p>
<p><em><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(t,X(t))=%20&amp;%20%5Cpartial_%7Bx%7Df(t,X(t))V(t)dB(t)+%5Cleft%5B%5Cpartial_%7Bx%7Df(t,X(t))D(t)+%5Cpartial_%7Bt%7Df(t,X(t))+%5Cfrac%7B1%7D%7B2%7D(V(t))%5E%7B2%7D%5Cpartial_%7Bxx%7Df(t,X(t))%5Cright%5Ddt%0A%5Cend%7Baligned%7D"></em></p>
</div>
<p>The proof of the Theorem&nbsp;1 is again a Taylor approximation with the form of the quadratic variation of the process. We will omit it.</p>
<div id="exm-ornstein-uhlenbeck-process" class="theorem example">
<p><span class="theorem-title"><strong>Example 5</strong></span> (Ornstein-Uhlenbeck Process). Consider the Ornstein-Uhlenbeck process <img src="https://latex.codecogs.com/png.latex?(Y(t):t%5Cgeq0)">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AY(t)%20&amp;%20=Y(0)e%5E%7B-t%7D+e%5E%7B-t%7D%5Cint_%7B0%7D%5E%7Bt%7De%5E%7Bs%7DdB(s)%0A%5Cend%7Baligned%7D"></p>
<p>Note that this process is an explicit function of <img src="https://latex.codecogs.com/png.latex?t"> and of the Ito process <img src="https://latex.codecogs.com/png.latex?X(t)=Y(0)+%5Cint_%7B0%7D%5E%7Bt%7De%5E%7Bs%7DdB(s)">. Indeed, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AY(t)%20&amp;%20=e%5E%7B-t%7DX(t)%0A%5Cend%7Baligned%7D"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?f(t,x)=e%5E%7B-t%7Dx">. Then, <img src="https://latex.codecogs.com/png.latex?f_%7Bx%7D(t,x)=e%5E%7B-t%7D">, <img src="https://latex.codecogs.com/png.latex?f_%7Bxx%7D(t,x)=0"> and <img src="https://latex.codecogs.com/png.latex?f_%7Bt%7D(t,x)=-e%5E%7B-t%7Dx">. So, by Ito’s lemma,</p>
<p><span id="eq-ornstein-uhlenbeck-sde"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(t,x)%20&amp;%20=f_%7Bt%7D(t,X(t))dt+f_%7Bx%7D(t,X(t))dX(t)+%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D(t,X(t))d%3CX,X%3E_%7Bt%7D%5Cnonumber%20%5C%5C%0AdY(t)%20&amp;%20=-Y(t)dt+e%5E%7B-t%7DdX(t)%5Cnonumber%20%5C%5C%0AdY(t)%20&amp;%20=-Y(t)dt+e%5E%7B-t%7D(e%5E%7Bt%7DdB(t))%5Cnonumber%20%5C%5C%0AdY(t)%20&amp;%20=-Y(t)dt+dB(t)%0A%5Cend%7Baligned%7D%20%5Ctag%7B9%7D"></span></p>
<p>This is the SDE for the Ornstein Uhlenbeck process.</p>
<p>The SDE has a very nice interpretation: The drift is positive if <img src="https://latex.codecogs.com/png.latex?Y(t)%3C0"> and negative if <img src="https://latex.codecogs.com/png.latex?Y(t)%3E0">. Moreover, the drift is proportional to the position (exactly like a spring pulling the process back to the <img src="https://latex.codecogs.com/png.latex?x">-axis following the Hooke’s law!). This is the mechanism that ensures that the process does not venture too far from <img src="https://latex.codecogs.com/png.latex?0"> and is eventually stationary.</p>
<p>The SDE Equation&nbsp;9 is now easily generalized by adding two parameters for the volatility and the drift:</p>
<p><span id="eq-ornstein-uhlenbeck-sde-ii"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AdY(t)%20&amp;%20=-kY(t)dt+%5Csigma%20dB(t),%5Cquad%20k%5Cin%5Cmathbf%7BR%7D,%5Csigma%3E0%0A%5Cend%7Baligned%7D%20%5Ctag%7B10%7D"></span></p>
<p>It is not hard to check that the solution to the SDE is:</p>
<p><span id="eq-solution-to-the-ornstein-uhlenbeck-sde"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AY(t)%20&amp;%20=Y(0)e%5E%7B-kt%7D+e%5E%7B-kt%7D%5Cint_%7B0%7D%5E%7Bt%7De%5E%7Bks%7D%5Csigma%20dB(s)%0A%5Cend%7Baligned%7D%20%5Ctag%7B11%7D"></span></p>
</div>
<div id="exr-the-ornstein-uhlenbeck-process-with-parameters" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> The Ornstein-Uhlenbeck process with parameters. Use the Ito’s formula to show that the Equation&nbsp;11 is the solution to the Ornstein-Uhlenbeck SDE Equation&nbsp;10.</p>
</div>
<p><em>Solution.</em></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?X(t)=Y(0)+%5Cint_%7B0%7D%5E%7Bt%7De%5E%7Bks%7D%5Csigma%20dB(s)">, so <img src="https://latex.codecogs.com/png.latex?dX(t)=e%5E%7Bkt%7D%5Csigma%20dB(t)">. Then, <img src="https://latex.codecogs.com/png.latex?Y(t)=e%5E%7B-kt%7DX(t)">. Let <img src="https://latex.codecogs.com/png.latex?f(t,x)=e%5E%7B-kt%7Dx">. Then, by Ito’s formula:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(t,x)%20&amp;%20=-ke%5E%7B-kt%7DX(t)dt+e%5E%7B-kt%7DdX(t)%5C%5C%0AdY(t)%20&amp;%20=-kY(t)dt+e%5E%7B-kt%7De%5E%7Bkt%7D%5Csigma%20dB(t)%5C%5C%0AdY(t)%20&amp;%20=-kY(t)dt+%5Csigma%20dB(t)%0A%5Cend%7Baligned%7D"></p>
<p>The latest version of Ito’s formula is another useful tool for producing martingales from a function of an Ito process. We start with two examples generalizing martingales for Brownian motion.</p>
<div id="exm-generalization-of-bt2-t" class="theorem example">
<p><span class="theorem-title"><strong>Example 6</strong></span> (A generalization of <img src="https://latex.codecogs.com/png.latex?(B(t))%5E%7B2%7D-t">). Let <img src="https://latex.codecogs.com/png.latex?(V(t):t%5Cleq%20T)"> be a process in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D_%7Bc%7D%5E%7B2%7D(T)">. Consider an Ito process <img src="https://latex.codecogs.com/png.latex?(X(t):t%5Cleq%20T)"> given by <img src="https://latex.codecogs.com/png.latex?dX(t)=V(t)dB(t)">. Note that <img src="https://latex.codecogs.com/png.latex?((X(t))%5E%7B2%7D:t%5Cleq%20T)"> is a submartingale by Jensen’s inequality, since <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BX%5E%7B2%7D(t)%7C%5Cmathcal%7BF%7D_%7Bs%7D%5D%5Cgeq(%5Cmathbb%7BE%7D%5BX(t)%7C%5Cmathcal%7BF%7D_%7Bs%7D)%5E%7B2%7D=X%5E%7B2%7D(s)">. We show that the compensated process</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AM(t)%20&amp;%20=X%5E%7B2%7D(t)-%5Cint_%7B0%7D%5E%7Bt%7DV%5E%7B2%7D(s)ds,%5Cquad%20t%5Cleq%20T%0A%5Cend%7Baligned%7D"></p>
<p>is a martingale for the Brownian filtration. (This is another instance of the Doob-Meyer decomposition). By the Ito’s formula for <img src="https://latex.codecogs.com/png.latex?f(x)=x%5E%7B2%7D">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(x)%20&amp;%20=f_%7Bx%7D(X(t)dX(t)+%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D(X(t))d%3CX,X%3E_%7Bt%7D%5C%5C%0A&amp;%20=2X(t)dX(t)+(V(t))%5E%7B2%7Ddt%5C%5C%0Adf(X(t))%20&amp;%20=2X(t)V(t)dB(t)+(V(t))%5E%7B2%7Ddt%0A%5Cend%7Baligned%7D"></p>
<p>In Integral form this implies:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A(X(t))%5E%7B2%7D%20&amp;%20=(X(0))%5E%7B2%7D+2%5Cint_%7B0%7D%5E%7Bt%7DX(s)V(s)dB(s)+%5Cint_%7B0%7D%5E%7Bt%7D(V(s))%5E%7B2%7Dds%5C%5C%0AM(t)=(X(t))%5E%7B2%7D-%5Cint_%7B0%7D%5E%7Bt%7D(V(s))%5E%7B2%7Dds%20&amp;%20=(X(0))%5E%7B2%7D+2%5Cint_%7B0%7D%5E%7Bt%7DX(s)V(s)dB(s)%0A%5Cend%7Baligned%7D"></p>
<p>We conclude that <img src="https://latex.codecogs.com/png.latex?(M(t):t%5Cleq%20T)"> is a martingale, provided <img src="https://latex.codecogs.com/png.latex?X(t)V(t)%5Cin%20L_%7Bc%7D%5E%7B2%7D(T)">.</p>
<p>There is another more direct way to prove that <img src="https://latex.codecogs.com/png.latex?(M(t):t%5Cleq%20T)"> is a martingale whenever <img src="https://latex.codecogs.com/png.latex?(V(t):t%5Cleq%20T)%5Cin%5Cmathcal%7BL%7D_%7Bc%7D%5E%7B2%7D(T)">. This is by using increments: for <img src="https://latex.codecogs.com/png.latex?t'%3Ct%5Cleq%20T">,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathbb%7BE%7D%5BX_%7Bt'%7D%5E%7B2%7D%7C%5Cmathcal%7BF%7D_%7Bt%7D%5D%20&amp;%20=%5Cmathbb%7BE%7D%5B(X_%7Bt%7D+(X_%7Bt'%7D-X_%7Bt%7D))%5E%7B2%7D%7C%5Cmathcal%7BF%7D_%7Bt%7D%5D%5C%5C%0A&amp;%20=%5Cmathbb%7BE%7D%5BX_%7Bt%7D%5E%7B2%7D+2X_%7Bt%7D(X_%7Bt'%7D-X_%7Bt%7D)+(X_%7Bt'%7D-X_%7Bt%7D)%5E%7B2%7D%7C%5Cmathcal%7BF%7D_%7Bt%7D%5D%5C%5C%0A&amp;%20=X_%7Bt%7D%5E%7B2%7D+2X_%7Bt%7D%5Cmathbb%7BE%7D%5BX_%7Bt'%7D-X_%7Bt%7D%7C%5Cmathcal%7BF%7D_%7Bt%7D%5D+%5Cmathbb%7BE%7D%5B(X_%7Bt'%7D-X_%7Bt%7D)%5E%7B2%7D%7C%5Cmathcal%7BF%7D_%7Bt%7D%5D%0A%5Cend%7Baligned%7D"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?(X_%7Bt%7D:t%5Cgeq0)"> is a martingale, <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B(X_%7Bt'%7D-X_%7Bt%7D)%7CM_%7Bt%7D%5D=0">, so the middle term equals zero and we are left with:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathbb%7BE%7D%5BX_%7Bt'%7D%5E%7B2%7D%7C%5Cmathcal%7BF%7D_%7Bt%7D%5D%20&amp;%20=X_%7Bt%7D%5E%7B2%7D+%5Cmathbb%7BE%7D%5B(X_%7Bt'%7D-X_%7Bt%7D)%5E%7B2%7D%7C%5Cmathcal%7BF%7D_%7Bt%7D%5D%0A%5Cend%7Baligned%7D"></p>
<p>By conditional Ito Isometry,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathbb%7BE%7D%5B(X_%7Bt'%7D-X_%7Bt%7D)%5E%7B2%7D%7C%5Cmathcal%7BF%7D_%7Bt%7D%5D%20&amp;%20=%5Cint_%7B0%7D%5E%7Bt'%7DV_%7Bs%7D%5E%7B2%7Dds-%5Cint_%7B0%7D%5E%7Bt%7DV_%7Bs%7D%5E%7B2%7Dds=%5Cint_%7Bt%7D%5E%7Bt'%7DV_%7Bs%7D%5E%7B2%7Dds%0A%5Cend%7Baligned%7D"></p>
</div>
<div id="exm-generalization-of-gbm" class="theorem example">
<p><span class="theorem-title"><strong>Example 7</strong></span> (A generalization of the geometric Brownian motion). Let <img src="https://latex.codecogs.com/png.latex?%5Csigma(t)"> be a continuous, deterministic function such that <img src="https://latex.codecogs.com/png.latex?%7C%5Csigma(t)%7C%5Cleq1">, <img src="https://latex.codecogs.com/png.latex?t%5Cin%5B0,T%5D">. The process</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AM(t)%20&amp;%20=%5Cexp%5Cleft(%5Cint_%7B0%7D%5E%7Bt%7D%5Csigma(s)dB(s)-%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7D%5Csigma%5E%7B2%7D(s)ds%5Cright),%5Cquad%20t%5Cleq%20T%0A%5Cend%7Baligned%7D"></p>
<p>is a martingale for the Brownian filtration. To see this, note that we can write <img src="https://latex.codecogs.com/png.latex?M(t)=f(t,X(t))"> where <img src="https://latex.codecogs.com/png.latex?f(t,x)=%5Cexp(x-%5Cfrac%7B1%7D%7B2%7D%5Cint%5Csigma%5E%7B2%7D(s)ds)"> and <img src="https://latex.codecogs.com/png.latex?X(t)=%5Cint_%7B0%7D%5E%7Bt%7D%5Csigma(s)dB(s)">, so <img src="https://latex.codecogs.com/png.latex?dX(t)=%5Csigma(t)dB(t)">. Ito’s formula gives:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(t,x)%20&amp;%20=f_%7Bt%7D(t,X(t)dt+f_%7Bx%7D(t,X(t))dX(t)+%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D(t,X(t))d%3CX,X%3E_%7Bt%7D%5C%5C%0AdM(t)%20&amp;%20=-%5Cfrac%7B1%7D%7B2%7D%5Csigma%5E%7B2%7D(t)M(t)dt+M(t)%5Csigma(t)dB(t)+%5Cfrac%7B1%7D%7B2%7DM(t)%5Csigma%5E%7B2%7D(t)dt%5C%5C%0A&amp;%20=M(t)%5Csigma(t)dB(t)%5C%5C%0AM(t)%20&amp;%20=M(0)+%5Cint_%7B0%7D%5E%7Bt%7DM(s)%5Csigma(s)dB(s)%0A%5Cend%7Baligned%7D"></p>
<p>Observe also that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathbb%7BE%7D%5BM_%7Bt%7D%5E%7B2%7D%5D%20&amp;%20=e%5E%7B-%5Cint_%7B0%7D%5E%7Bt%7D%5Csigma%5E%7B2%7D(s)ds%7D%5Cmathbb%7BE%7D%5Be%5E%7B2%5Cint_%7B0%7D%5E%7Bt%7D%5Csigma(s)dB(s)%7D%5D=e%5E%7B%5Cint_%7B0%7D%5E%7Bt%7D%5Csigma%5E%7B2%7D(s)ds%7D%0A%5Cend%7Baligned%7D"></p>
<p>since <img src="https://latex.codecogs.com/png.latex?%5Cint_%7B0%7D%5E%7Bt%7D%5Csigma(s)dB(s)"> is a Gaussian random variable with mean <img src="https://latex.codecogs.com/png.latex?0"> and variance <img src="https://latex.codecogs.com/png.latex?%5Cint_%7B0%7D%5E%7Bt%7D%5Csigma%5E%7B2%7D(s)ds">.</p>
<p>We conclude from the equation that <img src="https://latex.codecogs.com/png.latex?(M(t),t%5Cgeq0)"> is a martingale.</p>
</div>
<div id="exm-martingales-of-gbm" class="theorem example">
<p><span class="theorem-title"><strong>Example 8</strong></span> (Martingales of Geometric Brownian Motion). Let</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AS(t)%20&amp;%20=S(0)%5Cexp(%5Csigma%20B(t)-%5Csigma%5E%7B2%7Dt/2)%0A%5Cend%7Baligned%7D"></p>
<p>be a geometric brownian motion. We find a PDE satisfied by <img src="https://latex.codecogs.com/png.latex?f(t,x)"> for <img src="https://latex.codecogs.com/png.latex?f(t,S(t))"> to be a martingale. It suffices to apply Ito’s formula of Theorem&nbsp;1. We get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(t,S(t))%20&amp;%20=f_%7Bt%7D(t,S(t))dt+f_%7Bx%7D(t,S(t))dS(t)+%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D(t,S(t))dS(t)%5Ccdot%20dS(t)%0A%5Cend%7Baligned%7D"></p>
<p>Now note from the earlier result that <img src="https://latex.codecogs.com/png.latex?dS(t)=S(t)%5Csigma%20dB(t)">. So, <img src="https://latex.codecogs.com/png.latex?dS(t)%5Ccdot%20dS(t)=%5Cfrac%7B1%7D%7B2%7D%5Csigma%5E%7B2%7D(S(t))%5E%7B2%7Ddt">. So,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(t,S(t))%20&amp;%20=%5Cleft%5C%7B%20%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B1%7D%7B2%7D%5Csigma%5E%7B2%7D(S(t))%5E%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D%5Cright%5C%7D%20dt+%5Csigma%20S(t)%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB(t)%0A%5Cend%7Baligned%7D"></p>
<p>Finally, the PDE for <img src="https://latex.codecogs.com/png.latex?f(t,x)"> is obtained by setting the factor in front of <img src="https://latex.codecogs.com/png.latex?dt"> to <img src="https://latex.codecogs.com/png.latex?0">, because we want <img src="https://latex.codecogs.com/png.latex?f"> to be a martingale process. It is important to keep in mind, that the PDE should always be written in terms of the time variable <img src="https://latex.codecogs.com/png.latex?t"> and the space variable <img src="https://latex.codecogs.com/png.latex?x">. Therefore, the PDE of <img src="https://latex.codecogs.com/png.latex?f"> as a function of time and space is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cfrac%7B1%7D%7B2%7D%5Csigma%5E%7B2%7Dx%5E%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D(t,x)+%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D(t,x)%20&amp;%20=0%0A%5Cend%7Baligned%7D"></p>
<p>No more randomness appears in the PDE!</p>
</div>
<p>Here is a specific case where we can apply the Ito’s formula to construct martingales of Ito processes.</p>
<div id="exm-martingale-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 9</strong></span> Consider the process given by the SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AdX(t)%20&amp;%20=X(t)dB(t),%5Cquad%20X(0)=2%0A%5Cend%7Baligned%7D"></p>
<p>Let’s find a PDE for which <img src="https://latex.codecogs.com/png.latex?f(t,X(t))"> is a martingale for the Brownian filtration. We have by Ito’s formula that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(t,X(t))%20&amp;%20=f_%7Bt%7D(t,X(t))dt+f_%7Bx%7D(t,X(t))dX(t)+%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D(t,X(t))d%3CX,X%3E_%7Bt%7D%5C%5C%0A&amp;%20=%5Cleft(%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B1%7D%7B2%7D(X(t))%5E%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D%5Cright)dt+X(t)%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB(t)%0A%5Cend%7Baligned%7D"></p>
<p>Setting the drift term to <img src="https://latex.codecogs.com/png.latex?0"> gives the PDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B1%7D%7B2%7Dx%5E%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D%20&amp;%20=0%0A%5Cend%7Baligned%7D"></p>
<p>It is then easy to check that <img src="https://latex.codecogs.com/png.latex?X(t)"> is a martingale and so is <img src="https://latex.codecogs.com/png.latex?t+%5Clog(X(t))%5E%7B2%7D">, since the functions <img src="https://latex.codecogs.com/png.latex?f(t,x)=x"> and <img src="https://latex.codecogs.com/png.latex?f(t,x)=t+%5Clog%20x%5E%7B2%7D"> satisfy the PDE. However, the process <img src="https://latex.codecogs.com/png.latex?tX(t)"> is not, as the function <img src="https://latex.codecogs.com/png.latex?f(t,x)=xt"> is not a solution of the PDE.</p>
</div>
</section>
<section id="multivariate-extension." class="level2">
<h2 class="anchored" data-anchor-id="multivariate-extension.">Multivariate Extension.</h2>
<p>Ito’s formula can be generalized to several Ito processes. Let’s start by stating an example of a function of two Ito processes. Such a function <img src="https://latex.codecogs.com/png.latex?f(x_%7B1%7D,x_%7B2%7D)"> will be a function of two space variables. Not surprisingly, it needs to have two derivatives in each variable and they need to be a continuous function; we need <img src="https://latex.codecogs.com/png.latex?f%5Cin%5Cmathcal%7BC%7D%5E%7B2%5Ctimes2%7D(%5Cmathbf%7BR%7D%5Ctimes%5Cmathbf%7BR%7D)">.</p>
<div id="thm-ito-formula-for-many-ito-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Ito’s formula for many Ito processes)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(X(t):t%5Cgeq0)"> and (Y(t):t)$ be two Ito processes of the form:</p>
<p><span id="eq-two-ito-processes"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AdX(t)%20&amp;%20=V(t)dB(t)+D(t)dt%5Cnonumber%20%5C%5C%0AdY(t)%20&amp;%20=U(t)dB(t)+R(t)dt%0A%5Cend%7Baligned%7D%20%5Ctag%7B12%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?(B(t):t%5Cgeq0)"> is a standard Brownian motion. Then, for <img src="https://latex.codecogs.com/png.latex?f%5Cin%5Cmathcal%7BC%7D%5E%7B2%5Ctimes2%7D(%5Cmathbf%7BR%7D%5Ctimes%5Cmathbf%7BR%7D)">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(X(t),Y(t))%20&amp;%20=f_%7Bx%7D(X(t),Y(t))dX(t)+f_%7By%7D(X(t),Y(t))dY(t)+%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D(X(t),Y(t))d%3CX,X%3E_%7Bt%7D%5C%5C%0A&amp;%20+f_%7Bxy%7D(X(t),Y(t))d%3CX,Y%3E_%7Bt%7D+%5Cfrac%7B1%7D%7B2%7Df_%7Byy%7D(X(t),Y(t))d%3CY,Y%3E_%7Bt%7D%0A%5Cend%7Baligned%7D"></p>
</div>
<p>The idea of the proof is the same as in Theorem&nbsp;1 : Taylor’s expansion and quadratic variation, together with the cross-variation of two processes.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AdX(t)%5Ccdot%20dY(t)%20&amp;%20=(V(t)dB(t)+D(t)dt)(U(t)dB(t)+R(t)dt)%5C%5C%0A&amp;%20=U(t)V(t)dt%0A%5Cend%7Baligned%7D"></p>
<div id="exm-product-rule" class="theorem example">
<p><span class="theorem-title"><strong>Example 10</strong></span> (Product Rule) An important example of this formula is Ito’s product rule. Let <img src="https://latex.codecogs.com/png.latex?X(t)"> and <img src="https://latex.codecogs.com/png.latex?Y(t)"> be as in Equation&nbsp;12. Then:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Ad(X(t)Y(t))%20&amp;%20=Y(t)dX(t)+X(t)dY(t)+dX(t)%5Ccdot%20dY(t)%0A%5Cend%7Baligned%7D"></p>
</div>
<div id="exr-a-riemann-integral" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(%5COmega,%5Cmathcal%7BF%7D,%5Cmathbb%7BP%7D)"> be a probability space and let <img src="https://latex.codecogs.com/png.latex?(B_%7Bt%7D:t%5Cgeq0)"> be a standard brownian motion. Using integration by parts, show that</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cint_%7B0%7D%5E%7Bt%7DB(s)ds%20&amp;%20=%5Cint_%7B0%7D%5E%7Bt%7D(t-s)dB(s)%0A%5Cend%7Baligned%7D"></p>
<p>and prove that <img src="https://latex.codecogs.com/png.latex?%5Cint_%7B0%7D%5E%7Bt%7DB(s)ds%5Csim%5Cmathcal%7BN%7D(0,t%5E%7B3%7D/3)">.</p>
<p>Is</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AX(t)%20&amp;%20=%5Cbegin%7Bcases%7D%0A0%20&amp;%20t=0%5C%5C%0A%5Cfrac%7B%5Csqrt%7B3%7D%7D%7Bt%7D%5Cint_%7B0%7D%5E%7Bt%7DB(s)ds%20&amp;%20t%3E0%0A%5Cend%7Bcases%7D%0A%5Cend%7Baligned%7D"></p>
<p>a standard Wiener process?</p>
<p><em>Solution.</em></p>
<p>Clearly, <img src="https://latex.codecogs.com/png.latex?B(s,%5Comega)"> is a random variable and the Riemann integral <img src="https://latex.codecogs.com/png.latex?%5Cint_0%5Et%20B(s,%5Comega)ds"> depends on the sample path <img src="https://latex.codecogs.com/png.latex?%5Comega">. So, <img src="https://latex.codecogs.com/png.latex?(%5Cint_0%5Et%20B_s%20ds,%20t%5Cleq%20T)"> is a stochastic process. Using integration by parts:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cint%20u%5Cleft(%5Cfrac%7Bdv%7D%7Bds%7D%5Cright)ds%20&amp;%20=uv-%5Cint%20v%5Cleft(%5Cfrac%7Bdu%7D%7Bds%7D%5Cright)ds%0A%5Cend%7Baligned%7D"></p>
<p>We set <img src="https://latex.codecogs.com/png.latex?u=B(s)"> and <img src="https://latex.codecogs.com/png.latex?dv/ds=1">. Then:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cint_%7B0%7D%5E%7Bt%7DB(s)ds%20&amp;%20=sB(s)%7C_%7B0%7D%5E%7Bt%7D-%5Cint_%7B0%7D%5E%7Bt%7DsdB(s)%5C%5C%0A&amp;%20=tB(t)-%5Cint_%7B0%7D%5E%7Bt%7DsdB(s)%5C%5C%0A&amp;%20=%5Cint_%7Bs=0%7D%5E%7Bs=t%7DtdB(s)-%5Cint_%7B0%7D%5E%7Bt%7DsdB(s)%5C%5C%0A&amp;%20=%5Cint_%7B0%7D%5E%7Bt%7D(t-s)dB(s)%0A%5Cend%7Baligned%7D"></p>
<p>Thus, <img src="https://latex.codecogs.com/png.latex?%5Cint_%7B0%7D%5E%7Bt%7DB(s)ds"> is a Gaussian random variable with:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathbb%7BE%7D%5Cleft%5B%5Cint_%7B0%7D%5E%7Bt%7DB(s)ds%5Cright%5D%20&amp;%20=%5Cmathbb%7BE%7D%5Cleft%5B%5Cint_%7B0%7D%5E%7Bt%7D(t-s)dB(s)%5Cright%5D%5C%5C%0A&amp;%20=0%0A%5Cend%7Baligned%7D"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathbb%7BE%7D%5Cleft%5B%5Cleft(%5Cint_%7B0%7D%5E%7Bt%7DB(s)ds%5Cright)%5E%7B2%7D%5Cright%5D%20&amp;%20=%5Cint_%7B0%7D%5E%7Bt%7D(t-s)%5E%7B2%7Dds%5C%5C%0A&amp;%20=%5Cleft.%5Cfrac%7B(t-s)%5E%7B3%7D%7D%7B-3%7D%5Cright%7C_%7B0%7D%5E%7Bt%7D%5C%5C%0A&amp;%20=%5Cfrac%7Bt%5E%7B3%7D%7D%7B3%7D%0A%5Cend%7Baligned%7D"></p>
<p>Thus, using the properties of Ito Integral, <img src="https://latex.codecogs.com/png.latex?%5Cint_%7B0%7D%5E%7Bt%7DB(s)ds=%5Cint_%7B0%7D%5E%7Bt%7D(t-s)dB(s)"> is a martingale. Now the quadratic variation <img src="https://latex.codecogs.com/png.latex?%3CM,M%3E_%7Bt%7D=0">, and this can be a bit tricky. Remember, <img src="https://latex.codecogs.com/png.latex?%5Cleft%5Clangle%20%5Cint_%7B0%7D%5E%7Bt%7Df(s,B_%7Bs%7D)dB(s),%5Cint_%7B0%7D%5E%7Bt%7Df(s,B_%7Bs%7D)dB(s)%5Cright%5Crangle%20=%5Cint_%7B0%7D%5E%7Bt%7Df%5E%7B2%7D(s,B_%7Bs%7D)ds"> if and only if <img src="https://latex.codecogs.com/png.latex?f"> is a function of the time <img src="https://latex.codecogs.com/png.latex?s"> and the position of the Brownian motion <img src="https://latex.codecogs.com/png.latex?B(s)">. Since, <img src="https://latex.codecogs.com/png.latex?f"> is a function of <img src="https://latex.codecogs.com/png.latex?t"> as well, this rule cannot be applied.</p>
<p>By first principles, we can show that, the quadratic variation is indeed <img src="https://latex.codecogs.com/png.latex?0">: <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Clim_%7Bn%5Cto%5Cinfty%7D%5Cmathbb%7BE%7D%5Cleft%5B%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cleft(I(t_%7Bj+1%7D)-I(t_%7Bj%7D)%5Cright)%5E%7B2%7D%5Cright%5D%20&amp;%20=%5Clim_%7Bn%5Cto%5Cinfty%7D%5Cmathbb%7BE%7D%5Cleft%5B%5Csum_%7Bj=0%7D%5E%7Bn-1%7DB_%7Bt_%7Bj%7D%7D%5E%7B2%7D(t_%7Bj+1%7D-t_%7Bj%7D)%5E%7B2%7D%5Cright%5D%5C%5C%0A&amp;%20=%5Clim_%7Bn%5Cto%5Cinfty%7D%5Cmax_%7B1%5Cleq%20j%5Cleq%20n%7D%7Ct_%7Bj+1%7D-t_%7Bj%7D%7C%5Ccdot%5Cmathbb%7BE%7D%5Cleft%5B%5Csum_%7Bj=0%7D%5E%7Bn-1%7DB_%7Bt_%7Bj%7D%7D%5E%7B2%7D(t_%7Bj+1%7D-t_%7Bj%7D)%5Cright%5D%0A%5Cend%7Baligned%7D"></p>
<p>Since the paths of <img src="https://latex.codecogs.com/png.latex?B_%7Bt%7D"> are continuous, so are the paths <img src="https://latex.codecogs.com/png.latex?B_%7Bt%7D%5E%7B2%7D"> on the compact interval <img src="https://latex.codecogs.com/png.latex?%5B0,t%5D">. So, <img src="https://latex.codecogs.com/png.latex?(B_%7Bs%7D%5E%7B2%7D,s%5Cin%5B0,t%5D)"> is uniformly bounded. Thus, the expectation term is bounded. As <img src="https://latex.codecogs.com/png.latex?n%5Cto%5Cinfty">, the mesh size approaches zero, and consequently the quadratic variation approaches zero.</p>
</div>
<div id="exm-something-that-is-not-a-martingale" class="theorem example">
<p><span class="theorem-title"><strong>Example 11</strong></span> Let <img src="https://latex.codecogs.com/png.latex?X_%7Bt%7D=%5Cint_%7B0%7D%5E%7Bt%7DB_%7Bs%7DdB_%7Bs%7D"> and <img src="https://latex.codecogs.com/png.latex?Y_%7Bt%7D=%5Cint_%7B0%7D%5E%7Bt%7DB_%7Bs%7D%5E%7B2%7DdB_%7Bs%7D">. Is <img src="https://latex.codecogs.com/png.latex?(X_%7Bt%7DY_%7Bt%7D,t%5Cgeq0)"> a martingale?</p>
</div>
<p><em>Solution.</em></p>
<p>By Ito’s product rule, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Ad(X_%7Bt%7DY_%7Bt%7D)%20&amp;%20=X_%7Bt%7DdY_%7Bt%7D+Y_%7Bt%7DdX_%7Bt%7D+dX_%7Bt%7D%5Ccdot%20dY_%7Bt%7D%5C%5C%0A&amp;%20=X_%7Bt%7DB_%7Bs%7D%5E%7B2%7DdB_%7Bs%7D+Y_%7Bt%7DB_%7Bs%7DdB_%7Bs%7D+(B_%7Bs%7DdB_%7Bs%7D)%5Ccdot(B_%7Bs%7D%5E%7B2%7DdB_%7Bs%7D)%5C%5C%0A&amp;%20=X_%7Bt%7DB_%7Bs%7D%5E%7B2%7DdB_%7Bs%7D+Y_%7Bt%7DB_%7Bs%7DdB_%7Bs%7D+B_%7Bs%7D%5E%7B3%7Ddt%5C%5C%0AX_%7Bt%7DY_%7Bt%7D%20&amp;%20=X_%7B0%7DY_%7B0%7D+%5Cint_%7B0%7D%5E%7Bt%7DX_%7Bt%7DB_%7Bs%7D%5E%7B2%7DdB_%7Bs%7D+%5Cint_%7B0%7D%5E%7Bt%7DY_%7Bt%7DB_%7Bs%7DdB_%7Bs%7D+%5Cint_%7B0%7D%5E%7Bt%7DB_%7Bs%7D%5E%7B3%7Ddt%0A%5Cend%7Baligned%7D"></p>
<p>The term in <img src="https://latex.codecogs.com/png.latex?dt"> is not zero, so the product cannot be a martingale.</p>
<div id="exm-generalization-of-gbm-ii" class="theorem example">
<p><span class="theorem-title"><strong>Example 12</strong></span> (A generalization of Geometric Brownian Motion). Consider <img src="https://latex.codecogs.com/png.latex?(%5Cint_%7B0%7D%5E%7Bt%7DV_%7Bs%7DdB_%7Bs%7D,t%5Cgeq0)"> an Ito process. Define the positive process:</p>
<p><span id="eq-generalization-of-gbm"><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AM_%7Bt%7D%20&amp;%20=%5Cexp%5Cleft(%5Cint_%7B0%7D%5E%7Bt%7DV_%7Bs%7DdB_%7Bs%7D-%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7DV_%7Bs%7D%5E%7B2%7Dds%5Cright),%5Cquad%20t%5Cgeq0%0A%5Cend%7Baligned%7D%20%5Ctag%7B13%7D"></span></p>
</div>
<p><em>Solution.</em></p>
<p>Ito’s formula applied to the processes <img src="https://latex.codecogs.com/png.latex?X_%7Bt%7D=%5Cint_%7B0%7D%5E%7Bt%7DV_%7Bs%7DdB_%7Bs%7D"> and <img src="https://latex.codecogs.com/png.latex?Y_%7Bt%7D=%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7DV_%7Bs%7D%5E%7B2%7Dds"> with the function <img src="https://latex.codecogs.com/png.latex?f(x,y)=e%5E%7Bx-y%7D"> yields:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(x,y)%20&amp;%20=f_%7Bx%7D(X_%7Bt%7D,Y_%7Bt%7D)dX_%7Bt%7D+f_%7By%7D(X_%7Bt%7D,Y_%7Bt%7D)dY_%7Bt%7D%5C%5C%0A&amp;%20+%5Cfrac%7B1%7D%7B2%7Df_%7Bxx%7D(X_%7Bt%7D,Y_%7Bt%7D)dX_%7Bt%7D%5Ccdot%20dX_%7Bt%7D+%5Cfrac%7B1%7D%7B2%7Df_%7Byy%7D(X_%7Bt%7D,Y_%7Bt%7D)dY_%7Bt%7D%5Ccdot%20dY_%7Bt%7D%5C%5C%0A&amp;%20+f_%7Bxy%7D(X_%7Bt%7D,Y_%7Bt%7D)dX_%7Bt%7D%5Ccdot%20dY_%7Bt%7D%0A%5Cend%7Baligned%7D"></p>
<p>Now, all first and second order derivatives are <img src="https://latex.codecogs.com/png.latex?%5Cpartial_%7Bx%7D(e%5E%7Bx-y%7D)=M_%7Bt%7D">, <img src="https://latex.codecogs.com/png.latex?%5Cpartial_%7By%7D(e%5E%7Bx-y%7D)=-e%5E%7Bx-y%7D=-M_%7Bt%7D">, <img src="https://latex.codecogs.com/png.latex?%5Cpartial_%7Bxx%7D(e%5E%7Bx-y%7D)=M_%7Bt%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?dX_%7Bt%7D=V_%7Bt%7DdB_%7Bt%7D">. <img src="https://latex.codecogs.com/png.latex?dY_%7Bt%7D=%5Cfrac%7B1%7D%7B2%7DV_%7Bt%7D%5E%7B2%7Ddt">.</p>
<p><img src="https://latex.codecogs.com/png.latex?dX_%7Bt%7D%5Ccdot%20dX_%7Bt%7D=V_%7Bt%7D%5E%7B2%7Ddt">, <img src="https://latex.codecogs.com/png.latex?dX_%7Bt%7D%5Ccdot%20dY_%7Bt%7D=0">,</p>
<p><img src="https://latex.codecogs.com/png.latex?dY_%7Bt%7D%5Ccdot%20dY_%7Bt%7D=0">.</p>
<p>Consequently, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AdM_%7Bt%7D%20&amp;%20=M_%7Bt%7DV_%7Bt%7DdB_%7Bt%7D-%5Cfrac%7B1%7D%7B2%7DM_%7Bt%7DV_%7Bt%7D%5E%7B2%7Ddt%5C%5C%0A&amp;%20+%5Cfrac%7B1%7D%7B2%7DM_%7Bt%7DV_%7Bt%7D%5E%7B2%7Ddt%5C%5C%0A&amp;%20=M_%7Bt%7DV_%7Bt%7DdB_%7Bt%7D%0A%5Cend%7Baligned%7D"></p>
<p>Thus, <img src="https://latex.codecogs.com/png.latex?(M_%7Bt%7D,t%5Cgeq0)"> is a martingale.</p>
<div id="exr-generalized-ito-integral" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3</strong></span> (Generalized Ito Integral). Let <img src="https://latex.codecogs.com/png.latex?(%5COmega,%5Cmathcal%7BF%7D,%5Cmathbb%7BP%7D)"> be a probability space and let <img src="https://latex.codecogs.com/png.latex?(B_%7Bt%7D:t%5Cgeq0)"> be a standard brownian motion. Given that <img src="https://latex.codecogs.com/png.latex?f"> is a simple process, show that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cint_%7B0%7D%5E%7Bt%7Df(s,B_%7Bs%7D)dB_%7Bs%7D%20&amp;%20=B_%7Bt%7Df(t,B_%7Bt%7D)-%5Cint_%7B0%7D%5E%7Bt%7D%5Cleft%5BB_%7Bs%7D%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D+%5Cfrac%7B1%7D%7B2%7DB_%7Bs%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D%5Cright%5Dds%5C%5C%0A&amp;%20-%5Cint_%7B0%7D%5E%7Bt%7DB_%7Bs%7D%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bs%7D%0A%5Cend%7Baligned%7D"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cint_%7B0%7D%5E%7Bt%7Df(s,B_%7Bs%7D)ds%20&amp;%20=tf(t,B_%7Bt%7D)-%5Cint_%7B0%7D%5E%7Bt%7Ds%5Cleft%5B%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D%5Cright%5Dds-%5Cint_%7B0%7D%5E%7Bt%7Ds%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bs%7D%0A%5Cend%7Baligned%7D"></p>
</div>
<p><em>Solution.</em></p>
<p>I suppress <img src="https://latex.codecogs.com/png.latex?(t,B_%7Bt%7D)"> for simplicity. Applying the product rule to <img src="https://latex.codecogs.com/png.latex?B_%7Bt%7Df">, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Ad(B_%7Bt%7Df)%20&amp;%20=fdB_%7Bt%7D+B_%7Bt%7Ddf+dB_%7Bt%7D%5Ccdot%20df%5C%5C%0A&amp;%20=fdB_%7Bt%7D+B_%7Bt%7D%5Cleft(%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7Ddt+%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bt%7D+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D(dB_%7Bt%7D)%5E%7B2%7D%5Cright)%5C%5C%0A&amp;%20+dB_%7Bt%7D%5Ccdot%5Cleft(%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7Ddt+%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bt%7D+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D(dB_%7Bt%7D)%5E%7B2%7D%5Cright)%5C%5C%0A&amp;%20=fdB_%7Bt%7D+%5Cleft(B_%7Bt%7D%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D+%5Cfrac%7B1%7D%7B2%7DB_%7Bt%7D%5Cright)dt+B_%7Bt%7D%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bt%7D%5C%5C%0AB_%7Bt%7Df%20&amp;%20=%5Cint_%7B0%7D%5E%7Bt%7DfdB_%7Bs%7D+%5Cint_%7B0%7D%5E%7Bt%7D%5Cleft(B_%7Bs%7D%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7DB_%7Bs%7D%5Cright)ds+%5Cint_%7B0%7D%5E%7Bt%7DB_%7Bs%7D%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bs%7D%5C%5C%0A%5Cint_%7B0%7D%5E%7Bt%7DfdB_%7Bs%7D%20&amp;%20=B_%7Bt%7Df-%5Cint_%7B0%7D%5E%7Bt%7D%5Cleft(B_%7Bs%7D%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7DB_%7Bs%7D%5Cright)ds-%5Cint_%7B0%7D%5E%7Bt%7DB_%7Bs%7D%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bs%7D%0A%5Cend%7Baligned%7D"></p>
<p>Applying product rule to <img src="https://latex.codecogs.com/png.latex?tf(t,B_%7Bt%7D)">, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Ad(tf)%20&amp;%20=fdt+tdf+dt%5Ccdot%20df%5C%5C%0A&amp;%20=fdt+t%5Cleft(%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7Ddt+%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bt%7D+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D(dB_%7Bt%7D)%5E%7B2%7D%5Cright)%5C%5C%0A&amp;%20+dt%5Cleft(%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7Ddt+%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bt%7D+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D(dB_%7Bt%7D)%5E%7B2%7D%5Cright)%5C%5C%0A&amp;%20=fdt+t%5Cleft(%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D%5Cright)dt+t%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bt%7D%5C%5C%0Atf%20&amp;%20=%5Cint_%7B0%7D%5E%7Bt%7Dfds+%5Cint_%7B0%7D%5E%7Bt%7Ds%5Cleft(%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D%5Cright)ds+%5Cint_%7B0%7D%5E%7Bt%7Ds%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bs%7D%5C%5C%0A%5Cint_%7B0%7D%5E%7Bt%7Dfds%20&amp;%20=tf-%5Cint_%7B0%7D%5E%7Bt%7Ds%5Cleft(%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B1%7D%7B2%7D%5Cfrac%7B%5Cpartial%5E%7B2%7Df%7D%7B%5Cpartial%20x%5E%7B2%7D%7D%5Cright)ds-%5Cint_%7B0%7D%5E%7Bt%7Ds%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7DdB_%7Bs%7D%0A%5Cend%7Baligned%7D"></p>
<p>The following example will be important when we discuss the Girsanov theorem.</p>
<div id="thm-ito-formula-for-many-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Ito’s formula for many Ito processes)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?X_t%20=%20(X_t%5E%7B(j)%7D,j%5Cleq%20d,j%5Cin%5Cmathbf%7BN%7D)"> be Ito processes constructed on <img src="https://latex.codecogs.com/png.latex?(%5COmega,%5Cmathcal%7BF%7D,%5Cmathbb%7BP%7D)"> and <img src="https://latex.codecogs.com/png.latex?f%20%5Cin%20C%5E%7B1,2%7D(%5B0,T%5D%5Ctimes%20%5Cmathbb%7BR%7D%5Ed)">. Then for <img src="https://latex.codecogs.com/png.latex?t%20%5Cin%20%5B0,T%5D">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Adf(t,X_t)%20=%20%5Cpartial_t%20f(t,X_t)%20dt%20+%20%5Csum_%7Bj=1%7D%5E%7Bd%7D%20%5Cpartial_%7Bx_j%7D%20f(t,X_t)%20dX_t%5E%7B(j)%7D%20+%20%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bj=1%7D%5E%7Bd%7D%20%5Csum_%7Bk=1%7D%5Ed%20%5Cpartial_%7Bx_j%20x_k%7D%5E2%20f(t,X_t)%20dX_t%5E%7B(j)%7D%5Ccdot%20dX_t%5E%7B(k)%7D%0A"></p>
</div>
</section>
<section id="numerical-simulation-of-sdes" class="level2">
<h2 class="anchored" data-anchor-id="numerical-simulation-of-sdes">Numerical Simulation of SDEs</h2>
<p>The good news is that it is not too hard to implement iterative schemes to sample paths of a diffusion. Consider <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cleq%20T)"> a solution to the SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Csigma(X_t)%20dB_t%20+%20%5Cmu(X_t)%20dt%0A"></p>
<p>To keep the notation to a minimum, we consider a time-homogeonous diffusion. For a partition <img src="https://latex.codecogs.com/png.latex?(t_j,j%5Cleq%20n)"> of <img src="https://latex.codecogs.com/png.latex?%5B0,T%5D"> with <img src="https://latex.codecogs.com/png.latex?t_n%20=%20T">, consider the increment</p>
<p><span id="eq-increment-of-a-diffusion"><img src="https://latex.codecogs.com/png.latex?%0AX_%7Bt_%7Bj+1%7D%7D%20-%20X_%7Bt_j%7D%20=%20%5Cint_%7Bt_j%7D%5E%7Bt_%7Bj+1%7D%7D%20%5Csigma(X_s)%20dB(s)%20+%20%5Cint_%7Bt_j%7D%5E%7Bt_%7Bj+1%7D%7D%20%5Cmu(X_s)%20ds%0A%5Ctag%7B14%7D"></span></p>
<p>Note that, if <img src="https://latex.codecogs.com/png.latex?%5Csigma"> and <img src="https://latex.codecogs.com/png.latex?%5Cmu"> are smooth functions, we can apply Ito’s formula to <img src="https://latex.codecogs.com/png.latex?%5Csigma(X_s)"> and <img src="https://latex.codecogs.com/png.latex?%5Cmu(X_s)"> for <img src="https://latex.codecogs.com/png.latex?s%5Cin%20(t_j,t_%7Bj+1%7D%5D">! We get:</p>
<p><span id="eq-ito-taylor-expansion-of-mu-and-sigma"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csigma(X_s)%20&amp;=%20%5Csigma(X_%7Bt_j%7D)%20+%20%5Cint_%7Bt_j%7D%5E%7Bs%7D%5Csigma'(X_u)%20dX_u%20+%20%5Cfrac%7B1%7D%7B2%7D%5Cint_%7Bt_j%7D%5E%7Bs%7D%20%5Csigma''(X_u)(dX_u)%5E2%5C%5C%0A%5Cmu(X_s)%20&amp;=%20%5Cmu(X_%7Bt_j%7D)%20+%20%5Cint_%7Bt_j%7D%5E%7Bs%7D%5Cmu'(X_u)%20dX_u%20+%20%5Cfrac%7B1%7D%7B2%7D%5Cint_%7Bt_j%7D%5E%7Bs%7D%20%5Cmu''(X_u)(dX_u)%5E2%0A%5Cend%7Balign*%7D%0A%5Ctag%7B15%7D"></span></p>
<p>Now, we can approximate the increment in Equation&nbsp;14 at different levels of precision by considering a different estimate for Equation&nbsp;15.</p>
<div id="exm-euler-maruyama-scheme" class="theorem example">
<p><span class="theorem-title"><strong>Example 13</strong></span> (Euler-Maruyama Scheme). This scheme consists of taking <img src="https://latex.codecogs.com/png.latex?%5Csigma(X_s)%20%5Capprox%20%5Csigma(X_%7Bt_j%7D)"> and <img src="https://latex.codecogs.com/png.latex?%5Cmu(X_s)%20%5Capprox%20%5Cmu(X_%7Bt_j%7D)"> for <img src="https://latex.codecogs.com/png.latex?s%20%5Cin%20%5Bt_j,t_%7Bj+1%7D)"> in Equation&nbsp;15. Putting this back in Equation&nbsp;14, we get:</p>
<p><span id="eq-euler-maruyama"><img src="https://latex.codecogs.com/png.latex?%0AX_%7Bt_%7Bj+1%7D%7D%20-%20X_%7Bt_j%7D%20%5Capprox%20%5Csigma(X_%7Bt_j%7D)(B_%7Bt_%7Bj+1%7D%7D-B_%7Bt_j%7D)%20+%20%5Cmu(X_%7Bt_j%7D)(t_%7Bj+1%7D%20-%20t_j)%0A%5Ctag%7B16%7D"></span></p>
<p>The process <img src="https://latex.codecogs.com/png.latex?X_t"> can then be constructed recursively on the discrete set <img src="https://latex.codecogs.com/png.latex?(t_j,j%20%5Cleq%20n)"> as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AX_0%20&amp;=%20x%5C%5C%0AX_%7Bt_1%7D%20&amp;=%20(X_%7Bt_1%7D%20-%20X_0)%20+%20X_0%5C%5C%0AX_%7Bt_2%7D%20&amp;=%20(X_%7Bt_2%7D%20-%20X_%7Bt_1%7D)%20+%20(X_%7Bt_1%7D%20-%20X_0)%20+%20X_0%5C%5C%0A%5Cvdots%5C%5C%0AX_%7Bt_n%7D%20&amp;=%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(X_%7Bt_%7Bj+1%7D%7D%20-%20X_%7Bt_j%7D)%20+%20X_0%0A%5Cend%7Balign*%7D%0A"></p>
</div>
<div id="exm-milstein-scheme" class="theorem example">
<p><span class="theorem-title"><strong>Example 14</strong></span> (Milstein Scheme). In this scheme, we go an order further for the approximation of the volatility in Equation&nbsp;15 and consider also the integral in <img src="https://latex.codecogs.com/png.latex?dX_u">. We take <img src="https://latex.codecogs.com/png.latex?dX_u%20=%20%5Csigma(X_%7Bt_j%7D)dB_u">. We then express <img src="https://latex.codecogs.com/png.latex?%5Csigma(X_s)"> in Equation&nbsp;15 as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Csigma(X_s)%20&amp;%5Capprox%20%5Csigma(X_%7Bt_j%7D)%20+%20%5Cint_%7Bt_j%7D%5E%7Bs%7D%20%5Csigma'(X_%7Bt_j%7D)%20(%5Csigma(X_%7Bt_j%7D)dB_u)%5C%5C%0A&amp;=%20%5Csigma(X_%7Bt_j%7D)%20+%20%5Csigma'(X_%7Bt_j%7D)%20%5Csigma(X_%7Bt_j%7D)%20%5Cint_%7Bt_j%7D%5E%7Bs%7D%20%20dB_u%5C%5C%0A&amp;=%20%5Csigma(X_%7Bt_j%7D)%20+%20%5Csigma'(X_%7Bt_j%7D)%20%5Csigma(X_%7Bt_j%7D)%20(B_s%20-%20B_%7Bt_j%7D)%0A%5Cend%7Balign*%7D%0A"></p>
<p>If we put this back in Equation&nbsp;14, we get:</p>
<p><span id="eq-milstein-approx-step1"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AX_%7Bt_%7Bj+1%7D%7D%20-%20X_%7Bt_j%7D%20&amp;%5Capprox%20%5Csigma(X_%7Bt_j%7D)(B_%7Bt_%7Bj+1%7D%7D-B_%7Bt_j%7D)%20+%20%5Cmu(X_%7Bt_j%7D)(t_%7Bj+1%7D%20-%20t_j)%20%5C%5C%0A&amp;+%20%5Csigma'(X_%7Bt_j%7D)%20%5Csigma(X_%7Bt_j%7D)%20%5Cint_%7Bt_j%7D%5E%7Bt_%7Bj+1%7D%7D%20(B(s)%20-%20B(t_j))dB(s)%0A%5Cend%7Balign*%7D%0A%5Ctag%7B17%7D"></span></p>
<p>Now, consider the function <img src="https://latex.codecogs.com/png.latex?f(x)=x%5E2">. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af_x(x)%20&amp;=%202x%5C%5C%0Af_%7Bxx%7D(x)%20&amp;=%202%0A%5Cend%7Balign*%7D%0A"></p>
<p>So, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AB%5E2(t_%7Bj+1%7D)%20-%20B%5E2(t_j)%20=%202%20%5Cint_%7Bt_j%7D%5E%7Bt_%7Bj+1%7D%7D%20B(s)%20dB(s)%20+%20%5Cfrac%7B1%7D%7B2%7D%20%5Cint_%7Bt_j%7D%5E%7Bt_%7Bj+1%7D%7D%20(2)%20ds%0A"></p>
<p>Thus,</p>
<p><span id="eq-ito-integral-of-bm"><img src="https://latex.codecogs.com/png.latex?%0A%5Cint_%7Bt_j%7D%5E%7Bt_%7Bj+1%7D%7D%20B(s)%20dB(s)%20=%20%5Cfrac%7B1%7D%7B2%7D%5B(B_%7Bt_%7Bj+1%7D%7D%5E2%20-%20B_%7Bt_j%7D%5E2)-(t_%7Bj+1%7D-t_j)%5D%0A%5Ctag%7B18%7D"></span></p>
<p>Substituting Equation&nbsp;18 into Equation&nbsp;17, we get the Milstein approximation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AX_%7Bt_%7Bj+1%7D%7D%20-%20X_%7Bt_j%7D%20&amp;%5Capprox%20%5Csigma(X_%7Bt_j%7D)(B_%7Bt_%7Bj+1%7D%7D-B_%7Bt_j%7D)%20+%20%5Cmu(X_%7Bt_j%7D)(t_%7Bj+1%7D%20-%20t_j)%20%5C%5C%0A&amp;+%5Csigma'(X_%7Bt_j%7D)%20%5Csigma(X_%7Bt_j%7D)%20%20%5Cleft%5B%5Cfrac%7B1%7D%7B2%7D((B_%7Bt_%7Bj+1%7D%7D%5E2%20-%20B_%7Bt_j%7D%5E2)-(t_%7Bj+1%7D-t_j))%20-%20%20B_%7Bt_j%7D(B_%7Bt_%7Bj+1%7D%7D-B_%7Bt_j%7D)%5Cright%5D%5C%5C%0A&amp;=%20%5Csigma(X_%7Bt_j%7D)(B_%7Bt_%7Bj+1%7D%7D-B_%7Bt_j%7D)%20+%20%5Cmu(X_%7Bt_j%7D)(t_%7Bj+1%7D%20-%20t_j)%20%5C%5C%0A&amp;+%20%5Cfrac%7B%5Csigma'(X_%7Bt_j%7D)%20%5Csigma(X_%7Bt_j%7D)%7D%7B2%7D%20%20%5Cleft%5B(B_%7Bt_%7Bj+1%7D%7D%5E2%20-%20B_%7Bt_j%7D%5E2)-(t_%7Bj+1%7D-t_j)%20-%20%202B_%7Bt_j%7DB_%7Bt_%7Bj+1%7D%7D+2B_%7Bt_j%7D%5E2%5Cright%5D%5C%5C%0A&amp;=%20%5Csigma(X_%7Bt_j%7D)(B_%7Bt_%7Bj+1%7D%7D-B_%7Bt_j%7D)%20+%20%5Cmu(X_%7Bt_j%7D)(t_%7Bj+1%7D%20-%20t_j)%20%5C%5C%0A&amp;+%20%5Cfrac%7B%5Csigma'(X_%7Bt_j%7D)%20%5Csigma(X_%7Bt_j%7D)%7D%7B2%7D%20%20%5Cleft%5B(B_%7Bt_%7Bj+1%7D%7D%20-%20B_%7Bt_j%7D)%5E2-(t_%7Bj+1%7D-t_j)%5Cright%5D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Thus, under the Milstein scheme</p>
<p><span id="eq-milstein"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AX_%7Bt_%7Bj+1%7D%7D%20-%20X_%7Bt_j%7D%20&amp;%5Capprox%20%5Csigma(X_%7Bt_j%7D)(B_%7Bt_%7Bj+1%7D%7D-B_%7Bt_j%7D)%20+%20%5Cmu(X_%7Bt_j%7D)(t_%7Bj+1%7D%20-%20t_j)%20%5C%5C%0A&amp;+%20%5Cfrac%7B%5Csigma'(X_%7Bt_j%7D)%20%5Csigma(X_%7Bt_j%7D)%7D%7B2%7D%20%20%5Cleft%5B(B_%7Bt_%7Bj+1%7D%7D%20-%20B_%7Bt_j%7D)%5E2-(t_%7Bj+1%7D-t_j)%5Cright%5D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B19%7D"></span></p>
<p>The recursive nature of these two schemes makes them easy to implement numerically. The Milstein scheme is not much more costly to implement as it contains only one more term than the Euler scheme.</p>
</div>
<section id="python-implementation" class="level3">
<h3 class="anchored" data-anchor-id="python-implementation">Python implementation</h3>
<p>Let’s code an <code>SIVP</code> class and an abstract base class <code>Solver</code>.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dataclasses <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dataclass</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> abc <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ABC, abstractmethod</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Callable, Optional</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb1-7"></span>
<span id="cb1-8">sns.set_style(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"whitegrid"</span>)</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># More descriptive type hints</span></span>
<span id="cb1-11">T <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ndarray</span>
<span id="cb1-12">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ndarray</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@dataclass</span></span>
<span id="cb1-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> SIVP:</span>
<span id="cb1-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    An abstraction for a stochastic initial value problem</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb1-19">    t_start : <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span></span>
<span id="cb1-20">    t_end : <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span></span>
<span id="cb1-21">    initial_condition: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span></span>
<span id="cb1-22"></span>
<span id="cb1-23">    drift: Callable[[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, np.ndarray], np.ndarray]</span>
<span id="cb1-24">    vol: Callable[[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, np.ndarray], np.ndarray]</span>
<span id="cb1-25">    dvol_dx: Optional[Callable[[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, np.ndarray], np.ndarray]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"></span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@dataclass</span></span>
<span id="cb1-30"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Solver(ABC):</span>
<span id="cb1-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    An abstract base class for all numerical schemes</span></span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb1-34"></span>
<span id="cb1-35">    num_steps: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-36">    num_paths: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-37"></span>
<span id="cb1-38">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> __post_init__(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb1-39">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb1-40"></span>
<span id="cb1-41">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># x_values is a matrix of shape [num_paths,num_steps]</span></span>
<span id="cb1-42">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.num_paths, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb1-43">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.step_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.num_steps</span>
<span id="cb1-44"></span>
<span id="cb1-45">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gaussian increments</span></span>
<span id="cb1-46">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.brownian_increments <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.step_size) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.random.standard_normal(</span>
<span id="cb1-47">            size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.num_paths, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.num_steps)</span>
<span id="cb1-48">        )</span>
<span id="cb1-49">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.brownian <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cumsum(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.brownian_increments, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-50">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.brownian <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.concatenate(</span>
<span id="cb1-51">            [np.zeros(shape<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.num_paths, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.brownian], axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-52">        )</span>
<span id="cb1-53"></span>
<span id="cb1-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@abstractmethod</span></span>
<span id="cb1-55">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> iterate(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, sivp: SIVP) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> X:</span>
<span id="cb1-56">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Compute the next iterate X(n+1)</span></span>
<span id="cb1-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb1-59"></span>
<span id="cb1-60">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> solve(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, sivp: SIVP) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> (T, X):</span>
<span id="cb1-61">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Solve the SIVP</span></span>
<span id="cb1-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb1-64">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.full(</span>
<span id="cb1-65">            shape<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.num_paths,), fill_value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sivp.initial_condition</span>
<span id="cb1-66">        )</span>
<span id="cb1-67">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.num_steps:</span>
<span id="cb1-68">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.iterate(sivp)</span>
<span id="cb1-69">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-70"></span>
<span id="cb1-71">        times <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(sivp.t_start, sivp.t_end, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.num_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-72">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> times, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values</span>
<span id="cb1-73"></span>
<span id="cb1-74">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> reset(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb1-75">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.__post_init__()</span></code></pre></div>
</div>
<p>The <code>EulerMaruyama</code> and <code>Milstein</code> methods will derive from the abstract base class <code>Solver</code>.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@dataclass</span></span>
<span id="cb2-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> EulerMaruyama(Solver):</span>
<span id="cb2-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Numerical solver for a stochastic differential equation(SDE) using</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    the Euler-Maruyama method.</span></span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Consider an SDE of the form :</span></span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    dX_t = mu(t,X_t) dt + sigma(t,X_t) dB_t</span></span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    with initial condition X_0 = x_0</span></span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    The solution to the SDE can be computed using the increments</span></span>
<span id="cb2-14"></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    X_{n+1} - X_n = mu(n,X_n)(t_{n+1}-t_n) + sigma(n,X_n)(B(n+1)-B(n))</span></span>
<span id="cb2-16"></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb2-18"></span>
<span id="cb2-19">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> iterate(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, sivp: SIVP) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> X:</span>
<span id="cb2-20">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Generate the next iterate X(n+1)</span></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb2-23">        current_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.step_size</span>
<span id="cb2-24">        mu_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sivp.drift(current_time, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>])</span>
<span id="cb2-25">        sigma_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sivp.vol(current_time, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>])</span>
<span id="cb2-26">        delta_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb2-27">            mu_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.step_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> sigma_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.brownian_increments[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>]</span>
<span id="cb2-28">        )</span>
<span id="cb2-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> delta_x</span></code></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@dataclass</span></span>
<span id="cb3-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Milstein(Solver):</span>
<span id="cb3-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Numerical solver for a stochastic differential equation(SDE) using</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    the Euler-Maruyama method.</span></span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Consider an SDE of the form :</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    dX_t = mu(t,X_t) dt + sigma(t,X_t) dB_t</span></span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    with initial condition X_0 = x_0</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    The solution to the SDE can be computed using the increments</span></span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    X_{n+1} - X_n = mu(n,X_n)(t_{n+1}-t_n) + sigma(n,X_n)(B(n+1)-B(n))</span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    + 0.5 * sigma(n,X_n) * sigma'(n,X_n) * ((B(n+1) - B(n))**2 - (t_{n+1} - t_n))</span></span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb3-19"></span>
<span id="cb3-20">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> iterate(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, sivp: SIVP):</span>
<span id="cb3-21">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Generate the next iterate X(n+1)</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb3-24">        current_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.step_size</span>
<span id="cb3-25">        mu_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sivp.drift(current_time, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>])</span>
<span id="cb3-26">        sigma_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sivp.vol(current_time, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>])</span>
<span id="cb3-27">        dvol_dx_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sivp.dvol_dx(current_time, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>])</span>
<span id="cb3-28"></span>
<span id="cb3-29">        delta_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb3-30">            mu_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.step_size</span>
<span id="cb3-31">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> sigma_n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.brownian_increments[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>]</span>
<span id="cb3-32">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb3-33">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sigma_n</span>
<span id="cb3-34">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dvol_dx_n</span>
<span id="cb3-35">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.brownian_increments[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.step_size)</span>
<span id="cb3-36">        )</span>
<span id="cb3-37"></span>
<span id="cb3-38">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x_values[:, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> delta_x</span></code></pre></div>
</div>
<div id="exr-simulating-sdes" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4</strong></span> (Simulating SDEs) Simulate 100 paths for the following diffusions given by their SDEs on <img src="https://latex.codecogs.com/png.latex?%5B0,1%5D"> using the Euler-Maruyama scheme and the Milstein scheme for a discretization of <img src="https://latex.codecogs.com/png.latex?0.01">.</p>
<ol type="a">
<li>Geometric Brownian Motion:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0AdS_t%20=%20S_t%20dB_t%20+%20%5Cleft(%5Cmu%20+%20%5Cfrac%7B%5Csigma%5E2%7D%7B2%7D%5Cright)S_t%20dt,%20%5Cquad%20S_0%20=%201%0A"></p>
<p>for <img src="https://latex.codecogs.com/png.latex?%5Cmu=-1/2">, <img src="https://latex.codecogs.com/png.latex?%5Cmu=-2">, and <img src="https://latex.codecogs.com/png.latex?%5Cmu=0"></p>
<ol start="2" type="a">
<li>Ornstein-Uhlenbeck process:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20-X_t%20dt%20+%20dB_t,%20%5Cquad%20X_0%20=%201%0A"></p>
<ol start="3" type="a">
<li>The diffusion:</li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Csqrt%7B1+X_t%5E2%7DdB_t%20+%20%5Csin%20X_t%20dt,%20%5Cquad%20X_0%20=%200%0A"></p>
</div>
<p><em>Solution.</em></p>
<p>We can now use <code>EulerMaruyama</code> and <code>Milstein</code> solvers and generate some sample paths.</p>
<div class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> plot_trajectories(ts, xs, title):</span>
<span id="cb4-2">    plt.xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'Time $t$'</span>)</span>
<span id="cb4-3">    plt.ylabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$X(t)$'</span>)</span>
<span id="cb4-4">    plt.title(title)</span>
<span id="cb4-5">    plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb4-6">    plt.plot(ts, xs.transpose())</span>
<span id="cb4-7">    plt.show()</span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mu = -0.5 case</span></span>
<span id="cb4-10">euler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> EulerMaruyama(num_paths<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, num_steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb4-11"></span>
<span id="cb4-12">gbm_sde <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SIVP(</span>
<span id="cb4-13">    t_start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,</span>
<span id="cb4-14">    t_end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>,</span>
<span id="cb4-15">    initial_condition<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>,</span>
<span id="cb4-16">    drift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t: np.zeros(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb4-17">    vol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t: s_t,</span>
<span id="cb4-18">    dvol_dx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t: np.ones(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb4-19">)</span>
<span id="cb4-20"></span>
<span id="cb4-21"></span>
<span id="cb4-22">ts, xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> euler.solve(gbm_sde)</span>
<span id="cb4-23">euler.reset()</span>
<span id="cb4-24"></span>
<span id="cb4-25">plot_trajectories(ts, xs, <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'10 sample paths of Geometric Brownian Motion, $\mu=-0.5$'</span>)</span>
<span id="cb4-26"></span>
<span id="cb4-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mu = -2 case</span></span>
<span id="cb4-28">gbm_sde.drift <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t : <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> s_t</span>
<span id="cb4-29">ts, xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> euler.solve(gbm_sde)</span>
<span id="cb4-30">euler.reset()</span>
<span id="cb4-31"></span>
<span id="cb4-32">plot_trajectories(ts, xs, <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'10 sample paths of Geometric Brownian Motion, $\mu=-2.0$'</span>)</span>
<span id="cb4-33"></span>
<span id="cb4-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mu = 0 case</span></span>
<span id="cb4-35">gbm_sde.drift <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t : <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> s_t</span>
<span id="cb4-36">ts, xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> euler.solve(gbm_sde)</span>
<span id="cb4-37">euler.reset()</span>
<span id="cb4-38"></span>
<span id="cb4-39">plot_trajectories(ts, xs, <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'10 sample paths of Geometric Brownian Motion, $\mu=0.0$'</span>)</span>
<span id="cb4-40"></span>
<span id="cb4-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ornstein-uhlenbeck</span></span>
<span id="cb4-42">ornstein_uhlenbeck_sde <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SIVP(</span>
<span id="cb4-43">    t_start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,</span>
<span id="cb4-44">    t_end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>,</span>
<span id="cb4-45">    initial_condition<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>,</span>
<span id="cb4-46">    drift <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t : <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>s_t,</span>
<span id="cb4-47">    vol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t : np.ones(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb4-48">    dvol_dx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t : np.zeros(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb4-49">)</span>
<span id="cb4-50"></span>
<span id="cb4-51">ts, xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> euler.solve(ornstein_uhlenbeck_sde)</span>
<span id="cb4-52">euler.reset()</span>
<span id="cb4-53"></span>
<span id="cb4-54">plot_trajectories(ts, xs, <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'10 sample paths of Ornstein-Uhlenbeck'</span>)</span>
<span id="cb4-55"></span>
<span id="cb4-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># diffusion</span></span>
<span id="cb4-57">diffusion_sde <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SIVP(</span>
<span id="cb4-58">    t_start<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,</span>
<span id="cb4-59">    t_end<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>,</span>
<span id="cb4-60">    initial_condition<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,</span>
<span id="cb4-61">    drift <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t : np.sin(s_t),</span>
<span id="cb4-62">    vol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t : np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>s_t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb4-63">    dvol_dx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> t, s_t : s_t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> s_t<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) </span>
<span id="cb4-64">)</span>
<span id="cb4-65"></span>
<span id="cb4-66">ts,xs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> euler.solve(diffusion_sde)</span>
<span id="cb4-67">euler.reset()</span>
<span id="cb4-68"></span>
<span id="cb4-69">plot_trajectories(ts, xs, <span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'10 sample paths of the diffusion'</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/ito-processes-and-stochastic-diff-eqs/index_files/figure-html/cell-5-output-1.png" width="576" height="448" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/ito-processes-and-stochastic-diff-eqs/index_files/figure-html/cell-5-output-2.png" width="595" height="448" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/ito-processes-and-stochastic-diff-eqs/index_files/figure-html/cell-5-output-3.png" width="576" height="448" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/ito-processes-and-stochastic-diff-eqs/index_files/figure-html/cell-5-output-4.png" width="595" height="447" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/ito-processes-and-stochastic-diff-eqs/index_files/figure-html/cell-5-output-5.png" width="591" height="447" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="convergence" class="level3">
<h3 class="anchored" data-anchor-id="convergence">Convergence</h3>
<p>It is of course possible go beyond the Milstein scheme to improve the approximation. However, it turns out that the above schemes already converge quite rapidly to the process itself. To see this, consider the mean absolute error between the approximation <img src="https://latex.codecogs.com/png.latex?X_T%5E%7B(n)%7D"> at time <img src="https://latex.codecogs.com/png.latex?T"> and <img src="https://latex.codecogs.com/png.latex?X_T">. Suppose that the approximation <img src="https://latex.codecogs.com/png.latex?X%5E%7B(n)%7D"> is obtained for a partition with discretization <img src="https://latex.codecogs.com/png.latex?t_%7Bj+1%7D-t_j%20=%201/n">. It is possible to show that for the Euler scheme, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5B%7CX_T%5E%7B(n)%7D%20-%20X_T%7C%5D%20%5Cleq%20%5Cfrac%7BC%7D%7B%5Csqrt%7Bn%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>whereas for the Milstein scheme</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5B%7CX_T%5E%7B(n)%7D%20-%20X_T%7C%5D%20%5Cleq%20%5Cfrac%7BC'%7D%7Bn%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>for some constants <img src="https://latex.codecogs.com/png.latex?C,C'%3E0">. Note that the mean error between the two process must be the worst at the last point, since the errors add up.</p>
</section>
</section>
<section id="existence-and-uniqueness-of-sdes" class="level2">
<h2 class="anchored" data-anchor-id="existence-and-uniqueness-of-sdes">Existence and Uniqueness of SDEs</h2>
<p>As for the differential equations in standard calculus, SDEs play an important role in modelling stochastic phenomena. To model a trajectory <img src="https://latex.codecogs.com/png.latex?X_t,%20t%5Cleq%20T">, it suffices to write down the variation due to the deterministic change <img src="https://latex.codecogs.com/png.latex?%5Cmu(X_t)dt"> for some function <img src="https://latex.codecogs.com/png.latex?%5Cmu(X_t)"> and the variation due to local fluctuations <img src="https://latex.codecogs.com/png.latex?%5Csigma(X_t)dB_t"> for some function <img src="https://latex.codecogs.com/png.latex?%5Csigma(X_t)">. Here, we assume that the local drift and volatility are time-homogenous for simplicity. This gives the SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Cmu(X_t)%20dt%20+%20%5Csigma(X_t)%20dB_t%0A"></p>
<p>Do we get one nice Ito process for any choice of functions <img src="https://latex.codecogs.com/png.latex?%5Csigma"> and <img src="https://latex.codecogs.com/png.latex?%5Cmu">? The short answer is no. Here are sufficient conditions for the existence of a unique process.</p>
<div id="thm-existence-and-uniqueness-of-solutions-to-sde" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4 (Existence and Uniqueness of solutions to SDE)</strong></span> Consider the SDE</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Cmu(X_t)%20dt%20%20+%20%5Csigma(X_t)dB_t,%20%5Cquad%20X_0%20=%20x,%20%5Cquad%20t%5Cin%20%5B0,T%5D%0A"></p>
<p>If the functions <img src="https://latex.codecogs.com/png.latex?%5Csigma"> and <img src="https://latex.codecogs.com/png.latex?%5Cmu"> grow not faster than <img src="https://latex.codecogs.com/png.latex?Kx%5E2"> for some <img src="https://latex.codecogs.com/png.latex?K%3E0"> and are differentiable with bounded derivatives on <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5E1">, then there exists a unique solution <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cin%5B0,T%5D)"> to the SDE. In other words, there exists a continuous process <img src="https://latex.codecogs.com/png.latex?(X_t,%20t%20%5Cleq%20T)"> adapted to the filtration of the Brownian motion given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AX_t%20=%20x%20+%20%5Cint_0%5Et%20%5Cmu(X_s)%20ds%20+%20%5Cint_0%5Et%20%5Csigma(X_s)%20dB_s,%20%5Cquad%20t%5Cleq%20T%0A"></p>
</div>
<div id="exm-diffusion" class="theorem example">
<p><span class="theorem-title"><strong>Example 15</strong></span> Consider the SDE :</p>
<p><span id="eq-a-diffusion"><img src="https://latex.codecogs.com/png.latex?%0AdX_t%20=%20%5Csqrt%7B1%20+%20X_t%5E2%7DdB_t%20+%20%5Csin%20X_t%20dt%0A%5Ctag%7B20%7D"></span></p>
<p>There exists a unique diffusion process <img src="https://latex.codecogs.com/png.latex?(X_t,t%5Cgeq%200)"> that is a solution of this SDE. To see this, we verify the conditions of the Theorem&nbsp;4. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Csigma(x)%20=%20%5Csqrt%7B1%20+%20x%5E2%7D,%20%5Cquad%20%5Cmu(x)%20=%20%5Csin%20x%0A"></p>
<p>Clearly, these functions satisfy the growth condition since <img src="https://latex.codecogs.com/png.latex?%5Cmu"> is bounded and <img src="https://latex.codecogs.com/png.latex?%5Csigma"> grows like <img src="https://latex.codecogs.com/png.latex?%7Cx%7C"> for large <img src="https://latex.codecogs.com/png.latex?x">. As for the derivatives, we have <img src="https://latex.codecogs.com/png.latex?%5Csigma'(x)=%5Cfrac%7Bx%7D%7B%5Csqrt%7B1+x%5E2%7D%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cmu'(x)=%5Ccos%20x">. The two derivatives are bounded.</p>
</div>
<p>The assumptions of Theorem&nbsp;4 are not too surprising, since similar ones are found in the classical case of ODE. For example, if we have the ODE</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7BdX_t%7D%7Bdt%7D%20=%20X_t%5E%7B1/2%7D,%20%5Cquad%20X_0%20=%200%0A"></p>
<p>then clearly <img src="https://latex.codecogs.com/png.latex?X_t%20=%200"> for all <img src="https://latex.codecogs.com/png.latex?t"> is a solution. But, we also have by integrating that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AX_t%20=%20%5Cfrac%7Bt%5E2%7D%7B4%7D,%20t%20%5Cgeq%200%0A"></p>
<p>Therefore, the uniqueness breaks down. Note, that the function <img src="https://latex.codecogs.com/png.latex?%5Cmu(x)=%5Csqrt%7Bx%7D"> does not have bounded derivatives at <img src="https://latex.codecogs.com/png.latex?0">. Similarly, consider the ODE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7BdX_t%7D%7Bdt%7D%20=%20e%5E%7BX_t%7D,%20X_0%20=%200%0A"></p>
<p>Here, the function <img src="https://latex.codecogs.com/png.latex?%5Cmu(x)"> grows much faster than <img src="https://latex.codecogs.com/png.latex?x%5E2">. The solution of the ODE is by integrating</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A-(e%5E%7B-X_t%7D%20-%201)%20&amp;=%20t%5C%5C%0Ae%5E%7B-X_t%7D%20&amp;=%20(1%20-%20t)%5C%5C%0A-X_t%20&amp;=%20%5Clog(1%20-%20t)%5C%5C%0AX_t%20&amp;=%20%5Clog%20%5Cleft(%5Cfrac%7B1%7D%7B1-t%7D%5Cright)%0A%5Cend%7Balign*%7D%0A"></p>
<p>The solution explodes at <img src="https://latex.codecogs.com/png.latex?t=1">. The same phenomenon may occur for SDE; that is the process will almost surely go <img src="https://latex.codecogs.com/png.latex?%5Cinfty"> in finite time. These times are called <em>explosion times</em>. Note that it is possible to consider the paths of the diffusion upto these explosion times. It is important to keep in mind that the conditions of Theorem&nbsp;4 are sufficient, but not necessary. In particular, it is sometimes possible to explicitly construct a diffusion whose local volatility and drift do not satisfy the conditions. Let’s look at two important instances of such diffusions.</p>
<div class="{exm-bessel-process}">
<p>Let <img src="https://latex.codecogs.com/png.latex?B_t"> be a brownian motion in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed"> for <img src="https://latex.codecogs.com/png.latex?d%3E1">. Consider the process giving the distance at time <img src="https://latex.codecogs.com/png.latex?t"> of <img src="https://latex.codecogs.com/png.latex?B_t"> to the origin; that is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AR_t%20=%20%7C%7CB_t%7C%7C%20=%20%5Cleft(%5Csum_%7Bj=1%7D%5Ed%20B_t%5E%7B(j)%7D%5Cright)%5E2%0A"></p>
<p>(For <img src="https://latex.codecogs.com/png.latex?d=1">, this is simply <img src="https://latex.codecogs.com/png.latex?%7CB_t%7C">. Ito’s formula cannot be applied in this case, since the absolute value is not differentiable at the origin.) In higher dimensions, the function is smooth enough as long as we stay away from the origin. This is not a problem as long as <img src="https://latex.codecogs.com/png.latex?R_0%20%3E%200">.</p>
</div>
<p>Let’s find out the SDE that this process satisfies.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?r=f(x_1,x_2,%5Cldots,x_d)=%5Csqrt%7B%5Csum_%7Bj=1%7D%5Ed%20x_j%5E2%7D">. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20r%7D%7B%5Cpartial%20x_j%7D%20&amp;=%20%5Cfrac%7Bx_j%7D%7B%5Csqrt%7B%5Csum_%7Bj=1%7D%5Ed%20x_j%5E2%7D%7D%5C%5C%0A%5Cfrac%7B%5Cpartial%5E2%20r%7D%7B%5Cpartial%20x_j%5E2%7D%20&amp;=%20%5Cfrac%7B%7C%7Cx%7C%7C%20-%20x_j%20%5Ccdot%20%5Cfrac%7Bx_j%7D%7B%7C%7Cx%7C%7C%7D%7D%7B%7C%7Cx%7C%7C%5E2%7D%5C%5C%0A&amp;=%20%5Cfrac%7B%7C%7Cx%7C%7C%5E2%20-%20x_j%5E2%7D%7B%7C%7Cx%7C%7C%5E3%7D%0A%5Cend%7Balign*%7D"></p>
<p>By Ito’s formula,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AdR_t%20&amp;=%20%5Csum_%7Bj=1%7D%5E%7Bd%7D%20%5Cfrac%7BB_t%5E%7Bj%7D%7D%7BR_t%7D%20dB_t%5E%7B(j)%7D%20+%20%5Cfrac%7B1%7D%7B2%7D%20%5Csum_%7Bj=1%7D%5E%7Bd%7D%20%5Cfrac%7BR_t%5E2%20-%20(B_t%5E%7B(j)%7D)%5E2%7D%7BR_t%5E3%7D%5C%5C%0A&amp;=%20%5Csum_%7Bj=1%7D%5E%7Bd%7D%20%5Cfrac%7BB_t%5E%7Bj%7D%7D%7BR_t%7D%20dB_t%5E%7B(j)%7D%20+%20%5Cfrac%7B1%7D%7B2%7D%20%5Cfrac%7Bd%20R_t%5E2%20-%20R_t%5E2%7D%7BR_t%5E3%7D%5C%5C%0A&amp;=%20%5Csum_%7Bj=1%7D%5E%7Bd%7D%20%5Cfrac%7BB_t%5E%7Bj%7D%7D%7BR_t%7D%20dB_t%5E%7B(j)%7D%20+%20%5Cfrac%7B1%7D%7B2%7D%20%5Cfrac%7B(d-1)%7D%7BR_t%7D%0A%5Cend%7Balign*%7D"></p>
<p>We can define <img src="https://latex.codecogs.com/png.latex?dW_t%20=%20%5Csum_%7Bj=1%7D%5E%7Bd%7D%20%5Cfrac%7BB_t%5E%7B(j)%7D%7D%7BR_t%7D%20dB_t%5E%7B(j)%7D">. Then, <img src="https://latex.codecogs.com/png.latex?dR_t%20=%20dW_t%20+%20%5Cfrac%7Bd-1%7D%7B2R_t%7Ddt"></p>
<p>It turns out that <img src="https://latex.codecogs.com/png.latex?(W_t,t%20%5Cgeq%200)"> is a standard Brownian motion by Levy’s characterization theorem. This is the subject of the next section. The SDE shows that <img src="https://latex.codecogs.com/png.latex?dR_t"> is a diffusion. The SDE makes sense for any real number <img src="https://latex.codecogs.com/png.latex?d%20%3E%201">, not only integers. Moreover, the SDE is well-defined since <img src="https://latex.codecogs.com/png.latex?R_t"> is never equal to <img src="https://latex.codecogs.com/png.latex?0">. However, the SDE does not satisfy the assumption of the existence and uniqueness of the solution of SDEs since <img src="https://latex.codecogs.com/png.latex?1/x"> diverges at <img src="https://latex.codecogs.com/png.latex?0">. The solution to the SDE still exists since we constructed it! We sample paths of this process in numerical project.</p>
<div id="exm-cox-ingersoll-ross-process" class="theorem example">
<p><span class="theorem-title"><strong>Example 16 (The Cox-Ingersoll-Ross (CIR) model.)</strong></span> Consider the SDE:</p>
<p><span id="eq-cir-process"><img src="https://latex.codecogs.com/png.latex?%0AdS_t%20=%20%5Csigma%20%5Csqrt%7BS_t%7D%20dW_t%20+%20(a%20-%20bS_t)dt,%20%5Cquad%20S_0%20%3E%200%0A%5Ctag%7B21%7D"></span></p>
<p>for some parameters <img src="https://latex.codecogs.com/png.latex?a,b%20%3E%200"> where <img src="https://latex.codecogs.com/png.latex?(W_t,t%20%5Cgeq%200)"> is a standard Brownian motion. The local volatility <img src="https://latex.codecogs.com/png.latex?%5Csigma(x)=%5Csigma%20%5Csqrt%7Bx%7D"> does not have a bounded derivative close to <img src="https://latex.codecogs.com/png.latex?0">, since <img src="https://latex.codecogs.com/png.latex?%5Csigma'(x)=%5Cfrac%7B%5Csigma%7D%7B2%5Csqrt%7Bx%7D%7D">. We will nevertheless construct a diffusion that is a solution to the SDE. Consider independent Ornstein-Uhlenbeck processes <img src="https://latex.codecogs.com/png.latex?X_t%5E%7B(j)%7D,%20j%20%5Cleq%20d">, with SDE:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AdX_t%5E%7B(j)%7D%20=%20%5Cfrac%7B-b%7D%7B2%7DX_t%5E%7B(j)%7Ddt%20+%20%5Cfrac%7B%5Csigma%7D%7B2%7DdB_t%5E%7B(j)%7D,%20%5Cquad%20X_0%5E%7B(j)%7D%20%3E%200%0A"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?B_t%20=%20(B_t%5E%7B(j)%7D,j%5Cleq%20d)"> is a Brownian motion in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed">. We consider the process</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AS_t%20=%20%5Csum_%7Bj%20%5Cleq%20d%7D%20(X_t%5E%7B(j)%7D)%5E2%0A"></p>
<p>Clearly, <img src="https://latex.codecogs.com/png.latex?S_t"> is nongegative for all <img src="https://latex.codecogs.com/png.latex?t%20%5Cgeq%200"> by design, so <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7BS_t%7D"> is well-defined. Let’s compute the SDE of the process. By Ito’s formula, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AdS_t%20&amp;=%202%5Csum_%7Bj=1%7D%5E%7Bd%7DX_t%5E%7B(j)%7D%20dX_t%5E%7B(j)%7D%20+%20%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bj=1%7D%5E%7Bd%7D%202%20(dX_t%5E%7B(j)%7D)%5E2%5C%5C%0A&amp;=2%5Csum_%7Bj=1%7D%5E%7Bd%7DX_t%5E%7B(j)%7D%20dX_t%5E%7B(j)%7D%20+%20%5Cfrac%7B%5Csigma%5E2%7D%7B4%7D%5Csum_%7Bj=1%7D%5E%7Bd%7D%20dt%20%5C%5C%0A&amp;=2%5Csum_%7Bj=1%7D%5E%7Bd%7DX_t%5E%7B(j)%7D%20%5Cleft(%5Cfrac%7B-b%7D%7B2%7DX_t%5E%7B(j)%7Ddt%20+%20%5Cfrac%7B%5Csigma%7D%7B2%7DdB_t%5E%7B(j)%7D%5Cright)%20+%20%5Cfrac%7Bd%5Csigma%5E2%7D%7B4%7D%20dt%5C%5C%0A&amp;=%5Cleft%5B%5Cleft(%5Csum_%7Bj=1%7D%5Ed%20(-b)(X_t%5E%7B(j)%7D)%5E2%5Cright)%20+%20%5Cfrac%7Bd%5Csigma%5E2%7D%7B4%7D%5Cright%5D%20dt%20+%20%5Csigma%20%5Csum_%7Bj=1%7D%5E%7Bd%7D%20X_t%5E%7B(j)%7D%20dB_t%5E%7B(j)%7D%5C%5C%0A&amp;=%5Csigma%20%5Csum_%7Bj=1%7D%5E%7Bd%7D%20X_t%5E%7B(j)%7D%20dB_t%5E%7B(j)%7D%20+%20%5Cleft%5B%5Cfrac%7Bd%5Csigma%5E2%7D%7B4%7D%20-%20b%20S_t%5Cright%5D%20dt%20%5C%5C%0A&amp;=%20%5Csigma%20%5Csqrt%7BS_t%7D%20%5Csum_%7Bj=1%7D%5E%7Bd%7D%20%5Cfrac%7BX_t%5E%7B(j)%7D%7D%7B%5Csqrt%7BS_t%7D%7D%20dB_t%5E%7B(j)%7D%20%20+%20%5Cleft%5B%5Cfrac%7Bd%5Csigma%5E2%7D%7B4%7D%20-%20b%20S_t%5Cright%5D%20dt%20%5C%5C%0A&amp;=%20%5Csigma%20%5Csqrt%7BS_t%7D%20dW_t%20%20+%20%5Cleft%5B%5Cfrac%7Bd%5Csigma%5E2%7D%7B4%7D%20-%20b%20S_t%5Cright%5D%20dt%20%5C%5C%0A%5Cend%7Balign*%7D%0A"></p>
<p>where we have defined <img src="https://latex.codecogs.com/png.latex?dW_t%20=%20%5Csum_%7Bj=1%7D%5Ed%20%5Cfrac%7BX_t%5E%7B(j)%7D%7D%7B%5Csqrt%7BS_t%7D%7D%20dB_t%5E%7B(j)%7D">. It turns out that the process <img src="https://latex.codecogs.com/png.latex?(W_t,t%5Cgeq%200)"> is a standard brownian motion by Levy’s characterization theorem. If we accept this for a moment, we have the SDE:</p>
<p><span id="eq-cir-process-2"><img src="https://latex.codecogs.com/png.latex?%0AdS_t%20=%20%5Csigma%20%5Csqrt%7BS_t%7D%20dW_t%20+%20%5Cleft(%5Cfrac%7Bd%20%5Csigma%5E2%7D%7B4%7D%20-%20bS_t%5Cright)%20dt,%20%5Cquad%20S_0%20%3E%200%0A%5Ctag%7B22%7D"></span></p>
<p>This is a time-homogenous diffusion called the Cox-Ingersoll-Ross (CIR) process. Again, notice that there are no issues with square root, since <img src="https://latex.codecogs.com/png.latex?S_t"> is positive by construction! The SDE also makes sense if replace <img src="https://latex.codecogs.com/png.latex?d%5Csigma%5E2/4"> by a parameter <img src="https://latex.codecogs.com/png.latex?a"> in Equation&nbsp;21 as long as <img src="https://latex.codecogs.com/png.latex?a%20%5Cgeq%20%5Cfrac%7Bd%5Csigma%5E2%7D%7B4%7D">. This process is important for interest rates and stochastic volatility models.</p>
<p>Note that the local drift is <img src="https://latex.codecogs.com/png.latex?a%20-%20bS_t,%20a%5Cge%20%5Cfrac%7Bd%5Csigma%5E2%7D%7B4%7D">. This can be written as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aa%20-%20bS_t%20=%20b%5Cleft(%5Cfrac%7Bb%7D%7Ba%7D%20-%20S_t%20%5Cright)%0A%5Cend%7Balign*%7D"></p>
<p>This means that the local drift is negative if <img src="https://latex.codecogs.com/png.latex?S_t%20%3E%20%5Cfrac%7Ba%7D%7Bb%7D"> and it is positive if <img src="https://latex.codecogs.com/png.latex?S_t%20%3C%20%5Cfrac%7Ba%7D%7Bb%7D">. So, the SDE exhibits the same phenomenon as for the SDE of the Ornstein-Uhlenbeck process in Example&nbsp;5. In particular we should expect that for <img src="https://latex.codecogs.com/png.latex?t"> large, the process should fluctuate around the mean value <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Ba%7D%7Bb%7D">. The CIR model is therefore an example of a mean-reverting process. More generally, this hints to the fact, that the process is stationary in the long run.</p>
</div>
</section>
<section id="martingale-representation-and-levys-characterization" class="level2">
<h2 class="anchored" data-anchor-id="martingale-representation-and-levys-characterization">Martingale Representation and Levy’s Characterization</h2>
<p>We know very well by now, that an Ito integral is continuous martingale with respect to the Brownian filtration, whenever the integrand is in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D_c%5E2(T)">. What can we say about the converse? In other words, if we have a martingale with respect to the Brownian filtration, can it be expressed as an Ito integral for some integrand <img src="https://latex.codecogs.com/png.latex?(V_t,t%5Cleq%20T)">? Amazingly, the answer to this question is yes!</p>
<div id="thm-martingale-representation-theorem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5 (Martingale Representation Theorem.)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B_t,t%20%5Cgeq%200)"> be a Brownian motion with filtration <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t,t%5Cgeq%200)"> on <img src="https://latex.codecogs.com/png.latex?(%5COmega,%5Cmathcal%7BF%7D,%5Cmathbb%7BP%7D)">. Consider a martingale <img src="https://latex.codecogs.com/png.latex?(M_t,t%5Cleq%20T)"> with respect to this filtration. Then, there exists an adapted process <img src="https://latex.codecogs.com/png.latex?(V_t,t%20%5Cleq%20T)"> such that:</p>
<p><span id="eq-martingale-representation-theorem"><img src="https://latex.codecogs.com/png.latex?%0AM_t%20=%20M_0%20+%20%5Cint_0%5Et%20V_s%20dB_s,%20%5Cquad%20t%20%5Cleq%20T%0A%5Ctag%7B23%7D"></span></p>
<p>One striking fact of the result is that <img src="https://latex.codecogs.com/png.latex?(M_t,t%5Cleq%20T)"> ought to be continuous. In other words, we cannot construct a process with a jump that is a martingale adapted to Brownian motion!</p>
<p>Instead of the proving the theorem, we will see how the result is not too surprising with stronger assumptions. Instead of supposing that <img src="https://latex.codecogs.com/png.latex?M_t"> is <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_t"> measurable, take that <img src="https://latex.codecogs.com/png.latex?M_t"> is <img src="https://latex.codecogs.com/png.latex?%5Csigma(B_t)">-measurable. In other words, <img src="https://latex.codecogs.com/png.latex?M_t=h(B_t)"> for some function <img src="https://latex.codecogs.com/png.latex?h">. In the case where <img src="https://latex.codecogs.com/png.latex?h"> is smooth, then it is clear by Ito’s formula that the representation Equation&nbsp;23 holds with <img src="https://latex.codecogs.com/png.latex?V_s%20=%20h'(B_s)">.</p>
</div>
<p>An important consequence of Theorem&nbsp;5 is a third definition of Brownian motion.</p>
<div id="thm-levy-characterization-theorem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6 (One-dimensional Levy’s Characterization theorem)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(M_t,t%5Cin%20%5B0,T%5D)"> be a continuous martingale with respect to the filtration <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_t,t%20%5Cleq%20T)"> with <img src="https://latex.codecogs.com/png.latex?M_0%20=%200"> and with quadratic variation <img src="https://latex.codecogs.com/png.latex?%3CM%3E_t%20=%20t">. Then, <img src="https://latex.codecogs.com/png.latex?(M_t,t%5Cleq%20T)"> is a standard brownian motion.</p>
</div>
<p><em>Proof.</em></p>
<p>We first need to show that <img src="https://latex.codecogs.com/png.latex?M_t%20-%20M_s%20%5Csim%20%5Cmathcal%7BN%7D(0,t%20-%20s)"> or using the characteristic function approach, we need to show that <img src="https://latex.codecogs.com/png.latex?f_%7B(M_t%20-%20M_s)%7D(%5Ctheta)=%5Cmathbb%7BE%7D%5Be%5E%7B%5Ctheta%20(M_t%20-%20M_s)%7D%5D%20=%20e%5E%7B%5Cfrac%7B1%7D%7B2%7D%5Ctheta%5E2%20(t-s)%7D"> for constant <img src="https://latex.codecogs.com/png.latex?%5Ctheta">.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?f(t,x)%20=%20e%5E%7B%5Ctheta%20x%20-%20%5Cfrac%7B1%7D%7B2%7D%5Ctheta%5E2%20t%7D">.</p>
<p>By Ito’s formula, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Adf(t,M_t)%20&amp;=%20%5Ctheta%20e%5E%7B%5Ctheta%20M_t%20-%20%5Cfrac%7B1%7D%7B2%7D%5Ctheta%5E2%20t%7D%20dM_t%20+%20%5Cleft(-%5Cfrac%7B1%7D%7B2%7D%5Ctheta%5E2%20+%20%5Cfrac%7B1%7D%7B2%7D%20%5Ctheta%5E2%20%5Cright)e%5E%7B%5Ctheta%20M_t%20-%20%5Cfrac%7B1%7D%7B2%7D%5Ctheta%5E2%20t%7Ddt%5C%5C%0A&amp;=%20%5Ctheta%20f(t,M_t)%20dM_t%0A%5Cend%7Balign*%7D"></p>
<p>Integrating on both sides, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(t,M_t)%20-%20f(s,M_s)%20&amp;=%20%5Ctheta%20%5Cint_0%5Et%20f(u,M_u)%20dM_u%0A%5Cend%7Balign*%7D"></p>
<p>The ito integral <img src="https://latex.codecogs.com/png.latex?%5Cint_0%5Et%20f(s,M_s)%20dM_s"> is well-defined and its expectation is <img src="https://latex.codecogs.com/png.latex?0">. Hence, applying expectation operator on both sides, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Bf(t,M_t)%20-%20f(s,M_s)%5D%20&amp;=%20%5Ctheta%20%5Cmathbb%7BE%7D%20%5Cleft%5B%20%5Cint_0%5Et%20f(s,M_s)%20dM_s%5Cright%5D%5C%5C%0A&amp;=%200%0A%5Cend%7Balign*%7D"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?e%5E%7Bx%7D%20%5Cneq%200"> for all <img src="https://latex.codecogs.com/png.latex?x">, dividing by <img src="https://latex.codecogs.com/png.latex?f(s,M_s)">, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Cleft%5B%5Cfrac%7Bf(t,M_t)%7D%7Bf(s,M_s)%7D%5Cright%5D%20&amp;=%201%5C%5C%0A%5Cmathbb%7BE%7D%5Cleft%5B%5Cfrac%7Be%5E%7B%5Ctheta%20M_t%20-%20%5Cfrac%7B1%7D%7B2%7D%5Ctheta%5E2%20t%7D%7D%7Be%5E%7B%5Ctheta%20M_s%20-%20%5Cfrac%7B1%7D%7B2%7D%5Ctheta%5E2%20s%7D%7D%5Cright%5D%20&amp;=%201%5C%5C%0A%5Cmathbb%7BE%7D%5Cleft%5Be%5E%7B%5Ctheta(M_t%20-%20M_s)%7D%5Cright%5D%20&amp;=%20e%5E%7B%5Cfrac%7B1%7D%7B2%7D%5Ctheta%5E2(t-s)%7D%0A%5Cend%7Balign*%7D"></p>
<p>which is the moment generating function for the normal distribution with mean zero and variance <img src="https://latex.codecogs.com/png.latex?t-s">. So, <img src="https://latex.codecogs.com/png.latex?M_t%20-%20M_s%20%5Csim%20%5Cmathcal%7BN%7D(0,%20t%20-%20s)">.</p>
<p>Further, consider <img src="https://latex.codecogs.com/png.latex?t_1%20%5Cleq%20t_2%20%5Cleq%20t_3">. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5B(M_%7Bt_3%7D%20-%20M_%7Bt_2%7D)(M_%7Bt_2%7D%20-%20M_%7Bt_1%7D)%5D%20&amp;=%20%5Cmathbb%7BE%7D%5B%5Cmathbb%7BE%7D%5B(M_%7Bt_3%7D%20-%20M_%7Bt_2%7D)(M_%7Bt_2%7D%20-%20M_%7Bt_1%7D)%7C%5Cmathcal%7BF%7D_%7Bt_2%7D%5D%5D%20%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5B(M_%7Bt_2%7D%20-%20M_%7Bt_1%7D)%5Cmathbb%7BE%7D%5B(M_%7Bt_3%7D%20-%20M_%7Bt_2%7D)%7C%5Cmathcal%7BF%7D_%7Bt_2%7D%5D%5D%20%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5B(M_%7Bt_2%7D%20-%20M_%7Bt_1%7D)(M_%7Bt_2%7D%20-%20M_%7Bt_2%7D)%5D%20%5C%5C%0A&amp;=%200%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BM_%7Bt_3%7D%20-%20M_%7Bt_2%7D%7C%5Cmathcal%7BF%7D_%7Bt_2%7D%5D%20=%200"> follows from the fact that <img src="https://latex.codecogs.com/png.latex?(M_t,t%5Cgeq%200)"> is a martingale. Consequently, <img src="https://latex.codecogs.com/png.latex?M_%7Bt_3%7D%20-%20M_%7Bt_2%7D%20%5Cperp%20M_%7Bt_2%7D%20-%20M_%7Bt_1%7D"> and non-overlapping increments are independent.</p>
<p>Moreover, <img src="https://latex.codecogs.com/png.latex?M(0)%20=%200">. So, <img src="https://latex.codecogs.com/png.latex?(M_t,t%5Cgeq%200)"> is a standard brownian motion. This closes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
<section id="exercise-problems" class="level2">
<h2 class="anchored" data-anchor-id="exercise-problems">Exercise Problems</h2>
<div id="exr-power-of-bm" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 5</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(%5COmega,%5Cmathcal%7BF%7D,%5Cmathbb%7BP%7D)"> be a probability space and <img src="https://latex.codecogs.com/png.latex?(W_t,t%5Cgeq%200)"> be a standard Wiener process. Find the SDE for the random process <img src="https://latex.codecogs.com/png.latex?X_t%20=%20W_t%5En,%20n%20%5Cin%20%5Cmathbb%7BZ%7D%5E%7B+%7D">.</p>
<p>Show that</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5BW_t%5En%5D%20=%20%5Cfrac%7B1%7D%7B2%7Dn(n-1)%20%5Cint_0%5Et%20%5Cmathbb%7BE%7D%5Cleft%5BW_s%5E%7B(n-2)%7D%5Cright%5D%20ds%0A"></p>
<p>and using mathematical induction prove that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cmathbb%7BE%7D%5BW_t%5En%5D%20=%20%5Cbegin%7Bcases%7D%0A%5Cfrac%7Bn!%20t%5E%7Bn/2%7D%7D%7B2%5E%7Bn/2%7D%20%5Cleft(%5Cfrac%7Bn%7D%7B2%7D%5Cright)!%7D,%20&amp;%20n=2,4,6,%5Cldots%5C%5C%0A0,%20&amp;%20n=1,3,5,%5Cldots%0A%5Cend%7Bcases%7D%0A"></p>
</div>
<p><em>Solution.</em></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>Stochastic Calculus</category>
  <guid>https://quantdev.blog/posts/ito-processes-and-stochastic-diff-eqs/</guid>
  <pubDate>Sun, 07 Jul 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/ito-processes-and-stochastic-diff-eqs/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Multivariate Ito Calculus</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/multivariate_ito_calculus/</link>
  <description><![CDATA[ 





<section id="multivariate-ito-calculus." class="level1">
<h1>Multivariate Ito Calculus.</h1>
<p>We can generalize the theory to functions of several brownian motions. This unleashes the full power of Ito calculus.</p>
<section id="multidimensional-brownian-motion." class="level2">
<h2 class="anchored" data-anchor-id="multidimensional-brownian-motion.">Multidimensional Brownian motion.</h2>
<div id="def-brownian-motion-in-Rd" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Brownian motion in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7Bd%7D">.)</strong></span> Take <img src="https://latex.codecogs.com/png.latex?d%5Cin%5Cmathbf%7BN%7D">. Let <img src="https://latex.codecogs.com/png.latex?B%5E%7B(1)%7D,%5Cldots,B%5E%7B(d)%7D"> be independent standard Brownian motions in <img src="https://latex.codecogs.com/png.latex?(%5COmega,%5Cmathcal%7BF%7D,%5Cmathbb%7BP%7D)">. The process <img src="https://latex.codecogs.com/png.latex?(B_%7Bt%7D:t%5Cgeq0)"> taking values in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7Bd%7D"> defined by :</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AB_%7Bt%7D%20&amp;%20=(B_%7Bt%7D%5E%7B(1)%7D,%5Cldots,B_%7Bt%7D%5E%7B(d)%7D),%5Cquad%20t%5Cgeq0%0A%5Cend%7Baligned%7D">
<p>is called a <img src="https://latex.codecogs.com/png.latex?d-">dimensional Brownian motion or a Brownian motion in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7Bd%7D">.</p>
</div>
<p>The Brownian filtration <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_%7Bt%7D:t%5Cgeq0)"> is now composed of the information of all Brownian motions. In other words, it is given by the sigma-fields:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathcal%7BF%7D_%7Bt%7D%20&amp;%20=%5Csigma(B_%7Bs%7D%5E%7B(i)%7D,1%5Cleq%20i%5Cleq%20d,s%5Cleq%20t)%0A%5Cend%7Baligned%7D">
<p>For every outcome <img src="https://latex.codecogs.com/png.latex?%5Comega">, the path of trajectory of a <img src="https://latex.codecogs.com/png.latex?d-">dimensional Brownian motion is a curve in space parametrized by the time <img src="https://latex.codecogs.com/png.latex?t">:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0At%5Cmapsto%20B_%7Bt%7D(%5Comega)%20&amp;%20=(B_%7Bt%7D%5E%7B(1)%7D(%5Comega),B_%7Bt%7D%5E%7B(2)%7D(%5Comega),%5Cldots,B_%7Bt%7D%5E%7B(d)%7D(%5Comega))%0A%5Cend%7Baligned%7D">
<p>Of course, this curve is continuous, since each coordinate is. The below numerical project gives an example of one path of a two-dimensional brownian motion. This is a very rugged and intertwined curve! We might wonder, what it does as <img src="https://latex.codecogs.com/png.latex?t%5Cto%5Cinfty">. Does it wander around <img src="https://latex.codecogs.com/png.latex?(0,0)"> ad infinitum or does it eventually escape to infinity? We will answer this question in a later section. For doing so, we shall need a version of Ito’s formula for multi-dimensional Brownian motion. We finish this section by noticing that it is also easy to construct Brownian motions in higher dimensions for which the coordinates are correlated.</p>
<section id="d-brownian-motion" class="level3">
<h3 class="anchored" data-anchor-id="d-brownian-motion">2D Brownian Motion</h3>
<p>Consider a two-dimensional Brownian motion <img src="https://latex.codecogs.com/png.latex?(B_%7Bt%7D%5E%7B(1)%7D,B_%7B2%7D%5E%7B(2)%7D)"> starting at <img src="https://latex.codecogs.com/png.latex?(0,0)">.</p>
<p>Let’s plot one path of this Brownian motion on the plane <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7B2%7D"> on the plane in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7B2%7D"> on the time interval <img src="https://latex.codecogs.com/png.latex?%5B0,5%5D"> using a discretization of <img src="https://latex.codecogs.com/png.latex?0.001">.</p>
<p>We define <code>BrownianMotion2D</code> class.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> seaborn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> sns</span>
<span id="cb1-4"></span>
<span id="cb1-5">sns.set_style(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"whitegrid"</span>)</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> BrownianMotion2D:</span>
<span id="cb1-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Generate sample paths for a 2d-brownian motion</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb1-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(</span>
<span id="cb1-12">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb1-13">        endpoint : <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>,</span>
<span id="cb1-14">        discretization : <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span></span>
<span id="cb1-15">    ):</span>
<span id="cb1-16">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.endpoint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> endpoint</span>
<span id="cb1-17">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.discretization <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> discretization</span>
<span id="cb1-18"></span>
<span id="cb1-19">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> generate_paths(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, num_paths : <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>):</span>
<span id="cb1-20">        steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.discretization)</span>
<span id="cb1-21">        delta_z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.discretization) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.random.randn(num_paths,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,steps)</span>
<span id="cb1-22">        </span>
<span id="cb1-23">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># paths has shape [num_paths,2,num_steps]</span></span>
<span id="cb1-24">        paths <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.cumsum(delta_z,axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-25"></span>
<span id="cb1-26">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Brownian motion has position (0,0) at time t=0</span></span>
<span id="cb1-27">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append initial position </span></span>
<span id="cb1-28">        init_position <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((num_paths,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb1-29">        paths <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.append(init_position,paths,axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-30"></span>
<span id="cb1-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> paths</span></code></pre></div>
</div>
<p>We can then configure and use <code>BrownianMotion2D</code> objects as we please.</p>
<div class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">bm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BrownianMotion2D(endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>,discretization<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>)</span>
<span id="cb2-2">paths <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> bm.generate_paths(num_paths<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-3">path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> paths[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb2-4"></span>
<span id="cb2-5"></span>
<span id="cb2-6">plt.xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$x$'</span>)</span>
<span id="cb2-7">plt.ylabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$y$'</span>)</span>
<span id="cb2-8">plt.title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'2D-Brownian motion'</span>)</span>
<span id="cb2-9">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-10">plt.plot(path[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],path[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>)</span>
<span id="cb2-11">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/multivariate_ito_calculus/index_files/figure-html/cell-3-output-1.png" width="594" height="447" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="brownian-motion-with-correlated-coordinates" class="level3">
<h3 class="anchored" data-anchor-id="brownian-motion-with-correlated-coordinates">Brownian motion with correlated coordinates</h3>
<div id="exm-brownian-motion-with-correlated-coordinates" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (Brownian motion with correlated coordinates)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B_%7Bt%7D:t%5Cgeq0)"> be a two dimensional brownian motion. Let <img src="https://latex.codecogs.com/png.latex?-1%3C%5Crho%3C1">. We construct the two dimensional process as follows: <img src="https://latex.codecogs.com/png.latex?W_%7Bt%7D=(W_%7Bt%7D%5E%7B(1)%7D,W_%7Bt%7D%5E%7B(2)%7D)"> where:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AW_%7Bt%7D%5E%7B(1)%7D%20&amp;%20=B_%7Bt%7D%5E%7B(1)%7D%5C%5C%0AW_%7Bt%7D%5E%7B(2)%7D%20&amp;%20=%5Crho%20B_%7Bt%7D%5E%7B(1)%7D+%5Csqrt%7B1-%5Crho%5E%7B2%7D%7DB_%7Bt%7D%5E%7B(2)%7D%0A%5Cend%7Baligned%7D">
<p><img src="https://latex.codecogs.com/png.latex?W_%7Bt%7D%5E%7B(1)%7D=B_%7Bt%7D%5E%7B(1)%7D"> is Gaussian with mean <img src="https://latex.codecogs.com/png.latex?0"> and variance <img src="https://latex.codecogs.com/png.latex?t">. Since, <img src="https://latex.codecogs.com/png.latex?B_%7Bt%7D%5E%7B(1)%7D"> and <img src="https://latex.codecogs.com/png.latex?B_%7Bt%7D%5E%7B(2)%7D">are independent gaussian random variables and the sum of IID Gaussians is Gaussian, <img src="https://latex.codecogs.com/png.latex?W_%7Bt%7D%5E%7B(2)%7D"> is Gaussian with mean <img src="https://latex.codecogs.com/png.latex?0"> and variance <img src="https://latex.codecogs.com/png.latex?t">. The covariance between <img src="https://latex.codecogs.com/png.latex?W_%7Bt%7D%5E%7B(1)%7D"> and <img src="https://latex.codecogs.com/png.latex?W_%7Bt%7D%5E%7B(2)%7D"> is:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cmathbf%7BE%7D%5BW_%7Bt%7D%5E%7B(1)%7DW_%7Bt%7D%5E%7B(2)%7D%5D%20&amp;%20=%5Cmathbf%7BE%7D%5BB_%7Bt%7D%5E%7B(1)%7D(%5Crho%20B_%7Bt%7D%5E%7B(1)%7D+%5Csqrt%7B1-%5Crho%5E%7B2%7D%7DB_%7Bt%7D%5E%7B(2)%7D)%5D%5C%5C%0A&amp;%20=%5Cmathbf%7BE%7D%5B%5Crho(B_%7Bt%7D%5E%7B(1)%7D)%5E%7B2%7D+%5Csqrt%7B1-%5Crho%5E%7B2%7D%7DB_%7Bt%7D%5E%7B(1)%7DB_%7Bt%7D%5E%7B(2)%7D%5D%5C%5C%0A&amp;%20=%5Crho%20t%0A%5Cend%7Baligned%7D">
<p>Hence, the coordinates at time <img src="https://latex.codecogs.com/png.latex?t"> are not independent.</p>
</div>
<p>Consider now the process <img src="https://latex.codecogs.com/png.latex?(W_%7Bt%7D:t%5Cgeq0)"> for <img src="https://latex.codecogs.com/png.latex?%5Crho=1/2"> as in example 2. Let’s plot one path of this process on the plane <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7B2%7D"> on the time-interval <img src="https://latex.codecogs.com/png.latex?%5B0,5%5D"> using a discretization of <img src="https://latex.codecogs.com/png.latex?0.001">.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> BrownianMotion2DWithCorrelatedCoords(BrownianMotion2D):</span>
<span id="cb3-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Generate sample paths for a 2d-brownian motion</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    have correlated coordiantes</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb3-6"></span>
<span id="cb3-7">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(</span>
<span id="cb3-8">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, </span>
<span id="cb3-9">        endpoint: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, </span>
<span id="cb3-10">        discretization: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, </span>
<span id="cb3-11">        rho: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb3-12">    ):</span>
<span id="cb3-13">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.endpoint <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> endpoint</span>
<span id="cb3-14">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.discretization <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> discretization</span>
<span id="cb3-15">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rho <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rho</span>
<span id="cb3-16"></span>
<span id="cb3-17">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> generate_paths(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, num_paths: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>):</span>
<span id="cb3-18"></span>
<span id="cb3-19">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Call the base class generate_paths() method to generate a pair of</span></span>
<span id="cb3-20">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># independent brownian motion paths. It returns a tensor of</span></span>
<span id="cb3-21">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># shape (num_paths, 2, num_steps)</span></span>
<span id="cb3-22">        paths <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().generate_paths(num_paths<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>num_paths)</span>
<span id="cb3-23"></span>
<span id="cb3-24">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the brownian motions B1(t) and B2(t)</span></span>
<span id="cb3-25">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># B1(t) and B2(t) have dimensions [num_paths,num_steps]</span></span>
<span id="cb3-26">        x_coord <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> paths[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, :]</span>
<span id="cb3-27">        y_coord <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> paths[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, :]</span>
<span id="cb3-28"></span>
<span id="cb3-29">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply the transformation</span></span>
<span id="cb3-30">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># W1(t) = B1(t)</span></span>
<span id="cb3-31">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># W2(t) = rho * B1(t) + sqrt(1 - rho**2) B2(t)</span></span>
<span id="cb3-32">        x_coord <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x_coord</span>
<span id="cb3-33">        y_coord <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rho <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_coord <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rho<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_coord</span>
<span id="cb3-34"></span>
<span id="cb3-35">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assemble back the x- and y- coordinates</span></span>
<span id="cb3-36">        x_coord <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.expand_dims(x_coord, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-37">        y_coord <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.expand_dims(y_coord, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-38"></span>
<span id="cb3-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Return a tensor of shape [num_paths,d=2,num_steps]</span></span>
<span id="cb3-40">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.concatenate([x_coord, y_coord], axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<p>Let’s configure the <code>BrownianMotion2DWithCorrelatedCoords</code> engine with the settings <code>endpoint=5.0</code>, <code>discretization=0.001</code> and <code>rho=0.5</code> and generate a sample path.</p>
<div class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">bm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BrownianMotion2DWithCorrelatedCoords(</span>
<span id="cb4-2">    endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>,</span>
<span id="cb4-3">    discretization<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>,</span>
<span id="cb4-4">    rho<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span></span>
<span id="cb4-5">)</span>
<span id="cb4-6">paths <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> bm.generate_paths(num_paths<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-7">path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> paths[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb4-8"></span>
<span id="cb4-9">plt.xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$x$'</span>)</span>
<span id="cb4-10">plt.ylabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$y$'</span>)</span>
<span id="cb4-11">plt.title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'Correlated Brownian motion $W(t)=(W^{(1)}(t),W^{(2)}(t))$'</span>)</span>
<span id="cb4-12">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb4-13">plt.plot(path[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],path[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blue'</span>)</span>
<span id="cb4-14">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/multivariate_ito_calculus/index_files/figure-html/cell-5-output-1.png" width="598" height="452" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">plt.xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$t$'</span>)</span>
<span id="cb5-2">plt.ylabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$W_t$'</span>)</span>
<span id="cb5-3">plt.title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'Correlated Brownian motion paths'</span>)</span>
<span id="cb5-4">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb5-5">t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,stop<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>,num<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5001</span>)</span>
<span id="cb5-6">plt.plot(t,path[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span>
<span id="cb5-7">plt.plot(t,path[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>)</span>
<span id="cb5-8">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/multivariate_ito_calculus/index_files/figure-html/cell-6-output-1.png" width="584" height="447" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="itos-formula." class="level2">
<h2 class="anchored" data-anchor-id="itos-formula.">Ito’s Formula.</h2>
<div id="thm-ito-formula-function-of-d-brownian-motions" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Ito’s Formula.)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B_%7Bt%7D:t%5Cgeq0)"> be a <img src="https://latex.codecogs.com/png.latex?d-">dimensional brownian motion. Consider <img src="https://latex.codecogs.com/png.latex?f%5Cin%5Cmathcal%7BC%7D%5E%7B2%7D(%5Cmathbf%7BR%7D%5E%7Bd%7D)">. Then, we have with probability one that for all <img src="https://latex.codecogs.com/png.latex?t%5Cgeq0">:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Af(B_%7Bt%7D)-f(B_%7B0%7D)%20&amp;%20=%5Csum_%7Bi=1%7D%5E%7Bd%7D%5Cint_%7B0%7D%5E%7Bt%7D%5Cpartial_%7Bx_%7Bi%7D%7Df(B_%7Bs%7D)dB_%7Bs%7D%5E%7B(i)%7D+%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7D%5Csum_%7Bi=1%7D%5E%7Bd%7D%5Cpartial_%7Bx_%7Bi%7D%7D%5E%7B2%7Df(B_%7Bs%7D)ds%5Clabel%7Beq:multidimensional-ito-formula%7D%0A%5Cend%7Baligned%7D">
</div>
<div id="rem-equality-of-processes" class="proof remark">
<p><span class="proof-title"><em>Remark 1</em>. </span>I stress that, as in the one-dimensional case, Ito’s formula is an equality of processes (and not an equality in distribution). Thus, the processes on both sides must agree for each path.</p>
</div>
<p>Interestingly, the mixed partials <img src="https://latex.codecogs.com/png.latex?%5Cpartial_%7Bx_%7Bi%7Dx_%7Bj%7D%7Df(B_%7Bs%7D)">, <img src="https://latex.codecogs.com/png.latex?i%5Cneq%20j"> do not appear in the formula! We see from Ito’s formula that the process <img src="https://latex.codecogs.com/png.latex?f(B_%7Bt%7D)"> can be represented as a sum of <img src="https://latex.codecogs.com/png.latex?d+1"> processes: <img src="https://latex.codecogs.com/png.latex?d"> Ito integrals and one Riemann integral (which is a process of finite variation). In vector notation, the formula takes the form:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Af(B_%7Bt%7D)-f(B_%7B0%7D)%20&amp;%20=%5Cint_%7B0%7D%5E%7Bt%7D%5Cnabla%20f(B_%7Bs%7D)%5E%7BT%7DdB_%7Bs%7D+%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7D%5Cnabla%5E%7B2%7Df(B_%7Bs%7D)ds%0A%5Cend%7Baligned%7D">
<p>where it is understood that the first term is the sum of the <img src="https://latex.codecogs.com/png.latex?d"> Ito integrals in the equation. The symbol <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E%7B2%7D"> is the Laplacian of <img src="https://latex.codecogs.com/png.latex?f">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=1%7D%5E%7Bd%7D%5Cfrac%7B%5Cpartial%5E%7B2%7D%7D%7B%5Cpartial%20x_%7Bi%7D%5E%7B2%7D%7Df(B_%7Bs%7D%5E%7B(1)%7D,%5Cldots,B_%7Bs%7D%5E%7B(d)%7D)ds"></p>
<p>In differential form, Ito’s formula becomes very neat:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Adf(B_%7Bt%7D)%20&amp;%20=%5Csum_%7Bi=1%7D%5E%7Bd%7D%5Cpartial_%7Bx_%7Bi%7D%7Df(B_%7Bs%7D)dB_%7Bt%7D%5E%7B(i)%7D+%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi=1%7D%5E%7Bd%7D%5Cpartial_%7Bx_%7Bi%7D%7D%5E%7B2%7Df(B_%7Bs%7D)dt=%5Cnabla%20f(B_%7Bt%7D)%5E%7BT%7DdB_%7Bs%7D+%5Cfrac%7B1%7D%7B2%7D%5Cnabla%5E%7B2%7Df(B_%7Bt%7D)dt%0A%5Cend%7Baligned%7D">
<div id="exm-ito-formula-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 2</strong></span> Consider the functions (1) <img src="https://latex.codecogs.com/png.latex?f(x_%7B1%7D,x_%7B2%7D)=x_%7B1%7D%5E%7B2%7D+x_%7B2%7D%5E%7B2%7D"> (2) <img src="https://latex.codecogs.com/png.latex?f(x_%7B1%7D,x_%7B2%7D)=e%5E%7Bx_%7B1%7D%7D%5Ccos%20x_%7B2%7D"> and the processes <img src="https://latex.codecogs.com/png.latex?(X_%7Bt%7D:t%5Cgeq0)"> and <img src="https://latex.codecogs.com/png.latex?(Y_%7Bt%7D:t%5Cgeq0)">. If we apply Ito’s formula to the first process, we have:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AX_%7Bt%7D%20&amp;%20=%5Cint_%7B0%7D%5E%7Bt%7D2B_%7Bs%7D%5E%7B(1)%7DdB_%7Bs%7D%5E%7B(1)%7D+%5Cint_%7B0%7D%5E%7Bt%7D2B_%7Bs%7D%5E%7B(2)%7DdB_%7Bs%7D%5E%7B(2)%7D+%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7D(4dt)%5C%5C%0A&amp;%20=%5Cint_%7B0%7D%5E%7Bt%7D2B_%7Bs%7D%5E%7B(1)%7DdB_%7Bs%7D%5E%7B(1)%7D+%5Cint_%7B0%7D%5E%7Bt%7D2B_%7Bs%7D%5E%7B(2)%7DdB_%7Bs%7D%5E%7B(2)%7D+2t%0A%5Cend%7Baligned%7D">
<p>The second process gives:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0AY_%7Bt%7D%20&amp;%20=%5Ccos%20B_%7Bs%7D%5E%7B(2)%7D%5Cint_%7B0%7D%5E%7Bt%7De%5E%7BB_%7Bs%7D%5E%7B(1)%7D%7DdB_%7Bs%7D%5E%7B(1)%7D-e%5E%7BB_%7Bs%7D%5E%7B(1)%7D%7D%5Cint%5Csin%20B_%7Bs%7D%5E%7B(2)%7DdB_%7Bs%7D%5E%7B(2)%7D+%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7D%5Cleft(e%5E%7BB_%7Bs%7D%5E%7B(1)%7D%7D%5Ccos%20B_%7Bs%7D%5E%7B(2)%7D-e%5E%7BB_%7Bs%7D%5E%7B(1)%7D%7D%5Ccos%20B_%7Bs%7D%5E%7B(2)%7D%5Cright)dt%5C%5C%0A&amp;%20=1+%5Ccos%20B_%7Bs%7D%5E%7B(2)%7D%5Cint_%7B0%7D%5E%7Bt%7De%5E%7BB_%7Bs%7D%5E%7B(1)%7D%7DdB_%7Bs%7D%5E%7B(1)%7D-e%5E%7BB_%7Bs%7D%5E%7B(1)%7D%7D%5Cint%5Csin%20B_%7Bs%7D%5E%7B(2)%7DdB_%7Bs%7D%5E%7B(2)%7D%0A%5Cend%7Baligned%7D">
</div>
<div id="exm-cross-variation-of-b1-and-b2" class="theorem example">
<p><span class="theorem-title"><strong>Example 3</strong></span> (Cross-Variation of <img src="https://latex.codecogs.com/png.latex?B_%7Bt%7D%5E%7B(1)%7D"> and <img src="https://latex.codecogs.com/png.latex?B_%7Bt%7D%5E%7B(2)%7D">). Let <img src="https://latex.codecogs.com/png.latex?(t_%7Bj%7D:j%5Cleq%20n)"> be a sequence of partitions of <img src="https://latex.codecogs.com/png.latex?%5B0,t%5D"> such that <img src="https://latex.codecogs.com/png.latex?%5Cmax_%7Bj%7D%7Ct_%7Bj+1%7D-t_%7Bj%7D%7C%5Cto0"> as <img src="https://latex.codecogs.com/png.latex?n%5Cto%5Cinfty">. Prove that:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Clim_%7Bn%5Cto%5Cinfty%7D%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(B_%7Bt_%7Bj+1%7D%7D%5E%7B(1)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(1)%7D)(B_%7Bt_%7Bj+1%7D%7D%5E%7B(2)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(2)%7D)%20&amp;%20=0%5Cquad%5Ctext%7Bin%20%7D%20L%5E%7B2%7D%0A%5Cend%7Baligned%7D">
<p>This justifies the rule <img src="https://latex.codecogs.com/png.latex?dB_%7Bt%7D%5E%7B(1)%7D%5Ccdot%20dB_%7Bt%7D%5E%7B(2)%7D=0">.</p>
<p><em>Hint</em>: Just compute the second moment of the sum.</p>
</div>
<div id="sol-solution-1" class="proof solution">
<p><span class="proof-title"><em>Solution 1</em>. </span>We have:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A&amp;%20%5Cmathbf%7BE%7D%5Cleft%5B%5Cleft(%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(B_%7Bt_%7Bj+1%7D%7D%5E%7B(1)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(1)%7D)(B_%7Bt_%7Bj+1%7D%7D%5E%7B(2)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(2)%7D)%5Cright)%5E%7B2%7D%5Cright%5D%5C%5C%0A=%20&amp;%20%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cmathbf%7BE%7D%5B(B_%7Bt_%7Bj+1%7D%7D%5E%7B(1)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(1)%7D)%5E%7B2%7D(B_%7Bt_%7Bj+1%7D%7D%5E%7B(2)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(2)%7D)%5E%7B2%7D%5D%5C%5C%0A+%20&amp;%202%5Csum_%7Bj%3Ck%7D%5Cmathbf%7BE%7D%5Cleft%5B(B_%7Bt_%7Bj+1%7D%7D%5E%7B(1)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(1)%7D)(B_%7Bt_%7Bk+1%7D%7D%5E%7B(1)%7D-B_%7Bt_%7Bk%7D%7D%5E%7B(1)%7D)(B_%7Bt_%7Bj+1%7D%7D%5E%7B(2)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(2)%7D)(B_%7Bt_%7Bk+1%7D%7D%5E%7B(2)%7D-B_%7Bt_%7Bk%7D%7D%5E%7B(2)%7D)%5Cright%5D%0A%5Cend%7Baligned%7D">
<p>Both these expectations are zero, since the brownian motions are independent and non-overlapping increments are independent.</p>
<p>Consequently, <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(B_%7Bt_%7Bj+1%7D%7D%5E%7B(1)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(1)%7D)(B_%7Bt_%7Bj+1%7D%7D%5E%7B(2)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(2)%7D)%5Cto0"> in the <img src="https://latex.codecogs.com/png.latex?L%5E%7B2%7D"> sense.</p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>The proof of the formula follows the usual recipe: Taylor’s theorem together with the quadratic variation and the cross-variation. In this case, we do get a cross-variation between the different Brownian motions. More precisely, consider a partition <img src="https://latex.codecogs.com/png.latex?(t_%7Bj%7D:j%5Cleq%20n)"> of <img src="https://latex.codecogs.com/png.latex?%5B0,t%5D">. Then we can write:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Af(B_%7Bt%7D)-f(B_%7B0%7D)%20&amp;%20=%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(f(B_%7Bt_%7Bj+1%7D%7D)-f(B_%7Bt_%7Bj%7D%7D))%0A%5Cend%7Baligned%7D">
<p>We can apply the Taylor’s series expansion for each <img src="https://latex.codecogs.com/png.latex?j"> to get:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Af(B_%7Bt%7D)-f(B_%7B0%7D)%20&amp;%20=%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cnabla%20f(B_%7Bt_%7Bj%7D%7D)(B_%7Bt_%7Bj+1%7D%7D-B_%7Bt_%7Bj%7D%7D)%5C%5C%0A&amp;%20+%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bj=0%7D%5E%7Bn-1%7D(B_%7Bt_%7Bj+1%7D%7D-B_%7Bt_%7Bj%7D%7D)%5E%7BT%7DHf(B_%7Bt_%7Bj%7D%7D)(B_%7Bt_%7Bj+1%7D%7D-B_%7Bt_%7Bj%7D%7D)+%5Cmathcal%7BE%7D%0A%5Cend%7Baligned%7D">
<p>where <img src="https://latex.codecogs.com/png.latex?Hf"> is the Hessian matrix of <img src="https://latex.codecogs.com/png.latex?f">. We wrote the expansion using the vector notation to be economical. Let’s keep in mind that each term is a sum over the derivatives. The first term will converge to <img src="https://latex.codecogs.com/png.latex?d"> Ito integrals as in the one-dimensional case. Now, the summand in the second term is:</p>
<p><img src="https://latex.codecogs.com/png.latex?(B_%7Bt_%7Bj+1%7D%7D%5E%7B(1)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(1)%7D,%5Cldots,B_%7Bt_%7Bj+1%7D%7D%5E%7B(d)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(d)%7D)%5Cleft%5B%5Cbegin%7Barray%7D%7Bccc%7D%0A%5Cpartial_%7Bx_%7B1%7D%7D%5E%7B2%7Df(B_%7Bt_%7Bj%7D%7D)%20&amp;%20%5Cldots%20&amp;%20%5Cpartial_%7Bx_%7B1%7Dx_%7Bd%7D%7D%5E%7B2%7Df(B_%7Bt_%7Bj%7D%7D)%5C%5C%0A%5Cvdots%20&amp;%20%5Cddots%5C%5C%0A%5Cpartial_%7Bx_%7Bd%7Dx_%7B1%7D%7D%5E%7B2%7Df(B_%7Bt_%7Bj%7D%7D)%20&amp;%20%20&amp;%20%5Cpartial_%7Bx_%7Bd%7D%7D%5E%7B2%7Df(B_%7Bt_%7Bj%7D%7D)%0A%5Cend%7Barray%7D%5Cright%5D%5Cleft%5B%5Cbegin%7Barray%7D%7Bc%7D%0AB_%7Bt_%7Bj+1%7D%7D%5E%7B(1)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(1)%7D%5C%5C%0A%5Cvdots%5C%5C%0AB_%7Bt_%7Bj+1%7D%7D%5E%7B(d)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(d)%7D%0A%5Cend%7Barray%7D%5Cright%5D"></p>
<p>So, <img src="https://latex.codecogs.com/png.latex?(B_%7Bt_%7Bj+1%7D%7D%5E%7B(i)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(i)%7D)"> is pre-multiplied with the term <img src="https://latex.codecogs.com/png.latex?%5Cpartial_%7Bx_%7Bi%7Dx_%7Bk%7D%7D%5E%7B2%7Df(B_%7Bt_%7Bj%7D%7D)"> and it is post-multiplied <img src="https://latex.codecogs.com/png.latex?(B_%7Bt_%7Bj+1%7D%7D%5E%7B(k)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(k)%7D)">. Consequently, the second term in the Taylor’s series expansion can be re-written as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bj=0%7D%5E%7Bn-1%7D%5Cleft(%5Csum_%7Bi=1%7D%5E%7Bd%7D%5Cpartial_%7Bx_%7Bi%7D%7D%5E%7B2%7Df(B_%7Bt_%7Bj%7D%7D)(B_%7Bt_%7Bj+1%7D%7D%5E%7B(i)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(i)%7D)%5E%7B2%7D+%5Csum_%7B1%5Cleq%20i%3Ck%5Cleq%20d%7D%5Cpartial_%7Bx_%7Bi%7Dx_%7Bk%7D%7D%5E%7B2%7Df(B_%7Bt_%7Bj%7D%7D)(B_%7Bt_%7Bj+1%7D%7D%5E%7B(i)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(i)%7D)(B_%7Bt_%7Bj+1%7D%7D%5E%7B(k)%7D-B_%7Bt_%7Bj%7D%7D%5E%7B(k)%7D)%5Cright)"></p>
<p>The second term on the right converges to <img src="https://latex.codecogs.com/png.latex?0"> in the <img src="https://latex.codecogs.com/png.latex?L%5E%7B2%7D"> sense when <img src="https://latex.codecogs.com/png.latex?i%5Cneq%20k">, from exercise. This explains why the mixed derivatives disappear in the multi-dimensional Ito’s formula. As for the case <img src="https://latex.codecogs.com/png.latex?i=k">, it reduces to the quadratic variation as in the one-dimensional case. This is where the Riemann integral arises, after suitable conditioning on <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D_%7Bt_%7Bj%7D%7D">, the sigma-field generated by <img src="https://latex.codecogs.com/png.latex?B_%7Bs%7D">, <img src="https://latex.codecogs.com/png.latex?s%5Cleq%20t_%7Bj%7D">.</p>
</div>
<p>As in the one-dimensional case,it is not necessary to learn Ito’s formula by heart. It suffices to write the differential of the function <img src="https://latex.codecogs.com/png.latex?f"> to second order. We can then apply the rules of multivariate Ito calculus:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Ccdot"></th>
<th style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?dt"></th>
<th style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?dB_%7Bt%7D%5E%7B(1)%7D"></th>
<th style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?dB_%7Bt%7D%5E%7B(2)%7D"></th>
<th style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cldots"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?dt"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?dB_%7Bt%7D%5E%7B(1)%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?dt"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?dB_%7Bt%7D%5E%7B(2)%7D"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?dt"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?%5Cldots"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?0"></td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?dt"></td>
</tr>
</tbody>
</table>
<p>Note that the rule <img src="https://latex.codecogs.com/png.latex?dB_%7Bt%7D%5E%7B(i)%7DdB_%7Bt%7D%5E%7B(j)%7D=0"> for <img src="https://latex.codecogs.com/png.latex?i%5Cneq%20j"> is being motivated by the cross-variation result.</p>
<p>How can we construct martingales using the Ito’s formula? Recall that an Ito integral <img src="https://latex.codecogs.com/png.latex?(%5Cint_%7B0%7D%5E%7Bt%7DX_%7Bs%7DdB_%7Bs%7D,t%5Cleq%20T)"> is a martingale whenever the integrand is in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D_%7Bc%7D%5E%7B2%7D(T)">, the space of adapted processes with continuous paths and for which:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cint_%7B0%7D%5E%7BT%7D%5Cmathbf%7BE%7D%5BX_%7Bs%7D%5E%7B2%7D%5Dds%20&amp;%20%3C%5Cinfty%0A%5Cend%7Baligned%7D">
<p>The only difference here is that the integrand is a function of many Brownian motions. However, the integrands involved in the Ito integrals of the multidimensional Ito’s formula are clearly adapted to the filtration <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_%7Bt%7D:t%5Cgeq0)"> of <img src="https://latex.codecogs.com/png.latex?(B_%7Bt%7D:t%5Cgeq0)"> as they are functions of the Brownian motion at the time. The arguments of Ito integral in and apply verbatim, if we take the definition of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D_%7Bc%7D%5E%7B2%7D(t)"> with the filtration <img src="https://latex.codecogs.com/png.latex?(%5Cmathcal%7BF%7D_%7Bt%7D:t%5Cgeq0)"> of <img src="https://latex.codecogs.com/png.latex?(B_%7Bt%7D:t%5Cgeq0)">. With this in mind, we have the following corollary.</p>
<section id="brownian-martingales" class="level3">
<h3 class="anchored" data-anchor-id="brownian-martingales">Brownian Martingales</h3>
<div id="cor-brownian-martingales" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 1 (Brownian Martingales.)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B_%7Bt%7D:t%5Cgeq0)"> be a Brownian motion in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7Bd%7D">. Consider <img src="https://latex.codecogs.com/png.latex?f%5Cin%5Cmathcal%7BC%7D%5E%7B2%7D(%5Cmathbf%7BR%7D%5E%7Bd%7D)"> such that processes <img src="https://latex.codecogs.com/png.latex?(%5Cpartial_%7Bx%20%7Bi%7D%7Df(B_%7Bt%7D),t%5Cleq%20T)%5Cin%5Cmathcal%7BL%7D_%7Bc%7D%5E%7B2%7D(T)"> for every <img src="https://latex.codecogs.com/png.latex?i%5Cleq%20d">. Then, the process :</p>
<p><img src="https://latex.codecogs.com/png.latex?f(B_%7Bt%7D)-%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7D%5Cnabla%5E%7B2%7Df(B_%7Bs%7D)ds,%5Cquad%20t%5Cleq%20T"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E%7B2%7D=%5Csum_%7Bi=1%7D%5E%7Bd%7D%5Cpartial_%7Bx_%7Bi%7D%7D%5E%7B2%7D"> is the Laplacian, is a martingale for the Brownian filtration.</p>
</div>
<p>For example, consider the processes <img src="https://latex.codecogs.com/png.latex?X_%7Bt%7D=(B_%7Bt%7D%5E%7B(1)%7D)%5E%7B2%7D+(B_%7Bt%7D%5E%7B(2)%7D)%5E%7B2%7D"> and <img src="https://latex.codecogs.com/png.latex?Y_%7Bt%7D=%5Cexp(B_%7Bt%7D%5E%7B(1)%7D)%5Ccos(B_%7Bt%7D%5E%7B(2)%7D)">. Then, we have :</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7D%5Cnabla%5E%7B2%7DX_%7Bs%7Dds=%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7D4ds=2t"></p>
<p>and</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0A%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7D%5Cnabla%5E%7B2%7DY_%7Bs%7Dds%20&amp;%20=%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5E%7Bt%7D0%5Ccdot%20ds=0%0A%5Cend%7Baligned%7D">
<p>Thus, the processes <img src="https://latex.codecogs.com/png.latex?X_%7Bt%7D-2t"> and <img src="https://latex.codecogs.com/png.latex?Y_%7Bt%7D"> are martingales for the Brownian filtration. In one dimension, there are no interesting martingales constructed with functions of <em>space</em> only. Indeed, <img src="https://latex.codecogs.com/png.latex?(f(B_%7Bt%7D):t%5Cgeq0)"> is a martingale if and only if <img src="https://latex.codecogs.com/png.latex?f''(x)=0"> for all <img src="https://latex.codecogs.com/png.latex?x">. But, such functions are of the form <img src="https://latex.codecogs.com/png.latex?f(x)=ax+b">, <img src="https://latex.codecogs.com/png.latex?a,b%5Cin%5Cmathbf%7BR%7D">. In other words, in one dimension, Brownian martingales of the form <img src="https://latex.codecogs.com/png.latex?f(B_%7Bt%7D)"> are simply <img src="https://latex.codecogs.com/png.latex?aB_%7Bt%7D+b">. Not very surprising! The situation is very different in higher dimensions. Indeed, corollary implies that <img src="https://latex.codecogs.com/png.latex?f(B_%7Bt%7D)"> is a martingale whenever <img src="https://latex.codecogs.com/png.latex?f"> is a harmonic function:</p>
<div id="def-harmonic-function" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 (Harmonic function.)</strong></span> A function <img src="https://latex.codecogs.com/png.latex?f:%5Cmathbf%7BR%7D%5E%7Bd%7D%5Cto%5Cmathbf%7BR%7D"> is harmonic in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7Bd%7D"> if and only if <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E%7B2%7Df(x)%5Cequiv0"> for all <img src="https://latex.codecogs.com/png.latex?x%5Cin%5Cmathbf%7BR%7D%5E%7Bd%7D">. More generally, a function <img src="https://latex.codecogs.com/png.latex?f:%5Cmathbf%7BR%7D%5E%7Bd%7D%5Cto%5Cmathbf%7BR%7D"> is harmonic in the region <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D%5Csubset%5Cmathbf%7BR%7D%5E%7Bd%7D"> if and only if <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E%7B2%7Df(x)%5Cequiv0"> for all <img src="https://latex.codecogs.com/png.latex?x%5Cin%5Cmathcal%7BO%7D">.</p>
</div>
<p>Note that the function <img src="https://latex.codecogs.com/png.latex?f(x)=e%5E%7Bx_%7B1%7D%7D%5Ccos%20x_%7B2%7D"> is harmonic in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7Bd%7D">. This is why the process <img src="https://latex.codecogs.com/png.latex?Y_%7Bt%7D=%5Cexp(B_%7Bt%7D%5E%7B(1)%7D)%5Ccos(B_%7Bt%7D%5E%7B(2)%7D)"> is a martingale. The distinction to a subset of <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7Bd%7D"> in the above definition is important since it may happen that the function is harmonic only in a subset of the space; see for example equation. It is possible to define a Brownian martingale in such cases by considering the process until it exits the region. This will turn out to be important as we move ahead.</p>
<p>The multidimensional Ito’s formula generalizes to functions of time and space as in proposition:</p>
<div id="def-function-in-C12" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3</strong></span> A function <img src="https://latex.codecogs.com/png.latex?f:%5B0,%5Cinfty)%5Ctimes%5Cmathbf%7BR%7D%5E%7Bd%7D%5Cto%5Cmathbf%7BR%7D"> is in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BC%7D%5E%7B1,2%7D(%5B0,T%5D%5Ctimes%5Cmathbf%7BR%7D%5E%7Bd%7D)"> if the partial derivative in <em>time</em> :</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7Df(t,%5Cmathbf%7Bx%7D)"></p>
<p>exists and is continuous and the second order partial derivatives in space:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%5E%7B2%7D%7D%7B%5Cpartial%20x_%7Bi%7D%5E%7B2%7D%7Df(t,x_%7B1%7D,x_%7B2%7D,%5Cldots,x_%7Bi%7D,%5Cldots,x_%7Bd%7D),%5Cquad1%5Cleq%20i%5Cleq%20d"></p>
<p>exist and are continuous.</p>
</div>
</section>
</section>
<section id="multidimensional-ito-formula---functions-of-space-and-time" class="level2">
<h2 class="anchored" data-anchor-id="multidimensional-ito-formula---functions-of-space-and-time">Multidimensional Ito formula - Functions of space and time</h2>
<div id="thm-Multidimensional-Ito-formula-functions-of-space-and-time" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Multidimensional Ito’s formula for functions of space and time)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B_%7Bt%7D:t%5Cleq%20T)"> be a <img src="https://latex.codecogs.com/png.latex?d">-dimensional Brownian motion. Consider a function <img src="https://latex.codecogs.com/png.latex?f%5Cin%5Cmathcal%7BC%7D%5E%7B1,2%7D(%5B0,T%5D%5Ctimes%5Cmathbf%7BR%7D%5E%7Bd%7D)">. Then, we have with probability one for all <img src="https://latex.codecogs.com/png.latex?t%5Cleq%20T">:</p>
<img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Baligned%7D%0Af(t,B_%7Bt%7D)-f(0,B_%7B0%7D)%20&amp;%20=%5Csum_%7Bi=1%7D%5E%7Bd%7D%5Cint_%7B0%7D%5E%7Bt%7D%5Cpartial_%7Bx_%7Bi%7D%7Df(s,B_%7Bs%7D)dB_%7Bs%7D%5E%7B(i)%7D+%5Cint_%7B0%7D%5E%7Bt%7D%5Cleft(%5Cpartial_%7Bt%7Df(s,B_%7Bs%7D)+%5Csum_%7Bi=1%7D%5E%7Bd%7D%5Cpartial_%7Bx_%7Bi%7D%7D%5E%7B2%7Df(s,B_%7Bs%7D)%5Cright)ds%0A%5Cend%7Baligned%7D">
</div>
<p>The martingale condition is then similar to the ones in corollary ([cor:brownian-martingales-in-Rd]): if the processes <img src="https://latex.codecogs.com/png.latex?(%5Cpartial_%7Bx_%7Bi%7D%7Df(s,B_%7Bs%7D),t%5Cleq%20T)%5Cin%5Cmathcal%7BL%7D_%7Bc%7D%5E%7B2%7D(T)"> for every <img src="https://latex.codecogs.com/png.latex?1%5Cleq%20i%5Cleq%20d">, then the process</p>
<p><span id="eq-martingale-process"><img src="https://latex.codecogs.com/png.latex?f(t,B_%7Bt%7D)-%5Cint_%7B0%7D%5E%7Bt%7D%5Cleft%5C%7B%20%5Cpartial_%7Bt%7Df(s,B_%7Bs%7D)++%5Csum_%7Bi=1%7D%5E%7Bd%7D%5Cpartial_%7Bx_%7Bi%7D%7D%5E%7B2%7Df(s,B_%7Bs%7D)%5Cright%5C%7D%20ds,%5Cquad%20t%5Cleq%20T%20%5Ctag%7B1%7D"></span></p>
<p>is a martingale for the Brownian filtration. In particular, if <img src="https://latex.codecogs.com/png.latex?f"> satisfies the partial differential equation:</p>
<p><span id="eq-martingale-condition-for-f"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20t%7D+%5Cfrac%7B1%7D%7B2%7D%5Cnabla%5E%7B2%7Df%20&amp;%20=0%0A%5Cend%7Baligned%7D%0A%5Ctag%7B2%7D"></span></p>
<p>then the process <img src="https://latex.codecogs.com/png.latex?(f(t,B_%7Bt%7D):t%5Cleq%20T)"> itself is a martingale.</p>
</section>
<section id="polyas-random-walk-theorem" class="level2">
<h2 class="anchored" data-anchor-id="polyas-random-walk-theorem">Polya’s Random Walk Theorem</h2>
<p>Consider a <em>simple random walk</em> on the integer lattice <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D%5Ed">. At each time step, a random walker makes a random move of length one in one of the lattice directions.</p>
<p>We say that, if the random walk returns to the origin with probability one infinitely many times, it is <em>recurrent</em>, if it does not we will call it <em>transient</em>.</p>
<p>It’s worth to spend a moment visiting Polya’s Random Walk Theorem, a fascinating, but not so intuitive result.</p>
<p>Assuming all random walks start at the origin, we define <img src="https://latex.codecogs.com/png.latex?u"> to be the probability that a random walker returns to the origin. The probability that the random walker returns to the origin exactly <img src="https://latex.codecogs.com/png.latex?m"> times is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%7Bm%20%5Cchoose%20m-1%7D%20u%5E%7Bm-1%7D%20(1%20-%20u)%5E%7Bm%20-%20(m%20-%201)%7D%20=%20u%5E%7Bm-1%7D(1-u)%0A%5Cend%7Balign*%7D"></p>
<p>The expected number of times the particle returns to the origin for an infinite random walk is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AE%20&amp;=%20%5Csum_%7Bm%20=%201%7D%5E%7B%5Cinfty%7D%20m%20(u%5E%7Bm-1%7D(1-u))%5C%5C%0A&amp;=%20(1-u)%5Csum_%7Bm=1%7D%5E%7B%5Cinfty%7Dmu%5E%7Bm-1%7D%5C%5C%0A&amp;=%20(1-u)%5Csum_%7Bm=1%7D%5E%7B%5Cinfty%7D%5Cfrac%7Bd%7D%7Bdu%7Du%5E%7Bm%7D%5C%5C%0A%5Cend%7Balign*%7D"></p>
<p>We note that limit exchanging is acceptable since the power series <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bn=1%7D%5E%7B%5Cinfty%7Dx%5En"> converges uniformly for <img src="https://latex.codecogs.com/png.latex?u%20%3C%201"> and we can apply the differentiable limit theorem.</p>
<p>So we obtain:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AE%20&amp;=%20(1-u)%5Cfrac%7Bd%7D%7Bdu%7D%5Csum_%7Bm%20=%201%7D%5E%7B%5Cinfty%7D%20u%5Em%20%5C%5C%0A&amp;=%20(1-u)%5Ccdot%20%5Cfrac%7B1%7D%7B(1-u)%5E2%7D%5C%5C%0A&amp;=%20%5Cfrac%7B1%7D%7B1-u%7D%0A%5Cend%7Balign*%7D"></p>
<p>So, we see that if <img src="https://latex.codecogs.com/png.latex?E"> is finite, <img src="https://latex.codecogs.com/png.latex?u%20%3C%201">, then the walk is transient and if <img src="https://latex.codecogs.com/png.latex?E%20=%20+%5Cinfty">, <img src="https://latex.codecogs.com/png.latex?u=1">, then the walk is recurrent.</p>
<p>We then define <img src="https://latex.codecogs.com/png.latex?u_n"> to be the probability that a given walk is at the origin on the <img src="https://latex.codecogs.com/png.latex?n">th step, defining the value <img src="https://latex.codecogs.com/png.latex?u_0=1"> for the trivial loop. We also introduce an indicator random variable <img src="https://latex.codecogs.com/png.latex?x_n">, which takes the value <img src="https://latex.codecogs.com/png.latex?1">, if the particle is at the origin on the <img src="https://latex.codecogs.com/png.latex?n">th step and zero otherwise.</p>
<p>Then</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AT%20=%20%5Csum_%7Bn=1%7D%5E%7B%5Cinfty%7Dx_n%0A%5Cend%7Balign*%7D"></p>
<p>is the total number of times, the particle is at the origin, so <img src="https://latex.codecogs.com/png.latex?E"> is equal to the expectation of <img src="https://latex.codecogs.com/png.latex?T">, <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D(T)">, which is equal to:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5BT%5D%20&amp;=%20%5Csum_%7Bn=1%7D%5E%7B%5Cinfty%7D%5Cmathbb%7BE%7D%5Bx_n%5D%5C%5C%0A&amp;=%20%5Csum_%7Bn=1%7D%5E%7B%5Cinfty%7D%20u_n%0A%5Cend%7Balign*%7D"></p>
<p>But, we showed previously that if <img src="https://latex.codecogs.com/png.latex?E"> is finite, then the walk is transient and if <img src="https://latex.codecogs.com/png.latex?E%20=%20%5Cinfty">, then the walk is recurrent, so we have established that if:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Csum_%7Bn=1%7D%5E%7B%5Cinfty%7Du_n%0A%5Cend%7Balign*%7D"></p>
<p>converges then the walk is transient and if the sum diverges, then the walk is recurrent.</p>
<section id="mathbbz1-case" class="level3">
<h3 class="anchored" data-anchor-id="mathbbz1-case"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D%5E1"> case</h3>
<p>Now that we have built up the necessary tools, we will consider the cases. We start by considering a simple random walk on <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D%5E1">. Since, as mentioned previously, a walk must have an even number of steps to be a loop, we only look at <img src="https://latex.codecogs.com/png.latex?u_%7B2n%7D,n%20%5Cin%20%5Cmathbb%7BZ%7D%5E+">. A path of length <img src="https://latex.codecogs.com/png.latex?2n"> returning to the origin must have <img src="https://latex.codecogs.com/png.latex?n"> up-moves and <img src="https://latex.codecogs.com/png.latex?n"> down-moves. The number of such paths are <img src="https://latex.codecogs.com/png.latex?%7B2n%20%5Cchoose%20n%7D">. Each such path has a probability of occurrence <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%5E%7B2n%7D%7D">. Thus,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Au_%7B2n%7D%20=%20%5Cfrac%7B1%7D%7B2%5E%7B2n%7D%7D%7B2n%20%5Cchoose%20n%7D%0A%5Cend%7Balign*%7D"></p>
<p>Using Stirling’s approximation <img src="https://latex.codecogs.com/png.latex?n!%20%5Csim%20%5Csqrt%7B2%5Cpi%20n%7D%20e%5E%7B-n%7D%20n%5E%7Bn%7D">, we obtain:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Au_%7B2n%7D%20&amp;=%20%5Cfrac%7B1%7D%7B2%5E%7B2n%7D%7D%20%5Cfrac%7B(2n)!%7D%7Bn!%20n!%7D%5C%5C%0A&amp;%5Capprox%20%5Cfrac%7B1%7D%7B2%5E%7B2n%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Csqrt%7B2%5Cpi(2n)%7D%20e%5E%7B-2n%7D(2n)%5E%7B2n%7D%7D%7B%5Cleft(%5Csqrt%7B2%5Cpi%20n%7D%20e%5E%7B-n%7D%20n%5En%5Cright)%5E2%7D%5C%5C%0A&amp;=%5Cfrac%7B1%7D%7B%5Csqrt%7B%5Cpi%20n%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>So, we see that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Csum_%7Bn=0%7D%5E%7B%5Cinfty%7D%20u_%7B2n%7D%20%5Capprox%20%5Csum_%7Bn=0%7D%5E%7B%5Cinfty%7D%20%5Cfrac%7B1%7D%7B%5Csqrt%7Bn%5Cpi%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>And the series on the right certainly diverges so, we see that a simple random walk in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D%5E1"> is recurrent since <img src="https://latex.codecogs.com/png.latex?E"> diverges.</p>
</section>
<section id="mathbbz2-case" class="level3">
<h3 class="anchored" data-anchor-id="mathbbz2-case"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D%5E2"> case</h3>
<p>A particle has an equal probability <img src="https://latex.codecogs.com/png.latex?1/4"> of moving left, right, up or down randomly in the <img src="https://latex.codecogs.com/png.latex?d=2"> dimensional lattice. Each path of <img src="https://latex.codecogs.com/png.latex?2n"> steps has a probability <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B4%5E%7B2n%7D%7D"> of occurring. We then consider the number of paths with equal steps left and right (say <img src="https://latex.codecogs.com/png.latex?L"> steps in each horizontal direction) and equal steps up and down (then <img src="https://latex.codecogs.com/png.latex?n-L">) is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%7B2n%20%5Cchoose%20L%7D%7B2n%20-%20L%20%5Cchoose%20L%7D%7B2n%20-%202L%20%5Cchoose%20n%20-%20L%7D%7Bn-L%20%5Cchoose%20n%20-%20L%7D%20=%20%5Cfrac%7B(2n)!%7D%7BL!%20L!%20(n-L)!%20(n-L)!%7D%0A%5Cend%7Balign*%7D"></p>
<p>So we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Au_%7B2n%7D%20&amp;=%20%5Cfrac%7B1%7D%7B4%5E%7B2n%7D%7D%20%5Csum_%7BL=0%7D%5En%20%5Cfrac%7B(2n)!%7D%7BL!%20L!%20(n-L)!%20(n-L)!%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B1%7D%7B4%5E%7B2n%7D%7D%20%5Csum_%7BL=0%7D%5En%20%5Cfrac%7B(2n)!%7D%7Bn!%20n!%7D%20%5Ccdot%20%5Cleft(%5Cfrac%7Bn!%7D%7BL!%20(n-L)!%7D%5Cright)%5E2%20%5C%5C%0A&amp;=%5Cfrac%7B1%7D%7B4%5E%7B2n%7D%7D%20%7B2n%20%5Cchoose%20n%7D%5Csum_%7BL=0%7D%5En%20%7Bn%20%5Cchoose%20L%7D%5E2%0A%5Cend%7Balign*%7D"></p>
<p>Suppose, we are to form a team of <img src="https://latex.codecogs.com/png.latex?n"> players from a population of <img src="https://latex.codecogs.com/png.latex?2n"> participants. There <img src="https://latex.codecogs.com/png.latex?%7B2n%20%5Cchoose%20n%7D"> distinguishable teams of size <img src="https://latex.codecogs.com/png.latex?n">. Alternatively, we could divide the population into two halves of <img src="https://latex.codecogs.com/png.latex?n"> participants each, choose <img src="https://latex.codecogs.com/png.latex?L"> participants from the first sub-population, and the remaining <img src="https://latex.codecogs.com/png.latex?n-L"> participants from the second sub-population. So, the number of distinguishable teams is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Csum_%7BL=0%7D%5E%7Bn%7D%7Bn%20%5Cchoose%20L%7D%7Bn%20%5Cchoose%20n%20-%20L%7D%20=%20%5Csum_%7BL=0%7D%5E%7Bn%7D%20%7Bn%20%5Cchoose%20L%7D%5E2%0A%5Cend%7Balign*%7D"></p>
<p>So, we have the combinatorial identity:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Csum_%7BL=0%7D%5E%7Bn%7D%20%7Bn%20%5Cchoose%20L%7D%5E2%20=%20%7B2n%20%5Cchoose%20n%7D%0A%5Cend%7Balign*%7D"></p>
<p>Thus,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Au_%7B2n%7D%20&amp;=%5Cfrac%7B1%7D%7B4%5E%7B2n%7D%7D%20%7B2n%20%5Cchoose%20n%7D%5Csum_%7BL=0%7D%5En%20%7Bn%20%5Cchoose%20L%7D%5E2%5C%5C%0A&amp;=%20%5Cleft(%5Cfrac%7B1%7D%7B2%5E%7B2n%7D%7D%20%7B2n%20%5Cchoose%20n%7D%5Cright)%5E2%0A%5Cend%7Balign*%7D"></p>
<p>So, we have that, it is just the square of the result from <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D%5E1">, so we see in this case that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Au_%7B2n%7D%20&amp;%5Capprox%20%5Csum_%7Bn=0%7D%5E%7B%5Cinfty%7D%20%5Cfrac%7B1%7D%7B%5Cpi%20n%7D%0A%5Cend%7Balign*%7D"></p>
<p>And the series on the right certainly diverges, so we see that a simple random walk in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D%5E2"> is recurrent as <img src="https://latex.codecogs.com/png.latex?E"> diverges.</p>
</section>
<section id="mathbbz3-case" class="level3">
<h3 class="anchored" data-anchor-id="mathbbz3-case"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D%5E3"> case</h3>
<p>As before, in order to have a walk return to the origin we must have equal steps in the positive and negative directions for each direction and each path of <img src="https://latex.codecogs.com/png.latex?2n"> has a probability of occurring of <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B6%5E%7B2n%7D%7D">. Then, extending the idea from the previous subsection, the number of paths (of total length <img src="https://latex.codecogs.com/png.latex?2n">) with <img src="https://latex.codecogs.com/png.latex?L"> steps left and right, <img src="https://latex.codecogs.com/png.latex?U"> steps up and down and <img src="https://latex.codecogs.com/png.latex?n%20-%20L%20-%20U"> steps forward and backward is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B(2n)!%7D%7BL!%20L!%20U!%20U!%20(n%20-%20L%20-%20U)!%20(n%20-%20L%20-%20U)!%7D%0A%5Cend%7Balign*%7D"></p>
<p>So, we get:</p>
<p><span id="eq-probability-of-return-to-origin-at-nth-step-in-3d"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Au_%7B2n%7D%20&amp;=%20%5Cfrac%7B1%7D%7B6%5E%7B2n%7D%7D%20%5Csum_%7BL,U,L+U%20%5Cleq%20n%7D%20%5Cfrac%7B(2n)!%7D%7BL!%20L!%20U!%20U!%20(n%20-%20L%20-%20U)!%20(n%20-%20L%20-%20U)!%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B1%7D%7B2%5E%7B2n%7D%7D%20%7B2n%20%5Cchoose%20n%7D%20%5Csum_%7BL,U,L+U%20%5Cleq%20n%7D%20%5Cleft(%5Cfrac%7B1%7D%7B3%5En%7D%5Cfrac%7Bn!%7D%7BL!%20U!%20(n%20-%20U%20-%20L)!%7D%5Cright)%5E2%0A%5Cend%7Balign*%7D%0A%5Ctag%7B3%7D"></span></p>
<p>Consider a <img src="https://latex.codecogs.com/png.latex?3">-sided fair coin, with <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D%5C%7B%5Ctext%7BHeads%7D%5C%7D%20=%20%5Cmathbb%7BP%7D%5C%7B%5Ctext%7BTails%7D%5C%7D%20=%20%5Cmathbb%7BP%7D%5C%7B%5Ctext%7BEdge%7D%5C%7D%20=%20%5Cfrac%7B1%7D%7B3%7D">. Suppose that the coin is tossed <img src="https://latex.codecogs.com/png.latex?n=3%5E2%20=%209"> times. The probability of landing <img src="https://latex.codecogs.com/png.latex?L"> heads, <img src="https://latex.codecogs.com/png.latex?U"> tails and <img src="https://latex.codecogs.com/png.latex?n%20-%20L%20-%20U"> edges is <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bn!%7D%7BL!U!(n-L-U)!%7D%20%5Cfrac%7B1%7D%7B3%5En%7D">. This is precisely the term seen in the above expression. The number of heads, tails and edges in <img src="https://latex.codecogs.com/png.latex?n"> coin tosses follows a multinomial distribution. It can be easily demonstrated, that in, <img src="https://latex.codecogs.com/png.latex?n/3%20=%203"> heads, <img src="https://latex.codecogs.com/png.latex?n/3"> tails and <img src="https://latex.codecogs.com/png.latex?n/3"> edges are most likely to occur in <img src="https://latex.codecogs.com/png.latex?n"> coin tosses. So, we can find an upper bound on the summand in Equation&nbsp;3 as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7Bn!%7D%7B3%5En%20L!%20U!%20(n-%20L%20-%20U)!%7D%20%5Cleq%20%5Cfrac%7Bn!%7D%7B3%5En%20%5Clfloor%5Cfrac%7Bn%7D%7B3%7D%5Crfloor!%20%5Clfloor%5Cfrac%7Bn%7D%7B3%7D%5Crfloor!%20%5Clfloor%5Cfrac%7Bn%7D%7B3%7D%5Crfloor!%7D%0A%5Cend%7Balign*%7D"></p>
<p>Also, from the multinomial expansion theorem:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A(1%20+%20a%20+%20b)%5En%20=%20%5Csum_%7BL,U,L+U%5Cleq%20n%7D%20%5Cfrac%7Bn!%7D%7BL!%20U!%20(n-L-U)!%7D%20a%5EL%20b%5EU%0A%5Cend%7Balign*%7D"></p>
<p>Setting <img src="https://latex.codecogs.com/png.latex?a%20=%20b%20=%201">, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Csum_%7BL,U,L+U%5Cleq%20n%7D%20%5Cfrac%7Bn!%7D%7B3%5En%20L!%20U!%20(n-L-U)!%7D%20a%5EL%20b%5EU%20=%201%0A%5Cend%7Balign*%7D"></p>
<p>We then see that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Au_%7B2n%7D%20%5Cleq%20%5Cfrac%7B1%7D%7B2%5E%7B2n%7D%7D%20%7B2n%20%5Cchoose%20n%7D%20%5Cfrac%7Bn!%7D%7B3%5En%20%5Clfloor%5Cfrac%7Bn%7D%7B3%7D%5Crfloor!%20%5Clfloor%5Cfrac%7Bn%7D%7B3%7D%5Crfloor!%20%5Clfloor%5Cfrac%7Bn%7D%7B3%7D%5Crfloor!%7D%0A%5Cend%7Balign*%7D"></p>
<p>We can simplify this as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Au_%7B2n%7D%20&amp;=%20%5Cfrac%7B1%7D%7B2%5E%7B2n%7D%7D%7B2n%20%5Cchoose%20n%7D%20%5Cfrac%7Bn!%7D%7B3%5En%20%5Cleft(%5Clfloor%5Cfrac%7Bn%7D%7B3%7D%5Crfloor!%5Cright)%5E3%7D%20%5C%5C%0A&amp;%5Capprox%20%5Cfrac%7B1%7D%7B%5Csqrt%7B%5Cpi%20n%7D%7D%20%5Ctimes%20%5Cfrac%7B%5Csqrt%7B2%5Cpi%20n%7D%20e%5E%7B-n%7D%20n%5En%7D%7B3%5En%20%5Cleft%5C%7B%5Csqrt%7B2%5Cpi%20%5Cfrac%7Bn%7D%7B3%7D%7De%5E%7B-n/3%7D%20%5Cleft(%5Cfrac%7Bn%7D%7B3%7D%5Cright)%5E%7Bn/3%7D%5Cright%5C%7D%5E3%7D%5C%5C%0A&amp;=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B%5Cpi%20n%7D%7D%20%5Cfrac%7B%5Csqrt%7B2%5Cpi%20n%7D%20e%5E%7B-n%7D%20n%5En%7D%7B3%5En%20%5Cfrac%7B(2%5Cpi%20n)%5E%7B3/2%7D%7D%7B3%5E%7B3/2%7D%7D%20e%5E%7B-n%7D%20%5Cfrac%7Bn%5En%7D%7B3%5En%7D%7D%5C%5C%0A&amp;=%20%5Cfrac%7B1%7D%7B%5Csqrt%7B%5Cpi%20n%7D%7D%20%5Cfrac%7B%5Csqrt%7B2%5Cpi%20n%7D%20%5Ccancel%7Be%5E%7B-n%7D%7D%20%5Ccancel%7Bn%5En%7D%7D%7B%5Ccancel%7B3%5En%7D%20%5Cfrac%7B(2%5Cpi%20n)%5E%7B3/2%7D%7D%7B3%5E%7B3/2%7D%7D%20%5Ccancel%7Be%5E%7B-n%7D%7D%20%5Cfrac%7B%20%5Ccancel%7Bn%5En%7D%7D%7B%5Ccancel%7B3%5En%7D%7D%7D%5C%5C%0A&amp;%5Capprox%20%5Cfrac%7BM%7D%7B(%5Cpi%20n)%5E%7B3/2%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?M"> is a positive constant. We then see:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Csum_n%20u_%7B2n%7D%20&amp;=%20M%20%5Csum_n%20%5Cfrac%7B1%7D%7Bn%5E%7B%5Cfrac%7B3%7D%7B2%7D%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>The sum on the right hand side converges, so we have that a simple random walk in three dimensions is transient. The proof of Polya’s Random Walk Theorem is complete.</p>
</section>
</section>
<section id="recurrence-and-transience-of-brownian-motion" class="level2">
<h2 class="anchored" data-anchor-id="recurrence-and-transience-of-brownian-motion">Recurrence and Transience of Brownian Motion</h2>
<p>In one dimension, we established that every path of a Brownian motion reaches any level <img src="https://latex.codecogs.com/png.latex?a%20%5Cin%20%5Cmathbf%7BR%7D">. More precisely, for <img src="https://latex.codecogs.com/png.latex?a%20%3E%200">, if we define the stopping time :</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Ctau%20=%20%5Cmin%20%5C%7B%20t%20%5Cgeq%200%20:%20B_t%20%5Cgeq%20a%5C%7D%0A%5Cend%7Balign*%7D"></p>
<p>we have <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D%5C%7B%5Ctau_a%20%3C%20%5Cinfty%20%5C%7D%20=%201">. This implies in particular that every path will come back to <img src="https://latex.codecogs.com/png.latex?0"> and will do infinitely many times. This is because <img src="https://latex.codecogs.com/png.latex?B(t+%5Ctau)%20-%20B(t)"> is a standard brownian motion. This property of Brownian motion is called <em>recurrence</em>. This is to be compared with Brownian motion with a drift. In our analysis, we found that, if the drift is negative, then there are paths that will not reach a given level <img src="https://latex.codecogs.com/png.latex?a%20%3E%200"> with positive probability. Such paths go to infinity without ever going back to <img src="https://latex.codecogs.com/png.latex?0">. This property of the process is called <em>transience</em>.</p>
<p>We can derive similar properties for the multidimensional Brownian motion. We will rely heavily on Corollary&nbsp;1 and on some knowledge of harmonic functions. Harmonic functions play a very important role in mathematics, physics and in nature in general. As we mentioned earlier, if <img src="https://latex.codecogs.com/png.latex?d%20=%201">, the only harmonic functions are the linear functions, since the equation <img src="https://latex.codecogs.com/png.latex?f''(x)%20=%200"> has the solutions <img src="https://latex.codecogs.com/png.latex?f(x)=ax+b">. However, in higher dimensions, the collection of harmonic functions is very rich. This gives access to a plethora of Brownian martingales. For example, the following functions are harmonic in the whole space minus the origin, <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5Ed%20%5Csetminus%20%5C%7B0%5C%7D">.</p>
<p><span id="eq-example-of-harmonic-function"><img src="https://latex.codecogs.com/png.latex?%0Ah(x)%20=%20%5Cbegin%7Bcases%7D%0A%5Clog%20%7C%7Cx%7C%7C,%20&amp;%20d%20=%202%20%5C%5C%0A%7C%7Cx%7C%7C%5E%7B2%20-%20d%7D,%20&amp;%20d%20%5Cgeq%203%0A%5Cend%7Bcases%7D%0A%5Ctag%7B4%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?x%5Cin%5Cmathbf%7BR%7D%5Ed">.</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Consider</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(x_1,x_2)%20=%20%5Clog%20%5Csqrt%20%7Bx_1%5E2%20+%20x_2%5E2%7D%0A%5Cend%7Balign*%7D"></p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x_1%7D%20&amp;=%20%5Cfrac%7B1%7D%7B%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20x_1%7D%20(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%7D)%5C%5C%0A&amp;=%5Cfrac%7B1%7D%7B%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%7D%7D%20%5Ccdot%20%5Cfrac%7Bx_1%7D%7B%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%7D%7D%5C%5C%0A&amp;=%20%5Cfrac%7Bx_1%7D%7Bx_1%5E2%20+%20x_2%5E2%7D%0A%5Cend%7Balign*%7D"></p>
<p>Further,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x_1%5E2%7D%20&amp;=%20%5Cfrac%7B(x_1%5E2%20+%20x_2%5E2)(1)%20-%20x_1(2x_1)%7D%7B(x_1%5E2%20+%20x_2%5E2)%5E2%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7Bx_1%5E2%20-%20x_2%5E2%7D%7B(x_1%5E2%20+%20x_2%5E2)%7D%0A%5Cend%7Balign*%7D"></p>
<p>By symmetry,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x_2%5E2%7D%0A&amp;=%20%5Cfrac%7Bx_2%5E2%20-%20x_1%5E2%7D%7B(x_1%5E2%20+%20x_2%5E2)%7D%0A%5Cend%7Balign*%7D"></p>
<p>So,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x_1%5E2%7D%20&amp;=%20-%20%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x_2%5E2%7D%5C%5C%0A%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x_1%5E2%7D%20+%20%5Cfrac%7B%5Cpartial%5E2%20f%7D%7B%5Cpartial%20x_2%5E2%7D&amp;=0%0A%5Cend%7Balign*%7D"></p>
<p>We conclude that <img src="https://latex.codecogs.com/png.latex?f"> is harmonic.</p>
<p>Next, consider</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Ag(x_1,x_2,%5Cldots,x_d)%20=%20%5Cfrac%7B1%7D%7B%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5E%7Bd-2%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>Now,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20g%7D%7B%5Cpartial%20x_i%7D%20&amp;=%20%5Cfrac%7B(2-d)%7D%7B%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5E%7Bd-1%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20x_i%7D%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5C%5C%0A&amp;=%20%5Cfrac%7B(2-d)%7D%7B%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5E%7Bd-1%7D%7D%5Ccdot%20%5Cfrac%7B2x_i%7D%7B2%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%7D%5C%5C%0A&amp;=%20%5Cfrac%7B(2-d)x_i%7D%7B%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5Ed%7D%0A%5Cend%7Balign*%7D"></p>
<p>Further, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%5E2%20g%7D%7B%5Cpartial%20x_i%5E2%7D%20&amp;=%20(2-d)%5Cfrac%7B%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5Ed%20(1)%20-%20(x_i)%5Ccdot%20d%20%5Ccdot%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5E%7Bd-1%7D%5Ccdot%20%5Cfrac%7Bx_i%7D%7B%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%7D%7D%7B%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5E%7B2d%7D%7D%5C%5C%0A&amp;=(2-d)%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5E%7Bd-2%7D%20%5Cfrac%7B%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5E2%20%20-%20d%20x_i%5E2%7D%7B%5Cleft(%5Csqrt%7Bx_1%5E2%20+%20x_2%5E2%20+%20%5Cldots%20+%20x_d%5E2%7D%5Cright)%5E%7B2d%7D%7D%5C%5C%0A&amp;=(2-d)%20%5Cfrac%7B%5Cleft(%5Csum_%7Bi=1%7D%5Ed%20x_i%5E2%5Cright)%20-%20dx_i%5E2%20%7D%7B%7C%7Cx%7C%7C%5E%7Bd+2%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>We conclude that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Csum_%7Bi=1%7D%5E%7Bd%7D%20%5Cfrac%7B%5Cpartial%5E2%20g%7D%7B%5Cpartial%20x_i%5E2%7D%20=%200%0A%5Cend%7Balign*%7D"></p>
<p>and hence <img src="https://latex.codecogs.com/png.latex?g"> is harmonic.</p>
</div>
<p>Interestingly enough, the answer to the recurrence versus transience puzzle depends on the dimension. We will show that Brownian motion is recurrent in dimension <img src="https://latex.codecogs.com/png.latex?d=2"> in the sense that every Brownian motion path starting from <img src="https://latex.codecogs.com/png.latex?x"> will eventually enter a disc around the origin, no matter how small the disc is. The Brownian path will then enter this disc infinitely many times, as <img src="https://latex.codecogs.com/png.latex?t%20%5Cto%20%5Cinfty">. Note that, we did not say that the path actually hits <img src="https://latex.codecogs.com/png.latex?0">, but that <em>it enters a disc around the <img src="https://latex.codecogs.com/png.latex?0"></em>. This nuance is important, as we will in fact show that a Brownian path actually never hits a given point. In dimension <img src="https://latex.codecogs.com/png.latex?d=3"> or higher, it is proved that there are some paths starting from a given <img src="https://latex.codecogs.com/png.latex?x"> that will never enter a given ball around the origin with positive probability. This is the transience property.</p>
<p>The strategy of the proof is similar to the approach for Brownian motion with a drift. We will find a good function <img src="https://latex.codecogs.com/png.latex?h%20:%20%5Cmathbf%7BR%7D%5Ed%20%5Cto%20%5Cmathbf%7BR%7D"> for which <img src="https://latex.codecogs.com/png.latex?h(B_t)"> is a martingale. In light of Corollary&nbsp;1, this function needs to be harmonic in a suitable region. The desired probability is then obtained by considering the right boundary values.</p>
<div id="thm-recurrence-and-transience-of-brownian-motion" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Recurrence and transience of a brownian motion in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5Ed">)</strong></span> Let <img src="https://latex.codecogs.com/png.latex?(B_t,t%5Cgeq%200)"> be a Brownian motion in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5Ed"> starting at <img src="https://latex.codecogs.com/png.latex?B_0%20=%20x">. Consider for <img src="https://latex.codecogs.com/png.latex?r%20%3C%20%7C%7Cx%7C%7C">, the stopping time</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Ctau_r%20=%20%5Cmin%20%5C%7Bt%20%5Cgeq%200%20:%20%7C%7CB_t%7C%7C%20%3C%20r%5C%7D%0A%5Cend%7Balign*%7D"></p>
<p>the first hitting time of the paths in a ball of radius <img src="https://latex.codecogs.com/png.latex?r"> around the origin. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(%5Ctau_r%20%3C%20%5Cinfty)%20=%0A%5Cbegin%7Bcases%7D%0A1%20&amp;%20%5Ctext%7B%20if%20%7Dd%20%5Cleq%202%20%5C%5C%0A%5Cleft(%5Cfrac%7Br%7D%7B%7C%7Cx%7C%7C%7D%5Cright)%5E%7Bd-2%7D%20&amp;%20%5Ctext%7B%20if%20%7Dd%20%5Cgeq%203%0A%5Cend%7Bcases%7D%0A%5Cend%7Balign*%7D"></p>
<p>In particular, for <img src="https://latex.codecogs.com/png.latex?d%20%5Cleq%202">, the paths are recurrent; that is, they come back infinitely many times in a neighbourhood of the origin. For <img src="https://latex.codecogs.com/png.latex?d%20%5Cgeq%203">, each path will eventually never come back to a neighbourhood of the origin.</p>
</div>
<p>Note that we made sure that the starting point of the Brownian motion <img src="https://latex.codecogs.com/png.latex?x"> is outside the ball of radius <img src="https://latex.codecogs.com/png.latex?r">.</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Consider another hitting time of a ball with a radius larger than <img src="https://latex.codecogs.com/png.latex?%7C%7Cx%7C%7C">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Ctau_R'%20=%20%5Cmin%20%5C%7Bt%20%5Cgeq%200%20:%20%7C%7CB_t%7C%7C%20%5Cgeq%20R%5C%7D,%20%5Cquad%20r%20%3C%20%7C%7Cx%7C%7C%20%3C%20R%0A%5Cend%7Balign*%7D"></p>
<p>Note that <img src="https://latex.codecogs.com/png.latex?%5Ctau_R'"> must increase with <img src="https://latex.codecogs.com/png.latex?R"> and that it must go to <img src="https://latex.codecogs.com/png.latex?+%5Cinfty"> as <img src="https://latex.codecogs.com/png.latex?R%20%5Cto%20%5Cinfty">. Moreover, the sequence of events <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Ctau_r%20%3C%20%5Ctau_R'%5C%7D_%7BR%20%3E%20%7C%7Cx%7C%7C%7D"> is increasing. In particular, by continuity of probability measure, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%5Cmathbb%7BP%7D(%5Ctau_r%20%3C%20%5Ctau_R')%20&amp;=%20%5Cmathbb%7BP%7D(%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%5Ctau_r%20%3C%20%5Ctau_R')%5C%5C%0A&amp;=%20%5Cmathbb%7BP%7D(%5Ctau_r%20%3C%20%5Cinfty)%0A%5Cend%7Balign*%7D"></p>
<p>If we set <img src="https://latex.codecogs.com/png.latex?%5Ctau%20=%20%5Ctau_r%20%5Cland%20%5Ctau_R'">, then the event <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Ctau_r%20%3C%20%5Ctau_R'%5C%7D"> is the same as the event <img src="https://latex.codecogs.com/png.latex?%5C%7B%7C%7CB_%5Ctau%7C%7C=r%5C%7D">. So, <img src="https://latex.codecogs.com/png.latex?%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%5Cmathbb%7BP%7D(%5Ctau_r%20%3C%20%5Ctau_R')%20=%20%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%5Cmathbb%7BP%7D(%7C%7CB_%5Ctau%7C%7C=r)">.</p>
<p>Now, consider the event <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Ctau%20%3C%20%5Cinfty%5C%7D">. Let <img src="https://latex.codecogs.com/png.latex?E_n"> be the event that the <img src="https://latex.codecogs.com/png.latex?n">th increment <img src="https://latex.codecogs.com/png.latex?%7C%7CB_n%20-%20B_%7Bn-1%7D%7C%7C"> exceeds <img src="https://latex.codecogs.com/png.latex?R">. If <img src="https://latex.codecogs.com/png.latex?E_n"> occurs, then we must have the Brownian motion exits the spherical shell of thickness <img src="https://latex.codecogs.com/png.latex?R-r">. Moreover, we have <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(E_1)%20=%20%5Cldots%20=%20%5Cmathbb%7BP%7D(E_n)">, for all <img src="https://latex.codecogs.com/png.latex?n">. Call this probability <img src="https://latex.codecogs.com/png.latex?p">. Clearly, <img src="https://latex.codecogs.com/png.latex?0%20%3C%20p%20%3C%201">. Since the events <img src="https://latex.codecogs.com/png.latex?E_n"> are independent, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(E_1%5EC%20%5Ccap%20%5Cldots%20%5Ccap%20E_n%5EC)%20=%20(1%20-%20p)%5En%0A%5Cend%7Balign*%7D"></p>
<p>As <img src="https://latex.codecogs.com/png.latex?n%20%5Cto%20%5Cinfty">, we have <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cmathbb%7BP%7D(%5Cbigcap_%7Bk=1%7D%5E%7Bn%7DE_k%5EC)%20=%200">. Now, let <img src="https://latex.codecogs.com/png.latex?F_k"> be the event that there are no excursions upto <img src="https://latex.codecogs.com/png.latex?k">. That is, <img src="https://latex.codecogs.com/png.latex?F_k%20=%20%5Cbigcap_%7Bi=1%7D%5E%7Bk%7DE_i%5EC">. Now, the event <img src="https://latex.codecogs.com/png.latex?F_%7Bk+1%7D"> implies <img src="https://latex.codecogs.com/png.latex?F_k">, or equivalently, <img src="https://latex.codecogs.com/png.latex?F_%7Bk+1%7D%20%5Csubseteq%20F_k">. So, <img src="https://latex.codecogs.com/png.latex?%5C%7BF_k%5C%7D_%7Bk=1%7D%5E%7B%5Cinfty%7D"> is a decreasing sequence of events. Moreover, <img src="https://latex.codecogs.com/png.latex?%5Cbigcap_%7Bk=1%7D%5En%20F_k%20=%20%5Cbigcap_%7Bk=1%7D%5En%20E_k%5EC">. So, by continuity of probability measure,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cmathbb%7BP%7D(%5Cbigcap_%7Bk=1%7D%5E%7Bn%7DE_k%5EC)%0A&amp;=%20%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cmathbb%7BP%7D(%5Cbigcap_%7Bk=1%7D%5E%7Bn%7DF_k)%20%5C%5C%0A&amp;=%20%5Cmathbb%7BP%7D(%5Clim_%7Bn%20%5Cto%20%5Cinfty%7D%20%5Cbigcap_%7Bk=1%7D%5E%7Bn%7DF_k)%20%5C%5C%0A&amp;=%20%5Cmathbb%7BP%7D(%5Cbigcap_%7Bk=1%7D%5E%7B%5Cinfty%7DF_k)%20%5C%5C%0A&amp;=%20%5Cmathbb%7BP%7D(%5Cbigcap_%7Bk=1%7D%5E%7B%5Cinfty%7DE_k%5EC)%0A%5Cend%7Balign*%7D"></p>
<p>So, <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(%5Cbigcup_%7Bk=1%7D%5E%7B%5Cinfty%7DE_k)%20=%201">. There exists an <img src="https://latex.codecogs.com/png.latex?n_0%20%5Cin%20%5Cmathbf%7BN%7D">, such that the event <img src="https://latex.codecogs.com/png.latex?E_%7Bn_0%7D">, an excursion at <img src="https://latex.codecogs.com/png.latex?n_0"> occurs with probability <img src="https://latex.codecogs.com/png.latex?1">. So, the event <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Ctau%20%3C%20%5Cinfty%5C%7D"> occurs almost surely.</p>
<p>To compute <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(%7C%7CB_%5Ctau%7C%7C=r)">, the idea is to find a good function <img src="https://latex.codecogs.com/png.latex?h"> with the following properties:</p>
<ul>
<li><strong>Martingale</strong>: <img src="https://latex.codecogs.com/png.latex?(h(B_t),t%5Cleq%20%5Ctau)"> is a bounded martingale, so that the optional stopping theorem implies:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Bh(B_%5Ctau)%5D%20=%20h(B_0)%20=%20h(x)%0A%5Cend%7Balign*%7D"></p>
<ul>
<li><strong>Boundary values</strong>: Since <img src="https://latex.codecogs.com/png.latex?B_%5Ctau"> is a point at <img src="https://latex.codecogs.com/png.latex?%7C%7Cx%7C%7C=r"> or at <img src="https://latex.codecogs.com/png.latex?%7C%7Cx%7C%7C=R">, we pick boundary conditions for <img src="https://latex.codecogs.com/png.latex?h">, so that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5Bh(B_%7B%5Ctau%7D)%5D=%5Cmathbb%7BP%7D(%7C%7CB_%5Ctau%7C%7C=r)">.</li>
</ul>
<p>The second point is easy; it suffices to take the <em>boundary conditions</em> <img src="https://latex.codecogs.com/png.latex?h(x)=0"> at <img src="https://latex.codecogs.com/png.latex?%7C%7Cx%7C%7C=R"> and <img src="https://latex.codecogs.com/png.latex?h(x)=1"> at <img src="https://latex.codecogs.com/png.latex?%7C%7Cx%7C%7C=r">. For the first point, by Ito’s formula, we pick <img src="https://latex.codecogs.com/png.latex?h"> to be harmonic in the annulus <img src="https://latex.codecogs.com/png.latex?%5C%7Bx%20%5Cin%20%5Cmathbf%7BR%7D%5Ed%20:%20r%20%3C%20%7C%7Cx%7C%7C%3CR%20%5C%7D">. Thus, we can use the function in Equation&nbsp;4. Of course, the functions <img src="https://latex.codecogs.com/png.latex?ah(x)%20+%20b"> remain harmonic. To satisfy the boundary conditions, we pick <img src="https://latex.codecogs.com/png.latex?a"> and <img src="https://latex.codecogs.com/png.latex?b"> suitably:</p>
<section id="mathbbr1-case" class="level3">
<h3 class="anchored" data-anchor-id="mathbbr1-case"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5E1"> case</h3>
<p>Let <img src="https://latex.codecogs.com/png.latex?h(x)%20=%20ax%20+%20b">. Then, at <img src="https://latex.codecogs.com/png.latex?x=r">, we have:</p>
<p><span id="eq-boundary-condition-5"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Aar%20+%20b%20=%201%0A%5Cend%7Balign*%7D%0A%5Ctag%7B5%7D"></span></p>
<p>and at <img src="https://latex.codecogs.com/png.latex?x%20=%20R">, we have:</p>
<p><span id="eq-boundary-condition-6"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0AaR%20+%20b%20=%200%0A%5Cend%7Balign*%7D%0A%5Ctag%7B6%7D"></span></p>
<p>So, <img src="https://latex.codecogs.com/png.latex?b%20=%20-aR">. Substituting in Equation&nbsp;5, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aa%20&amp;=%20%5Cfrac%7B1%7D%7Br%20-%20R%7D%0Ab%20&amp;=%20-%5Cfrac%7BR%7D%7Br%20-%20R%7D%0A%5Cend%7Balign*%7D"></p>
<p>Consequently,</p>
<p><span id="eq-h(x)-R1-case"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ah(x)%20&amp;=%20%5Cfrac%7BR%20-%20x%7D%7BR%20-%20r%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B7%7D"></span></p>
</section>
<section id="mathbbr2-case" class="level3">
<h3 class="anchored" data-anchor-id="mathbbr2-case"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5E2"> case</h3>
<p>Let <img src="https://latex.codecogs.com/png.latex?h(x)%20=%20%5Clog%20%7C%7Cx%7C%7C">. Then, at <img src="https://latex.codecogs.com/png.latex?%7C%7Cx%7C%7C=r">, we have:</p>
<p><span id="eq-boundary-condition-1"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Aa%20%5Clog%20%7C%7Cx%7C%7C%20+%20b%20&amp;=%201%0Aa%20%5Clog%20r%20+%20b%20&amp;=%201%0A%5Cend%7Balign*%7D%0A%5Ctag%7B8%7D"></span></p>
<p>At <img src="https://latex.codecogs.com/png.latex?%7C%7Cx%7C%7C=R">, we have:</p>
<p><span id="eq-boundary-condition-2"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Aa%20%5Clog%20%7C%7Cx%7C%7C%20+%20b%20&amp;=%200%0Aa%20%5Clog%20R%20+%20b%20&amp;=%200%0A%5Cend%7Balign*%7D%0A%5Ctag%7B9%7D"></span></p>
<p>Thus, from Equation&nbsp;9, <img src="https://latex.codecogs.com/png.latex?b%20=%20-a%20%5Clog%20R">. Substituting the value for <img src="https://latex.codecogs.com/png.latex?b"> in Equation&nbsp;8, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Aa%20%5Clog%20r%20-%20a%20%5Clog%20R%20&amp;=%201%5C%5C%0Aa%20&amp;=%20%5Cfrac%7B1%7D%7B%5Clog%20r%20-%20%5Clog%20R%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Consequently,</p>
<p><span id="eq-h(x)-R2-case"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ah(x)%20&amp;=%20%5Cfrac%7B%5Clog%20%7C%7Cx%7C%7C%7D%7B%5Clog%20r%20-%20%5Clog%20R%7D%20-%20%20%5Cfrac%7B1%7D%7B%5Clog%20r%20-%20%5Clog%20R%7D%20%5Clog%20R%5C%5C%0A&amp;=%20%5Cfrac%7B%5Clog%20R%20-%20%5Clog%20%7C%7Cx%7C%7C%7D%7B%5Clog%20R%20-%20%5Clog%20r%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B10%7D"></span></p>
</section>
<section id="mathbbrd-d-geq-3-case" class="level3">
<h3 class="anchored" data-anchor-id="mathbbrd-d-geq-3-case"><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D%5Ed">, <img src="https://latex.codecogs.com/png.latex?d%20%5Cgeq%203"> case</h3>
<p>Let <img src="https://latex.codecogs.com/png.latex?h(x)=%7C%7Cx%7C%7C%5E%7B2-d%7D">. At <img src="https://latex.codecogs.com/png.latex?%7C%7Cx%7C%7C=r">, <img src="https://latex.codecogs.com/png.latex?a%20h(x)%20+%20b%20=%201">. So, we have:</p>
<p><span id="eq-boundary-condition-3"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Aa%20r%5E%7B2-d%7D%20+%20b%20=%201%0A%5Cend%7Balign*%7D%0A%5Ctag%7B11%7D"></span></p>
<p>At <img src="https://latex.codecogs.com/png.latex?%7C%7Cx%7C%7C=R">, <img src="https://latex.codecogs.com/png.latex?ah(x)%20+%20b%20=%200">. So, we have:</p>
<p><span id="eq-boundary-condition-4"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Aa%20%7C%7CR%7C%7C%5E%7B2-d%7D%20+%20b%20&amp;=%200%0A%5Cend%7Balign*%7D%0A%5Ctag%7B12%7D"></span></p>
<p>From Equation&nbsp;12, we get <img src="https://latex.codecogs.com/png.latex?b%20=%20-a%20R%5E%7B2-d%7D">. Substituting this value in Equation&nbsp;11, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aa%20r%5E%7B2-d%7D%20-%20aR%5E%7B2-d%7D%20%20&amp;=%201%5C%5C%0Aa%20&amp;=%20%5Cfrac%7B1%7D%7Br%5E%7B2-d%7D%20-%20R%5E%7B2-d%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>And</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ab%20=%20-%20%5Cfrac%7BR%5E%7B2-d%7D%7D%7Br%5E%7B2-d%7D%20-%20R%5E%7B2-d%7D%7D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Thus,</p>
<p><span id="eq-h(x)-R3-case"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Ah(x)%20&amp;=%20%5Cfrac%7B%7C%7Cx%7C%7C%5E%7B2-d%7D%7D%7Br%5E%7B2-d%7D%20-%20R%5E%7B2-d%7D%7D%20-%20%5Cfrac%7BR%5E%7B2-d%7D%7D%7Br%5E%7B2-d%7D%20-%20R%5E%7B2-d%7D%7D%5C%5C%0A&amp;=%20%5Cfrac%7BR%5E%7B2-d%7D%20-%20%7C%7Cx%7C%7C%7D%7BR%5E%7B2-d%7D%20-%20r%5E%7B2-d%7D%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B13%7D"></span></p>
<p>Collecting all the results together, we get:</p>
<p><span id="eq-hx-in-Rd-case"><img src="https://latex.codecogs.com/png.latex?%0Ah(x)%20=%20%5Cbegin%7Bcases%7D%0A%5Cfrac%7BR%20-%20x%7D%7BR%20-%20r%7D,%20&amp;%20d=1%20%5C%5C%0A%5Cfrac%7B%5Clog%20R%20-%20%5Clog%20%7C%7Cx%7C%7C%7D%7B%5Clog%20R%20-%20%5Clog%20r%7D,%20&amp;%20d=2%20%5C%5C%0A%5Cfrac%7BR%5E%7B2-d%7D%20-%20%7C%7Cx%7C%7C%5E%7B2-d%7D%7D%7BR%5E%7B2-d%7D%20-%20r%5E%7B2-d%7D%7D,%20&amp;%20d%20%5Cgeq%203%0A%5Cend%7Bcases%7D%0A%5Ctag%7B14%7D"></span></p>
<p>Passing to the limit as <img src="https://latex.codecogs.com/png.latex?R%20%5Cto%20%5Cinfty">, for <img src="https://latex.codecogs.com/png.latex?d=1">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20h(x)%20&amp;=%20%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7BR%20-%20x%7D%7BR%20-%20r%7D%20%5C%5C%0A&amp;=%20%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B1%20-%20%5Cfrac%7Bx%7D%7BR%7D%7D%7B1%20-%20%5Cfrac%7Br%7D%7BR%7D%7D%5C%5C%0A&amp;=%201%0A%5Cend%7Balign*%7D"></p>
<p>For <img src="https://latex.codecogs.com/png.latex?d%20=%202">, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20h(x)%20&amp;=%20%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B1%20-%20%5Cfrac%7B%5Clog%20x%7D%7B%5Clog%20R%7D%7D%7B1%20-%20%5Cfrac%7B%5Clog%20r%7D%7B%5Clog%20R%7D%7D%20%5C%5C%0A&amp;=%201%0A%5Cend%7Balign*%7D"></p>
<p>For <img src="https://latex.codecogs.com/png.latex?d%20=%203">, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%20h(x)%20&amp;=%20%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7BR%5E%7B2-d%7D%20-%20%7C%7Cx%7C%7C%5E%7B2-d%7D%7D%7BR%5E%7B2-d%7D%20-%20r%5E%7B2-d%7D%7D%5C%5C%0A&amp;=%20%5Cleft(%5Cfrac%7B%7C%7Cx%7C%7C%7D%7Br%7D%5Cright)%5E%7B2-d%7D%0A%5Cend%7Balign*%7D"></p>
<p>This concludes the proof. <img src="https://latex.codecogs.com/png.latex?%5Cblacksquare"></p>
</section>
</div>
<div id="exm-brownian-path-in-Rd-never-hits-a-given-point" class="theorem example">
<p><span class="theorem-title"><strong>Example 4</strong></span> We get more from the above proof. Indeed, in dimension <img src="https://latex.codecogs.com/png.latex?d%20%5Cgeq%202">, it implies that the probability that a Brownian motion starting at <img src="https://latex.codecogs.com/png.latex?B_0%20=%20x"> eventually hits any other point <img src="https://latex.codecogs.com/png.latex?y"> is <img src="https://latex.codecogs.com/png.latex?0">. Indeed, if we take <img src="https://latex.codecogs.com/png.latex?y%20=%200"> and <img src="https://latex.codecogs.com/png.latex?x%20%5Cneq%200">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(%5Cexists%20t%20%3E%200:%20B_t%20=%200)%20&amp;=%20%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%5Clim_%7Br%20%5Cto%20%5Cinfty%7D%20%5Cmathbb%7BP%7D(%5Ctau_r%20%3C%20%5Ctau_R')%5C%5C%0A&amp;=%20%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%5Clim_%7Br%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7BR%5E%7B2-d%7D%20-%20%7C%7Cx%7C%7C%5E%7B2-d%7D%7D%7BR%5E%7B2-d%7D%20-%20r%5E%7B2-d%7D%7D%5C%5C%0A&amp;=%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%20%20%5Clim_%7Br%20%5Cto%20%5Cinfty%7D%20%5Cfrac%7B(R/r)%5E%7B2-d%7D%20-%20(%7C%7Cx%7C%7C/r)%5E%7B2-d%7D%7D%7B(R/r)%5E%7B2-d%7D%20-%201%7D%5C%5C%0A&amp;=%20%5Clim_%7BR%20%5Cto%20%5Cinfty%7D%200%5C%5C%0A&amp;=%200%0A%5Cend%7Balign*%7D%0A"></p>
<p>Here, we shrink the inner radius to <img src="https://latex.codecogs.com/png.latex?0"> first and then we let the outer radius go to infinity after. It remains to take the limits of the expression obtained in equation Equation&nbsp;14. The first limit <img src="https://latex.codecogs.com/png.latex?r%20%5Cto%200"> gives <img src="https://latex.codecogs.com/png.latex?0"> right away.</p>
</div>
</section>
<section id="dynkins-formula-and-the-dirichlet-problem" class="level2">
<h2 class="anchored" data-anchor-id="dynkins-formula-and-the-dirichlet-problem">Dynkin’s Formula and the Dirichlet Problem</h2>
<p>In the last section, we translated the problem of recurrence and transience of Brownian motion in terms of a <em>boundary value problem</em>: we needed to find a particular function <img src="https://latex.codecogs.com/png.latex?h"> that solves a PDE (that is, <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E2%20h=0">) in a certain region of space(the annulus) and that satisfies given boundary conditions (the function is <img src="https://latex.codecogs.com/png.latex?1"> on the inner circle and <img src="https://latex.codecogs.com/png.latex?0"> on the outer circle). This is a particular case of the <em>Dirichlet problem</em> in PDE.</p>
<p>Consider a region <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D%20%5Csubset%20%5Cmathbb%7BR%7D%5Ed">. <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D"> is an open ball. That is, for all <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5Cmathcal%7BO%7D">, there exists <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%3E0">, such that <img src="https://latex.codecogs.com/png.latex?V_%5Cepsilon(x)%20=%20%5C%7By%20:%20%7C%7Cy%20-%20x%7C%7C%20%3C%20%5Cepsilon%5C%7D"> is contained in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D">. <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D"> doesn’t contain boundary points <img src="https://latex.codecogs.com/png.latex?%5Cpartial%20%5Cmathcal%7BO%7D">. In the proof of Theorem&nbsp;3, the region was the annulus <img src="https://latex.codecogs.com/png.latex?%5C%7Bx:%20r%20%3C%20%7C%7Cx%7C%7C%20%3C%20R%5C%7D"> and the boundary was given by the spheres <img src="https://latex.codecogs.com/png.latex?%5C%7Bx%20:%7C%7Cx%7C%7C%20=%20r%5C%7D"> and <img src="https://latex.codecogs.com/png.latex?%5C%7Bx:%20%7C%7Cx%7C%7C=R%5C%7D">. The Dirichlet problem in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D"> can be stated as follows:</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?f:%5Cpartial%5Cmathcal%7BO%7D%20%5Cto%20%5Cmathbb%7BR%7D"> be a function on the boundary of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D">. Can we extend the function <img src="https://latex.codecogs.com/png.latex?f"> to <img src="https://latex.codecogs.com/png.latex?O"> in such a way that the extension is harmonic on <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D"> and coincides with <img src="https://latex.codecogs.com/png.latex?f"> on the boundary?</p>
<p>In the instance of the proof of the Theorem&nbsp;3, we knew the solution of the problem, thanks to Equation&nbsp;4. The only job left to do was to adjust some parameters to fit the boundary conditions. It turns out that the formalism of stochastic calculus allows us to express the solution of the Dirichlet problem as an average over Brownian paths for general regions of space and boundary conditions. To do so, we look at a twist on the Ito’s formula called the <em>Dynkin’s formula</em>.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?x"> be a point in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D">. Consider a Brownian motion <img src="https://latex.codecogs.com/png.latex?(B_t,t%5Cgeq%200)"> starting at <img src="https://latex.codecogs.com/png.latex?x">, <img src="https://latex.codecogs.com/png.latex?B_0%20=%20x">. To emphasize the dependence on <img src="https://latex.codecogs.com/png.latex?x">, we write <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D_x"> and <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D_x"> for the probability and the expectation for the Brownian motion. Dykin’s formula is obtained by merging Corollary&nbsp;1 for the Brownian martingales together with the optional stopping theorem. More precisely, consider <img src="https://latex.codecogs.com/png.latex?f%20%5Cin%20C%5E2(%5Cmathbb%7BR%7D%5Ed)"> that satisfies the assumption of the Corollary&nbsp;1. We then have that the process:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AM_t%20&amp;=%20f(B_t)%20-%20%5Cfrac%7B1%7D%7B2%7D%5Cint_%7B0%7D%5Et%20%5Cnabla%5E2%20f(B_s)%20ds,%20%5Cquad%20t%20%5Cgeq%200%0A%5Cend%7Balign*%7D"></p>
<p>is a Brownian martingale.</p>
<p>Consider also the stopping time <img src="https://latex.codecogs.com/png.latex?%5Ctau%20=%20%5Cmin%20%5C%7Bt%20%5Cgeq%200%20:%20B_t%20%5Cin%20%5Cmathcal%7BO%7D%5EC%5C%7D">. This is the first exit time of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D"> of the Brownian motion path. Then, if the assumptions of the optional stopping theorem are fulfilled, we get <em>Dynkin’s formula</em>:</p>
<p><span id="eq-dynkins-formula"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5BM_%5Ctau%5D%20=%20%5Cmathbb%7BE%7D%5Bf(B_%5Ctau)%5D%20-%20%5Cfrac%7B1%7D%7B2%7D%20%5Cmathbb%7BE%7D%5Cleft%5B%5Cint_0%5E%5Ctau%20%5Cnabla%5E2%20f(B_s)ds%5Cright%5D%20=%20f(B_0)%20=%20M_0%0A%5Cend%7Balign*%7D%0A%5Ctag%7B15%7D"></span></p>
<p>As an application of Dynkin’s formula, let’s express the solution of the Dirichlet problem as an average over Brownian motion. If <img src="https://latex.codecogs.com/png.latex?f"> is harmonic in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D">, then <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E2%20f%20=%200"> in <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D">, so the process <img src="https://latex.codecogs.com/png.latex?(f(B_t),t%5Cleq%20%5Ctau)"> is itself a martingale. Note that since <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D"> is bounded, this is a bounded martingale! Moreover, the integrands <img src="https://latex.codecogs.com/png.latex?%5Cpartial_i%20f(B_s)">, <img src="https://latex.codecogs.com/png.latex?1%20%5Cleq%20i%20%5Cleq%20d">, are bounded. We conclude that the solution to the Dirichlet problem can be represented as follows:</p>
<p><span id="eq-dynkins-formula-applied-to-dirichlet-problem"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0Af(x)%20=%20%5Cmathbb%7BE%7D_x%5Bf(B_%5Ctau)%5D,%20%5Cquad%20x%20%5Cin%20%5Cmathcal%7BO%7D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B16%7D"></span></p>
<p>In other words, the value of the harmonic function of <img src="https://latex.codecogs.com/png.latex?f"> at <img src="https://latex.codecogs.com/png.latex?x"> is given by the average over the Brownian paths of the value of the function at the exit point of the path on the boundary of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D">. Equation Equation&nbsp;16 does not prove the existence of the solution to the Dirichlet problem, as we assume that such a function exists. Existence of the solution to the Dirichlet problem can be shown this way, assuming the region <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D"> and the function on the boundary are nice enough. However, note that the averaging on the right-hand side of the formula makes sense even in the case where <img src="https://latex.codecogs.com/png.latex?f"> is simply defined on the boundary <img src="https://latex.codecogs.com/png.latex?%5Cpartial%20%5Cmathcal%7BO%7D">. We then define a posteriori the <em>harmonic extension</em> of <img src="https://latex.codecogs.com/png.latex?f"> inside <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BO%7D"> by defining its value at <img src="https://latex.codecogs.com/png.latex?x"> as <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D_x%5Bf(B_%5Ctau)%5D">.</p>
</section>
<section id="numerical-projects" class="level2">
<h2 class="anchored" data-anchor-id="numerical-projects">Numerical Projects</h2>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<div id="exr-gaussian-integration-by-parts" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> <strong>Gaussian Integration by parts.</strong></p>
<ol type="a">
<li>Let <img src="https://latex.codecogs.com/png.latex?Z"> be a standard Gaussian random variable. Show using integration by parts that for a differentiable function <img src="https://latex.codecogs.com/png.latex?g">:</li>
</ol>
<p><span id="eq-gaussian-integration-by-parts"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5BZ%20g(Z)%5D%20=%20%5Cmathbb%7BE%7D%5Bg'(Z)%5D%0A%5Cend%7Balign*%7D%0A%5Ctag%7B17%7D"></span></p>
<p>where we assume that both expectations are well-defined.</p>
<ol start="2" type="a">
<li>Use this to recover the expression for the moments for <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BZ%5E%7B2j%7D%5D,j%20%5Cin%20%5Cmathbb%7BN%7D">.</li>
</ol>
</div>
<p><em>Solution</em>.</p>
<p>We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5Bg'(Z)%5D%20&amp;=%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%5Cphi(z)%20%5Ccdot%20g'(z)%20dz%20%5C%5C%0A&amp;=%20%5Cleft%5B%5Cfrac%7Be%5E%7B-z%5E2/2%7D%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%5Ccdot%20g(z)%5Cright%5D_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20-%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20g(z)%20%5Cfrac%7B-ze%5E%7B-z%5E2/2%7D%7D%7B%5Csqrt%7B2%5Cpi%7D%7Ddz%20%5C%5C%0A&amp;=%200%20+%20%5Cint_%7B-%5Cinfty%7D%5E%7B%5Cinfty%7D%20z%20g(z)%20%5Cphi(z)dz%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5BZg(Z)%5D%0A%5Cend%7Balign*%7D%0A"></p>
<p>Moreover, we can write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BE%7D%5BZ%5E%7B2n%7D%5D%20&amp;=%20%5Cmathbb%7BE%7D%5BZ%20%5Ccdot%20Z%5E%7B2n-1%7D%5D%20%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5BZ%20%5Ccdot%20g(Z)%5D,%20%5Cquad%20%5C%7B%20%5Ctext%7B%20where%20%7Dg(x)=x%5E%7B2n%20-%201%7D%5C%7D%20%5C%5C%0A&amp;=%20%5Cmathbb%7BE%7D%5Bg'(Z)%5D%20%5C%5C%0A&amp;=%20(2n%20-%201)%20%5Cmathbb%7BE%7D%5BZ%5E%7B(2n%20-%202)%7D%5D%20%5C%5C%0A&amp;%20%5Cvdots%20%5C%5C%0A&amp;=%20(2n%20-%201)%5Ccdots%205%20%5Ccdot%203%20%5Ccdot%20%5Cmathbb%7BE%7D%5BZ%5E2%5D%20%5C%5C%0A&amp;=%20(2n%20-%201)%5Ccdots%205%20%5Ccdot%203%20%5Ccdot%201%0A%5Cend%7Balign*%7D%0A"></p>
<div id="exr-the-heat-equation" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> <strong>The Heat Equation</strong>.</p>
<p>Use the Gaussian integration by parts identity to check that the solution <img src="https://latex.codecogs.com/png.latex?f(t,x)"> to the <em>heat equation</em> is:</p>
</div>


<!-- -->

</section>
</section>

 ]]></description>
  <category>Stochastic Calculus</category>
  <guid>https://quantdev.blog/posts/multivariate_ito_calculus/</guid>
  <pubDate>Wed, 03 Jul 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/multivariate_ito_calculus/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>The distribution of the first passage time of Brownian Motion</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/first_passage_time_of_BM/</link>
  <description><![CDATA[ 





<p>The distribution of Brownian motion enjoys many interesting symmetries. The reflection of a Brownian motion about any time <img src="https://latex.codecogs.com/png.latex?s"> is also a Brownian motion.</p>
<p><em>Lemma 1.</em> (<em>Reflection at time <img src="https://latex.codecogs.com/png.latex?s"></em>) Let <img src="https://latex.codecogs.com/png.latex?B_t"> be a standard Brownian motion. Then, the process <img src="https://latex.codecogs.com/png.latex?(-B_t,t%20%5Cgeq%200)"> is a Brownian motion. More generally, for any <img src="https://latex.codecogs.com/png.latex?s%20%5Cgeq%200">, the process <img src="https://latex.codecogs.com/png.latex?(%5Ctilde%7BB_t%7D,t%5Cgeq%200)"> defined by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Ctilde%7BB%7D_t%20=%20%5Cbegin%7Bcases%7D%0AB_t%20&amp;%20%5Ctext%7B%20if%20%7D%20t%5Cleq%20s%5C%5C%0AB_s%20-%20(B_t%20-%20B_s)%20&amp;%20%5Ctext%7B%20if%20%7Dt%20%3E%20s%0A%5Cend%7Bcases%7D%0A%5Cend%7Balign*%7D"></p>
<p>is a Brownian motion.</p>
<p><em>Claim</em>. <img src="https://latex.codecogs.com/png.latex?(-B_t,t%5Cgeq%200)"> is a Brownian motion.</p>
<p><em>Proof</em>.</p>
<p>We have, <img src="https://latex.codecogs.com/png.latex?-B(0)%20=%200">.</p>
<p>For any increment <img src="https://latex.codecogs.com/png.latex?s%20%3C%20t">, the increment <img src="https://latex.codecogs.com/png.latex?(-B_t)%20-%20(-B_s)%20=%20B_s%20-%20B_t"> is a Gaussian random variable with mean <img src="https://latex.codecogs.com/png.latex?0"> and variance <img src="https://latex.codecogs.com/png.latex?t%20-%20s">.</p>
<p>For any choice of <img src="https://latex.codecogs.com/png.latex?n"> times, <img src="https://latex.codecogs.com/png.latex?0%20%5Cleq%20t_1%20%5Cleq%20t_2%20%5Cleq%20%5Cldots%20%5Cleq%20t_n">, the increments:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A(B_%7B0%7D%20-%20B_%7Bt_1%7D),%20(B_%7Bt_1%7D%20-%20B_%7Bt_2%7D),%20%5Cldots,%20(B_%7Bt_n%7D%20-%20B_%7Bt_%7Bn-1%7D%7D)%0A%5Cend%7Balign*%7D"></p>
<p>are independent</p>
<p>The paths <img src="https://latex.codecogs.com/png.latex?-B_t(%5Comega)"> are continuous.</p>
<p>Thus, <img src="https://latex.codecogs.com/png.latex?(-B_t,t%5Cgeq%200)"> is a standard Brownian motion.</p>
<p><em>Claim</em>. <img src="https://latex.codecogs.com/png.latex?(%5Ctilde%7BB_t%7D,t%5Cgeq%200)"> is a Brownian motion.</p>
<p><em>Proof</em>.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?s%20%5Cgeq%200"> be any arbitrary time.</p>
<p>We have, <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BB%7D(0)%20=%200">.</p>
<p>Consider any increment <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BB%7D(t_2)%20-%20%5Ctilde%7BB%7D(t_1)">, <img src="https://latex.codecogs.com/png.latex?t_2%20%3C%20t_1">.</p>
<p>Case I. <img src="https://latex.codecogs.com/png.latex?s%20%5Cleq%20t_1%20%3C%20t_2"></p>
<p>Here</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Ctilde%7BB%7D(t_2)%20-%20%5Ctilde%7BB%7D(t_1)%20&amp;=%20B(s)%20-%20(B(t_2)%20-%20B(s))%20-%20(B(s)%20-%20(B(t_1)%20-%20B(s)))%20%5C%5C%0A&amp;=%20-(B(t_2)%20-%20B(t_1))%0A%5Cend%7Balign*%7D"></p>
<p>Hence, <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BB%7D(t_2)%20-%20%5Ctilde%7BB%7D(t_1)%20%5Csim%20%5Cmathcal%7BN%7D(0,t_2%20-%20t_1)">.</p>
<p>Case II. <img src="https://latex.codecogs.com/png.latex?t_1%20%3C%20s%20%3C%20t_2"></p>
<p>Here</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Ctilde%7BB%7D(t_2)%20-%20%5Ctilde%7BB%7D(t_1)%20&amp;=%20B(s)%20-%20(B(t_2)%20-%20B(s))%20-%20B(t_1)%5C%5C%0A&amp;=%20(B(s)%20-%20B(t_1))%20-%20(B(t_2)%20-%20B(s))%0A%5Cend%7Balign*%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?B(s)%20-%20B(t_1)"> and <img src="https://latex.codecogs.com/png.latex?B(t_2)%20-%20B(s)"> are independent random variables. Moreover, <img src="https://latex.codecogs.com/png.latex?B(s)%20-%20B(t_1)%20%5Csim%20%5Cmathcal%7BN%7D(0,s%20-%20t_1)"> and <img src="https://latex.codecogs.com/png.latex?B(t_2)%20-%20B(s)%20%5Csim%20%5Cmathcal%7BN%7D(0,t_2%20-%20s)">. Consequently, <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BB%7D(t_2)%20-%20%5Ctilde%7BB%7D(t_1)%20%5Csim%20%5Cmathcal%7BN%7D(0,t_2%20-%20t_1)">.</p>
<p>Case III. <img src="https://latex.codecogs.com/png.latex?t_1%20%3C%20t_2%20%5Cleq%20s"></p>
<p>Here</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Ctilde%7BB%7D(t_2)%20-%20%5Ctilde%7BB%7D(t_1)%20&amp;=%20B(t_2)%20-%20B(t_1)%0A%5Cend%7Balign*%7D"></p>
<p>so <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BB%7D(t_2)%20-%20%5Ctilde%7BB%7D(t_1)%20%5Csim%20%5Cmathcal%7BN%7D(0,t_2%20-%20t_1)">.</p>
<p>Finally, the paths <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BB%7D(t,%5Comega)"> are continuous. Hence, <img src="https://latex.codecogs.com/png.latex?(%5Ctilde%7BB%7D(t),t%5Cgeq%200)"> is a standard brownian motion.</p>
<section id="reflection-principle" class="level2">
<h2 class="anchored" data-anchor-id="reflection-principle">Reflection Principle</h2>
<p>It turns out that the above reflection property holds even if <img src="https://latex.codecogs.com/png.latex?s"> is replaced by a stopping time. I prove this here.</p>
<p><em>Lemma 2.</em> (<em>Reflection Principle</em>) Let <img src="https://latex.codecogs.com/png.latex?(B_t,t%20%5Cgeq%200)"> be a standard Brownian motion and <img src="https://latex.codecogs.com/png.latex?%5Ctau"> be a stopping time for its filtration. Then, the process <img src="https://latex.codecogs.com/png.latex?(%5Ctilde%7BB%7D(t),t%5Cgeq%200)"> defined by the reflection at time <img src="https://latex.codecogs.com/png.latex?%5Ctau">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Ctilde%7BB%7D(t)%20&amp;=%20%5Cbegin%7Bcases%7D%0AB_t%20&amp;%20%5Ctext%7B%20if%20%7D%20t%5Cleq%20%5Ctau%5C%5C%0AB_%5Ctau%20-%20(B_t%20-%20B_%5Ctau)%20&amp;%20%5Ctext%7B%20if%20%7Dt%20%3E%20%5Ctau%0A%5Cend%7Bcases%7D%0A%5Cend%7Balign*%7D"></p>
<p>is also a standard Brownian motion.</p>
</section>
<section id="bacheliers-formula" class="level2">
<h2 class="anchored" data-anchor-id="bacheliers-formula">Bachelier’s formula</h2>
<p>It is an amazing fact, that some simple manipulations using stopping time yield the complete distribution of the first passage time <img src="https://latex.codecogs.com/png.latex?%5Ctau_a"> of a Brownian motion as well as the distribution of the running maximum of the Brownian path on an interval of time <img src="https://latex.codecogs.com/png.latex?%5B0,T%5D">. This is surprising since the maximum of the Brownian path on <img src="https://latex.codecogs.com/png.latex?%5B0,T%5D">, denoted by <img src="https://latex.codecogs.com/png.latex?%5Csup_%7B0%5Cleq%20t%20%5Cleq%20T%7D%20B_t"> is a random variable that depends on the whole path on <img src="https://latex.codecogs.com/png.latex?%5B0,T%5D">. This beautiful result is due to Bachelier.</p>
<p><em>Proposition 3.</em> (<em>Bachelier’s formula</em>) Let <img src="https://latex.codecogs.com/png.latex?(B_t,t%5Cleq%20T)"> be a standard Brownian motion on <img src="https://latex.codecogs.com/png.latex?%5B0,T%5D">. Then, the CDF of the random variable <img src="https://latex.codecogs.com/png.latex?%5Csup_%7B0%20%5Cleq%20t%5Cleq%20T%7D%20B_t"> is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D%5Cleft(%5Csup_%7B0%5Cleq%20t%20%5Cleq%20T%7D%20B_t%20%5Cleq%20a%5Cright)%20=%20%5Cmathbb%7BP%7D(%7CB_T%7C%20%5Cleq%20a)%20%5Cquad%20%5Ctext%7B%20for%20any%20%7Da%5Cgeq%200%0A%5Cend%7Balign*%7D"></p>
<p>In particular, its PDF is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af_%7Bmax%7D(a)%20=%20%5Cfrac%7B2%7D%7B%5Csqrt%7B2%5Cpi%20T%7D%7D%20e%5E%7B-a%5E2/2T%7D%0A%5Cend%7Balign*%7D"></p>
<p>In other words, the random variable <img src="https://latex.codecogs.com/png.latex?%5Csup_%7B0%20%5Cleq%20t%20%5Cleq%20T%7D%20B_t"> (the maximum of the brownian motion at any time <img src="https://latex.codecogs.com/png.latex?t">) has the same distribution as <img src="https://latex.codecogs.com/png.latex?%7CB_T%7C"> (the terminal distribution of the absolute value of the brownian motion).</p>
<p>This equality holds in distribution for a fixed <img src="https://latex.codecogs.com/png.latex?t">. As a bonus corollary, we get the distribution of the first passage time at <img src="https://latex.codecogs.com/png.latex?a">.</p>
<p><em>Proof</em>. Consider <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a)">. By splitting this probability over the event of the endpoint, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a)%20&amp;=%20%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a,%20B_T%20%3E%20a)%20+%20%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a,%20B_T%20%5Cleq%20a)%0A%5Cend%7Balign*%7D"></p>
<p>Note also that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(B_T%20=%20a)%20=%200">. Hence, the first probability equals <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(B_T%20%5Cgeq%20a)">. As for the second, consider the time <img src="https://latex.codecogs.com/png.latex?%5Ctau_a">. On the event considered, we have <img src="https://latex.codecogs.com/png.latex?%5Ctau_a%20%5Cleq%20T"> and using the reflection principle (lemma 2), we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a,%20B_T%20%5Cleq%20a)%20&amp;=%20%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a,%20%5Ctilde%7BB%7D_T%20%5Cgeq%20a)%0A%5Cend%7Balign*%7D"></p>
<p>Observe that, since <img src="https://latex.codecogs.com/png.latex?%5Ctau_a%20%5Cleq%20T">, the event <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Csup_%7Bt%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a%5C%7D"> is the same as <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Csup_%7Bt%5Cleq%20T%7D%20%5Ctilde%7BB%7D(t)%20%5Cgeq%20a%5C%7D">. Therefore the above probability is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a)%20&amp;=%20%5Cmathbb%7BP%7D(B_T%20%3E%20a)%20+%20%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20%5Ctilde%7BB%7D_t%20%5Cgeq%20a,%20%5Ctilde%7BB%7D_T%20%5Cgeq%20a)%0A%5Cend%7Balign*%7D"></p>
<p>But, <img src="https://latex.codecogs.com/png.latex?%5Ctilde%7BB%7D_t"> is also a standard brownian motion and has the same distribution as <img src="https://latex.codecogs.com/png.latex?B_t">. <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(B_t%20%5Cin%20S)%20=%20%5Cmathbb%7BP%7D(%5Ctilde%7BB%7D_t%20%5Cin%20S)"> by the reflection principle. So, we can simply drop the tilde signs and write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a)%20&amp;=%20%5Cmathbb%7BP%7D(B_T%20%3E%20a)%20+%20%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20%7BB%7D_t%20%5Cgeq%20a,%20%7BB%7D_T%20%5Cgeq%20a)%5C%5C%0A&amp;=%5Cmathbb%7BP%7D(B_T%20%3E%20a)%20+%20%5Cmathbb%7BP%7D(%7BB%7D_T%20%5Cgeq%20a)%5C%5C%0A&amp;=%20%5Cmathbb%7BP%7D(B_T%20%5Cleq%20-a)%20+%20%5Cmathbb%7BP%7D(B_T%20%5Cgeq%20a)%20%5C%5C%0A&amp;%20%5Cquad%20%5C%7B%5Ctext%7B%20By%20symmetry%20of%20the%20Gaussian%20distribution%20%7D%5C%7D%5C%5C%0A&amp;=%20%5Cmathbb%7BP%7D(B_T%20%5Cleq%20-a%20%5Ccup%20B_T%20%5Cgeq%20a)%20%5C%5C%0A&amp;=%20%5Cmathbb%7BP%7D(%7CB_T%7C%20%5Cgeq%20a)%0A%5Cend%7Balign*%7D"></p>
<p>We conclude that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(%5Csup%20B_t%20%5Cleq%20a)%20=%20%5Cmathbb%7BP%7D(%7CB_T%7C%20%5Cleq%20a)%0A%5Cend%7Balign*%7D"></p>
<p>as claimed.</p>
<p>To derive the PDF, we can always write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(%5Csup_%7Bt%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a)%20&amp;=%20%5Cmathbb%7BP%7D(B_T%20%3E%20a)%20+%20%5Cmathbb%7BP%7D(%7BB%7D_T%20%5Cgeq%20a)%5C%5C%0A&amp;=%202%5Cmathbb%7BP%7D(B_T%20%5Cgeq%20a)%5C%5C%0A&amp;=%202(1%20-%20F_%7BB_T%7D(a))%0A%5Cend%7Balign*%7D"></p>
<p>So:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AF_%7B%5Csup%20B_t%7D(a)%20&amp;=%201%20-%202(1%20-%20F_%7BB_T%7D(a))%5C%5C%0A%5Cfrac%7Bd%7D%7Bda%7D(F_%7B%5Csup%20B_t%7D(a))%20&amp;=%202%20%5Cfrac%7Bd%7D%7Bda%7D(F_%7BB_T%7D(a))%5C%5C%0Af_%7B%5Csup%20B_t%7D(a)%20&amp;=%202%20f_%7BB_T%7D(a)%5C%5C%0A&amp;=%20%5Cfrac%7B2%7D%7B%5Csqrt%7B2%5Cpi%20T%7D%7D%5Cexp%5Cleft%5B-%5Cfrac%7Ba%5E2%7D%7B2T%7D%5Cright%5D%0A%5Cend%7Balign*%7D"></p>
</section>
<section id="distribution-of-the-first-passage-time-tau_a" class="level2">
<h2 class="anchored" data-anchor-id="distribution-of-the-first-passage-time-tau_a">Distribution of the first passage time <img src="https://latex.codecogs.com/png.latex?%5Ctau_a"></h2>
<p><em>Corollary 4.</em> Let <img src="https://latex.codecogs.com/png.latex?a%20%5Cgeq%200"> and let <img src="https://latex.codecogs.com/png.latex?%5Ctau_a%20=%20%5Cmin%20%5C%7Bt%20%5Cgeq%200:%20B_t%20%5Cgeq%20a%5C%7D">. Then:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D(%5Ctau_a%20%5Cleq%20T)%20=%20%5Cmathbb%7BP%7D%5Cleft(%5Csup_%7B0%20%5Cleq%20t%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a%5Cright)%20=%20%5Cint_%7Ba%7D%5E%7B%5Cinfty%7D%20%5Cfrac%7B2%7D%7B%5Csqrt%7B2%5Cpi%20T%7D%7De%5E%7B-x%5E2/2T%7D%20dx%0A%5Cend%7Balign*%7D"></p>
<p>In particular, the random variable <img src="https://latex.codecogs.com/png.latex?%5Ctau_a"> has PDF:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af_%7B%5Ctau_a%7D(t)%20=%20%5Cfrac%7Ba%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%20%5Cfrac%7Be%5E%7B-a%5E2/2t%7D%7D%7Bt%5E%7B3/2%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>This implies that it is heavy-tailed and <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B%5Ctau_a%5D%20=%20%5Cinfty">.</p>
<p><em>Proof.</em></p>
<p>The maximum on <img src="https://latex.codecogs.com/png.latex?%5B0,T%5D"> is larger than or equal to <img src="https://latex.codecogs.com/png.latex?a">, if and only if, <img src="https://latex.codecogs.com/png.latex?%5Ctau_a%20%5Cleq%20T">. Therefore, the events <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Csup_%7B0%20%5Cleq%20t%20%5Cleq%20T%7D%20B_t%20%5Cgeq%20a%5C%7D"> and <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Ctau_a%20%5Cleq%20T%5C%7D"> are the same. So, the CDF <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D(%5Ctau_a%20%5Cleq%20t)"> of <img src="https://latex.codecogs.com/png.latex?%5Ctau_a"> is</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AF_%7B%5Ctau_a%7D(t)%20=%20%5Cint_%7Ba%7D%5E%7B%5Cinfty%7D%20%5Cfrac%7B2%7D%7B%5Csqrt%7B2%5Cpi%20t%7D%7D%20e%5E%7B-%5Cfrac%7Bx%5E2%7D%7B2t%7D%7D%20dx%0A%5Cend%7Balign*%7D"></p>
<p>To get the PDF, it remains to differentiate the integral with respect to <img src="https://latex.codecogs.com/png.latex?t">. This is easy to do, once we realise a change of variable <img src="https://latex.codecogs.com/png.latex?u%20=%20x/%5Csqrt%7Bt%7D">, <img src="https://latex.codecogs.com/png.latex?du%20=%20dx/%5Csqrt%7Bt%7D"> that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AF_%7B%5Ctau_a%7D(t)%20&amp;=%20%5Cint_%7Ba/%5Csqrt%7Bt%7D%7D%5E%7B%5Cinfty%7D%20%5Cfrac%7B2%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%20e%5E%7B-%5Cfrac%7Bu%5E2%7D%7B2%7D%7Ddu%5C%5C%0A&amp;=%202(1%20-%20%5CPhi%5Cleft(%5Cfrac%7Ba%7D%7B%5Csqrt%7Bt%7D%7D%5Cright))%0A%5Cend%7Balign*%7D"></p>
<p>Differentiating on both sides with respect to <img src="https://latex.codecogs.com/png.latex?t">, we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af_%7B%5Ctau_a%7D(t)%20&amp;=%20-%202%5Cphi%5Cleft(%5Cfrac%7Ba%7D%7B%5Csqrt%7Bt%7D%7D%5Cright)%20%5Cleft(-%5Cfrac%7B1%7D%7B2%7D%5Cright)%20%5Cfrac%7Ba%7D%7Bt%5E%7B3/2%7D%7D%5C%5C%0A&amp;=%20%5Cfrac%7Ba%7D%7Bt%5E%7B3/2%7D%7D%20%5Cfrac%7Be%5E%7B-a%5E2/2t%7D%7D%7B%5Csqrt%7B2%5Cpi%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>This closes the proof.</p>


<!-- -->

</section>

 ]]></description>
  <category>Stochastic Calculus</category>
  <guid>https://quantdev.blog/posts/first_passage_time_of_BM/</guid>
  <pubDate>Mon, 01 Jul 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/first_passage_time_of_BM/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Borel-Cantelli Lemmas</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/borel_cantelli_lemmas/</link>
  <description><![CDATA[ 





<section id="borel-cantelli-lemmas" class="level2">
<h2 class="anchored" data-anchor-id="borel-cantelli-lemmas">Borel-Cantelli Lemmas</h2>
<p><em>Borel-Cantelli Lemmas</em>.</p>
<ol type="a">
<li><p><em>(First Borel-Cantelli Lemma)</em> Let <img src="https://latex.codecogs.com/png.latex?(A_n)"> be a sequence of events such that the series <img src="https://latex.codecogs.com/png.latex?%5Csum_n%20%5Cmathbb%7BP%7D(A_n)"> converges to a finite value <img src="https://latex.codecogs.com/png.latex?L">. Then, almost surely finitely many <img src="https://latex.codecogs.com/png.latex?A_n">’s will occur.</p></li>
<li><p><em>(Second Borel-Cantelli Lemma)</em> Let <img src="https://latex.codecogs.com/png.latex?(A_n)"> be a sequence of independent events, such that the infinite series <img src="https://latex.codecogs.com/png.latex?%5Csum_n%20%5Cmathbb%7BP%7D(A_n)"> diverges to <img src="https://latex.codecogs.com/png.latex?%5Cinfty">. Then, almost surely, infinitely many <img src="https://latex.codecogs.com/png.latex?A_n">’s will occur.</p></li>
</ol>
<p>Fix a probability space <img src="https://latex.codecogs.com/png.latex?(%5COmega,%5Cmathcal%7BF%7D,%5Cmathbb%7BP%7D)">. Let <img src="https://latex.codecogs.com/png.latex?A_1,%20A_2,%20A_3,%20%5Cldots"> be an infinite sequence of events belonging to <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BF%7D">. We shall often be interested in finding out how many of the <img src="https://latex.codecogs.com/png.latex?A_n">’s occur.</p>
<p>The event <img src="https://latex.codecogs.com/png.latex?A_n"> occurs infinitely often (<img src="https://latex.codecogs.com/png.latex?A_n%5Chspace%7B2mm%7Di.o">) is the set of all <img src="https://latex.codecogs.com/png.latex?%5Comega"> that belong to infinitely many <img src="https://latex.codecogs.com/png.latex?A_n">’s.</p>
<p>Imagine that an infinite number of <img src="https://latex.codecogs.com/png.latex?A_n">’s occur. That is, <img src="https://latex.codecogs.com/png.latex?(%5Cforall%20n)(%5Cexists%20m%20%5Cgeq%20n)(%5Ctext%7Bs.t.%20%7DA_m%20%5Ctext%7B%20occurs%7D)">. In other words:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5C%7BA_n%20%5Ctext%7B%20infinitely%20often%7D%5C%7D%20=%20%5Cbigcap_%7Bn=1%7D%5E%7B%5Cinfty%7D%20%5Cunderbrace%7B%5Cbigcup_%7Bm%5Cgeq%20n%7D%20A_m%7D_%7BB_n%7D%20%5Ctag%7B1%7D%0A%5Cend%7Balign*%7D"></p>
<p>Here, <img src="https://latex.codecogs.com/png.latex?B_n"> is the event that atleast one of <img src="https://latex.codecogs.com/png.latex?A_n,A_%7Bn+1%7D,%5Cldots"> occur. For that reason, <img src="https://latex.codecogs.com/png.latex?B_n"> is referred to as the <img src="https://latex.codecogs.com/png.latex?n">-th tail event. <img src="https://latex.codecogs.com/png.latex?%5C%7BA_n%20%5Chspace%7B2mm%7D%20i.o.%5C%7D"> is the intersection of all <img src="https://latex.codecogs.com/png.latex?B_n">’s, so it is the event that all the <img src="https://latex.codecogs.com/png.latex?B_n">’s occur. Therefore, no matter how far I go, no matter how big <img src="https://latex.codecogs.com/png.latex?n_0"> is, atleast one of <img src="https://latex.codecogs.com/png.latex?A_%7Bn_0%7D,%20A_%7Bn_0%7D+1,%5Cldots"> occurs.</p>
<p>Taking the complement of both sides in (1), we get the expression for the event that <img src="https://latex.codecogs.com/png.latex?A_n"> occurs finitely many times.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5C%7BA_n%20%5Ctext%7B%20occurs%20finitely%20often%7D%5C%7D%20=%20%5Cbigcup_%7Bn_0=1%7D%5E%7B%5Cinfty%7D%20%5Cbigcap_%7Bn%20%5Cgeq%20n_0%7D%20A_n%5EC%0A%5Cend%7Balign*%7D"></p>
<p>It means that, there exists an <img src="https://latex.codecogs.com/png.latex?n_0">, such that each of the further <img src="https://latex.codecogs.com/png.latex?A_i">’s fail to occur.</p>
<p>In order to prove the Borel-Cantelli lemmas, we require the following lemma.</p>
</section>
<section id="limit-of-product-series" class="level2">
<h2 class="anchored" data-anchor-id="limit-of-product-series">Limit of product series</h2>
<p><em>Lemma</em>. If <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=1%7D%5E%5Cinfty%20p_i%20=%20%5Cinfty">, then <img src="https://latex.codecogs.com/png.latex?%5Clim%20%5Cprod_%7Bi=1%7D%5E%7Bn%7D(1-p_i)%20=%200">.</p>
<p><em>Proof.</em></p>
<p>We know that:</p>
<p>Using Taylor’s series expansion of <img src="https://latex.codecogs.com/png.latex?%5Cln(1+x)"> about <img src="https://latex.codecogs.com/png.latex?a=0">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cln(1+x)%20&amp;=%20x%20-%20%5Cfrac%7Bf''(c)%7D%7B2!%7Dx%5E2%5C%5C%0A&amp;=%20x%20-%20%5Cfrac%7B1%7D%7B(1+c)%5E2%7D%20%5Ccdot%20%5Cfrac%7Bx%5E2%7D%7B2%7D%5C%5C%0A&amp;%5Cleq%20x%5C%5C%0A&amp;%5Cquad%20%5C%7B%5Ctext%7Bsince%20%7D%20%5Cleft(%5Cfrac%7Bx%7D%7B1+c%7D%5Cright)%5E2%20%5Cgeq%200%5C%7D%0A%5Cend%7Balign*%7D"></p>
<p>So,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cln(1%20-%20p_i)%20&amp;%5Cleq%20-p_i%5C%5C%0A%5Csum_%7Bi=1%7D%5E%7Bn%7D%20%5Cln(1%20-%20p_i)%20&amp;%5Cleq%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(-p_i)%5C%5C%0A%5Cln%5Cleft(%5Cprod_%7Bi=1%7D%5E%7Bn%7D(1-p_i)%5Cright)%20&amp;%5Cleq%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20(-p_i)%5C%5C%0A%5Cprod_%7Bi=1%7D%5E%7Bn%7D(1-p_i)%20&amp;%5Cleq%20e%5E%7B-%5Csum_%7Bi=1%7D%5E%7Bn%7D%20p_i%7D%0A%5Cend%7Balign*%7D"></p>
<p>So,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A0%20%5Cleq%20%5Cprod_%7Bi=1%7D%5E%7Bn%7D(1-p_i)%20%5Cleq%20e%5E%7B-%5Clim%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20p_i%7D%0A%5Cend%7Balign*%7D"></p>
<p>Now, <img src="https://latex.codecogs.com/png.latex?e%5E%7B-%5Clim%20%5Csum_%7Bi=1%7D%5E%7Bn%7D%20p_i%7D%20=%200">, so by the squeeze theorem, <img src="https://latex.codecogs.com/png.latex?%5Clim%20%5Cprod_%7Bi=1%7D%5E%7Bn%7D(1-p_i)%20=%200">.</p>
</section>
<section id="proof-of-the-first-borel-cantelli-lemma" class="level2">
<h2 class="anchored" data-anchor-id="proof-of-the-first-borel-cantelli-lemma">Proof of the First Borel-Cantelli Lemma</h2>
<p>Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D%5Cleft(%5Cbigcap_%7Bn=1%7D%5E%7B%5Cinfty%7D%20B_n%5Cright)%20=%200">. Observe that, <img src="https://latex.codecogs.com/png.latex?B_1%20%5Csupseteq%20B_2%20%5Csupseteq%20B_3%20%5Csupseteq%20%5Cldots">. So, <img src="https://latex.codecogs.com/png.latex?(B_n)"> is a decreasing sequence of events.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D%5Cleft(%5Cbigcap_%7Bn=1%7D%5E%7B%5Cinfty%7D%20B_n%5Cright)%20&amp;=%20%5Clim_%7Bn%20%5Cto%20%5Cinfty%20%7D%5Cmathbb%7BP%7D(B_n)%20%5C%5C%0A&amp;%20%5Cquad%20%5C%7B%20%5Ctext%7BContinuity%20of%20probability%20measure%7D%20%5C%7D%5C%5C%0A&amp;=%20%5Clim_%7Bn%5Cto%5Cinfty%7D%20%5Cmathbb%7BP%7D%5Cleft(%5Cbigcup_%7Bn=1%7D%5E%7B%5Cinfty%7DA_n%5Cright)%5C%5C%0A&amp;%5Cleq%20%5Clim_%7Bn%5Cto%5Cinfty%7D%20%5Csum_%7Bn=1%7D%5E%7B%5Cinfty%7D%20%5Cmathbb%7BP%7D%5Cleft(A_n%5Cright)%5C%5C%0A&amp;%20%5Cquad%20%5C%7B%20%5Ctext%7BUnion%20bound%7D%20%5C%7D%0A%5Cend%7Balign*%7D"></p>
<p>The infinite series <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bn=1%7D%5E%7B%5Cinfty%7D%20%5Cmathbb%7BP%7D%5Cleft(A_n%5Cright)"> is convergent. The tail sum <img src="https://latex.codecogs.com/png.latex?%5Clim_%7Bk%20%5Cto%20%5Cinfty%7D%20%5Csum%20a_k"> of a convergent series <img src="https://latex.codecogs.com/png.latex?%5Csum%20a_k"> is zero. Hence,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A0%20%5Cleq%20%5Cmathbb%7BP%7D%5Cleft(%5Cbigcap_%7Bn=1%7D%5E%7B%5Cinfty%7D%20B_n%5Cright)%20%5Cleq%200%0A%5Cend%7Balign*%7D"></p>
<p>Consequently,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D%5Cleft(%5Cbigcap_%7Bn=1%7D%5E%7B%5Cinfty%7D%20B_n%5Cright)%20=%200%0A%5Cend%7Balign*%7D"></p>
<p>Hence, <img src="https://latex.codecogs.com/png.latex?A_n"> occurs only finitely many times.</p>
</section>
<section id="proof-of-the-second-borel-cantelli-lemma" class="level2">
<h2 class="anchored" data-anchor-id="proof-of-the-second-borel-cantelli-lemma">Proof of the second Borel-Cantelli Lemma</h2>
<p>Our claim is that <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BP%7D%5Cleft(A_n%20%5Chspace%7B2mm%7D%20i.o.%5Cright)%20=%201">. We must therefore prove that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D%20%5Cleft(%5Cbigcap_%7Bm=1%7D%5E%7B%5Cinfty%7D%20%5Cbigcup_%7Bn=m%7D%5E%7B%5Cinfty%7DA_n%20%5Cright)%20=%20%5Cmathbb%7BP%7D%20%5Cleft(%5Cbigcap_%7Bm=1%7D%5E%7B%5Cinfty%7D%20B_m%20%5Cright)%20=%201%0A%5Cend%7Balign*%7D"></p>
<p>Or:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D%20%5Cleft(%5Cbigcup_%7Bn=1%7D%5E%7B%5Cinfty%7D%20B_n%5EC%20%5Cright)%20=%200%0A%5Cend%7Balign*%7D"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?(B_n%5EC)"> is an increasing sequence of events, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D%20%5Cleft(%5Cbigcup_%7Bn=1%7D%5E%7B%5Cinfty%7D%20B_n%5EC%5Cright)%20&amp;=%20%5Clim%20%5Cmathbb%7BP%7D(B_n%5EC)%5C%5C%0A&amp;=%20%5Clim%20%5Cmathbb%7BP%7D%5Cleft%5C%7B%20%5Cleft(%5Cbigcup_%7Bm%20%5Cgeq%20n%7D%20A_m%5Cright)%5EC%20%5Cright%5C%7D%20%5C%5C%0A&amp;=%20%5Clim%20%5Cmathbb%7BP%7D%20%5Cleft%5C%7B%5Cbigcap_%7Bm%20%5Cgeq%20n%7D%20A_m%5EC%20%5Cright%5C%7D%5C%5C%0A&amp;=%20%5Clim%20%5Cprod_%7Bm=n%7D%5E%7B%5Cinfty%7D%20%5Cmathbb%7BP%7D%20(A_m%5EC)%5C%5C%0A&amp;=%20%5Clim%20%5Cprod_%7Bm=n%7D%5E%7B%5Cinfty%7D%20(1-P(A_m))%0A%5Cend%7Balign*%7D"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?%5Csum_i%20P(A_i)"> diverges to <img src="https://latex.codecogs.com/png.latex?%5Cinfty">, <img src="https://latex.codecogs.com/png.latex?%5Cprod_i%20(1-P(A_i))"> converges to zero. Consequently,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbb%7BP%7D%20%5Cleft(%5Cbigcup_%7Bn=1%7D%5E%7B%5Cinfty%7D%20B_n%5EC%20%5Cright)%20=%200%0A%5Cend%7Balign*%7D"></p>


<!-- -->

</section>

 ]]></description>
  <category>Probability Theory</category>
  <guid>https://quantdev.blog/posts/borel_cantelli_lemmas/</guid>
  <pubDate>Thu, 27 Jun 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/borel_cantelli_lemmas/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Positive Definiteness</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/positive_definiteness/</link>
  <description><![CDATA[ 





<section id="positive-definite-matrices" class="level2">
<h2 class="anchored" data-anchor-id="positive-definite-matrices">Positive Definite Matrices</h2>
<p><em>Definition 1</em>. A real-valued symmetric matrix <img src="https://latex.codecogs.com/png.latex?A"> is <em>positive-definite</em> (written as <img src="https://latex.codecogs.com/png.latex?A%20%5Csucc%200">), if for every real valued vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%20%5Cin%20%5Cmathbf%7BR%7D%5En%20%5Csetminus%20%5C%7B%5Cmathbf%7B0%7D%5C%7D">, the quadratic form</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aq(%5Cmathbf%7Bx%7D)%20=%20%5Cmathbf%7Bx%7D%5ET%20A%20%5Cmathbf%7Bx%7D%20%3E%200%0A%5Cend%7Balign*%7D"></p>
<p>The real-value symmetric matrix <img src="https://latex.codecogs.com/png.latex?A"> is positive semi-definite (written as <img src="https://latex.codecogs.com/png.latex?A%20%5Csucceq%200">) if :</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aq(%5Cmathbf%7Bx%7D)%20=%20%5Cmathbf%7Bx%7D%5ET%20A%20%5Cmathbf%7Bx%7D%20%5Cgeq%200%0A%5Cend%7Balign*%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cforall%20%5Cmathbf%7Bx%7D%20%5Cin%20%5Cmathbf%7BR%7D%5En%20%5Csetminus%20%5C%7B%5Cmathbf%7B0%7D%5C%7D">.</p>
<p>Intuitively, positive definite matrices are like strictly positive real numbers. Consider a scalar <img src="https://latex.codecogs.com/png.latex?a%20%3E%200">. The sign of <img src="https://latex.codecogs.com/png.latex?ax"> will depend on the sign of <img src="https://latex.codecogs.com/png.latex?x">. And <img src="https://latex.codecogs.com/png.latex?x%5Ccdot%20ax%20%3E%200">. However, if <img src="https://latex.codecogs.com/png.latex?a%20%3C%200">, multiplying it with <img src="https://latex.codecogs.com/png.latex?x"> will flip the sign, so <img src="https://latex.codecogs.com/png.latex?x"> and <img src="https://latex.codecogs.com/png.latex?ax"> have opposite signs and <img src="https://latex.codecogs.com/png.latex?x%20%5Ccdot%20ax%20%3C%200">.</p>
<p>If <img src="https://latex.codecogs.com/png.latex?A%20%5Csucc%200">, then by definition <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%5ET%20A%20%5Cmathbf%7Bx%7D%20%3E%200"> for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%20%5Cin%20%5Cmathbf%7BR%7D%5En">. Thus, the vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D"> and it’s transformed self <img src="https://latex.codecogs.com/png.latex?A%5Cmathbf%7Bx%7D"> should make an angle <img src="https://latex.codecogs.com/png.latex?%5Ctheta%20%5Cin%20%5Cleft%5B-%5Cfrac%7B%5Cpi%7D%7B2%7D,%5Cfrac%7B%5Cpi%7D%7B2%7D%5Cright%5D">. Both <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D"> and <img src="https://latex.codecogs.com/png.latex?A%5Cmathbf%7Bx%7D"> lie on the same side of the hyperplane <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%5E%7B%5Cperp%7D">.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>load_ext itikz</span></code></pre></div>
</div>
<div class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb2-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb2-3">\draw [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>] (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) node [below] {\huge $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-4">\draw [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [above] {\huge $x_2$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-5">\draw [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) node [above] {\huge $\mathbf{x}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-6">\draw [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) node [above] {\huge $A\mathbf{x}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-7">\draw [dashed] (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) node [] {\huge $\mathbf{x}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{\perp}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-8">\draw[draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>black,thick] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) arc (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">18.43</span>:<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">68.19</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) node [midway,above] {\huge $\theta$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-9">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/positive_definiteness/index_files/figure-html/cell-3-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="convex-functions" class="level2">
<h2 class="anchored" data-anchor-id="convex-functions">Convex functions</h2>
<p>There is a second geometric way to think about positive definite matrices : a quadratic form is convex when the matrix is symmetric and positive definite.</p>
<p><em>Definition 2.</em> (Convex function) A function <img src="https://latex.codecogs.com/png.latex?f:%5Cmathbf%7BR%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> is <em>convex</em>, if for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D,%5Cmathbf%7By%7D%5Cin%20%5Cmathbf%7BR%7D%5En"> and <img src="https://latex.codecogs.com/png.latex?0%20%5Cleq%20%5Clambda%20%5Cleq%201">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(%5Clambda%20%5Cmathbf%7Bx%7D%20+%20(1-%5Clambda)%5Cmathbf%7By%7D)%20%5Cleq%20%5Clambda%20f(%5Cmathbf%7Bx%7D)%20+%20(1-%5Clambda)%20f(%5Cmathbf%7By%7D)%20%5Ctag%7B1%7D%0A%5Cend%7Balign*%7D"></p>
<p><em>Proposition 3.</em> Assume that the function <img src="https://latex.codecogs.com/png.latex?f:%5Cmathbf%7BR%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> is differentiable. Then, <img src="https://latex.codecogs.com/png.latex?f"> is convex, if and only if, for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D,%5Cmathbf%7By%7D%20%5Cin%20%5Cmathbf%7BR%7D%5En">, the inequality</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(%5Cmathbf%7By%7D)%20%5Cgeq%20f(%5Cmathbf%7Bx%7D)%20+%20%5Cnabla%20f(%5Cmathbf%7By%7D)%5ET%20(%5Cmathbf%7By%7D%20-%20%5Cmathbf%7Bx%7D)%20%5Ctag%7B2%7D%0A%5Cend%7Balign*%7D"></p>
<p>is satisfied.</p>
<p><em>Proof.</em></p>
<p><img src="https://latex.codecogs.com/png.latex?%5CLongrightarrow"> direction.</p>
<p>Assume that <img src="https://latex.codecogs.com/png.latex?f"> is convex and let <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%20%5Cneq%20%5Cmathbf%7By%7D%20%5Cin%20%5Cmathbf%7BR%7D%5En">. The convexity of <img src="https://latex.codecogs.com/png.latex?f"> implies that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af((%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7By%7D)/2)%20%5Cleq%20%5Cfrac%7B1%7D%7B2%7Df(%5Cmathbf%7Bx%7D)%20+%20%5Cfrac%7B1%7D%7B2%7Df(%5Cmathbf%7By%7D)%0A%5Cend%7Balign*%7D"></p>
<p>Denote now <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bh%7D%20=%20%5Cmathbf%7By%7D-%5Cmathbf%7Bx%7D">. Then this inequality reads:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D/2)%20%5Cleq%20%5Cfrac%7B1%7D%7B2%7D%20f(%5Cmathbf%7Bx%7D)%20+%20%5Cfrac%7B1%7D%7B2%7Df(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D)%0A%5Cend%7Balign*%7D"></p>
<p>Using elementary transformations, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7Bf(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D/2)%7D%7B1/2%7D%20&amp;%5Cleq%20f(%5Cmathbf%7Bx%7D)%20+%20f(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D)%20%5C%5C%0Af(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D)%20-%20f(%5Cmathbf%7Bx%7D)%20&amp;%5Cgeq%20%5Cfrac%7Bf(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D/2)%20-%20f(%5Cmathbf%7Bx%7D)%7D%7B1/2%7D%0A%5Cend%7Balign*%7D"></p>
<p>Repeating this line of argumentation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D)%20-%20f(%5Cmathbf%7Bx%7D)%20%5Cgeq%20%5Cfrac%7Bf(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D/2)%20-%20f(%5Cmathbf%7Bx%7D)%7D%7B1/2%7D%20%5Cgeq%20%5Cfrac%7Bf(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D/4)%20-%20f(%5Cmathbf%7Bx%7D)%7D%7B1/4%7D%0A%5Cend%7Balign*%7D"></p>
<p>Consequently,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D)%20-%20f(%5Cmathbf%7Bx%7D)%20%5Cgeq%20%5Cfrac%7Bf(%5Cmathbf%7Bx%7D%20+%202%5E%7B-k%7D%5Cmathbf%7Bh%7D)%20-%20f(%5Cmathbf%7Bx%7D)%7D%7B2%5E%7B-k%7D%7D%20%5Ctag%7B2%7D%0A%5Cend%7Balign*%7D"></p>
<p>By the order limit theorem,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bh%7D)%20-%20f(%5Cmathbf%7Bx%7D)%20%5Cgeq%20%5Clim_%7Bk%20%5Cto%20%5Cinfty%7D%5Cfrac%7Bf(%5Cmathbf%7Bx%7D%20+%202%5E%7B-k%7D%5Cmathbf%7Bh%7D)%20-%20f(%5Cmathbf%7Bx%7D)%7D%7B2%5E%7B-k%7D%7D%20=%20D_%7B%5Cmathbf%7Bh%7D%7Df(%5Cmathbf%7Bx%7D)%20=%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%20%5Ccdot%20(%5Cmathbf%7By%7D%20-%20%5Cmathbf%7Bx%7D)%0A%5Cend%7Balign*%7D"></p>
<p>Replacing <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D-%5Cmathbf%7Bx%7D"> by <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bh%7D">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(%5Cmathbf%7By%7D)%20%5Cgeq%20f(%5Cmathbf%7Bx%7D)%20+%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5ET%20(%5Cmathbf%7By%7D%20-%20%5Cmathbf%7Bx%7D)%0A%5Cend%7Balign*%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5CLongleftarrow"> direction.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bw%7D,%20%5Cmathbf%7Bz%7D%20%5Cin%20%5Cmathbf%7BR%7D%5En">. Moreover, denote:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbf%7Bx%7D%20:=%20%5Clambda%20%5Cmathbf%7Bw%7D%20+%20(1-%5Clambda)%5Cmathbf%7Bz%7D%0A%5Cend%7Balign*%7D"></p>
<p>Then, the inequality in (1) implies that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(%5Cmathbf%7Bw%7D)%20&amp;%5Cgeq%20f(%5Cmathbf%7Bx%7D)%20+%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5ET%20(%5Cmathbf%7Bw%7D%20-%20%5Cmathbf%7Bx%7D)%5C%5C%0Af(%5Cmathbf%7Bz%7D)%20&amp;%5Cgeq%20f(%5Cmathbf%7Bx%7D)%20+%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5ET%20(%5Cmathbf%7Bz%7D%20-%20%5Cmathbf%7Bx%7D)%20%5Ctag%7B3%7D%0A%5Cend%7Balign*%7D"></p>
<p>Note moreover that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbf%7Bw%7D%20-%20%5Cmathbf%7Bx%7D%20&amp;=%20(1-%5Clambda)(%5Cmathbf%7Bw%7D-%5Cmathbf%7Bz%7D)%5C%5C%0A%5Cmathbf%7Bz%7D%20-%20%5Cmathbf%7Bx%7D%20&amp;=%20%5Clambda(%5Cmathbf%7Bz%7D-%5Cmathbf%7Bw%7D)%0A%5Cend%7Balign*%7D"></p>
<p>Thus, if we multiply the first line in (3) with <img src="https://latex.codecogs.com/png.latex?%5Clambda"> and the second line with <img src="https://latex.codecogs.com/png.latex?(1-%5Clambda)"> and then add the two inequalities, we obtain:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Clambda%20f(%5Cmathbf%7Bw%7D)%20+%20(1-%5Clambda)f(%5Cmathbf%7Bz%7D)%20&amp;%5Cgeq%20f(%5Cmathbf%7Bx%7D)%20+%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5B%5Clambda(1-%5Clambda)(%5Cmathbf%7Bw%7D%20-%20%5Cmathbf%7Bz%7D%20+%20%5Cmathbf%7Bz%7D%20-%20%5Cmathbf%7Bw%7D)%5C%5C%0A&amp;=f(%5Clambda%20%5Cmathbf%7Bw%7D%20+%20(1-%5Clambda)%5Cmathbf%7Bz%7D)%0A%5Cend%7Balign*%7D"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bw%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bz%7D"> were arbitrary, this proves the convexity of <img src="https://latex.codecogs.com/png.latex?f">.</p>
<p>The convexity of a differentiable function can either be characterized by the fact that all secants lie above the graph or that all tangents lie below the graph.</p>
<p>We state the next corollary without proof.</p>
<p><em>Corollary 4</em>. Assume that <img src="https://latex.codecogs.com/png.latex?f:%5Cmathbf%7BR%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> is convex and differentiable. Then <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%5E*"> is a global minimizer of <img src="https://latex.codecogs.com/png.latex?f">, if and only if <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20f(%5Cmathbf%7Bx%7D%5E%7B*%7D)%20=%200">.</p>
<section id="hessians-of-convex-functions." class="level3">
<h3 class="anchored" data-anchor-id="hessians-of-convex-functions.">Hessians of convex functions.</h3>
<p><em>Proposition 5.</em> (Second derivative test) Let <img src="https://latex.codecogs.com/png.latex?f:X%5Csubseteq%5Cmathbf%7BR%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> be a <img src="https://latex.codecogs.com/png.latex?C%5E2"> function and suppose that <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D%5Cin%20X"> is a critical point of <img src="https://latex.codecogs.com/png.latex?f">. If the hessian <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E2%20f(%5Cmathbf%7Ba%7D)"> is positive definite, then <img src="https://latex.codecogs.com/png.latex?f"> has a local minimum at <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D">.</p>
<p><em>Proof.</em></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?q(%5Cmathbf%7Bx%7D)%20=%20%5Cmathbf%7Bx%7D%5ET%20A%20%5Cmathbf%7Bx%7D"> be a quadratic form. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aq(%5Clambda%20%5Cmathbf%7Bh%7D)%20&amp;=%20(%5Clambda%20%5Cmathbf%7Bx%7D%5ET)%20A%20(%5Clambda%20%5Cmathbf%7Bx%7D)%5C%5C%0A&amp;=%20%5Clambda%5E2%20%5Cmathbf%7Bx%7D%5ET%20A%20%5Cmathbf%7Bx%7D%5C%5C%0A&amp;=%20%5Clambda%5E2%20q(%5Cmathbf%7Bx%7D)%20%5Ctag%7B4%7D%0A%5Cend%7Balign*%7D"></p>
<p>We show that if <img src="https://latex.codecogs.com/png.latex?A"> is the symmetric matrix associated with a positive definite quadratic form <img src="https://latex.codecogs.com/png.latex?q(%5Cmathbf%7Bx%7D)">, then there exists <img src="https://latex.codecogs.com/png.latex?M%20%3E%200"> such that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aq(%5Cmathbf%7Bh%7D)%20%5Cgeq%20M%20%7C%7C%5Cmathbf%7Bh%7D%7C%7C%5E2%20%5Ctag%7B5%7D%0A%5Cend%7Balign*%7D"></p>
<p>for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bh%7D%20%5Cin%20%5Cmathbf%7BR%7D%5En">.</p>
<p>First note that when <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bh%7D%20=%20%5Cmathbf%7B0%7D">, then <img src="https://latex.codecogs.com/png.latex?q(%5Cmathbf%7Bh%7D)=q(%5Cmathbf%7B0%7D)=0">, so the conclusion holds trivially in this case.</p>
<p>Next, suppose that when <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bh%7D"> is a unit vector, that is <img src="https://latex.codecogs.com/png.latex?%7C%7C%5Cmathbf%7Bh%7D%7C%7C=1">. The set of all unit vectors in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5En"> is an <img src="https://latex.codecogs.com/png.latex?(n-1)">-dimensional hypersphere, which is a compact set. By the extreme-value theorem, the restriction of <img src="https://latex.codecogs.com/png.latex?q"> to <img src="https://latex.codecogs.com/png.latex?S"> must achieve a global minimum value <img src="https://latex.codecogs.com/png.latex?M"> somewhere on <img src="https://latex.codecogs.com/png.latex?S">. Thus, <img src="https://latex.codecogs.com/png.latex?q(%5Cmathbf%7Bh%7D)%20%5Cgeq%20M"> for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bh%7D%20%5Cin%20S">.</p>
<p>Finally, let <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bh%7D"> be any nonzero vector in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5En">. Then, its normalization <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bh%7D/%7C%7C%5Cmathbf%7Bh%7D%7C%7C"> is a unit vector and also lies in <img src="https://latex.codecogs.com/png.latex?S">. Therefore, by the result of step 1, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aq(%5Cmathbf%7Bh%7D)%20&amp;=%20q%5Cleft(%7C%7C%5Cmathbf%7Bh%7D%7C%7C%20%5Ccdot%20%5Cfrac%7B%5Cmathbf%7Bh%7D%7D%7B%7C%7C%5Cmathbf%7Bh%7D%7C%7C%7D%20%5Cright)%5C%5C%0A&amp;=%20%7C%7C%5Cmathbf%7Bh%7D%7C%7C%5E2%20q%5Cleft(%5Cfrac%7B%5Cmathbf%7Bh%7D%7D%7B%7C%7C%5Cmathbf%7Bh%7D%7C%7C%7D%5Cright)%5C%5C%0A&amp;%5Cgeq%20M%20%7C%7C%5Cmathbf%7Bh%7D%7C%7C%5E2%0A%5Cend%7Balign*%7D"></p>
<p>We can now prove the theorem.</p>
<p>By the second order Taylor’s formula, we have that, for the critical point <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D"> of <img src="https://latex.codecogs.com/png.latex?f">,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(%5Cmathbf%7Bx%7D)%20=%20f(%5Cmathbf%7Ba%7D)%20+%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5Ccdot(%5Cmathbf%7Bx%7D%20-%20%5Cmathbf%7Ba%7D)%20+%20%5Cfrac%7B1%7D%7B2%7D(%5Cmathbf%7Bx%7D%20-%20%5Cmathbf%7Ba%7D)%5ET%20%5Cnabla%5E2%20f(%5Cmathbf%7Ba%7D)%20(%5Cmathbf%7Bx%7D%20-%20%5Cmathbf%7Ba%7D)%20+%20R_2(%5Cmathbf%7Bx%7D,%5Cmathbf%7Ba%7D)%20%5Ctag%7B6%7D%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?R_2(%5Cmathbf%7Bx%7D,%5Cmathbf%7Ba%7D)/%7C%7C%5Cmathbf%7Bx%7D-%5Cmathbf%7Ba%7D%7C%7C%5E2%20%5Cto%200"> as <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%20%5Cto%20%5Cmathbf%7Ba%7D">.</p>
<p>If <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E2%20f(%5Cmathbf%7Ba%7D)%20%5Csucc%200">, then</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B1%7D%7B2%7D(%5Cmathbf%7Bx%7D%20-%20%5Cmathbf%7Ba%7D)%5ET%20%5Cnabla%5E2%20f(%5Cmathbf%7Ba%7D)%20(%5Cmathbf%7Bx%7D%20-%20%5Cmathbf%7Ba%7D)%20%5Cgeq%20M%7C%7C%5Cmathbf%7Bx%7D%20-%20%5Cmathbf%7Ba%7D%7C%7C%5E2%20%5Ctag%7B7%7D%0A%5Cend%7Balign*%7D"></p>
<p>Pick <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20%20=%20M">. By the definition of limits, since <img src="https://latex.codecogs.com/png.latex?R_2(%5Cmathbf%7Bx%7D,%5Cmathbf%7Ba%7D)/%7C%7C%5Cmathbf%7Bx%7D%20-%20%5Cmathbf%7Ba%7D%7C%7C%5E2%20%5Cto%200"> as <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%20%5Cto%20%5Cmathbf%7Ba%7D">, there exists <img src="https://latex.codecogs.com/png.latex?%5Cdelta%20%3E%200">, such that for all <img src="https://latex.codecogs.com/png.latex?%7C%7C%5Cmathbf%7Bx%7D%20-%20%5Cmathbf%7Ba%7D%7C%7C%3C%5Cdelta">, <img src="https://latex.codecogs.com/png.latex?%7CR_2(%5Cmathbf%7Bx%7D,%5Cmathbf%7Ba%7D)%7C/%7C%7C%5Cmathbf%7Bx%7D%20-%20%5Cmathbf%7Ba%7D%7C%7C%5E2%20%3C%20M">. Or equivalently,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%7CR_2(%5Cmathbf%7Bx%7D,%5Cmathbf%7Ba%7D)%7C%20%3C%20M%7C%7C%5Cmathbf%7Bx%7D-%5Cmathbf%7Ba%7D%7C%7C%5E2%0A%5Cend%7Balign*%7D"></p>
<p>that is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A-M%7C%7C%5Cmathbf%7Bx%7D-%5Cmathbf%7Ba%7D%7C%7C%5E2%20%3C%20R_2(%5Cmathbf%7Bx%7D,%5Cmathbf%7Ba%7D)%20%3C%20M%7C%7C%5Cmathbf%7Bx%7D-%5Cmathbf%7Ba%7D%7C%7C%5E2%20%5Ctag%7B8%7D%0A%5Cend%7Balign*%7D"></p>
<p>Putting together (6), (7) and (8),</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(%5Cmathbf%7Bx%7D)%20-%20f(%5Cmathbf%7Ba%7D)%20%3E%200%0A%5Cend%7Balign*%7D"></p>
<p>so that <img src="https://latex.codecogs.com/png.latex?f"> has a minimum at <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D">.</p>
<p><em>Proposition 6</em>. A twice differentiable function <img src="https://latex.codecogs.com/png.latex?f:%5Cmathbf%7BR%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> is convex, if and only if, the hessian <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E2%20f(%5Cmathbf%7Bx%7D)"> is positive semi-definite for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%5Cin%5Cmathbf%7BR%7D%5En">.</p>
<p><em>Proof.</em></p>
<p>Assume first that <img src="https://latex.codecogs.com/png.latex?f"> is convex and let <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%5Cin%5Cmathbf%7BR%7D%5En">. Define the <img src="https://latex.codecogs.com/png.latex?g:%5Cmathbf%7BR%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> as a function of the vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D"> setting:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Ag(%5Cmathbf%7By%7D)%20:=%20f(%5Cmathbf%7By%7D)%20-%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5ET%20(%5Cmathbf%7By%7D%20-%20%5Cmathbf%7Bx%7D)%0A%5Cend%7Balign*%7D"></p>
<p>Consider the mapping <img src="https://latex.codecogs.com/png.latex?T(%5Cmathbf%7By%7D)%20=%20-%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5ET%20(%5Cmathbf%7By%7D%20-%20%5Cmathbf%7Bx%7D)">. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AT(%5Clambda%20%5Cmathbf%7By%7D_1%20+%20(1-%5Clambda)%5Cmathbf%7By%7D_2)%20&amp;=%20-%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5ET%20(%5Clambda%20%5Cmathbf%7By%7D_1%20+%20(1-%5Clambda)%5Cmathbf%7By%7D_2%20-%20%5Cmathbf%7Bx%7D)%20%5C%5C%0A&amp;=%20%5Clambda%20%5B-%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5ET%20(%5Cmathbf%7By%7D_1%20-%20%5Cmathbf%7Bx%7D)%5D%20+%20(1-%5Clambda)%5B-%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5ET%20(%5Cmathbf%7By%7D_2%20-%20%5Cmathbf%7Bx%7D)%5D%5C%5C%0A&amp;=%5Clambda%20T(%5Cmathbf%7By%7D_1)%20+%20(1-%5Clambda)T(%5Cmathbf%7By%7D_2)%0A%5Cend%7Balign*%7D"></p>
<p>Thus, <img src="https://latex.codecogs.com/png.latex?T"> is an affine transformation.</p>
<p>Since an affine transformation is convex and <img src="https://latex.codecogs.com/png.latex?f"> is convex, their sum <img src="https://latex.codecogs.com/png.latex?g"> is also convex. Moreover <img src="https://latex.codecogs.com/png.latex?g"> is a function of <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D">, treating <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D"> as a constant, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cnabla%20g(%5Cmathbf%7By%7D)%20=%20%5Cnabla%20f(%5Cmathbf%7By%7D)%20-%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%0A%5Cend%7Balign*%7D"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cnabla%5E2%20g(%5Cmathbf%7By%7D)%20=%20%5Cnabla%5E2%20f(%5Cmathbf%7By%7D)%0A%5Cend%7Balign*%7D"></p>
<p>for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D%20%5Cin%20%5Cmathbf%7BR%7D%5En">. In particular, <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20g(%5Cmathbf%7Bx%7D)%20=%200">. Thus, corollary (4) implies that <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D"> is a global minimizer of <img src="https://latex.codecogs.com/png.latex?g">. Now, the second order necessary condition for a minimizer implies that <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E2%20g(%5Cmathbf%7Bx%7D)"> is positive semi-definite. Since <img src="https://latex.codecogs.com/png.latex?%5Cnabla%5E2%20g(%5Cmathbf%7Bx%7D)%20=%20%5Cnabla%5E2%20f(%5Cmathbf%7Bx%7D)">, this proves that the Hessian of <img src="https://latex.codecogs.com/png.latex?f"> is positive semi-definite for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D%20%5Cin%20%5Cmathbf%7BR%7D%5En">.</p>
<p>Thus, a function <img src="https://latex.codecogs.com/png.latex?f"> is convex, if its Hessian is everywhere positive semi-definite. This allows us to test whether a given function is convex.</p>
</section>
</section>
<section id="tests-for-positive-definiteness" class="level2">
<h2 class="anchored" data-anchor-id="tests-for-positive-definiteness">Tests for positive definiteness</h2>
<p>One of the most important theorems of finite dimensional vector spaces is the <em>spectral theorem</em>. Every real symmetric matrix <img src="https://latex.codecogs.com/png.latex?A"> is orthogonally diagonalizable. It admits <img src="https://latex.codecogs.com/png.latex?A%20=%20Q%5CLambda%20Q%5ET"> factorization, where <img src="https://latex.codecogs.com/png.latex?Q"> is an orthogonal matrix and <img src="https://latex.codecogs.com/png.latex?%5CLambda%20=%20diag(%5Clambda_1,%5Cldots,%5Clambda_n)">.</p>
<p>From basic algebra, we know that, if <img src="https://latex.codecogs.com/png.latex?A"> is a non-singular matrix, with all it’s pivot elements <img src="https://latex.codecogs.com/png.latex?a_%7Bkk%7D%5E%7B(k)%7D"> non-zero in the Gaussian elimination process, then <img src="https://latex.codecogs.com/png.latex?A=LDU"> where <img src="https://latex.codecogs.com/png.latex?L"> and <img src="https://latex.codecogs.com/png.latex?U"> are lower and upper unitriangular matrices and <img src="https://latex.codecogs.com/png.latex?D"> is a diagonal matrix consisting of the pivots of <img src="https://latex.codecogs.com/png.latex?A">. If <img src="https://latex.codecogs.com/png.latex?A"> is symmetric, then it admits the unique factorization <img src="https://latex.codecogs.com/png.latex?A%20=%20LDL%5ET">.</p>
<p>Consider the quadratic form <img src="https://latex.codecogs.com/png.latex?q(%5Cmathbf%7Bx%7D)%20=%20%5Cmathbf%7Bx%7D%5ET%20A%20%5Cmathbf%7Bx%7D">. Substituting <img src="https://latex.codecogs.com/png.latex?A%20=%20Q%20%5CLambda%20Q%5ET">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aq(%5Cmathbf%7Bx%7D)%20&amp;=%20%5Cmathbf%7Bx%7D%5ET%20A%20%5Cmathbf%7Bx%7D%20%5C%5C%0A&amp;=%20%5Cmathbf%7Bx%7D%5ET%20Q%20%5CLambda%20Q%5ET%20%5Cmathbf%7Bx%7D%20%5C%5C%0A&amp;=%20(Q%5ET%20%5Cmathbf%7Bx%7D)%5ET%20%5CLambda%20(Q%5ET%20%5Cmathbf%7Bx%7D)%20%5Ctag%7B9%7D%0A%5Cend%7Balign*%7D"></p>
<p>But, the matrix <img src="https://latex.codecogs.com/png.latex?Q%20=%20%5B%5Cmathbf%7Bq%7D_1,%5Cmathbf%7Bq%7D_2,%5Cldots,%5Cmathbf%7Bq%7D_n%5D">. Moreover, <img src="https://latex.codecogs.com/png.latex?A=Q%5CLambda%20Q%5ET"> implies that <img src="https://latex.codecogs.com/png.latex?AQ%5E%7B-1%7D%20=%20AQ%5ET%20=%20%5CLambda%20Q%5ET">. Therefore:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AA%5Cbegin%7Bbmatrix%7D%0A%5Cmathbf%7Bq%7D_1%5C%5C%0A%5Cmathbf%7Bq%7D_2%5C%5C%0A%5Cvdots%5C%5C%0A%5Cmathbf%7Bq%7D_n%0A%5Cend%7Bbmatrix%7D=%5Cbegin%7Bbmatrix%7D%0A%5Clambda_1%20%5C%5C%0A&amp;%20%5Clambda_2%20%5C%5C%0A&amp;%20&amp;%20%5Cddots%20%5C%5C%0A&amp;%20&amp;%20&amp;%20%5Clambda_n%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%0A%5Cmathbf%7Bq%7D_1%5C%5C%0A%5Cmathbf%7Bq%7D_2%5C%5C%0A%5Cvdots%5C%5C%0A%5Cmathbf%7Bq%7D_n%0A%5Cend%7Bbmatrix%7D%0A%5Cend%7Balign*%7D"></p>
<p>So, <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bq%7D_1,%5Cldots,%5Cmathbf%7Bq%7D_n"> are the eigenvectors of <img src="https://latex.codecogs.com/png.latex?A">. Now,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbf%7Bq%7D_1%20&amp;=%20%5Bq_%7B11%7D,%20q_%7B21%7D,%20%5Cldots,q_%7Bn1%7D%5D%5ET%20=%20q_%7B11%7D%20%5Cmathbf%7Be%7D_1%20+%20q_%7B21%7D%20%5Cmathbf%7Be%7D_2%20+%20%5Cldots%20+%20q_%7Bn1%7D%20%5Cmathbf%7Be%7D_n%5C%5C%0A%5Cmathbf%7Bq%7D_2%20&amp;=%20%5Bq_%7B12%7D,%20q_%7B22%7D,%20%5Cldots,q_%7Bn2%7D%5D%5ET%20=%20q_%7B12%7D%20%5Cmathbf%7Be%7D_1%20+%20q_%7B22%7D%20%5Cmathbf%7Be%7D_2%20+%20%5Cldots%20+%20q_%7Bn2%7D%20%5Cmathbf%7Be%7D_n%5C%5C%0A%5Cvdots%20%5C%5C%0A%5Cmathbf%7Bq%7D_n%20&amp;=%20%5Bq_%7B1n%7D,%20q_%7B2n%7D,%20%5Cldots,q_%7Bnn%7D%5D%5ET%20=%20q_%7B1n%7D%20%5Cmathbf%7Be%7D_1%20+%20q_%7B2n%7D%20%5Cmathbf%7Be%7D_2%20+%20%5Cldots%20+%20q_%7Bnn%7D%20%5Cmathbf%7Be%7D_n%0A%5Cend%7Balign*%7D"></p>
<p>So,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AQ%20=%20%5Cbegin%7Bbmatrix%7D%0Aq_%7B11%7D%20&amp;%20%5Cldots%20&amp;%20q_%7B1n%7D%5C%5C%0A%5Cvdots%20&amp;%20&amp;%20%5Cvdots%20%5C%5C%0Aq_%7Bn1%7D%20&amp;%20%5Cldots%20&amp;%20q_%7Bnn%7D%0A%5Cend%7Bbmatrix%7D%0A%5Cend%7Balign*%7D"></p>
<p>is the change of basis matrix from the standard basis <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BB%7D_%7Bold%7D=%5C%7B%5Cmathbf%7Be%7D_1,%5Cldots,%5Cmathbf%7Be%7D_n%5C%7D"> to the eigenvector basis <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BB%7D_%7Bnew%7D=%5C%7B%5Cmathbf%7Bq%7D_1,%5Cldots,%5Cmathbf%7Bq%7D_n%5C%7D">.</p>
<p>If <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D"> are the coordinates of a vector in the standard basis and <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D"> are its coordinates in the eigenvector basis, then <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D=Q%5Cmathbf%7By%7D">.</p>
<p>Hence, substituting <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D=Q%5E%7B-1%7D%5Cmathbf%7Bx%7D=Q%5ET%20%5Cmathbf%7Bx%7D"> in equation (9), the quadratic form becomes:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aq(%5Cmathbf%7Bx%7D)%20&amp;=%20%5Cmathbf%7Bx%7D%5ET%20A%20%5Cmathbf%7Bx%7D%20=%20%5Cmathbf%7By%7D%5ET%20%5CLambda%20%5Cmathbf%7By%7D%5C%5C%0A&amp;=%5Clambda_1%20y_1%5E2%20+%20%5Clambda_2%20y_2%5E2%20+%20%5Cldots%20+%20%5Clambda_n%20y_n%5E2%0A%5Cend%7Balign*%7D"></p>
<p>where we have changed the axes to be aligned across the eigenvectors of <img src="https://latex.codecogs.com/png.latex?A">.</p>
<p>The coefficients <img src="https://latex.codecogs.com/png.latex?%5Clambda_i"> are the diagonal entries of <img src="https://latex.codecogs.com/png.latex?%5CLambda"> and are the pivots of <img src="https://latex.codecogs.com/png.latex?A">. The quadratic form is strictly positive for all <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D">, if and only if the eigenvalues <img src="https://latex.codecogs.com/png.latex?%5Clambda_1%20%3E%200">, <img src="https://latex.codecogs.com/png.latex?%5Clambda_2%20%3E0">, <img src="https://latex.codecogs.com/png.latex?%5Cldots">, <img src="https://latex.codecogs.com/png.latex?%5Clambda_n%20%3E%200">.</p>
<p><em>Theorem 7.</em> (Positive definiteness) Let <img src="https://latex.codecogs.com/png.latex?A%20%5Cin%20%5Cmathbf%7BR%7D%5E%7Bn%20%5Ctimes%20n%7D"> be a real symmetric positive definite(SPD) matrix. Then, the following statements are equivalent:</p>
<ol type="1">
<li><p><img src="https://latex.codecogs.com/png.latex?A"> is non-singular and has positive pivot elements when performing Gaussian elimination (without row exchanges).</p></li>
<li><p><img src="https://latex.codecogs.com/png.latex?A"> admits a factorization <img src="https://latex.codecogs.com/png.latex?A%20=%20Q%20%5CLambda%20Q%5ET">, where <img src="https://latex.codecogs.com/png.latex?%5CLambda%20=%20diag(%5Clambda_1,%5Cldots,%5Clambda_n)"> such that <img src="https://latex.codecogs.com/png.latex?%5Clambda_i%20%3E%200"> for all <img src="https://latex.codecogs.com/png.latex?i=1,2,3,%5Cldots,n">.</p></li>
</ol>
</section>
<section id="cholesky-factorization" class="level2">
<h2 class="anchored" data-anchor-id="cholesky-factorization">Cholesky Factorization</h2>
<p>We can push the result above slightly further in the positive definite case. Since, each eigen value <img src="https://latex.codecogs.com/png.latex?%5Clambda_i"> is positive, the quadratic form can be written as a sum of squares:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Clambda_1%20y_1%5E2%20+%20%5Clambda_2%20y_2%5E2%20+%20%5Cldots%20+%20%5Clambda_n%20y_n%5E2%20&amp;=%20(%5Csqrt%7B%5Clambda_1%7D%20y_1)%5E2%20+%20%5Cldots%20+%20(%5Csqrt%7B%5Clambda_n%7D%20y_n)%5E2%5C%5C%0A&amp;=%20z_1%5E2%20+%20z%5E2%20+%20%5Cldots%20+%20z_n%5E2%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?z_i%20=%5Csqrt%7B%5Clambda_i%7Dy_i">. In the matrix form, we are writing:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Chat%7Bq%7D(%5Cmathbf%7By%7D)%20&amp;=%20%5Cmathbf%7By%7D%5ET%20%5CLambda%20%5Cmathbf%7By%7D%5C%5C%0A&amp;=%20%5Cmathbf%7Bz%7D%5ET%20%5Cmathbf%7Bz%7D%5C%5C%0A&amp;=%20%7C%7C%5Cmathbf%7Bz%7D%7C%7C%5E2%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bz%7D%20=%20S%5Cmathbf%7By%7D"> with <img src="https://latex.codecogs.com/png.latex?S=diag(%5Csqrt%7B%5Clambda_1%7D,%5Cldots,%5Csqrt%7B%5Clambda_n%7D)">. Since <img src="https://latex.codecogs.com/png.latex?%5CLambda%20=%20S%5E2=SS%5ET">, <img src="https://latex.codecogs.com/png.latex?S"> can be thought as the square root of the original matrix <img src="https://latex.codecogs.com/png.latex?%5CLambda">. Substituting back into the equation <img src="https://latex.codecogs.com/png.latex?A=Q%5CLambda%20Q%5ET">, we deduce the <em>Cholesky factorization</em>:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AA%20&amp;=%20Q%5CLambda%20Q%5ET%5C%5C%0A&amp;=%20QS%20S%5ET%20Q%5ET%5C%5C%0A&amp;=%20MM%5ET%0A%5Cend%7Balign*%7D"></p>
</section>
<section id="level-plots-of-a-positive-definite-quadratic-form-are-ellipsoids" class="level2">
<h2 class="anchored" data-anchor-id="level-plots-of-a-positive-definite-quadratic-form-are-ellipsoids">Level plots of a positive definite quadratic form are ellipsoids</h2>
<p>Consider the level plot of a positive definite quadratic form <img src="https://latex.codecogs.com/png.latex?q(%5Cmathbf%7Bx%7D)">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aq(%5Cmathbf%7Bx%7D)%20=%20%5Chat%7Bq%7D(%5Cmathbf%7By%7D)%20&amp;=%201%20%5C%5C%0A%5Clambda_1%20y_1%5E2%20+%20%5Cldots%20+%20%5Clambda_n%20y_n%5E2%20&amp;=%201%5C%5C%0A%5Cfrac%7By_1%5E2%7D%7B%5Cleft(%5Cfrac%7B1%7D%7B%5Csqrt%7B%5Clambda_1%7D%7D%5Cright)%5E2%7D+%5Cfrac%7By_2%5E2%7D%7B%5Cleft(%5Cfrac%7B1%7D%7B%5Csqrt%7B%5Clambda_2%7D%7D%5Cright)%5E2%7D%20+%20%5Cldots%20+%20%5Cfrac%7By_n%5E2%7D%7B%5Cleft(%5Cfrac%7B1%7D%7B%5Csqrt%7B%5Clambda_n%7D%7D%5Cright)%5E2%7D%20&amp;=%201%0A%5Cend%7Balign*%7D"></p>
<p>Thus, the level plot of a positive definite quadratic form is an ellipse (if <img src="https://latex.codecogs.com/png.latex?n=2">) or an ellipsoid (if <img src="https://latex.codecogs.com/png.latex?n%20%3E%202">) with axes aligned along the eigenvectors and lengths <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B%5Csqrt%7B%5Clambda_i%7D%7D">, <img src="https://latex.codecogs.com/png.latex?i=1,2,3,%5Cldots,n">.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb3-3"></span>
<span id="cb3-4">A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>], [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]])</span>
<span id="cb3-5"></span>
<span id="cb3-6">eigenvalues, eigenvectors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linalg.eig(A)</span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The parameteric equation of an ellipse is</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (x(theta),y(theta))=(a cos theta, b sin theta)</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># where a and b are semi-major and semi-minor axes</span></span>
<span id="cb3-11">theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>)</span>
<span id="cb3-12">y1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> eigenvalues[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(theta)</span>
<span id="cb3-13">y2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> eigenvalues[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(theta)</span>
<span id="cb3-14"></span>
<span id="cb3-15">Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([y1,y2])</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The change of basis matrix from the standard basis to the eigen vector basis</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># is Q. So, x = Q y, where Q = [q_1,q_2]; q_1, q_2 are the eigenvectors of A.</span></span>
<span id="cb3-19"></span>
<span id="cb3-20">Q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> eigenvectors.T</span>
<span id="cb3-21">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(Q, Y)</span>
<span id="cb3-22">x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,:]</span>
<span id="cb3-23">x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,:]</span>
<span id="cb3-24"></span>
<span id="cb3-25">plt.xlim([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb3-26">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb3-27">plt.title(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$q(\mathbf</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{x}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">)=\mathbf</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{x}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">^T A \mathbf</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{x}</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;"> = 1$'</span>)</span>
<span id="cb3-28">plt.xlabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$x_1$'</span>)</span>
<span id="cb3-29">plt.ylabel(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'$x_2$'</span>)</span>
<span id="cb3-30">plt.plot(x1, x2)</span>
<span id="cb3-31">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/positive_definiteness/index_files/figure-html/cell-4-output-1.png" width="615" height="453" class="figure-img"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>Linear Algebra</category>
  <guid>https://quantdev.blog/posts/positive_definiteness/</guid>
  <pubDate>Wed, 19 Jun 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/positive_definiteness/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Optimization Algorithms</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/optimization_algorithms/</link>
  <description><![CDATA[ 





<section id="gradient-vector" class="level2">
<h2 class="anchored" data-anchor-id="gradient-vector">Gradient vector</h2>
<p><em>Definition</em>. Let <img src="https://latex.codecogs.com/png.latex?f:%5Cmathbf%7BR%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> be a scalar-valued function. The gradient vector of <img src="https://latex.codecogs.com/png.latex?f"> is defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cnabla%20f(%5Cmathbf%7Bx%7D)%20=%20%5Cleft%5B%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x_1%7D,%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x_2%7D,%5Cldots,%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x_n%7D%5Cright%5D%0A%5Cend%7Balign*%7D"></p>
<p>The graph of the function <img src="https://latex.codecogs.com/png.latex?f:%5Cmathbf%7BR%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> is the <em>hypersurface</em> in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E%7Bn+1%7D"> given by the equation <img src="https://latex.codecogs.com/png.latex?x_%7Bn+1%7D=f(x_1,%5Cldots,x_n)">.</p>
<p><em>Definition</em>. <img src="https://latex.codecogs.com/png.latex?f"> is said to be <em>differentiable</em> at <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D"> if all the partial derivatives <img src="https://latex.codecogs.com/png.latex?f_%7Bx_i%7D(%5Cmathbf%7Ba%7D)"> exist and if the function <img src="https://latex.codecogs.com/png.latex?h(%5Cmathbf%7Bx%7D)"> defined by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Ah(%5Cmathbf%7Bx%7D)%20=%20f(%5Cmathbf%7Ba%7D)%20+%20%5Cnabla%20f(%5Cmathbf%7Ba%7D)%5Ccdot%20(%5Cmathbf%7Bx%7D-%5Cmathbf%7Ba%7D)%0A%5Cend%7Balign*%7D"></p>
<p>is a good linear approximation to <img src="https://latex.codecogs.com/png.latex?f"> near <img src="https://latex.codecogs.com/png.latex?a">, meaning that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AL%20=%20%5Clim_%7B%5Cmathbf%7Bx%7D%20%5Cto%20%5Cmathbf%7Ba%7D%7D%20%5Cfrac%7Bf(%5Cmathbf%7Bx%7D)%20-%20h(%5Cmathbf%7Bx%7D)%7D%7B%7C%7C%5Cmathbf%7Bx%7D%20-%20%5Cmathbf%7Ba%7D%7C%7C%7D%20=%200%0A%5Cend%7Balign*%7D"></p>
<p>If <img src="https://latex.codecogs.com/png.latex?f"> is differentiable at <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D,f(%5Cmathbf%7Ba%7D)">, then the hypersurface determined by the graph has a <em>tangent hyperplane</em> at <img src="https://latex.codecogs.com/png.latex?(%5Cmathbf%7Ba%7D,f(%5Cmathbf%7Ba%7D))"> given by the equation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Ah(%5Cmathbf%7Bx%7D)%20=%20f(%5Cmathbf%7Ba%7D)%20+%20%5Cnabla%20f(%5Cmathbf%7Ba%7D)%5Ccdot%20(%5Cmathbf%7Bx%7D-%5Cmathbf%7Ba%7D)%0A%5Cend%7Balign*%7D"></p>
<section id="the-directional-derivative" class="level3">
<h3 class="anchored" data-anchor-id="the-directional-derivative">The directional derivative</h3>
<p>Let <img src="https://latex.codecogs.com/png.latex?f(x,y)"> be a scalar-valued function of two variables. We understand the partial derivative <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D(a,b)"> as the slope at the point <img src="https://latex.codecogs.com/png.latex?(a,b,f(a,b))"> of the curve obtained as the intersection of the surface <img src="https://latex.codecogs.com/png.latex?z=f(x,y)"> and the plane <img src="https://latex.codecogs.com/png.latex?y=b">. The other partial derivative has a geometric interpretation. However, the surface <img src="https://latex.codecogs.com/png.latex?z=f(x,y)"> contains infinitely many curves passing through <img src="https://latex.codecogs.com/png.latex?(a,b,f(a,b))"> whose slope we might choose to measure. The directional derivative enables us to do this.</p>
<p>Intuitively, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D(a,b)"> is as the rate of change of <img src="https://latex.codecogs.com/png.latex?f"> as we move <em>infinitesimally</em> from <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D=(a,b)"> in the <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bi%7D"> direction.</p>
<p>Mathematically, by the definition of the derivative of <img src="https://latex.codecogs.com/png.latex?f">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D(a,b)%20&amp;=%20%5Clim_%7Bh%20%5Cto%200%7D%20%5Cfrac%7Bf(a+h,b)%20-%20f(a,b)%7D%7Bh%7D%5C%5C%0A&amp;=%5Clim_%7Bh%20%5Cto%200%7D%20%5Cfrac%7Bf((a,b)%20+%20(h,0))%20-%20f(a,b)%7D%7Bh%7D%5C%5C%0A&amp;=%5Clim_%7Bh%20%5Cto%200%7D%20%5Cfrac%7Bf((a,b)%20+%20h(1,0))%20-%20f(a,b)%7D%7Bh%7D%5C%5C%0A&amp;=%5Clim_%7Bh%20%5Cto%200%7D%20%5Cfrac%7Bf(%5Cmathbf%7Ba%7D%20+%20h%5Cmathbf%7Bi%7D)%20-%20f(%5Cmathbf%7Ba%7D)%7D%7Bh%7D%0A%5Cend%7Balign*%7D"></p>
<p>Similarly, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20y%7D(a,b)%20=%20%5Clim_%7Bh%5Cto%200%7D%20%5Cfrac%7Bf(%5Cmathbf%7Ba%7D%20+%20h%5Cmathbf%7Bj%7D)-f(%5Cmathbf%7Ba%7D)%7D%7Bh%7D%0A%5Cend%7Balign*%7D"></p>
<p>Writing partial derivatives as we have enables us to see that they are special cases of a more general type of derivative. Suppose <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D"> is a unit vector in <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D%5E2">. The quantity:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Clim_%7Bh%20%5Cto%200%7D%20%5Cfrac%7Bf(%5Cmathbf%7Ba%7D%20+%20h%5Cmathbf%7Bv%7D)%20-%20f(%5Cmathbf%7Ba%7D)%7D%7Bh%7D%0A%5Cend%7Balign*%7D"></p>
<p>is nothing more than the rate of change of <img src="https://latex.codecogs.com/png.latex?f"> as we move infinitesimally from <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D%20=%20(a,b)"> in the direction specified by <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D=(A,B)%20=%20A%5Cmathbf%7Bi%7D%20+%20B%5Cmathbf%7Bj%7D">.</p>
<p><em>Definition</em>. Let <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D%5Cin%20%5Cmathbf%7BR%7D%5En"> be any unit vector, then the <em>directional derivative</em> of <img src="https://latex.codecogs.com/png.latex?f"> at <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D"> in the direction of <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D">, denoted <img src="https://latex.codecogs.com/png.latex?D_%7B%5Cmathbf%7Bv%7D%7Df(%5Cmathbf%7Ba%7D)"> is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AD_%7B%5Cmathbf%7Bv%7D%7Df(%5Cmathbf%7Ba%7D)%20=%20%5Clim_%7Bh%20%5Cto%200%7D%20%5Cfrac%7Bf(%5Cmathbf%7Ba%7D%20+%20h%5Cmathbf%7Bv%7D)%20-%20f(%5Cmathbf%7Ba%7D)%7D%7Bh%7D%0A%5Cend%7Balign*%7D"></p>
<p>Let’s define a new function <img src="https://latex.codecogs.com/png.latex?F"> of a single variable <img src="https://latex.codecogs.com/png.latex?t">, by holding everything else constant:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AF(t)%20=%20f(%5Cmathbf%7Ba%7D%20+%20t%5Cmathbf%7Bv%7D)%0A%5Cend%7Balign*%7D"></p>
<p>Then, by the definition of directional derivatives, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AD_%7B%5Cmathbf%7Bv%7D%7Df(%5Cmathbf%7Ba%7D)%20&amp;=%20%5Clim_%7Bt%5Cto%200%7D%20%5Cfrac%7Bf(%5Cmathbf%7Ba%7D%20+%20t%5Cmathbf%7Bv%7D)%20-%20f(%5Cmathbf%7Ba%7D)%7D%7Bt%7D%5C%5C%0A&amp;=%20%5Clim_%7Bt%5Cto%200%7D%20%5Cfrac%7BF(t)%20-%20F(0)%7D%7Bt%20-%200%7D%20%5C%5C%0A&amp;=%20F'(0)%0A%5Cend%7Balign*%7D"></p>
<p>That is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AD_%7B%5Cmathbf%7Bv%7D%7Df(%5Cmathbf%7Ba%7D)%20=%20%5Cfrac%7Bd%7D%7Bdt%7D%20f(%5Cmathbf%7Ba%7D%20+%20t%5Cmathbf%7Bv%7D)%5Cvert_%7Bt=0%7D%0A%5Cend%7Balign*%7D"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D(t)%20=%20%5Cmathbf%7Ba%7D+t%5Cmathbf%7Bv%7D">. Then, by the chain rule:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7Bd%7D%7Bdt%7D%20f(%5Cmathbf%7Ba%7D%20+%20t%5Cmathbf%7Bv%7D)%20&amp;=%20Df(%5Cmathbf%7Bx%7D)%20D%5Cmathbf%7Bx%7D(t)%20%5C%5C%0A&amp;=%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%20%5Ccdot%20%5Cmathbf%7Bv%7D%0A%5Cend%7Balign*%7D"></p>
<p>This equation emphasizes the geometry of the situation. The directional derivative is just the dot product of the gradient vector and the direction vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D">.</p>
<p><em>Theorem.</em> Let <img src="https://latex.codecogs.com/png.latex?f:X%5Cto%5Cmathbf%7BR%7D"> be differentiable at <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D%5Cin%20X">. Then, the directional derivative <img src="https://latex.codecogs.com/png.latex?D_%7B%5Cmathbf%7Bv%7D%7Df(%5Cmathbf%7Ba%7D)"> exists for all directions <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D%5Cin%5Cmathbf%7BR%7D%5En"> and moreover we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AD_%7B%5Cmathbf%7Bv%7D%7Df(%5Cmathbf%7Ba%7D)%20=%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%5Ccdot%20%5Cmathbf%7Bv%7D%0A%5Cend%7Balign*%7D"></p>
</section>
<section id="gradients-and-steepest-ascent" class="level3">
<h3 class="anchored" data-anchor-id="gradients-and-steepest-ascent">Gradients and steepest ascent</h3>
<p>Suppose you are traveling in space near the planet Nilrebo and that one of your spaceship’s instruments measures the external atmospheric pressure on your ship as a function <img src="https://latex.codecogs.com/png.latex?f(x,y,z)"> of position. Assume quite reasonably that this function is differentiable. Then, the directional derivative exists and if you travel from point <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Ba%7D=(a,b,c)"> in the direction of the unit vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bu%7D=u%5Cmathbf%7Bi%7D+v%5Cmathbf%7Bj%7D+w%5Cmathbf%7Bk%7D">, the rate of change of pressure is given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AD_%7B%5Cmathbf%7Bu%7D%7Df(%5Cmathbf%7Ba%7D)%20=%20%5Cnabla%20f(%5Cmathbf%7Ba%7D)%20%5Ccdot%20%5Cmathbf%7Bu%7D%20=%20%7C%7C%5Cnabla%20f(%5Cmathbf%7Ba%7D)%7C%7C%20%5Ccdot%20%7C%7C%5Cmathbf%7Bu%7D%7C%7C%20%5Ccos%20%5Ctheta%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> is the angle between <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bu%7D"> and the gradient vector <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20f(%5Cmathbf%7Ba%7D)">. Because, <img src="https://latex.codecogs.com/png.latex?-1%20%5Cleq%20%5Ccos%20%5Ctheta%20%5Cleq%201">, and <img src="https://latex.codecogs.com/png.latex?%7C%7C%5Cmathbf%7Bu%7D%7C%7C=1">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A-%20%7C%7C%5Cnabla%20f(%5Cmathbf%7Ba%7D)%7C%7C%20%5Cleq%20D_%7B%5Cmathbf%7Bu%7D%7Df(%5Cmathbf%7Ba%7D)%20%5Cleq%20%7C%7C%5Cnabla%20f(%5Cmathbf%7Ba%7D)%7C%7C%0A%5Cend%7Balign*%7D"></p>
<p>Moreover, <img src="https://latex.codecogs.com/png.latex?%5Ccos%20%5Ctheta%20=%201"> when <img src="https://latex.codecogs.com/png.latex?%5Ctheta%20=%200"> and <img src="https://latex.codecogs.com/png.latex?%5Ccos%20%5Ctheta%20=%20-1"> when <img src="https://latex.codecogs.com/png.latex?%5Ctheta%20=%20%5Cpi">.</p>
<p><em>Theorem</em>. The directional derivative <img src="https://latex.codecogs.com/png.latex?D_%7B%5Cmathbf%7Bu%7D%7Df(%5Cmathbf%7Ba%7D)"> is maximized, with respect to the direction, when <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bu%7D"> points in the direction of the gradient vector <img src="https://latex.codecogs.com/png.latex?f(%5Cmathbf%7Ba%7D)"> and is minimized when <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bu%7D"> points in the opposite direction. Furthermore, the maximum and minimum values of <img src="https://latex.codecogs.com/png.latex?D_%7B%5Cmathbf%7Bu%7D%7Df(%5Cmathbf%7Ba%7D)"> are <img src="https://latex.codecogs.com/png.latex?%7C%7C%5Cnabla%20f(%5Cmathbf%7Ba%7D)%7C%7C"> and <img src="https://latex.codecogs.com/png.latex?-%7C%7C%5Cnabla%20f(%5Cmathbf%7Ba%7D)%7C%7C">.</p>
<p><em>Theorem</em> Let <img src="https://latex.codecogs.com/png.latex?f:X%20%5Csubseteq%20%5Cmathbf%7BR%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> be a function of class <img src="https://latex.codecogs.com/png.latex?C%5E1">. If <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D_0"> is a point on the level set <img src="https://latex.codecogs.com/png.latex?S=%5C%7B%5Cmathbf%7Bx%7D%20%5Cin%20X%20%7C%20f(%5Cmathbf%7Bx%7D)%20=%20c%5C%7D">, then the gradient vector <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20f(%5Cmathbf%7Bx%7D_0)%20%5Cin%20%5Cmathbf%7BR%7D%5En"> is perpendicular to <img src="https://latex.codecogs.com/png.latex?S">.</p>
<p><em>Proof.</em> We need to establish the following: if <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D"> is any vector tangent to <img src="https://latex.codecogs.com/png.latex?S"> at <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D_0">, then <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20f(%5Cmathbf%7Bx%7D_0)"> is perpendicular to <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D"> (i.e.&nbsp;<img src="https://latex.codecogs.com/png.latex?%5Cnabla%20f(%5Cmathbf%7Bx%7D_0)%20%5Ccdot%20%5Cmathbf%7Bv%7D%20=%200">). By a tangent vector to <img src="https://latex.codecogs.com/png.latex?S"> at <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D_0">, we mean that <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bv%7D"> is the velocity vector of a curve <img src="https://latex.codecogs.com/png.latex?C"> that lies in <img src="https://latex.codecogs.com/png.latex?S"> and passes through <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D_0">.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?C"> be given parametrically by <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D(t)=(x_1(t),%5Cldots,x_n(t))"> where <img src="https://latex.codecogs.com/png.latex?a%20%3C%20t%20%3C%20b"> and <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D(t_0)%20=%20%5Cmathbf%7Bx%7D_0"> for some number <img src="https://latex.codecogs.com/png.latex?t_0"> in <img src="https://latex.codecogs.com/png.latex?(a,b)">.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7Bd%7D%7Bdt%7D%5Bf(%5Cmathbf%7Bx%7D(t))%5D%20&amp;=%20Df(%5Cmathbf%7Bx%7D)%20%5Ccdot%20%5Cmathbf%7Bx%7D'(t)%5C%5C%0A&amp;=%20%5Cnabla%20f(%5Cmathbf%7Bx%7D)%20%5Ccdot%20%5Cmathbf%7Bv%7D%0A%5Cend%7Balign*%7D"></p>
<p>Evaluation at <img src="https://latex.codecogs.com/png.latex?t%20=%20t_0">, yields:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cnabla%20f%20(%5Cmathbf%7Bx%7D(t_0))%20%5Ccdot%20%5Cmathbf%7Bx%7D'(t_0)%20=%20%5Cnabla%20f(%5Cmathbf%7Bx%7D_0)%20%5Ccdot%20%5Cmathbf%7Bv%7D%0A%5Cend%7Balign*%7D"></p>
<p>On the other hand, since <img src="https://latex.codecogs.com/png.latex?C"> is contained in <img src="https://latex.codecogs.com/png.latex?S">, <img src="https://latex.codecogs.com/png.latex?f(%5Cmathbf%7Bx%7D)=c">. So,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7Bd%7D%7Bdt%7D%5Bf(%5Cmathbf%7Bx%7D(t))%5D%20&amp;=%20%5Cfrac%7Bd%7D%7Bdt%7D%5Bc%5D%20=%200%0A%5Cend%7Balign*%7D"></p>
<p>Putting the above two facts together, we have the desired result.</p>
</section>
</section>
<section id="gradient-descent---naive-implementation" class="level2">
<h2 class="anchored" data-anchor-id="gradient-descent---naive-implementation">Gradient Descent - Naive Implementation</h2>
<p>Beginning at <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D_0">, optimization algorithms generate a sequence of iterates <img src="https://latex.codecogs.com/png.latex?%5C%7B%5Cmathbf%7Bx%7D_k%5C%7D_%7Bk=0%7D%5E%7B%5Cinfty%7D"> that terminate when no more progress can be made or it seems a solution point has been approximated with sufficient accuracy. The <em>gradient descent method</em> is an optimization algorithm that moves along <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bd%7D_k%20=%20-%5Cnabla%20f(%5Cmathbf%7Bx%7D_k)"> at every step. Thus,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbf%7Bx%7D_%7Bk+1%7D%20=%20%5Cmathbf%7Bx%7D_k%20-%20%5Calpha_k%20%5Cmathbf%7Bd%7D_k%0A%5Cend%7Balign*%7D"></p>
<p>It can choose the step length <img src="https://latex.codecogs.com/png.latex?%5Calpha_k"> in a variety of ways. One advantage of steepest descent is that it requires the calculation of the gradient <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20f(%5Cmathbf%7Bx%7D_k)">, but not of the second derivatives. However, it can be excruciatingly slow on difficult problems.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>load_ext itikz</span></code></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Callable</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-3"></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> gradient_descent(</span>
<span id="cb2-6">    func: Callable[[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>], <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>],</span>
<span id="cb2-7">    alpha: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb2-8">    xval_0: np.array,</span>
<span id="cb2-9">    epsilon: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>,</span>
<span id="cb2-10">    n_iter: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>,</span>
<span id="cb2-11">    debug_step: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb2-12">):</span>
<span id="cb2-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    The gradient descent algorithm.</span></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb2-16"></span>
<span id="cb2-17">    xval_hist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb2-18">    funcval_hist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb2-19"></span>
<span id="cb2-20">    xval_curr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> xval_0</span>
<span id="cb2-21">    error <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb2-22">    i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-23"></span>
<span id="cb2-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> np.linalg.norm(error) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> epsilon <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> n_iter:</span>
<span id="cb2-25">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save down x_curr and func(x_curr)</span></span>
<span id="cb2-26">        xval_hist.append(xval_curr)</span>
<span id="cb2-27">        funcval_hist.append(func(xval_curr))</span>
<span id="cb2-28"></span>
<span id="cb2-29">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the forward difference</span></span>
<span id="cb2-30">        bump <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span></span>
<span id="cb2-31">        num_dims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(xval_curr)</span>
<span id="cb2-32">        xval_bump <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> xval_curr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.eye(num_dims) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bump</span>
<span id="cb2-33">        xval_nobump <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.full((num_dims, num_dims), xval_curr)</span>
<span id="cb2-34"></span>
<span id="cb2-35">        grad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb2-36">            [</span>
<span id="cb2-37">                (func(xval_h) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> func(xval)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> bump</span>
<span id="cb2-38">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> xval_h, xval <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(xval_bump, xval_nobump)</span>
<span id="cb2-39">            ]</span>
<span id="cb2-40">        )</span>
<span id="cb2-41"></span>
<span id="cb2-42">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute the next iterate</span></span>
<span id="cb2-43">        xval_next <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> xval_curr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> alpha <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grad</span>
<span id="cb2-44"></span>
<span id="cb2-45">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute the error vector</span></span>
<span id="cb2-46">        error <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> xval_next <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> xval_curr</span>
<span id="cb2-47"></span>
<span id="cb2-48">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> debug_step <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb2-49">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(</span>
<span id="cb2-50">                <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"x[</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">] = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>xval_curr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, f(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>xval_curr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">) = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>func(xval_curr)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, f'(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>xval_curr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">) = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>grad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, error=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>error<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-51">            )</span>
<span id="cb2-52"></span>
<span id="cb2-53">        xval_curr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> xval_next</span>
<span id="cb2-54">        i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-55"></span>
<span id="cb2-56">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> xval_hist, funcval_hist</span></code></pre></div>
</div>
<p>One infamous test function is the <em>Rosenbrock function</em> defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(x,y)%20=%20(a-x)%5E2%20+%20b(y-x%5E2)%5E2%0A%5Cend%7Balign*%7D"></p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> rosenbrock(x):</span>
<span id="cb3-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> f(x):</span>
<span id="cb3-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span></code></pre></div>
</div>
<p>Here is the plot of the Rosenbrock function with parameters <img src="https://latex.codecogs.com/png.latex?a=1,b=100">.</p>
<div class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb4-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb4-3">\begin{axis}[</span>
<span id="cb4-4">     title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{Plot of $f(x,y)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>$},</span>
<span id="cb4-5">]</span>
<span id="cb4-6">    \addplot3 [surf] {(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-7">\end{axis}</span>
<span id="cb4-8">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/optimization_algorithms/index_files/figure-html/cell-5-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">x_history, f_x_history <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gradient_descent(</span>
<span id="cb5-2">    func<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rosenbrock,</span>
<span id="cb5-3">    alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>,</span>
<span id="cb5-4">    xval_0<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.array([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>]),</span>
<span id="cb5-5">    epsilon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span>,</span>
<span id="cb5-6">    debug_step<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb5-7">)</span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"x* = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>x_history[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, f(x*)=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>f_x_history[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x[0] = [-2.  2.], f([-2.  2.]) = 409.0, f'([-2.  2.]) = [-1603.9997999  -399.9      ], error=[1.6039998 0.3999   ]
x[1000] = [-0.34194164  0.12278388], f([-0.34194164  0.12278388]) = 1.804241076974863, f'([-0.34194164  0.12278388]) = [-1.8359394   1.27195859], error=[ 0.00183594 -0.00127196]
x[2000] = [0.59082668 0.34719456], f([0.59082668 0.34719456]) = 0.16777685109400048, f'([0.59082668 0.34719456]) = [-0.23242066 -0.27632251], error=[0.00023242 0.00027632]
x[3000] = [0.71914598 0.51617916], f([0.71914598 0.51617916]) = 0.0789773438798074, f'([0.71914598 0.51617916]) = [-0.06806067 -0.09835534], error=[6.80606659e-05 9.83553399e-05]
x[4000] = [0.7626568  0.58094326], f([0.7626568  0.58094326]) = 0.05638109494458334, f'([0.7626568  0.58094326]) = [-0.02638936 -0.04042575], error=[2.63893643e-05 4.04257465e-05]
x[5000] = [0.78028032 0.60825002], f([0.78028032 0.60825002]) = 0.04831123625687607, f'([0.78028032 0.60825002]) = [-0.01115051 -0.01747329], error=[1.11505139e-05 1.74732947e-05]
x[6000] = [0.78785296 0.62017375], f([0.78785296 0.62017375]) = 0.045035368749296534, f'([0.78785296 0.62017375]) = [-0.00487137 -0.00770719], error=[4.87136843e-06 7.70718502e-06]
x[7000] = [0.79118466 0.62545602], f([0.79118466 0.62545602]) = 0.04363059164103049, f'([0.79118466 0.62545602]) = [-0.00215834 -0.00342913], error=[2.1583377e-06 3.4291304e-06]
x[8000] = [0.79266536 0.62781071], f([0.79266536 0.62781071]) = 0.04301342477692797, f'([0.79266536 0.62781071]) = [-0.00096218 -0.00153153], error=[9.62177510e-07 1.53153219e-06]
x[9000] = [0.79332635 0.62886327], f([0.79332635 0.62886327]) = 0.042739342077472306, f'([0.79332635 0.62886327]) = [-0.0004301  -0.00068518], error=[4.30102710e-07 6.85176669e-07]
x* = [0.7936218  0.62933403], f(x*)=0.04261711392593988</code></pre>
</div>
</div>
</section>
<section id="convergence." class="level2">
<h2 class="anchored" data-anchor-id="convergence.">Convergence.</h2>
<p>When applying gradient descent in practice, we need to choose a value for the learning rate parameter <img src="https://latex.codecogs.com/png.latex?%5Calpha">. An error surface <img src="https://latex.codecogs.com/png.latex?E"> is usually a convex function on the weight space <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bw%7D">. Intuitively, we might expect that increasing the value of <img src="https://latex.codecogs.com/png.latex?%5Calpha"> should lead to bigger steps through the weight space and hence faster convergence. However, the successive steps oscillate back and forth across the valley, and if we increase <img src="https://latex.codecogs.com/png.latex?%5Calpha"> too much, these oscillations will become divergent. Because <img src="https://latex.codecogs.com/png.latex?%5Calpha"> must be kept sufficiently small to avoid divergent oscillations across the valley, progress along the valley is very slow. Gradient descent then takes many small steps to reach the minimum and is a very inefficient procedure.</p>
<p>We can gain deeper insight into this problem, by considering a quadratic approximation to the error function in the neighbourhood of the minimum. Let the error function be given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(w)%20=%20%5Cfrac%7B1%7D%7B2%7Dw%5ET%20A%20w%20-%20b%5ET%20w,%20%5Cquad%20w%5Cin%5Cmathbf%7BR%7D%5En%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?A"> is symmetric and <img src="https://latex.codecogs.com/png.latex?A%20%5Csucc%200">.</p>
<p>Differentiating on both sides, the gradient of the error function is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cnabla%20f(w)%20=%20Aw%20-%20b%0A%5Cend%7Balign*%7D"></p>
<p>and the hessian is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cnabla%5E2%20f(w)%20=%20A%0A%5Cend%7Balign*%7D"></p>
<p>The critical points of <img src="https://latex.codecogs.com/png.latex?f"> are given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cnabla%20f(w%5E*)%20&amp;=%200%5C%5C%0AAw%5E%7B*%7D%20-%20b%20&amp;=%200%5C%5C%0Aw%5E%7B*%7D%20&amp;=%20A%5E%7B-1%7Db%0A%5Cend%7Balign*%7D"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(w%5E%7B*%7D)%20&amp;=%20%5Cfrac%7B1%7D%7B2%7D(A%5E%7B-1%7Db)%5ET%20A%20(A%5E%7B-1%7Db)%20-%20b%5ET%20(A%5E%7B-1%7D%20b)%5C%5C%0A&amp;=%20%5Cfrac%7B1%7D%7B2%7Db%5ET%20A%5E%7B-1%7D%20A%20A%5E%7B-1%7D%20b%20-b%5ET%20A%5E%7B-1%7D%20b%20%5C%5C%0A&amp;=%20%5Cfrac%7B1%7D%7B2%7Db%5ET%20A%5E%7B-1%7D%20b%20-%20b%5ET%20A%5E%7B-1%7D%20b%20%5C%5C%0A&amp;=%20-%5Cfrac%7B1%7D%7B2%7Db%5ET%20A%5E%7B-1%7D%20b%0A%5Cend%7Balign*%7D"></p>
<p>Therefore, the iterates of <img src="https://latex.codecogs.com/png.latex?w"> are:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aw%5E%7B(k+1)%7D%20=%20w%5E%7B(k)%7D%20-%20%5Calpha(Aw%5E%7B(k)%7D%20-%20b)%0A%5Cend%7Balign*%7D"></p>
<p>By the <em>spectral theorem</em>, every symmetric matrix <img src="https://latex.codecogs.com/png.latex?A"> is orthogonally diagonalizable. So, <img src="https://latex.codecogs.com/png.latex?A"> admits a factorization:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AA%20=%20Q%20%5CLambda%20Q%5ET%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5CLambda%20=%20diag(%5Clambda_1,%5Cldots,%5Clambda_n)"> and as per convention, we will assume that <img src="https://latex.codecogs.com/png.latex?%5Clambda_i">are sorted from smallest <img src="https://latex.codecogs.com/png.latex?%5Clambda_1"> to biggest <img src="https://latex.codecogs.com/png.latex?%5Clambda_n">.</p>
<p>Recall that <img src="https://latex.codecogs.com/png.latex?Q=%5Bq_1,%5Cldots,q_n%5D">, where <img src="https://latex.codecogs.com/png.latex?q_i"> are the eigenvectors of <img src="https://latex.codecogs.com/png.latex?A"> and <img src="https://latex.codecogs.com/png.latex?Q"> is the change of basis matrix from the standard basis to the eigenvector basis. So, if <img src="https://latex.codecogs.com/png.latex?a%20%5Cin%20%5Cmathbf%7BR%7D%5En"> are the coordinates of a vector in the standard basis and <img src="https://latex.codecogs.com/png.latex?b%20%5Cin%20%5Cmathbf%7BR%7D%5En"> are its coordinates in the eigenvector basis, then <img src="https://latex.codecogs.com/png.latex?a%20=%20Qb"> or <img src="https://latex.codecogs.com/png.latex?b=Q%5ET%20a">.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?x%5E%7B(k)%7D=Q%5ET(w%5E%7B(k)%7D-w%5E%7B*%7D)">. Equivalently, <img src="https://latex.codecogs.com/png.latex?w%5E%7B(k)%7D%20=%20Qx%5E%7B(k)%7D%20+%20w%5E%7B*%7D">. Thus, we are shifting the origin to <img src="https://latex.codecogs.com/png.latex?w%5E%7B*%7D"> and changing the axes to be aligned with the eigenvectors. In this new coordinate system,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AQx%5E%7B(k+1)%7D%20+%20w%5E%7B*%7D%20&amp;=%20Qx%5E%7B(k)%7D%20+%20w%5E%7B*%7D%20-%20%5Calpha(AQx%5E%7B(k)%7D%20+%20Aw%5E%7B*%7D%20-%20b)%5C%5C%0AQx%5E%7B(k+1)%7D%20&amp;=%20Qx%5E%7B(k)%7D%20-%20%5Calpha(AQx%5E%7B(k)%7D%20+%20Aw%5E%7B*%7D%20-%20b)%5C%5C%0AQx%5E%7B(k+1)%7D%20&amp;=%20Qx%5E%7B(k)%7D%20-%20%5Calpha(AQx%5E%7B(k)%7D%20+%20A(A%5E%7B-1%7Db)%20-%20b)%5C%5C%0A&amp;%20%5Cquad%20%5C%7B%5Ctext%7BSubstituting%20%7D%20w%5E%7B*%7D=A%5E%7B-1%7Db%20%5C%7D%5C%5C%0AQx%5E%7B(k+1)%7D%20&amp;=%20Qx%5E%7B(k)%7D%20-%20%5Calpha(AQx%5E%7B(k)%7D)%5C%5C%0AQx%5E%7B(k+1)%7D%20&amp;=%20Qx%5E%7B(k)%7D%20-%20%5Calpha(Q%5CLambda%20Q%5ET%20Qx%5E%7B(k)%7D)%5C%5C%0A&amp;%20%5Cquad%20%5C%7B%5Ctext%7BSubstituting%20%7D%20A%20=%20Q%5CLambda%20Q%5ET%20%5C%7D%5C%5C%0AQx%5E%7B(k+1)%7D%20&amp;=%20Qx%5E%7B(k)%7D%20-%20%5Calpha(Q%5CLambda%20x%5E%7B(k)%7D)%5C%5C%0A&amp;%20%5Cquad%20%5C%7B%5Ctext%7BUsing%20%7D%20Q%5ET%20Q%20=%20I%20%5C%7D%5C%5C%0Ax%5E%7B(k+1)%7D%20&amp;=%20x%5E%7B(k)%7D%20-%20%5Calpha%5CLambda%20x%5E%7B(k)%7D%0A%5Cend%7Balign*%7D"></p>
<p>The <img src="https://latex.codecogs.com/png.latex?i">-th coordinate of this recursive system is given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Ax_i%5E%7B(k+1)%7D%20&amp;=%20x_i%5E%7B(k)%7D%20-%20%5Calpha%5Clambda_i%20x_i%5E%7B(k)%7D%5C%5C%0A&amp;=%20(1-%5Calpha%20%5Clambda_i)x_i%5E%7B(k)%7D%5C%5C%0A&amp;=%20(1-%5Calpha%20%5Clambda_i)%5E%7Bk+1%7Dx_i%5E%7B(0)%7D%0A%5Cend%7Balign*%7D"></p>
<p>Moving back to our original space <img src="https://latex.codecogs.com/png.latex?w">, we can see that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aw%5E%7B(k)%7D%20-%20w%5E%7B*%7D%20=%20Qx%5E%7B(k)%7D%20&amp;=%20%5Csum_i%20q_i%20x_i%5E%7B(k)%7D%5C%5C%0A&amp;=%20%5Csum_i%20q_i%20(1-%5Calpha%20%5Clambda_i)%5E%7Bk+1%7D%20x_i%5E%7B(0)%7D%0A%5Cend%7Balign*%7D"></p>
<p>and there we have it - gradient descent in the closed form.</p>
<section id="decomposing-the-error" class="level3">
<h3 class="anchored" data-anchor-id="decomposing-the-error">Decomposing the error</h3>
<p>The above equation admits a simple interpretation. Each element of <img src="https://latex.codecogs.com/png.latex?x%5E%7B(0)%7D"> is the component of the error in the initial guess in <img src="https://latex.codecogs.com/png.latex?Q">-basis. There are <img src="https://latex.codecogs.com/png.latex?n"> such errors and each of these errors follow their own, solitary path to the minimum, decreasing exponentially with a compounding rate of <img src="https://latex.codecogs.com/png.latex?1-%5Calpha%20%5Clambda_i">. The closer that number is to <img src="https://latex.codecogs.com/png.latex?1">, the slower it converges.</p>
<p>For most step-sizes, the eigenvectors with the largest eigenvalues converge the fastest. This triggers an explosion of progress in the first few iterations, before things slow down, as the eigenvectors with smaller eigenvalues’ struggles are revealed. It’s easy to visualize this - look at the sequences of <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%5Ek%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B3%5Ek%7D">.</p>
<div class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb7-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb7-3">\begin{axis}[</span>
<span id="cb7-4">     title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{Comparison of the rates of convergence},</span>
<span id="cb7-5">     xlabel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{$n$},</span>
<span id="cb7-6">     ylabel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{$f(n)$}</span>
<span id="cb7-7">]</span>
<span id="cb7-8">    \addplot [domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,blue] {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>x)} node [midway,above] {$<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-9">    \addplot [domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,red] {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>x)} node [midway,below] {$<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-10">\end{axis}</span>
<span id="cb7-11">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/optimization_algorithms/index_files/figure-html/cell-7-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="choosing-a-step-size" class="level3">
<h3 class="anchored" data-anchor-id="choosing-a-step-size">Choosing a step size</h3>
<p>The above analysis gives us immediate guidance as to how to set a step-size <img src="https://latex.codecogs.com/png.latex?%5Calpha">. In order to converge, each <img src="https://latex.codecogs.com/png.latex?%7C1-%5Calpha%20%5Clambda_i%7C%20%3C%201">. All workable step-sizes, therefore, fall in the interval:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A-1%20&amp;%5Cleq%201%20-%20%5Calpha%20%5Clambda_i%20&amp;%5Cleq%201%20%5C%5C%0A-2%20&amp;%5Cleq%20-%20%5Calpha%20%5Clambda_i%20&amp;%5Cleq%200%20%5C%5C%0A0%20&amp;%5Cleq%20%5Calpha%20%5Clambda_i%20&amp;%5Cleq%202%0A%5Cend%7Balign*%7D"></p>
<p>Because <img src="https://latex.codecogs.com/png.latex?(1-%5Calpha%20%5Clambda_i)"> could be either positive or negative, the overall convergence rate is determined by the slowest error component, which must be either <img src="https://latex.codecogs.com/png.latex?%5Clambda_1"> or <img src="https://latex.codecogs.com/png.latex?%5Clambda_n">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Ctext%7Brate%7D(%5Calpha)%20=%20%5Cmax%20%5C%7B%7C1-%5Calpha%20%5Clambda_1%7C,%7C1-%5Calpha%20%5Clambda_n%7C%5C%7D%0A%5Cend%7Balign*%7D"></p>
<p>The optimal learning rate is that which balances the convergence rate. Setting the convergence rate to be equal for the smallest and largest eigenvalues, we can solve for the optimal step size.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%7C1-%20%5Calpha%20%5Clambda_1%7C%20=%20%7C1-%20%5Calpha%20%5Clambda_n%7C%0A%5Cend%7Balign*%7D"></p>
<p>Assuming <img src="https://latex.codecogs.com/png.latex?%5Clambda_1%20%5Cneq%20%5Clambda_n">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A1%20-%20%5Calpha%20%5Clambda_1%20&amp;=%20-1%20+%20%5Calpha%20%5Clambda_n%5C%5C%0A%5Calpha%20(%5Clambda_1%20+%20%5Clambda_n)%20&amp;=%202%5C%5C%0A%5Calpha%5E*%20&amp;=%20%5Cfrac%7B2%7D%7B%5Clambda_1%20+%20%5Clambda_n%7D%0A%5Cend%7Balign*%7D"></p>
<p>So, the optimal convergence rate equals:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmax%20%5C%7B%7C1-%5Calpha%20%5Clambda_1%7C,%7C1-%5Calpha%20%5Clambda_n%7C%5C%7D%20&amp;=%201%20-%20%5Cfrac%7B2%5Clambda_1%7D%7B%5Clambda_1%20+%20%5Clambda_n%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B%5Clambda_n%20-%20%5Clambda_1%7D%7B%5Clambda_n%20+%20%5Clambda_1%7D%5C%5C%0A&amp;=%20%5Cfrac%7B%5Ckappa%20-%201%7D%7B%5Ckappa%20+%201%7D%0A%5Cend%7Balign*%7D"></p>
<p>The ratio <img src="https://latex.codecogs.com/png.latex?%5Ckappa%20=%20%5Clambda_n%20/%20%5Clambda_1"> determines the convergence rate of the problem. Recall that the level curves of the error surface are ellipsoids. Hence, a poorly conditioned Hessian results in stretching one of the axes of the ellipses, and taken to its extreme, the contours are almost parallel. Since gradient vectors are orthogonal to the level curves, the optimizer keeps pin-balling between parallel lines and takes forever to reach the center.</p>
</section>
</section>
<section id="stochastic-gradient-descentsgd" class="level2">
<h2 class="anchored" data-anchor-id="stochastic-gradient-descentsgd">Stochastic Gradient Descent(SGD)</h2>
<p>In machine learning applications, we typically want to minimize the loss function <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D(w)"> that has the form of a sum:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathcal%7BL%7D(w)%20=%20%5Cfrac%7B1%7D%7Bn%7D%5Csum_i%20L_i(w)%0A%5Cend%7Balign*%7D"></p>
<p>where the weights <img src="https://latex.codecogs.com/png.latex?w"> (and the biases) are to be estimated. Each summand function <img src="https://latex.codecogs.com/png.latex?L_i"> is typically associated with the <img src="https://latex.codecogs.com/png.latex?i">-th sample in the data-set used for training.</p>
<p>When we minimize the above function with respect to the weights and biases, a standard gradient descent method would perform the following operations:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aw_%7Bk+1%7D%20:=%20w_k%20-%20%5Calpha_k%20%5Cnabla%20%5Cmathcal%7BL%7D(w_%7Bk%7D)%20=%20w_k%20-%20%5Cfrac%7B%5Calpha_k%7D%7Bn%7D%5Csum_%7Bi%7D%20%5Cnabla%20L_i(w_%7Bk%7D)%0A%5Cend%7Balign*%7D"></p>
<p>In the stochastic (or online) gradient descent algorithm, the true gradient of <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D(w)"> is approximated by the gradient at a single sample:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Aw_%7Bk+1%7D%20:=%20w_k%20-%20%5Calpha_k%20%5Cnabla%20%5Cmathcal%7BL%7D(w_%7Bk%7D)%20=%20w_k%20-%20%5Calpha_k%20%5Cnabla%20L_i(w_%7Bk%7D)%0A%5Cend%7Balign*%7D"></p>
</section>
<section id="sgdoptimizer-class" class="level2">
<h2 class="anchored" data-anchor-id="sgdoptimizer-class"><code>SGDOptimizer</code> class</h2>
<p>We are now in a position to code the <code>SGDOptimizer</code> class.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Global imports</span></span>
<span id="cb8-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb8-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nnfs</span>
<span id="cb8-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb8-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> nnfs.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> spiral_data</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dense_layer <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DenseLayer</span>
<span id="cb8-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> relu_activation <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ReLUActivation</span>
<span id="cb8-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> softmax_activation <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SoftmaxActivation</span>
<span id="cb8-10"></span>
<span id="cb8-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> loss <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Loss</span>
<span id="cb8-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> categorical_cross_entropy_loss <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> CategoricalCrossEntropyLoss</span>
<span id="cb8-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> categorical_cross_entropy_softmax <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> CategoricalCrossEntropySoftmax</span></code></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> SGDOptimizer:</span>
<span id="cb9-2"></span>
<span id="cb9-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize the optimizer</span></span>
<span id="cb9-4">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, learning_rate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>):</span>
<span id="cb9-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learning_rate</span>
<span id="cb9-6"></span>
<span id="cb9-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update the parameters</span></span>
<span id="cb9-8">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_params(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, layer):</span>
<span id="cb9-9">        layer.weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.dloss_dweights</span>
<span id="cb9-10">        layer.biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.dloss_dbiases</span></code></pre></div>
</div>
<p>Let’s play around with our optimizer.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create dataset</span></span>
<span id="cb10-2">X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spiral_data(samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a DenseLayer with 2 input features and 64 neurons</span></span>
<span id="cb10-5">dense1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)</span>
<span id="cb10-6"></span>
<span id="cb10-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create ReLU Activation (to be used with DenseLayer 1)</span></span>
<span id="cb10-8">activation1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ReLUActivation()</span>
<span id="cb10-9"></span>
<span id="cb10-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the second DenseLayer with 64 inputs and 3 output values</span></span>
<span id="cb10-11">dense2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb10-12"></span>
<span id="cb10-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create SoftmaxClassifer's combined loss and activation</span></span>
<span id="cb10-14">loss_activation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CategoricalCrossEntropySoftmax()</span>
<span id="cb10-15"></span>
<span id="cb10-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The next step is to create the optimizer object</span></span>
<span id="cb10-17">optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SGDOptimizer()</span></code></pre></div>
</div>
<p>Now, we perform a <em>forward pass</em> of our sample data.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass for our sample data</span></span>
<span id="cb11-2">dense1.forward(X)</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Performs a forward pass through the activation function</span></span>
<span id="cb11-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the output of the first dense layer here</span></span>
<span id="cb11-6">activation1.forward(dense1.output)</span>
<span id="cb11-7"></span>
<span id="cb11-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Performs a forward pass through the second DenseLayer</span></span>
<span id="cb11-9">dense2.forward(activation1.output)</span>
<span id="cb11-10"></span>
<span id="cb11-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Performs a forward pass through the activation/loss function</span></span>
<span id="cb11-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the output of the second DenseLayer and returns the loss</span></span>
<span id="cb11-13">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_activation.forward(dense2.output, y)</span>
<span id="cb11-14"></span>
<span id="cb11-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's print the loss value</span></span>
<span id="cb11-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Loss = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb11-17"></span>
<span id="cb11-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now we do our backward pass </span></span>
<span id="cb11-19">loss_activation.backward(loss_activation.output, y)</span>
<span id="cb11-20">dense2.backward(loss_activation.dloss_dz)</span>
<span id="cb11-21">activation1.backward(dense2.dloss_dinputs)</span>
<span id="cb11-22">dense1.backward(activation1.dloss_dz)</span>
<span id="cb11-23"></span>
<span id="cb11-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then finally we use our optimizer to update the weights and biases</span></span>
<span id="cb11-25">optimizer.update_params(dense1)</span>
<span id="cb11-26">optimizer.update_params(dense2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loss = 1.0986526582562541</code></pre>
</div>
</div>
<p>This is everything we need to train our model!</p>
<p>But why would we only perform this optimization only once, when we can perform it many times by leveraging Python’s looping capabilities? We will repeatedly perform a forward pass, backward pass and optimization until we reach some stopping point. Each full pass through all of the training data is called an <em>epoch</em>.</p>
<p>In most deep learning tasks, a neural network will be trained for multiple epochs, though the ideal scenario would be to have a perfect model with ideal weights and biases after only one epoch. To add multiple epochs of our training into our code, we will initialize our model and run a loop around all the code performing the forward pass, backward pass and optimization calculations.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create dataset</span></span>
<span id="cb13-2">X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spiral_data(samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a dense layer with 2 input features and 64 output values</span></span>
<span id="cb13-5">dense1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)</span>
<span id="cb13-6"></span>
<span id="cb13-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create ReLU Activation (to be used with the DenseLayer)</span></span>
<span id="cb13-8">activation1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ReLUActivation()</span>
<span id="cb13-9"></span>
<span id="cb13-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a second DenseLayer with 64 input features (as we take</span></span>
<span id="cb13-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># output of the previous layer here) and 3 output values (output values)</span></span>
<span id="cb13-12">dense2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb13-13"></span>
<span id="cb13-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create Softmax classifier's combined loss and activation</span></span>
<span id="cb13-15">loss_activation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CategoricalCrossEntropySoftmax()</span>
<span id="cb13-16"></span>
<span id="cb13-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create optimizer</span></span>
<span id="cb13-18">optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SGDOptimizer()</span>
<span id="cb13-19"></span>
<span id="cb13-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train in loop</span></span>
<span id="cb13-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10001</span>):</span>
<span id="cb13-22"></span>
<span id="cb13-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass of our training data through this layer</span></span>
<span id="cb13-24">    dense1.forward(X)</span>
<span id="cb13-25"></span>
<span id="cb13-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass through the activation function</span></span>
<span id="cb13-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the output of the first dense layer here</span></span>
<span id="cb13-28">    activation1.forward(dense1.output)</span>
<span id="cb13-29"></span>
<span id="cb13-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass through second DenseLayer</span></span>
<span id="cb13-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the outputs of the activation function of first layer as inputs</span></span>
<span id="cb13-32">    dense2.forward(activation1.output)</span>
<span id="cb13-33"></span>
<span id="cb13-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass through the activation/loss function</span></span>
<span id="cb13-35">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the output of the second DenseLayer here and returns the loss</span></span>
<span id="cb13-36">    loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_activation.forward(dense2.output, y)</span>
<span id="cb13-37"></span>
<span id="cb13-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>:</span>
<span id="cb13-39">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Epoch: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, Loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: .3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb13-40"></span>
<span id="cb13-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward pass</span></span>
<span id="cb13-42">    loss_activation.backward(loss_activation.output, y)</span>
<span id="cb13-43">    dense2.backward(loss_activation.dloss_dz)</span>
<span id="cb13-44">    activation1.backward(dense2.dloss_dinputs)</span>
<span id="cb13-45">    dense1.backward(activation1.dloss_dz)</span>
<span id="cb13-46"></span>
<span id="cb13-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update the weights and the biases</span></span>
<span id="cb13-48">    optimizer.update_params(dense1)</span>
<span id="cb13-49">    optimizer.update_params(dense2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch: 0, Loss:  1.099
Epoch: 1000, Loss:  1.029
Epoch: 2000, Loss:  0.962
Epoch: 3000, Loss:  0.848
Epoch: 4000, Loss:  0.699
Epoch: 5000, Loss:  0.544
Epoch: 6000, Loss:  0.508
Epoch: 7000, Loss:  0.478
Epoch: 8000, Loss:  0.460
Epoch: 9000, Loss:  0.443
Epoch: 10000, Loss:  0.419</code></pre>
</div>
</div>
<p>Our neural network mostly stays stuck at around a loss of <img src="https://latex.codecogs.com/png.latex?1.0"> and later around <img src="https://latex.codecogs.com/png.latex?0.85">-<img src="https://latex.codecogs.com/png.latex?0.90"> Given that this loss didn’t decrease much, we can assume that this learning rate being too high, also caused the model to get stuck in a <strong>local minimum</strong>, which we’ll learn more about soon. Iterating over more epochs, doesn’t seem helpful at this point, which tells us that we’re likely stuck with our optimization. Does this mean that this is the most we can get from our optimizer on this dataset?</p>
<p>Recall that we’re adjusting our weights and biases by applying some fraction, in this case <img src="https://latex.codecogs.com/png.latex?1.0"> to the gradient and subtracting this from the weights and biases. This fraction is called the <strong>learning rate</strong> (LR) and is the primary adjustable parameter for the optimizer as it decreases loss.</p>
</section>
<section id="learning-rate-decay" class="level2">
<h2 class="anchored" data-anchor-id="learning-rate-decay">Learning Rate Decay</h2>
<p>The idea of a <em>learning rate decay</em> is to start with a large learning rate, say <img src="https://latex.codecogs.com/png.latex?1.0"> in our case and then decrease it during training. There are a few methods for doing this. One option is program a <strong>decay rate</strong>, which steadily decays the learning rate per batch or per epoch.</p>
<p>Let’s plan to decay per step. This can also be referred to as <img src="https://latex.codecogs.com/png.latex?1/t"> <strong>decaying</strong> or <strong>exponential decaying</strong>. Basically, we’re going to update the learning rate each step by the reciprocal of the step count fraction. This fraction is a new hyper parameter that we’ll add to the optimizer, called the <strong>learning rate decay</strong>.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">initial_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb15-2">learning_rate_decay <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb15-3"></span>
<span id="cb15-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> step <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb15-5">    learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> initial_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> learning_rate_decay <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> step)</span>
<span id="cb15-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(learning_rate)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.0
0.9090909090909091
0.8333333333333334
0.7692307692307692
0.7142857142857143
0.6666666666666666
0.625
0.588235294117647
0.5555555555555556
0.5263157894736842</code></pre>
</div>
</div>
<p>The derivative of the function <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B1+x%7D"> is <img src="https://latex.codecogs.com/png.latex?-%5Cfrac%7B1%7D%7B(1+x)%5E2%7D">.</p>
<div class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb17-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb17-3">\begin{axis}[</span>
<span id="cb17-4">     title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{Plot of $f(x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span>\frac{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>}{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}$},</span>
<span id="cb17-5">     xlabel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{$x$},</span>
<span id="cb17-6">     ylabel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{$f(x)$}</span>
<span id="cb17-7">]</span>
<span id="cb17-8">    \addplot [domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>] {<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(( <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-9">\end{axis}</span>
<span id="cb17-10">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/optimization_algorithms/index_files/figure-html/cell-14-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The learning rate drops fast initially, but the change in the learning rate lowers in each step. We can update our <code>SGDOptimizer</code> class to allow for the learning rate decay.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> SGDOptimizer:</span>
<span id="cb18-2"></span>
<span id="cb18-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial optimizer - set settings</span></span>
<span id="cb18-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># learning rate of 1. is default for this optimizer</span></span>
<span id="cb18-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, learning_rate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>):</span>
<span id="cb18-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learning_rate</span>
<span id="cb18-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learning_rate</span>
<span id="cb18-8">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.decay <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> decay</span>
<span id="cb18-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.iterations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb18-10"></span>
<span id="cb18-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Call once before any parameter updates</span></span>
<span id="cb18-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> pre_update_params(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb18-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.decay:</span>
<span id="cb18-14">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (</span>
<span id="cb18-15">                <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.decay <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.iterations)</span>
<span id="cb18-16">            )</span>
<span id="cb18-17"></span>
<span id="cb18-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update parameters</span></span>
<span id="cb18-19">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_params(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, layer):</span>
<span id="cb18-20">        layer.weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.dloss_dweights</span>
<span id="cb18-21">        layer.biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.dloss_dbiases</span>
<span id="cb18-22"></span>
<span id="cb18-23">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> post_update_params(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb18-24">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.iterations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span></code></pre></div>
</div>
<p>Let’s use a decay rate of <img src="https://latex.codecogs.com/png.latex?0.01"> and train our neural network again.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> train(decay):</span>
<span id="cb19-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a dataset</span></span>
<span id="cb19-3">    X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spiral_data(samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb19-4"></span>
<span id="cb19-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a dense layer with 2 input features and 64 output values</span></span>
<span id="cb19-6">    dense1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)</span>
<span id="cb19-7"></span>
<span id="cb19-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create ReLU activation (to be used with the dense layer)</span></span>
<span id="cb19-9">    activation1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ReLUActivation()</span>
<span id="cb19-10"></span>
<span id="cb19-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create second DenseLayer with 64 input features (as we take output of the</span></span>
<span id="cb19-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># previous layer here) and 3 output values</span></span>
<span id="cb19-13">    dense2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb19-14"></span>
<span id="cb19-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create Softmax classifier's combined loss and activation</span></span>
<span id="cb19-16">    loss_activation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CategoricalCrossEntropySoftmax()</span>
<span id="cb19-17"></span>
<span id="cb19-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create optimizer</span></span>
<span id="cb19-19">    optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SGDOptimizer(learning_rate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>,decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>decay)</span>
<span id="cb19-20"></span>
<span id="cb19-21">    acc_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb19-22">    loss_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb19-23">    lr_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb19-24"></span>
<span id="cb19-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train in a loop</span></span>
<span id="cb19-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10001</span>):</span>
<span id="cb19-27">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass of our training data through this layer</span></span>
<span id="cb19-28">        dense1.forward(X)</span>
<span id="cb19-29"></span>
<span id="cb19-30">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass through the activation function</span></span>
<span id="cb19-31">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the output of the first dense layer here</span></span>
<span id="cb19-32">        activation1.forward(dense1.output)</span>
<span id="cb19-33"></span>
<span id="cb19-34">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass through second DenseLayer</span></span>
<span id="cb19-35">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the outputs of the activation function of first layer as inputs</span></span>
<span id="cb19-36">        dense2.forward(activation1.output)</span>
<span id="cb19-37"></span>
<span id="cb19-38">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass through the activation/loss function</span></span>
<span id="cb19-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the output of the second DenseLayer here and returns the loss</span></span>
<span id="cb19-40">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_activation.forward(dense2.output, y)</span>
<span id="cb19-41"></span>
<span id="cb19-42">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate accuracy from output of activation2 and targets</span></span>
<span id="cb19-43">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate values along the first axis</span></span>
<span id="cb19-44">        predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.argmax(loss_activation.output, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb19-45">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:</span>
<span id="cb19-46">            y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.argmax(y, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb19-47"></span>
<span id="cb19-48">        accuracy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> y)</span>
<span id="cb19-49"></span>
<span id="cb19-50">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb19-51">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(</span>
<span id="cb19-52">                <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"epoch: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-53"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">                acc : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>accuracy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-54"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">                loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: .3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-55"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">                lr : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>optimizer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>current_learning_rate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb19-56">            )</span>
<span id="cb19-57"></span>
<span id="cb19-58">        acc_vals.append(accuracy)</span>
<span id="cb19-59">        loss_vals.append(loss)</span>
<span id="cb19-60">        lr_vals.append(optimizer.current_learning_rate)</span>
<span id="cb19-61"></span>
<span id="cb19-62">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward pass</span></span>
<span id="cb19-63">        loss_activation.backward(loss_activation.output, y)</span>
<span id="cb19-64">        dense2.backward(loss_activation.dloss_dz)</span>
<span id="cb19-65">        activation1.backward(dense2.dloss_dinputs)</span>
<span id="cb19-66">        dense1.backward(activation1.dloss_dz)</span>
<span id="cb19-67"></span>
<span id="cb19-68">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update the weights and the biases</span></span>
<span id="cb19-69">        optimizer.pre_update_params()</span>
<span id="cb19-70">        optimizer.update_params(dense1)</span>
<span id="cb19-71">        optimizer.update_params(dense2)</span>
<span id="cb19-72">        optimizer.post_update_params()</span>
<span id="cb19-73"></span>
<span id="cb19-74">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> acc_vals, loss_vals, lr_vals</span></code></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">acc_vals, loss_vals, lr_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train(decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>epoch: 0,                 acc : 0.333,                 loss:  1.099,                 lr : 1.0
epoch: 1000,                 acc : 0.477,                 loss:  1.066,                 lr : 0.09099181073703366
epoch: 2000,                 acc : 0.457,                 loss:  1.065,                 lr : 0.047641734159123386
epoch: 3000,                 acc : 0.453,                 loss:  1.065,                 lr : 0.03226847370119393
epoch: 4000,                 acc : 0.450,                 loss:  1.064,                 lr : 0.02439619419370578
epoch: 5000,                 acc : 0.440,                 loss:  1.064,                 lr : 0.019611688566385566
epoch: 6000,                 acc : 0.443,                 loss:  1.063,                 lr : 0.016396130513198885
epoch: 7000,                 acc : 0.447,                 loss:  1.063,                 lr : 0.014086491055078181
epoch: 8000,                 acc : 0.447,                 loss:  1.063,                 lr : 0.012347203358439314
epoch: 9000,                 acc : 0.447,                 loss:  1.062,                 lr : 0.010990218705352238
epoch: 10000,                 acc : 0.447,                 loss:  1.062,                 lr : 0.009901970492127933</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb22-2">epochs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10001</span>)</span>
<span id="cb22-3">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Accuracy'</span>)</span>
<span id="cb22-4">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Epochs'</span>)</span>
<span id="cb22-5">plt.plot(epochs,acc_vals)</span>
<span id="cb22-6">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/optimization_algorithms/index_files/figure-html/cell-18-output-1.png" width="597" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb23-2">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Loss'</span>)</span>
<span id="cb23-3">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Epochs'</span>)</span>
<span id="cb23-4">plt.plot(epochs,loss_vals)</span>
<span id="cb23-5">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/optimization_algorithms/index_files/figure-html/cell-19-output-1.png" width="606" height="430" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb24-2">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Learning rate"</span>)</span>
<span id="cb24-3">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Epochs"</span>)</span>
<span id="cb24-4">plt.plot(epochs, lr_vals)</span>
<span id="cb24-5">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/optimization_algorithms/index_files/figure-html/cell-20-output-1.png" width="589" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The optimization algorithm appears to be stuck and the reason is because the learning rate decayed far too quickly and became too small, trapping the optimizer in some local minimum. We can, instead, try to decay a bit slower by making our decay a smaller number. For example, let’s go with <img src="https://latex.codecogs.com/png.latex?10%5E%7B-3%7D">.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">acc_vals, loss_vals, lr_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train(decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>epoch: 0,                 acc : 0.327,                 loss:  1.099,                 lr : 1.0
epoch: 1000,                 acc : 0.410,                 loss:  1.066,                 lr : 0.5002501250625312
epoch: 2000,                 acc : 0.413,                 loss:  1.055,                 lr : 0.33344448149383127
epoch: 3000,                 acc : 0.457,                 loss:  1.014,                 lr : 0.25006251562890724
epoch: 4000,                 acc : 0.527,                 loss:  0.968,                 lr : 0.2000400080016003
epoch: 5000,                 acc : 0.547,                 loss:  0.935,                 lr : 0.16669444907484582
epoch: 6000,                 acc : 0.563,                 loss:  0.918,                 lr : 0.1428775539362766
epoch: 7000,                 acc : 0.573,                 loss:  0.900,                 lr : 0.12501562695336915
epoch: 8000,                 acc : 0.577,                 loss:  0.882,                 lr : 0.11112345816201799
epoch: 9000,                 acc : 0.590,                 loss:  0.860,                 lr : 0.1000100010001
epoch: 10000,                 acc : 0.603,                 loss:  0.845,                 lr : 0.09091735612328393</code></pre>
</div>
</div>
<div class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb27-2">epochs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10001</span>)</span>
<span id="cb27-3">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Accuracy'</span>)</span>
<span id="cb27-4">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Epochs'</span>)</span>
<span id="cb27-5">plt.plot(epochs,acc_vals)</span>
<span id="cb27-6">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/optimization_algorithms/index_files/figure-html/cell-22-output-1.png" width="597" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb28-2">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Loss'</span>)</span>
<span id="cb28-3">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Epochs'</span>)</span>
<span id="cb28-4">plt.plot(epochs,loss_vals)</span>
<span id="cb28-5">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/optimization_algorithms/index_files/figure-html/cell-23-output-1.png" width="597" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">plt.grid(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb29-2">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Learning rate"</span>)</span>
<span id="cb29-3">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Epochs"</span>)</span>
<span id="cb29-4">plt.plot(epochs, lr_vals)</span>
<span id="cb29-5">plt.show()</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/optimization_algorithms/index_files/figure-html/cell-24-output-1.png" width="589" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="stochastic-gradient-descent-with-momentum" class="level2">
<h2 class="anchored" data-anchor-id="stochastic-gradient-descent-with-momentum">Stochastic Gradient Descent with Momentum</h2>
<p>Momentum proposes a small tweak to gradient descent. We give gradient descent a short-term memory. Let’s define the updated velocity <img src="https://latex.codecogs.com/png.latex?z%5E%7Bk+1%7D"> to be weighted and controlled by the mass <img src="https://latex.codecogs.com/png.latex?%5Cbeta">. When <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> is high, we simply use the velocity from the last time, that is, we are entirely driven by momentum. When <img src="https://latex.codecogs.com/png.latex?%5Cbeta=0">, the momentum is zero.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Az%5E%7B(k+1)%7D%20&amp;=%20%5Cbeta%20z%5E%7B(k)%7D%20+%20%5Cnabla%20f(w%5E%7B(k)%7D)%5C%5C%0Aw%5E%7Bk+1%7D%20&amp;=%20w%5Ek%20-%20%5Calpha%20z%5E%7Bk+1%7D%0A%5Cend%7Balign*%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?z%5E%7B(k+1)%7D"> is called the <em>velocity</em>. It accumulates the past gradients similar to how a heavy ball rolling down the error function landscape integrates over past forces. To see what’s happening in more detail, we can recursively write out:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Az%5E%7B(k)%7D%20&amp;=%20%5Cbeta%20z%5E%7Bk-1%7D%20+%20%5Cnabla%20f(w%5E%7B(k-1)%7D)%20%5C%5C%0A&amp;=%20%5Cbeta(%5Cbeta%20z%5E%7Bk-2%7D%20+%20%5Cnabla%20f(w%5E%7B(k-2)%7D))%20+%20%5Cnabla%20f(w%5E%7B(k-1)%7D)%5C%5C%0A&amp;=%20%5Cbeta%5E2%20z%5E%7Bk-2%7D%20+%20%5Cbeta%20%5Cnabla%20f(w%5E%7B(k-2)%7D)%20+%20%5Cnabla%20f(w%5E%7B(k-1)%7D)%5C%5C%0A&amp;=%20%5Cbeta%5E2%20(%5Cbeta%20z%5E%7Bk-3%7D%20+%20%5Cnabla%20f(w%5E%7B(k-3)%7D)%20)%20+%20%5Cbeta%20%5Cnabla%20f(w%5E%7B(k-2)%7D)%20+%20%5Cnabla%20f(w%5E%7B(k-1)%7D)%5C%5C%0A&amp;=%20%5Csum_%7Bt=0%7D%5E%7Bk%7D%20%5Cbeta%5Et%20%5Cnabla%20f(w%5E%7B(k-1-t)%7D)%0A%5Cend%7Balign*%7D"></p>
<p>The new gradient replacement no longer points into the direction of steepest descent on a particular instance any longer but rather in the direction of an exponentially weighted average of past gradients.</p>
<section id="the-dynamics-of-momentum" class="level3">
<h3 class="anchored" data-anchor-id="the-dynamics-of-momentum">The dynamics of Momentum</h3>
<p>Since <img src="https://latex.codecogs.com/png.latex?%5Cnabla%20f(w%5Ek)%20=%20Aw%5Ek%20-%20b">, the update on the quadratic is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Az%5E%7Bk+1%7D%20&amp;=%20%5Cbeta%20z%5Ek%20+%20(Aw%5Ek%20-%20b)%5C%5C%0Aw%5E%7Bk+1%7D%20&amp;=%20w%5Ek%20-%20%5Calpha%20z%5E%7Bk+1%7D%0A%5Cend%7Balign*%7D"></p>
<p>We go through the same motions as before with the change of basis <img src="https://latex.codecogs.com/png.latex?(w%5Ek%20-%20w%5E%7B*%7D)=Qx%5Ek"> and <img src="https://latex.codecogs.com/png.latex?z%5Ek%20=%20Q%20y%5Ek"> to yield the update rule:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AQ%20y%5E%7Bk+1%7D%20&amp;=%20%5Cbeta%20Q%20y%5Ek%20+%20(AQx%5Ek%20+%20Aw%5E*%20-%20b)%5C%5C%0AQ%20y%5E%7Bk+1%7D%20&amp;=%20%5Cbeta%20Q%20y%5Ek%20+%20(AQx%5Ek%20+%20AA%5E%7B-1%7Db%20-%20b)%5C%5C%0AQ%20y%5E%7Bk+1%7D%20&amp;=%20%5Cbeta%20Q%20y%5Ek%20+%20Q%5CLambda%20Q%5ET%20Q%20x%5Ek%5C%5C%0AQ%20y%5E%7Bk+1%7D%20&amp;=%20%5Cbeta%20Q%20y%5Ek%20+%20Q%5CLambda%20x%5Ek%5C%5C%0Ay%5E%7Bk+1%7D%20&amp;=%20%5Cbeta%20y%5Ek%20+%20%5CLambda%20x%5Ek%0A%5Cend%7Balign*%7D"></p>
<p>or equivalently:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Ay_i%5E%7Bk+1%7D%20&amp;=%20%5Cbeta%20y_i%5Ek%20+%20%5Clambda_i%20x_i%5Ek%0A%5Cend%7Balign*%7D"></p>
<p>Moreover,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AQx%5E%7Bk+1%7D%20+%20w%5E*%20&amp;=%20Qx%5Ek%20+%20w%5E*%20-%20%5Calpha%20Qy%5E%7Bk+1%7D%5C%5C%0Ax%5E%7Bk+1%7D%20&amp;=%20x%5Ek%20-%20%5Calpha%20y%5E%7Bk+1%7D%0A%5Cend%7Balign*%7D"></p>
<p>or equivalently:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Ax_i%5E%7Bk+1%7D%20&amp;=%20x_i%5Ek%20-%20%5Calpha%20y_i%5E%7Bk+1%7D%0A%5Cend%7Balign*%7D"></p>
<p>This lets us rewrite our iterates as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cbegin%7Bbmatrix%7D%0Ay_i%5E%7Bk+1%7D%5C%5C%0Ax_i%5E%7Bk+1%7D%0A%5Cend%7Bbmatrix%7D%20&amp;=%0A%5Cbegin%7Bbmatrix%7D%0A%5Cbeta%20y_i%5Ek%20+%20%5Clambda_i%20x_i%5Ek%5C%5C%0A(1-%5Calpha%5Clambda_i)x_i%5Ek%20-%20%5Calpha%20%5Cbeta%20y_i%5Ek%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%5Cbegin%7Bbmatrix%7D%0A%5Cbeta%20&amp;%20%5Clambda_i%5C%5C%0A-%20%5Calpha%20%5Cbeta%20&amp;%20(1-%5Calpha%5Clambda_i)%0A%5Cend%7Bbmatrix%7D%0A%5Cbegin%7Bbmatrix%7D%0Ay_i%5Ek%5C%5C%0Ax_i%5Ek%0A%5Cend%7Bbmatrix%7D%0A%5Cend%7Balign*%7D"></p>
<p>Consequently,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cbegin%7Bbmatrix%7D%0Ay_i%5Ek%5C%5C%0Ax_i%5Ek%0A%5Cend%7Bbmatrix%7D%20=%20R%5Ek%20%5Cbegin%7Bbmatrix%7D%0Ay_i%5E0%5C%5C%0Ax_i%5E0%0A%5Cend%7Bbmatrix%7D,%5Cquad%0AR%20=%20%5Cbegin%7Bbmatrix%7D%0A%5Cbeta%20&amp;%20%5Clambda_i%5C%5C%0A-%20%5Calpha%20%5Cbeta%20&amp;%20(1-%5Calpha%5Clambda_i)%0A%5Cend%7Bbmatrix%7D%0A%5Cend%7Balign*%7D"></p>
<p>In the case of <img src="https://latex.codecogs.com/png.latex?2%20%5Ctimes%202"> matrix, there is an elegant little known formula in terms of the eigenvalues of the matrix <img src="https://latex.codecogs.com/png.latex?R">, <img src="https://latex.codecogs.com/png.latex?%5Csigma_1"> and <img src="https://latex.codecogs.com/png.latex?%5Csigma_2">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AR%5Ek%20=%20%5Cbegin%7Bcases%7D%0A%5Csigma_1%5Ek%20R_1%20-%20%5Csigma_2%5Ek%20R_2%20&amp;%20%5Csigma_1%20%5Cneq%20%5Csigma_2,%5C%5C%0A%5Csigma_1%5Ek(kR%5Csigma_1-(k-1)I)%20&amp;%20%5Csigma_1%20=%20%5Csigma_2%0A%5Cend%7Bcases%7D%0A%5Cquad%0AR_j%20=%20%5Cfrac%7BR-%5Csigma_j%20I%7D%7B%5Csigma_1%20-%20%5Csigma_2%7D%0A%5Cend%7Balign*%7D"></p>
<p>The formula is rather complicated, but the takeway here is that it plays the exact same role the individual convergence rates <img src="https://latex.codecogs.com/png.latex?(1-%5Calpha%20%5Clambda_i)"> do in gradient descent. The convergence rate is therefore the slowest of the two rates, <img src="https://latex.codecogs.com/png.latex?%5Cmax%20%5C%7B%7C%5Csigma_1%7C,%7C%5Csigma_2%7C%5C%7D">.</p>
<p>For what values of <img src="https://latex.codecogs.com/png.latex?%5Calpha"> and <img src="https://latex.codecogs.com/png.latex?%5Cbeta"> does momentum converge? Since we need both <img src="https://latex.codecogs.com/png.latex?%5Csigma_1"> and <img src="https://latex.codecogs.com/png.latex?%5Csigma_2"> to converge, our convergence criterion is now <img src="https://latex.codecogs.com/png.latex?%5Cmax%20%5C%7B%7C%5Csigma_1%7C,%7C%5Csigma_2%7C%5C%7D%20%3C%201">.</p>
<p>It can be shown that when we choose an optimal value of the parameters <img src="https://latex.codecogs.com/png.latex?%5Calpha"> and <img src="https://latex.codecogs.com/png.latex?%5Cbeta">, the convergence rate is proportional to:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Csqrt%7B%5Ckappa%7D%20-%201%7D%7B%5Csqrt%7B%5Ckappa%7D%20+%201%7D%0A%5Cend%7Balign*%7D"></p>
<p>With barely a modicum of extra effort, we have square-rooted the condition number.</p>
</section>
</section>
<section id="adding-momentum-to-the-sgdoptimizer-class" class="level2">
<h2 class="anchored" data-anchor-id="adding-momentum-to-the-sgdoptimizer-class">Adding momentum to the <code>SGDOptimizer</code> class</h2>
<p>We are now in a position to add momentum to the <code>SGDOptimizer</code> class.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> SGDOptimizer:</span>
<span id="cb30-2"></span>
<span id="cb30-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial optimizer - set settings</span></span>
<span id="cb30-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># learning rate of 1. is default for this optimizer</span></span>
<span id="cb30-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, learning_rate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, momentum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>):</span>
<span id="cb30-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learning_rate</span>
<span id="cb30-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learning_rate</span>
<span id="cb30-8">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.decay <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> decay</span>
<span id="cb30-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.iterations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb30-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> momentum</span>
<span id="cb30-11"></span>
<span id="cb30-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Call once before any parameter updates</span></span>
<span id="cb30-13">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> pre_update_params(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb30-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.decay:</span>
<span id="cb30-15">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (</span>
<span id="cb30-16">                <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.decay <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.iterations)</span>
<span id="cb30-17">            )</span>
<span id="cb30-18"></span>
<span id="cb30-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update parameters</span></span>
<span id="cb30-20">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_params(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, layer):</span>
<span id="cb30-21"></span>
<span id="cb30-22">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If we use momentum</span></span>
<span id="cb30-23">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta:</span>
<span id="cb30-24"></span>
<span id="cb30-25">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If the layer does not contain momentum arrays, create them</span></span>
<span id="cb30-26">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filled with zeros</span></span>
<span id="cb30-27">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hasattr</span>(layer, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight_momentums"</span>):</span>
<span id="cb30-28">                layer.weight_momentums <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros_like(layer.dloss_dweights)</span>
<span id="cb30-29">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If there is no momentumm array for weights</span></span>
<span id="cb30-30">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the array doesnt exist for biases yet either</span></span>
<span id="cb30-31">                layer.bias_momentums <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros_like(layer.dloss_dbiases)</span>
<span id="cb30-32"></span>
<span id="cb30-33">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build weight updates with momentum - take previous</span></span>
<span id="cb30-34">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># updates multiplied by retain factor and update with</span></span>
<span id="cb30-35">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># with current gradients</span></span>
<span id="cb30-36">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># v[t+1] = \beta * v[t] + \alpha * dL/dw</span></span>
<span id="cb30-37">            weight_updates <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb30-38">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.weight_momentums</span>
<span id="cb30-39">                <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.dloss_dweights</span>
<span id="cb30-40">            )</span>
<span id="cb30-41">            layer.weight_momentums <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weight_updates</span>
<span id="cb30-42"></span>
<span id="cb30-43">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build bias updates</span></span>
<span id="cb30-44">            bias_updates <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb30-45">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.beta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.bias_momentums</span>
<span id="cb30-46">                <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.dloss_dbiases</span>
<span id="cb30-47">            )</span>
<span id="cb30-48">            layer.bias_momentums <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> bias_updates</span>
<span id="cb30-49">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb30-50">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vanilla SGD updates (as before momentum update)</span></span>
<span id="cb30-51">            weight_updates <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.dloss_dweights</span>
<span id="cb30-52">            bias_updates <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.dloss_dbiases</span>
<span id="cb30-53"></span>
<span id="cb30-54">        layer.weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> weight_updates</span>
<span id="cb30-55">        layer.biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> bias_updates</span>
<span id="cb30-56"></span>
<span id="cb30-57">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> post_update_params(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb30-58">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.iterations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span></code></pre></div>
</div>
<p>Let’s see an example illustrating how adding momentum changes the learning process. Keeping the same <code>learning_rate=1.0</code> and <code>decay=1e-3</code> from the previous training attempt and using a momentum of <code>0.50</code>:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> train(decay, momentum):</span>
<span id="cb31-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a dataset</span></span>
<span id="cb31-3">    X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spiral_data(samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb31-4"></span>
<span id="cb31-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a dense layer with 2 input features and 64 output values</span></span>
<span id="cb31-6">    dense1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)</span>
<span id="cb31-7"></span>
<span id="cb31-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create ReLU activation (to be used with the dense layer)</span></span>
<span id="cb31-9">    activation1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ReLUActivation()</span>
<span id="cb31-10"></span>
<span id="cb31-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create second DenseLayer with 64 input features (as we take output of the</span></span>
<span id="cb31-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># previous layer here) and 3 output values</span></span>
<span id="cb31-13">    dense2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb31-14"></span>
<span id="cb31-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create Softmax classifier's combined loss and activation</span></span>
<span id="cb31-16">    loss_activation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CategoricalCrossEntropySoftmax()</span>
<span id="cb31-17"></span>
<span id="cb31-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create optimizer</span></span>
<span id="cb31-19">    optimizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SGDOptimizer(learning_rate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>,decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>decay,momentum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>momentum)</span>
<span id="cb31-20"></span>
<span id="cb31-21">    acc_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb31-22">    loss_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb31-23">    lr_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb31-24"></span>
<span id="cb31-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Train in a loop</span></span>
<span id="cb31-26">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10001</span>):</span>
<span id="cb31-27">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass of our training data through this layer</span></span>
<span id="cb31-28">        dense1.forward(X)</span>
<span id="cb31-29"></span>
<span id="cb31-30">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass through the activation function</span></span>
<span id="cb31-31">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the output of the first dense layer here</span></span>
<span id="cb31-32">        activation1.forward(dense1.output)</span>
<span id="cb31-33"></span>
<span id="cb31-34">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass through second DenseLayer</span></span>
<span id="cb31-35">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the outputs of the activation function of first layer as inputs</span></span>
<span id="cb31-36">        dense2.forward(activation1.output)</span>
<span id="cb31-37"></span>
<span id="cb31-38">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass through the activation/loss function</span></span>
<span id="cb31-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># takes the output of the second DenseLayer here and returns the loss</span></span>
<span id="cb31-40">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_activation.forward(dense2.output, y)</span>
<span id="cb31-41"></span>
<span id="cb31-42">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate accuracy from output of activation2 and targets</span></span>
<span id="cb31-43">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate values along the first axis</span></span>
<span id="cb31-44">        predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.argmax(loss_activation.output, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb31-45">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:</span>
<span id="cb31-46">            y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.argmax(y, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb31-47"></span>
<span id="cb31-48">        accuracy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(predictions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> y)</span>
<span id="cb31-49"></span>
<span id="cb31-50">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> epoch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb31-51">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(</span>
<span id="cb31-52">                <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"epoch: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>epoch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb31-53"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">                acc : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>accuracy<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb31-54"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">                loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: .3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb31-55"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">                lr : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>optimizer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>current_learning_rate<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb31-56">            )</span>
<span id="cb31-57"></span>
<span id="cb31-58">        acc_vals.append(accuracy)</span>
<span id="cb31-59">        loss_vals.append(loss)</span>
<span id="cb31-60">        lr_vals.append(optimizer.current_learning_rate)</span>
<span id="cb31-61"></span>
<span id="cb31-62">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward pass</span></span>
<span id="cb31-63">        loss_activation.backward(loss_activation.output, y)</span>
<span id="cb31-64">        dense2.backward(loss_activation.dloss_dz)</span>
<span id="cb31-65">        activation1.backward(dense2.dloss_dinputs)</span>
<span id="cb31-66">        dense1.backward(activation1.dloss_dz)</span>
<span id="cb31-67"></span>
<span id="cb31-68">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update the weights and the biases</span></span>
<span id="cb31-69">        optimizer.pre_update_params()</span>
<span id="cb31-70">        optimizer.update_params(dense1)</span>
<span id="cb31-71">        optimizer.update_params(dense2)</span>
<span id="cb31-72">        optimizer.post_update_params()</span>
<span id="cb31-73"></span>
<span id="cb31-74">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> acc_vals, loss_vals, lr_vals</span></code></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">acc_vals, loss_vals, lr_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train(decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>, momentum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>epoch: 0,                 acc : 0.337,                 loss:  1.099,                 lr : 1.0
epoch: 1000,                 acc : 0.510,                 loss:  0.978,                 lr : 0.5002501250625312
epoch: 2000,                 acc : 0.557,                 loss:  0.879,                 lr : 0.33344448149383127
epoch: 3000,                 acc : 0.580,                 loss:  0.771,                 lr : 0.25006251562890724
epoch: 4000,                 acc : 0.630,                 loss:  0.735,                 lr : 0.2000400080016003
epoch: 5000,                 acc : 0.657,                 loss:  0.670,                 lr : 0.16669444907484582
epoch: 6000,                 acc : 0.753,                 loss:  0.573,                 lr : 0.1428775539362766
epoch: 7000,                 acc : 0.783,                 loss:  0.522,                 lr : 0.12501562695336915
epoch: 8000,                 acc : 0.790,                 loss:  0.481,                 lr : 0.11112345816201799
epoch: 9000,                 acc : 0.807,                 loss:  0.441,                 lr : 0.1000100010001
epoch: 10000,                 acc : 0.843,                 loss:  0.401,                 lr : 0.09091735612328393</code></pre>
</div>
</div>
<p>The model achieved the lowest loss and the highest accuracy that we’ve seen so far. Can we do better? Sure, we can! Let’s try to set the momentum to <img src="https://latex.codecogs.com/png.latex?0.9">:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">acc_vals, loss_vals, lr_vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> train(decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>, momentum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>epoch: 0,                 acc : 0.340,                 loss:  1.099,                 lr : 1.0
epoch: 1000,                 acc : 0.763,                 loss:  0.463,                 lr : 0.5002501250625312
epoch: 2000,                 acc : 0.790,                 loss:  0.407,                 lr : 0.33344448149383127
epoch: 3000,                 acc : 0.803,                 loss:  0.396,                 lr : 0.25006251562890724
epoch: 4000,                 acc : 0.813,                 loss:  0.391,                 lr : 0.2000400080016003
epoch: 5000,                 acc : 0.813,                 loss:  0.386,                 lr : 0.16669444907484582
epoch: 6000,                 acc : 0.813,                 loss:  0.384,                 lr : 0.1428775539362766
epoch: 7000,                 acc : 0.813,                 loss:  0.375,                 lr : 0.12501562695336915
epoch: 8000,                 acc : 0.833,                 loss:  0.332,                 lr : 0.11112345816201799
epoch: 9000,                 acc : 0.880,                 loss:  0.285,                 lr : 0.1000100010001
epoch: 10000,                 acc : 0.880,                 loss:  0.277,                 lr : 0.09091735612328393</code></pre>
</div>
</div>
</section>
<section id="adagrad" class="level2">
<h2 class="anchored" data-anchor-id="adagrad">AdaGrad</h2>
<p>In real-world datasets, some input features are sparse and some features are dense. If we use the same learning rate <img src="https://latex.codecogs.com/png.latex?%5Calpha"> for all the weights, parameters associated with sparse features receive meaningful updates only when these features occur. Given a decreasing learning rate, we might end up with a situation where parameters for dense features converge rather quickly to their optimal values, whereas for sparse features, we are still short of observing them sufficiently frequently before their optimal values can be determined. In other words, the learning rate decreases too slowly for dense features and too quickly for sparse features.</p>
<p>The update rule for adaptive step-size gradient descent is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbf%7Bg%7D_t%20&amp;=%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%20L%7D%7B%5Cpartial%20%5Cmathbf%7Bw%7D%7D%5C%5C%0A%5Cmathbf%7Bs%7D_t%20&amp;=%20%5Cmathbf%7Bs%7D_%7Bt-1%7D%20+%20%5Cmathbf%7Bg%7D_%7Bt%7D%5E2%20%5C%5C%0A%5Cmathbf%7Bw%7D_t%20&amp;=%20%5Cmathbf%7Bw%7D_%7Bt-1%7D%20+%20%5Cfrac%7B%5Calpha%7D%7B%5Csqrt%7B%5Cmathbf%7Bs%7D_t+%5Cepsilon%7D%7D%5Ccdot%20%5Cmathbf%7Bg%7D_t%0A%5Cend%7Balign*%7D"></p>
<p>Here the operations are applied coordinate-wise. So, the jacobian <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bg%7D_t%5E2"> has entries <img src="https://latex.codecogs.com/png.latex?g_t%5E2">. As before, <img src="https://latex.codecogs.com/png.latex?%5Calpha"> is the learning rate and <img src="https://latex.codecogs.com/png.latex?%5Cepsilon"> is an additive constant that ensures that we do not divide by <img src="https://latex.codecogs.com/png.latex?0">. Thus, the learning rate for features whose weights receive frequent updates is decreased faster, whilst for those features, whose weights receive infrequent updates, it is decreased slower.</p>
<p>Thus, Adagrad decreases the learning-rate dynamically on a per-coordinate basis.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> AdagradOptimizer:</span>
<span id="cb36-2"></span>
<span id="cb36-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial optimizer - set settings</span></span>
<span id="cb36-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># learning rate of 1. is default for this optimizer</span></span>
<span id="cb36-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, learning_rate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, decay<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, epsilon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span>):</span>
<span id="cb36-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learning_rate</span>
<span id="cb36-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learning_rate</span>
<span id="cb36-8">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.decay <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> decay</span>
<span id="cb36-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.iterations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb36-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.epsilon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> epsilon</span>
<span id="cb36-11"></span>
<span id="cb36-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Call once before any parameter updates</span></span>
<span id="cb36-13">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> pre_update_params(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb36-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.decay:</span>
<span id="cb36-15">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (</span>
<span id="cb36-16">                <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.decay <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.iterations)</span>
<span id="cb36-17">            )</span>
<span id="cb36-18"></span>
<span id="cb36-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update parameters</span></span>
<span id="cb36-20">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_params(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, layer):</span>
<span id="cb36-21">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hasattr</span>(layer, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight_cache"</span>):</span>
<span id="cb36-22">            layer.weight_cache <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros_like(layer.weights)</span>
<span id="cb36-23">            layer.bias_cache <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros_like(layer.biases)</span>
<span id="cb36-24"></span>
<span id="cb36-25">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update cache with squared current gradients</span></span>
<span id="cb36-26">        layer.weight_cache <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> layer.dloss_dweights<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb36-27">        layer.bias_cache <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> layer.dloss_dbiases<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb36-28"></span>
<span id="cb36-29">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vanilla SGD parameter update + normalization</span></span>
<span id="cb36-30">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># with square rooted cache</span></span>
<span id="cb36-31">        layer.weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> (</span>
<span id="cb36-32">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate</span>
<span id="cb36-33">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.dloss_dweights</span>
<span id="cb36-34">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (np.sqrt(layer.weight_cache) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.epsilon)</span>
<span id="cb36-35">        )</span>
<span id="cb36-36">        layer.biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> (</span>
<span id="cb36-37">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.current_learning_rate</span>
<span id="cb36-38">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> layer.dloss_dbiases</span>
<span id="cb36-39">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (np.sqrt(layer.bias_cache) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.epsilon)</span>
<span id="cb36-40">        )</span>
<span id="cb36-41"></span>
<span id="cb36-42">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> post_update_params(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb36-43">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.iterations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span></code></pre></div>
</div>
</section>
<section id="rmsprop" class="level2">
<h2 class="anchored" data-anchor-id="rmsprop">RMSProp</h2>
<p>One of the key issues of Adagrad is that the learning rate decreases at a predefined schedule essentially at a rate proportional <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B%5Csqrt%7Bt%7D%7D">. While this is generally appropriate for convex problems, it might not be ideal for nonconvex ones, such as those encountered in deep learning. Yet, the coordinate-wise adaptivity of Adagrad is highly desirable as a preconditioner.</p>
<p>Tieleman and Hinton(<a href="https://www.d2l.ai/chapter_references/zreferences.html#id284">2012</a>) have proposed the RMSProp algorithm as a simple fix to decouple the rate scheduling from coordinate adaptive learning rates. The issue is that the squares of the gradient <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bg%7D_t"> keeps accumulating into the state vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bs%7D_t%20=%20%5Cmathbf%7Bs%7D_%7Bt-1%7D%20+%20%5Cmathbf%7Bg%7D_t%5E2">. As a result, <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bs%7D_t"> keeps on growing without bounds, essentially linearly as the algorithm converges.</p>
<section id="the-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="the-algorithm">The Algorithm</h3>
<p>The update rule for the RMSProp algorithm is as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cmathbf%7Bs%7D_t%20&amp;=%20%5Cgamma%20%5Cmathbf%7Bs%7D_%7Bt-1%7D%20+%20(1-%20%5Cgamma)%5Cmathbf%7Bg%7D_t%5E2%5C%5C%0A%5Cmathbf%7Bx%7D_t%20&amp;=%20%5Cmathbf%7Bx%7D_%7Bt-1%7D%20-%20%5Cfrac%7B%5Calpha%7D%7B%5Csqrt%7B%5Cmathbf%7Bs%7D_t%20+%20%5Cepsilon%7D%7D%5Codot%20%5Cmathbf%7Bg%7D_t%0A%5Cend%7Balign*%7D"></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>Machine Learning</category>
  <guid>https://quantdev.blog/posts/optimization_algorithms/</guid>
  <pubDate>Sun, 09 Jun 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/optimization_algorithms/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Backpropogation</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/backpropogation/</link>
  <description><![CDATA[ 





<section id="calculating-the-network-error-with-loss" class="level2">
<h2 class="anchored" data-anchor-id="calculating-the-network-error-with-loss">Calculating the network error with Loss</h2>
<p>With a randomly initialized model, or even a model initialized with more sophisticated approaches, our goal is to train, or teach a model over time. To train a model, we tweak the weights and biases to improve the model’s accuracy and confidence. To do this, we calculate the error in our model. The <em>loss function</em> also referred to as the <em>cost function</em> quantifies the error.</p>
<section id="logit-vector" class="level3">
<h3 class="anchored" data-anchor-id="logit-vector">Logit vector</h3>
<p>Let <img src="https://latex.codecogs.com/png.latex?%5Cvec%7Bl%7D%20=%20%5Cmathbf%7Bw%7D%5Ccdot%20%5Cmathbf%7Bx%7D%20+%20%5Cmathbf%7Bb%7D"> be the result of the last dense layer of a neural network (the inner product between an input feature vector and the weights vector of the layer, added to the bias factor). This is commonly referred to as the <strong>logit vector</strong> in machine learning literature.</p>
</section>
<section id="entropy-cross-entropy-and-kl-divergence" class="level3">
<h3 class="anchored" data-anchor-id="entropy-cross-entropy-and-kl-divergence">Entropy, Cross-Entropy and KL-Divergence</h3>
<p>Let <img src="https://latex.codecogs.com/png.latex?X"> be a random variable with possible outcomes <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BX%7D">. Let <img src="https://latex.codecogs.com/png.latex?P"> be the true probability distribution of <img src="https://latex.codecogs.com/png.latex?X"> with probability mass function <img src="https://latex.codecogs.com/png.latex?p(x)">. Let <img src="https://latex.codecogs.com/png.latex?Q"> be an approximating distribution with probability mass function <img src="https://latex.codecogs.com/png.latex?q(x)">.</p>
<p><em>Definition</em>. The entropy of <img src="https://latex.codecogs.com/png.latex?P"> is defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AH(P)%20=%20-%5Csum_%7Bx%5Cin%5Cmathcal%7BX%7D%7D%20p(x)%20%5Ccdot%20%5Clog%20p(x)%0A%5Cend%7Balign*%7D"></p>
<p>In information theory, entropy is the measure of uncertainty, surprise of a system. By taking the logarithm <img src="https://latex.codecogs.com/png.latex?%5Clog%20p(x)">, <em>we concentrate on the order of the surprise</em>. Entropy, then, is an expectation over the uncertainties or the <em>expected surprise</em>.</p>
<p><em>Definition</em>. The cross-entropy of <img src="https://latex.codecogs.com/png.latex?Q"> relative to <img src="https://latex.codecogs.com/png.latex?P"> is defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AH(P,Q)%20=%20-%5Csum_%7Bx%5Cin%5Cmathcal%7BX%7D%7D%20p(x)%20%5Ccdot%20%5Clog%20q(x)%0A%5Cend%7Balign*%7D"></p>
<p><em>Definition</em>. For discrete distributions <img src="https://latex.codecogs.com/png.latex?P"> and <img src="https://latex.codecogs.com/png.latex?Q"> defined on the sample space <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BX%7D">, the <em>Kullback-Leibler(KL) divergence</em> (or relative entropy) from <img src="https://latex.codecogs.com/png.latex?Q"> to <img src="https://latex.codecogs.com/png.latex?P"> is defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AD_%7BKL%7D(P%7C%7CQ)%20=%20-%5Csum_%7Bx%5Cin%5Cmathcal%7BX%7D%7D%20p(x)%20%5Ccdot%20%5Clog%20%5Cfrac%7Bp(x)%7D%7Bq(x)%7D%0A%5Cend%7Balign*%7D"></p>
<p>Intuitively, it is the expected excess surprise from using <img src="https://latex.codecogs.com/png.latex?Q"> as a model instead of <img src="https://latex.codecogs.com/png.latex?P">, when the actual distribution is <img src="https://latex.codecogs.com/png.latex?P">. Note that, <img src="https://latex.codecogs.com/png.latex?D_%7BKL%7D(P%7C%7CQ)%20%5Cneq%20D_%7BKL%7D(Q%7C%7CP)">, so it is not symmetric and hence it is not a norm.</p>
</section>
<section id="categorical-cross-entropy-loss-function" class="level3">
<h3 class="anchored" data-anchor-id="categorical-cross-entropy-loss-function">Categorical cross-entropy loss function</h3>
<p>We are going to work on a multi-class classification problem.</p>
<p>For any input <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D_i">, the target vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D_i"> could be specified using <em>one-hot</em> encoding or an integer in the range <code>[0,numClasses)</code>.</p>
<p>Let’s say, we have <code>numClasses = 3</code>.</p>
<p>In one-hot encoding, the target vector <code>y_true</code> is an array like <code>[1, 0, 0]</code>, <code>[0, 1, 0]</code>, or <code>[0, 0, 1]</code>. The category/class is determined by the index which is <strong>hot</strong>. For example, if <code>y_true</code> equals <code>[0, 1, 0]</code>, then the sample belongs to class <img src="https://latex.codecogs.com/png.latex?1">, whilst if <code>y_true</code> equals <code>[0, 0, 1]</code>, the sample belongs to class <img src="https://latex.codecogs.com/png.latex?2">.</p>
<p>In integer encoding, the target vector <code>y_true</code> is an integer. For example, if <code>y_true</code> equals <img src="https://latex.codecogs.com/png.latex?1">, the sample belongs to class <img src="https://latex.codecogs.com/png.latex?1">, whilst if <code>y_true</code> equals <img src="https://latex.codecogs.com/png.latex?2">, the sample belongs to class <img src="https://latex.codecogs.com/png.latex?2">.</p>
<p>The <code>categorical_crossentropy</code> is defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AL_i%20=%20-%5Csum_%7Bj%7D%20y_%7Bi,j%7D%20%5Clog(%5Chat%7By%7D_%7Bi,j%7D)%0A%5Cend%7Balign*%7D"></p>
<p>Assume that we have a softmax output <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmathbf%7By%7D%7D_i">, <code>[0.7, 0.1, 0.2]</code> and target vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D_i"> <code>[1, 0, 0]</code>. Then, we can compute the categorical cross entropy loss as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A-%5Cleft(1%5Ccdot%20%5Clog%20(0.7)%20+%200%20%5Ccdot%20%5Clog%20(0.1)%20+%200%20%5Ccdot%20%5Clog(0.2)%5Cright)%20=%200.35667494%0A%5Cend%7Balign*%7D"></p>
<p>Let’s that we have a batch of <img src="https://latex.codecogs.com/png.latex?3"> samples. Additionally, suppose the target <code>y_true</code> is integer encoded. After running through the softmax activation function, the network’s output layer yields:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>load_ext itikz</span></code></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb2-2"></span>
<span id="cb2-3">y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb2-4">    [</span>
<span id="cb2-5">        [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>],</span>
<span id="cb2-6">        [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>],</span>
<span id="cb2-7">        [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]</span>
<span id="cb2-8">    ]</span>
<span id="cb2-9">)</span>
<span id="cb2-10"></span>
<span id="cb2-11">y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span></code></pre></div>
</div>
<p>With a collection of softmax outputs and their intended targets, we can map these indices to retrieve the predicted probabilities of the true class labels:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> targ_index, distribution <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(y_true,y_pred):</span>
<span id="cb3-2">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(distribution[targ_index])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.7
0.5
0.08</code></pre>
</div>
</div>
<p>This can be simplified.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(y_pred[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],y_true])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.7  0.5  0.08]</code></pre>
</div>
</div>
<p><code>numpy</code> lets us index an 2D-array in multiple ways. One of them is to use a list filled with row indices and a list with column indices. We could, thus, write:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(y_pred[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred)),y_true])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.7  0.5  0.08]</code></pre>
</div>
</div>
<p>The categorical cross-entropy loss for each of the samples is:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.log(y_pred[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred)),y_true]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.35667494 0.69314718 2.52572864]</code></pre>
</div>
</div>
<p>Finally, we want an average loss for the entire batch, to have an idea about how our model is doing during the training phase. Therefore, we have:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">neg_log <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.log(y_pred[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred)),y_true])</span>
<span id="cb11-2">average_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(neg_log)</span>
<span id="cb11-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(average_loss)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.191850256268978</code></pre>
</div>
</div>
<p>In the case, that the targets are one-hot encoded, we need to handle this case a bit differently. If <code>y_true.shape</code> has <img src="https://latex.codecogs.com/png.latex?2"> dimensions, then it implies, we have a set of one-hot encoded vectors. On the other hand, if <code>y_true</code> is a list, that is <code>y_true.shape</code> has <img src="https://latex.codecogs.com/png.latex?1"> dimension, then it means, we have <em>sparse labels</em>/integer encoding.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb13-2"></span>
<span id="cb13-3">y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb13-4">    [</span>
<span id="cb13-5">        [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>],</span>
<span id="cb13-6">        [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>],</span>
<span id="cb13-7">        [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]</span>
<span id="cb13-8">    ]</span>
<span id="cb13-9">)</span>
<span id="cb13-10"></span>
<span id="cb13-11">y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb13-12">    [</span>
<span id="cb13-13">        [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb13-14">        [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb13-15">        [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb13-16">    ]</span>
<span id="cb13-17">)</span>
<span id="cb13-18"></span>
<span id="cb13-19">correct_confidences <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([])</span>
<span id="cb13-20"></span>
<span id="cb13-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If categorical labels</span></span>
<span id="cb13-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb13-23">    correct_confidences <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y_pred[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred)), y_true]</span>
<span id="cb13-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred.shape)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>):</span>
<span id="cb13-25">    correct_confidences <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_true, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb13-26"></span>
<span id="cb13-27">neg_log <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.log(correct_confidences)</span>
<span id="cb13-28">average_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(neg_log)</span>
<span id="cb13-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(average_loss)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.191850256268978</code></pre>
</div>
</div>
<p>If the neural network output <code>y_pred</code> for some reason is the vector <code>[1, 0, 0]</code>, this would result in <code>numpy.log</code> function returning a negative infinity. To avoid such situations, it’s safer to apply a ceil and floor to <code>y_pred</code>.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">epsilon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span></span>
<span id="cb15-2">y_pred_clipped <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.clip(y_pred, epsilon, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>epsilon)</span></code></pre></div>
</div>
</section>
</section>
<section id="categorical-cross-entropy-loss-class" class="level2">
<h2 class="anchored" data-anchor-id="categorical-cross-entropy-loss-class">Categorical Cross-Entropy Loss Class</h2>
<p>I first create an abstract base class <code>Loss</code>. Every <code>Loss</code> object exposes the <code>calculate</code> method which in turn calls <code>Loss</code> object’s forward method to compute the log-loss for each sample and then takes an average of the sample losses.</p>
<p><code>CategoricalCrossEntropyLoss</code> class is a child class of <code>Loss</code> and provides an implementation of the <code>forward</code> method.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb16-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nnfs</span>
<span id="cb16-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> nnfs.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> spiral_data</span>
<span id="cb16-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> abc <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> abstractmethod</span>
<span id="cb16-5"></span>
<span id="cb16-6"></span>
<span id="cb16-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Abstract base class for losses</span></span>
<span id="cb16-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Loss:</span>
<span id="cb16-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@abstractmethod</span></span>
<span id="cb16-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, y_pred, y_true):</span>
<span id="cb16-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">pass</span></span>
<span id="cb16-12"></span>
<span id="cb16-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@abstractmethod</span></span>
<span id="cb16-14">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> backward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, y_pred, y_true):</span>
<span id="cb16-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">pass</span></span>
<span id="cb16-16"></span>
<span id="cb16-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculates the data and regularization losses</span></span>
<span id="cb16-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># given model output and ground truth values</span></span>
<span id="cb16-19">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> calculate(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, output, y):</span>
<span id="cb16-20"></span>
<span id="cb16-21">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the sample losses</span></span>
<span id="cb16-22">        sample_losses <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.forward(output, y)</span>
<span id="cb16-23"></span>
<span id="cb16-24">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the mean loss</span></span>
<span id="cb16-25">        data_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.mean(sample_losses)</span>
<span id="cb16-26"></span>
<span id="cb16-27">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Return loss</span></span>
<span id="cb16-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> data_loss</span>
<span id="cb16-29"></span>
<span id="cb16-30"></span>
<span id="cb16-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cross-Entropy loss</span></span>
<span id="cb16-32"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> CategoricalCrossEntropyLoss(Loss):</span>
<span id="cb16-33"></span>
<span id="cb16-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb16-35">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, y_pred, y_true):</span>
<span id="cb16-36">        num_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred)</span>
<span id="cb16-37"></span>
<span id="cb16-38">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clip data to prevent division by 0</span></span>
<span id="cb16-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clip both sides to not drag mean towards any value</span></span>
<span id="cb16-40">        epsilon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span></span>
<span id="cb16-41">        y_pred_clipped <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.clip(y_pred, epsilon, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> epsilon)</span>
<span id="cb16-42"></span>
<span id="cb16-43">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If categorical labels</span></span>
<span id="cb16-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb16-45">            correct_confidences <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y_pred[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred)), y_true]</span>
<span id="cb16-46">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># else if one-hot encoding</span></span>
<span id="cb16-47">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:</span>
<span id="cb16-48">            correct_confidences <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_true, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb16-49"></span>
<span id="cb16-50">        neg_log <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.log(correct_confidences)</span>
<span id="cb16-51">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> neg_log</span></code></pre></div>
</div>
<p>Using the manual created outputs and targets, we have:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb17-2">    [</span>
<span id="cb17-3">        [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>],</span>
<span id="cb17-4">        [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>],</span>
<span id="cb17-5">        [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]</span>
<span id="cb17-6">    ]</span>
<span id="cb17-7">)</span>
<span id="cb17-8"></span>
<span id="cb17-9">y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb17-10">    [</span>
<span id="cb17-11">        [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb17-12">        [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb17-13">        [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb17-14">    ]</span>
<span id="cb17-15">)</span>
<span id="cb17-16"></span>
<span id="cb17-17">loss_function <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CategoricalCrossEntropyLoss()</span>
<span id="cb17-18">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loss_function.calculate(y_pred, y_true)</span>
<span id="cb17-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(loss)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.191850256268978</code></pre>
</div>
</div>
</section>
<section id="backpropogation" class="level2">
<h2 class="anchored" data-anchor-id="backpropogation">Backpropogation</h2>
<p>Backpropogation consists going backwards along the edges and passing along gradients. We are going to chop up a neuron into it’s elementary operations and draw a computational graph. Each node in the graph receives an upstream gradient. The goal is pass on the correct downstream gradient.</p>
<p>Each node has a <em>local gradient</em> - the gradient of it’s output with respect to it’s input. Consider a node receiving an input <img src="https://latex.codecogs.com/png.latex?z"> and producing an output <img src="https://latex.codecogs.com/png.latex?h=f(z)">. Then, we have:</p>
<div class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb19-2">\begin{tikzpicture}</span>
<span id="cb19-3">    \node [circle,minimum size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,draw] (f) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\huge $f$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb19-4">    \node [blue] (localgrad) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\huge $\frac{\partial h}{\partial z}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb19-5">    \node [blue] (lgrad) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {\large Local gradient}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb19-6">    \draw [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.80</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [above,midway] {\huge $h$} (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb19-7">    \draw [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [below,midway] {\huge $\frac{\partial s}{\partial h}$} (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.80</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb19-8">    \node [] (upgrad) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {\huge Upstream gradient}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb19-9">    \draw [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [above,midway] {\huge $z$} (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.80</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb19-10">    \draw [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.80</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [below,midway] {\huge $\frac{\partial s}{\partial z} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> \frac{\partial s}{\partial h} \cdot \frac{\partial h}{\partial z}$} (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb19-11">    \node [] (downgrad) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {\huge Downstream gradient}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb19-12">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/backpropogation/index_files/figure-html/cell-13-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The downstream gradient <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20s%7D%7B%5Cpartial%20z%7D"> equals the upstream graient <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20s%7D%7B%5Cpartial%20h%7D"> times the local gradient <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20z%7D">.</p>
<p>What about nodes with multiple inputs? Say that, <img src="https://latex.codecogs.com/png.latex?h=f(x,y)">. Multiple inputs imply multiple local gradients.</p>
<div class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb20-2">\begin{tikzpicture}[x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>,y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>,yscale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.75</span>]</span>
<span id="cb20-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>uncomment <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> require: \path (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">216</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> diagram left start at <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> has height of <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">216</span></span>
<span id="cb20-4"></span>
<span id="cb20-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Shape: Circle [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:dp08328772161506959] </span>
<span id="cb20-6">\draw   (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">302.75</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">83.38</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">302.75</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">53.62</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">326.87</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">29.5</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">356.63</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">29.5</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">386.38</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">29.5</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">410.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">53.62</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">410.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">83.38</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">410.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.13</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">386.38</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">137.25</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">356.63</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">137.25</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">326.87</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">137.25</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">302.75</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">113.13</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">302.75</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">83.38</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da2730189357413113] </span>
<span id="cb20-8">\draw    (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">406</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">59.38</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">513.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">59.74</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-9">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">515.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">59.75</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">180.2</span>] [color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>]    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) .. (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>)   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-10"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da21080101466010737] </span>
<span id="cb20-11">\draw    (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">515</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">110.75</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">405</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">110.26</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-12">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">403</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">110.25</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.26</span>] [color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>]    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) .. (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>)   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-13"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da05192158713361961] </span>
<span id="cb20-14">\draw    (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">209</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.75</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">309.71</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">51.37</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-15">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">311.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">52.25</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">206.23</span>] [color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>]    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) .. (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>)   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-16"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da3568530309648137] </span>
<span id="cb20-17">\draw    (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">305</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">68.25</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">204.31</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20.61</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-18">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">202.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">19.75</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">25.32</span>] [color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>]    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) .. (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>)   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-19"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da4437541566257528] </span>
<span id="cb20-20">\draw    (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">205</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">167.25</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">311.2</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">116.12</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-21">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">313</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">115.25</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">154.29</span>] [color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>]    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) .. (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>)   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-22"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da2672766038605987] </span>
<span id="cb20-23">\draw    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">304.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">101.75</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">205.82</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">146.92</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-24">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">204</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">147.75</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">335.41</span>] [color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>]    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) .. (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.31</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.93</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.29</span>)   <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-25"></span>
<span id="cb20-26"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-27">\draw (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">352</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">76.4</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $f$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-28"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-29">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">318.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">44.4</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [font<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\small,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\huge $\frac{\partial h}{\partial x}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-30"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-31">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">318.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">88.9</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [font<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\small,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\huge $\frac{\partial h}{\partial y}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-32"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-33">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">258.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.4</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $x$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-34"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-35">\draw (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">264</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">136.9</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $y$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-36"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-37">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">151.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">96.9</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [font<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\small,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\huge $\frac{\partial s}{\partial y} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\frac{\partial s}{\partial h} \cdot \frac{\partial h}{\partial y}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-39">\draw (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">33.4</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [font<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\small,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\huge $\frac{\partial s}{\partial x} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\frac{\partial s}{\partial h} \cdot \frac{\partial h}{\partial x}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-40"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-41">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">322.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.9</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $h<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>f(x,y)$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-42"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-43">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">449.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">39.9</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $h$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-44"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-45">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">451.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">112.9</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $\frac{\partial s}{\partial h}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-46"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-47">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">164.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">172.9</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $ \begin{array}{l}</span>
<span id="cb20-48">Downstream\ \<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-49">gradients</span>
<span id="cb20-50">\end{array}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-51"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-52">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">430.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">175.4</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $ \begin{array}{l}</span>
<span id="cb20-53">Upstream\ \<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-54">gradients</span>
<span id="cb20-55">\end{array}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-56"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb20-57">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">318.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">173.9</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\huge $ \begin{array}{l}</span>
<span id="cb20-58">Local\ \<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-59">gradients</span>
<span id="cb20-60">\end{array}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-61"></span>
<span id="cb20-62"></span>
<span id="cb20-63">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/backpropogation/index_files/figure-html/cell-14-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Let’s start with a simple forward pass with <img src="https://latex.codecogs.com/png.latex?1"> neuron. Let’s say, we have the following input vector, weights and bias:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># input values</span></span>
<span id="cb21-2">w <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># weights</span></span>
<span id="cb21-3">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb21-4"></span>
<span id="cb21-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb21-6">z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(x,w) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb21-7"></span>
<span id="cb21-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ReLU Activation function</span></span>
<span id="cb21-9">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(z, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb22-2">\begin{tikzpicture}</span>
<span id="cb22-3">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb22-4">{</span>
<span id="cb22-5">    \node[] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) {\large $x[\i]$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-6">}</span>
<span id="cb22-7">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb22-8">{</span>
<span id="cb22-9">    \node[] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $w[\i]$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-10">}</span>
<span id="cb22-11">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb22-12">{</span>
<span id="cb22-13">    \node[circle, </span>
<span id="cb22-14">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb22-15">        draw,</span>
<span id="cb22-16">        ] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {\large $\times$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-17">        </span>
<span id="cb22-18">}</span>
<span id="cb22-19"></span>
<span id="cb22-20">\node [] (bias) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) {\large $b$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-21"></span>
<span id="cb22-22">\node [circle,minimum size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,draw] (Add) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {\large <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-23">\node [circle,minimum size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,draw] (ReLU) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {\large $\<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-24">\node [] (NextLayer) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-25"></span>
<span id="cb22-26">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$} (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb22-27">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$} (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb22-28">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb22-29">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb22-30">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb22-31">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb22-32"></span>
<span id="cb22-33">\draw (bias) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$}(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-34">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-35"></span>
<span id="cb22-36">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb22-37">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb22-38">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb22-39"></span>
<span id="cb22-40">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Add) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(ReLU)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb22-41">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (ReLU) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(NextLayer)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-42">\node [red] (A) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-43">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/backpropogation/index_files/figure-html/cell-16-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The ReLU function <img src="https://latex.codecogs.com/png.latex?f(x)=%5Cmax(x,0)"> is differentiable everywhere except at <img src="https://latex.codecogs.com/png.latex?x%20=%200">. We define <img src="https://latex.codecogs.com/png.latex?f'(x)"> as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af'(x)%20=%0A%5Cbegin%7Bcases%7D%0A1%20&amp;%20x%20%3E%200%20%5C%5C%0A0%20&amp;%20%5Ctext%7Botherwise%7D%0A%5Cend%7Bcases%7D%0A%5Cend%7Balign*%7D"></p>
<p>In Python, we write:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">relu_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.</span>)</span></code></pre></div>
</div>
<p>The input to the ReLU function is <img src="https://latex.codecogs.com/png.latex?6.00">, so the derivative equals <img src="https://latex.codecogs.com/png.latex?1.00">. We multiply this local gradient by the upstream gradient to calculate the downstream gradient.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb24-2"></span>
<span id="cb24-3">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># input values</span></span>
<span id="cb24-4">w <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># weights</span></span>
<span id="cb24-5">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb24-6"></span>
<span id="cb24-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb24-8">z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(x, w) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b</span>
<span id="cb24-9"></span>
<span id="cb24-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ReLU Activation function</span></span>
<span id="cb24-11">y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(z, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb24-12"></span>
<span id="cb24-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward pass</span></span>
<span id="cb24-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Upstream gradient</span></span>
<span id="cb24-15">ds_drelu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb24-16"></span>
<span id="cb24-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Derivative of the ReLU and the chain rule</span></span>
<span id="cb24-18">drelu_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb24-19">ds_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_drelu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> drelu_dz</span>
<span id="cb24-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(ds_dz)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.0</code></pre>
</div>
</div>
<p>The results with the derivative of the ReLU function and chain rule look as follows:</p>
<div class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb26-2">\begin{tikzpicture}</span>
<span id="cb26-3">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb26-4">{</span>
<span id="cb26-5">    \node[] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) {\large $x[\i]$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-6">}</span>
<span id="cb26-7">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb26-8">{</span>
<span id="cb26-9">    \node[] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $w[\i]$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-10">}</span>
<span id="cb26-11">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb26-12">{</span>
<span id="cb26-13">    \node[circle, </span>
<span id="cb26-14">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb26-15">        draw,</span>
<span id="cb26-16">        ] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {\large $\times$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-17">        </span>
<span id="cb26-18">}</span>
<span id="cb26-19"></span>
<span id="cb26-20">\node [] (bias) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) {\large $b$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-21"></span>
<span id="cb26-22">\node [circle,minimum size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,draw] (Add) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {\large <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-23">\node [circle,minimum size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,draw] (ReLU) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {\large $\<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-24">\node [] (NextLayer) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-25"></span>
<span id="cb26-26">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$} (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb26-27">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$} (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb26-28">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb26-29">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb26-30">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb26-31">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb26-32"></span>
<span id="cb26-33">\draw (bias) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$}(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-34">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-35"></span>
<span id="cb26-36">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb26-37">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb26-38">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb26-39"></span>
<span id="cb26-40">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Add) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(ReLU)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb26-41">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (ReLU) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(NextLayer)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-42">\node [red] (A) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-43">\node [red] (B) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-44">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/backpropogation/index_files/figure-html/cell-19-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Moving backward through our neural network, consider the add function <img src="https://latex.codecogs.com/png.latex?f(x,y,z)=x%20+%20y%20+%20z">. The partial derivatives <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D">, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20y%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20z%7D"> are all equal to <img src="https://latex.codecogs.com/png.latex?1">. So, the <strong>add gate</strong> always takes on the gradient on its output and distributes it equally to all of its inputs, regardless of what their values were during the forward pass.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Local gradients for the + function</span></span>
<span id="cb27-2">dz_dw0x0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb27-3">dz_dw1x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb27-4">dz_dw2x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb27-5">dz_db <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb27-6"></span>
<span id="cb27-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the downstream gradients</span></span>
<span id="cb27-8">ds_dw0x0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dz_dw0x0</span>
<span id="cb27-9">ds_dw1x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dz_dw1x1</span>
<span id="cb27-10">ds_dw2x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dz_dw2x2</span>
<span id="cb27-11">ds_db <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dz_db</span>
<span id="cb27-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(ds_dw0x0, ds_dw1x1, ds_dw2x2, ds_db)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.0 1.0 1.0 1.0</code></pre>
</div>
</div>
<p>We can update the computation graph as:</p>
<div class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb29-2">\begin{tikzpicture}</span>
<span id="cb29-3">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb29-4">{</span>
<span id="cb29-5">    \node[] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) {\large $x[\i]$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-6">}</span>
<span id="cb29-7">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb29-8">{</span>
<span id="cb29-9">    \node[] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $w[\i]$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-10">}</span>
<span id="cb29-11">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb29-12">{</span>
<span id="cb29-13">    \node[circle, </span>
<span id="cb29-14">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb29-15">        draw,</span>
<span id="cb29-16">        ] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {\large $\times$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-17">        </span>
<span id="cb29-18">}</span>
<span id="cb29-19"></span>
<span id="cb29-20">\node [] (bias) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) {\large $b$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-21"></span>
<span id="cb29-22">\node [circle,minimum size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,draw] (Add) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {\large <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-23">\node [circle,minimum size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,draw] (ReLU) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {\large $\<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-24">\node [] (NextLayer) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-25"></span>
<span id="cb29-26">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$} (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb29-27">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$} (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb29-28">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb29-29">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb29-30">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb29-31">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb29-32"></span>
<span id="cb29-33">\draw (bias) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$}(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-34">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-35"></span>
<span id="cb29-36">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb29-37">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb29-38">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb29-39"></span>
<span id="cb29-40">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Add) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(ReLU)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb29-41">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (ReLU) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(NextLayer)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-42">\node [red] (A) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-43">\node [red] (B) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-44">\node [red] (C) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-45">\node [red] (D) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-46">\node [red] (E) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-47">\node [red] (f) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-48">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/backpropogation/index_files/figure-html/cell-21-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now, consider the production function <img src="https://latex.codecogs.com/png.latex?f(x,y)%20=%20x%20*%20y">. The gradients of <img src="https://latex.codecogs.com/png.latex?f"> are <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20x%7D%20=%20y">, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20f%7D%7B%5Cpartial%20y%7D%20=%20x">. The <strong>multiply gate</strong> is therefore a little less easy to interpret. Its local gradients are the input values, except switched and this is multiplied by the upstream gradient.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Local gradients for the * function</span></span>
<span id="cb30-2">dw0x0_dx0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> w[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb30-3">dw0x0_dw0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb30-4">dw1x1_dx1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> w[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb30-5">dw1x1_dw1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb30-6">dw2x2_dx2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> w[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb30-7">dw2x2_dw2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb30-8"></span>
<span id="cb30-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the downstream gradients</span></span>
<span id="cb30-10">ds_dx0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_dw0x0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dw0x0_dx0</span>
<span id="cb30-11">ds_dw0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_dw0x0 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dw0x0_dw0</span>
<span id="cb30-12">ds_dx1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_dw1x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dw1x1_dx1</span>
<span id="cb30-13">ds_dw1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_dw1x1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dw1x1_dw1</span>
<span id="cb30-14">ds_dx2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_dw2x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dw2x2_dx2</span>
<span id="cb30-15">ds_dw2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ds_dw2x2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dw2x2_dw2</span>
<span id="cb30-16"></span>
<span id="cb30-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(ds_dx0, ds_dw0, ds_dx1, ds_dw1, ds_dx2, ds_dw2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-3.0 1.0 -1.0 -2.0 2.0 3.0</code></pre>
</div>
</div>
<p>We can update the computation graph as follows:</p>
<div class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb32-2">\begin{tikzpicture}</span>
<span id="cb32-3">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb32-4">{</span>
<span id="cb32-5">    \node[] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) {\large $x[\i]$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-6">}</span>
<span id="cb32-7">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb32-8">{</span>
<span id="cb32-9">    \node[] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $w[\i]$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-10">}</span>
<span id="cb32-11">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb32-12">{</span>
<span id="cb32-13">    \node[circle, </span>
<span id="cb32-14">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb32-15">        draw,</span>
<span id="cb32-16">        ] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {\large $\times$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-17">        </span>
<span id="cb32-18">}</span>
<span id="cb32-19"></span>
<span id="cb32-20">\node [] (bias) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) {\large $b$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-21"></span>
<span id="cb32-22">\node [circle,minimum size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,draw] (Add) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {\large <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-23">\node [circle,minimum size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,draw] (ReLU) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {\large $\<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-24">\node [] (NextLayer) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-25"></span>
<span id="cb32-26">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$} (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb32-27">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$} (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb32-28">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb32-29">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb32-30">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb32-31">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb32-32"></span>
<span id="cb32-33">\draw (bias) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$}(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-34">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-35"></span>
<span id="cb32-36">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb32-37">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb32-38">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Mult<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(Add)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb32-39"></span>
<span id="cb32-40">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Add) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(ReLU)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb32-41">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (ReLU) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node[midway,above,blue] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>$}(NextLayer)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-42">\node [red] (A) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-43">\node [red] (B) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-44">\node [red] (C) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-45">\node [red] (D) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-46">\node [red] (E) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-47">\node [red] (F) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.5</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-48">\node [red] (G) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-49">\node [red] (H) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-50">\node [red] (I) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.75</span>) {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-51">\node [red] (J) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-52">\node [red] (K) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.75</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-53">\node [red] (L) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-54">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/backpropogation/index_files/figure-html/cell-23-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Gradients sum at outward branches. Consider the following computation graph:</p>
<div class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb33-2">\begin{tikzpicture}[x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>,y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>,yscale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,xscale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb33-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>uncomment <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> require: \path (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">211</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> diagram left start at <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> has height of <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">211</span></span>
<span id="cb33-4"></span>
<span id="cb33-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Shape: Ellipse [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:dp4612472925724298] </span>
<span id="cb33-6">\draw   (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">444.62</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">444.62</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">81.19</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">455.38</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">468.64</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">481.91</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">492.66</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">81.19</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">492.66</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">492.66</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">108.81</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">481.91</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">468.64</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">455.38</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">444.62</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">108.81</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">444.62</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Shape: Ellipse [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:dp4844626229099638] </span>
<span id="cb33-8">\draw   (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">299.33</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">31.5</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">299.33</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">17.69</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">310.08</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">323.35</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">336.61</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">347.37</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">17.69</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">347.37</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">31.5</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">347.37</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">45.31</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">336.61</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">56.5</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">323.35</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">56.5</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">310.08</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">56.5</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">299.33</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">45.31</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">299.33</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">31.5</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Shape: Ellipse [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:dp2271780920027553] </span>
<span id="cb33-10">\draw   (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">303.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">94.7</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">303.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">80.89</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">314</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69.7</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">327.27</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69.7</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">340.53</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69.7</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">351.29</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">80.89</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">351.29</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">94.7</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">351.29</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">108.51</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">340.53</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">119.7</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">327.27</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">119.7</span>) .. controls (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">314</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">119.7</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">303.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">108.51</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">303.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">94.7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-11"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Shape: Ellipse [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:dp150108609534231] </span>
<span id="cb33-12">\draw   (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">299.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">167.7</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">299.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">153.89</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">310</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">142.7</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">323.27</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">142.7</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">336.53</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">142.7</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">347.29</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">153.89</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">347.29</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">167.7</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">347.29</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">181.51</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">336.53</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">192.7</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">323.27</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">192.7</span>) .. controls (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">310</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">192.7</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">299.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">181.51</span>) .. (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">299.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">167.7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-13"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da7844123205705824] </span>
<span id="cb33-14">\draw    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">347.37</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">31.5</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">450.04</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">76.06</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-15">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">452.79</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">77.25</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">203.46</span>] [fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]  [draw opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-16"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da814168086414518] </span>
<span id="cb33-17">\draw    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">351.29</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">94.7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">441.62</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">94.99</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-18">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">444.62</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">180.18</span>] [fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]  [draw opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-19"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da7411937688169676] </span>
<span id="cb33-20">\draw    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">347.29</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">167.7</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">446.35</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">110.75</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-21">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">448.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">109.25</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">150.1</span>] [fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]  [draw opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-22"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Shape: Circle [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:dp515320046458885] </span>
<span id="cb33-23">\draw   (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">163</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>) .. controls (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">163</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">82.19</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">174.19</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">71</span>) .. (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">188</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">71</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">201.81</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">71</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">213</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">82.19</span>) .. (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">213</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>) .. controls (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">213</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">109.81</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">201.81</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">121</span>) .. (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">188</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">121</span>) .. controls (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">174.19</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">121</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">163</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">109.81</span>) .. (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">163</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-24"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da6219161786925074] </span>
<span id="cb33-25">\draw    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">492.66</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">567</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">94.52</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-26">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">570</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">94.5</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">179.63</span>] [fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]  [draw opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-27"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da5694521418691749] </span>
<span id="cb33-28">\draw    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">84.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">95.75</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">160</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">95.99</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-29">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">163</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">180.18</span>] [fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]  [draw opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.04</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.86</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.04</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.86</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.34</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-30"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da08990804845355682] </span>
<span id="cb33-31">\draw    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">210.69</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">85.5</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">296.86</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">31.4</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-32">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">299.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">29.8</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">147.88</span>] [fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]  [draw opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da1505672958459916] </span>
<span id="cb33-34">\draw    (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">212.61</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">300.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">95.03</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-35">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">303.4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">95</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">179.37</span>] [fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]  [draw opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-36"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>Straight Lines [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>:da23258128449735227] </span>
<span id="cb33-37">\draw    (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">203</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">116.5</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">296.36</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">167.17</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-38">\draw [shift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">299</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">168.6</span>)}, rotate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">208.49</span>] [fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> }  ][line width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]  [draw opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.25</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> cycle    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-39"></span>
<span id="cb33-40"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-41">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">464.08</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">84.4</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $s$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-42"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-43">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">317.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">18.9</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-44"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-45">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">321.65</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">82.6</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-46"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-47">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">317.65</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">155.6</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-48"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-49">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">365.04</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">44.2</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\huge $\frac{\partial s}{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>}}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-50"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-51">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">365.52</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">94.3</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\huge $\frac{\partial s}{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-52"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-53">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">366.72</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">154</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\huge $\frac{\partial s}{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-54"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-55">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">183.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">85.4</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]    {\huge $a$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-56"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-57">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">304.78</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">21.4</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [font<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\tiny,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\normalsize $\frac{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>}}{\partial a}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-58"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-59">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">305.82</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">84.6</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [font<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\tiny,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\normalsize $\frac{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}}{\partial a}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-60"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-61">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">303.26</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">156.6</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [font<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\tiny,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\normalsize $\frac{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}}{\partial a}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-62"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-63">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">251.38</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">53.4</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [font<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\tiny,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\normalsize $\frac{\partial s}{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>}} \cdot \frac{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>}}{\partial a}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-64"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-65">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">249.38</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">99.8</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [font<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\tiny,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\normalsize $\frac{\partial s}{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}} \cdot \frac{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}}{\partial a}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-66"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Text Node</span>
<span id="cb33-67">\draw (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">245.78</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">165.8</span>) node [anchor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>north west][inner sep<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>]  [font<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>\tiny,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{rgb, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>:red, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> green, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> blue, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span> }  ,opacity<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> ]  {\normalsize $\frac{\partial s}{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}} \cdot \frac{\partial z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}}{\partial a}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-68"></span>
<span id="cb33-69"></span>
<span id="cb33-70">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/backpropogation/index_files/figure-html/cell-24-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The upstream gradient for the node <img src="https://latex.codecogs.com/png.latex?a"> is <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bds%7D%7Bda%7D">. By the law of total derivatives:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7Bds%7D%7Bda%7D%20=%20%5Cfrac%7B%5Cpartial%20s%7D%7B%5Cpartial%20z%5E1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z%5E1%7D%7B%5Cpartial%20a%7D%20+%20%5Cfrac%7B%5Cpartial%20s%7D%7B%5Cpartial%20z%5E2%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z%5E2%7D%7B%5Cpartial%20a%7D%20+%20%5Cfrac%7B%5Cpartial%20s%7D%7B%5Cpartial%20z%5E3%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z%5E3%7D%7B%5Cpartial%20a%7D%0A%5Cend%7Balign*%7D"></p>
</section>
<section id="backprop-for-a-single-neuron---a-python-implementation" class="level2">
<h2 class="anchored" data-anchor-id="backprop-for-a-single-neuron---a-python-implementation">Backprop for a single neuron - a python implementation</h2>
<p>We can write a naive implementation for the backprop algorithm for a single neuron.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb34-2"></span>
<span id="cb34-3">weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>])</span>
<span id="cb34-4">bias <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb34-5">inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>])</span>
<span id="cb34-6">target_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb34-7">learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span></span>
<span id="cb34-8"></span>
<span id="cb34-9"></span>
<span id="cb34-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> relu(x):</span>
<span id="cb34-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.maximum(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb34-12"></span>
<span id="cb34-13"></span>
<span id="cb34-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> relu_derivative(x):</span>
<span id="cb34-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.where(x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>)</span>
<span id="cb34-16"></span>
<span id="cb34-17"></span>
<span id="cb34-18"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>):</span>
<span id="cb34-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb34-20">    z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(weights, inputs) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bias</span>
<span id="cb34-21">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> relu(z)</span>
<span id="cb34-22">    loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> target_output) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb34-23"></span>
<span id="cb34-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward pass</span></span>
<span id="cb34-25">    dloss_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> target_output)</span>
<span id="cb34-26">    dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dloss_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> relu_derivative(z)</span>
<span id="cb34-27">    dz_dx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weights</span>
<span id="cb34-28">    dz_dw <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inputs</span>
<span id="cb34-29">    dz_db <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb34-30">    dloss_dx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dz_dx</span>
<span id="cb34-31">    dloss_dw <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dz_dw</span>
<span id="cb34-32">    dloss_db <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dz_db</span>
<span id="cb34-33"></span>
<span id="cb34-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update the weights and bias</span></span>
<span id="cb34-35">    weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dloss_dw</span>
<span id="cb34-36">    bias <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dloss_db</span>
<span id="cb34-37"></span>
<span id="cb34-38">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print the loss for this iteration</span></span>
<span id="cb34-39">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb34-40">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Iteration </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb34-41"></span>
<span id="cb34-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Final weights : "</span>, weights)</span>
<span id="cb34-43"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Final bias : "</span>, bias)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration 10, loss: 20.80624545154949
Iteration 20, loss: 11.314318574097976
Iteration 30, loss: 6.152662434665503
Iteration 40, loss: 3.345783025909011
Iteration 50, loss: 1.8194178821496518
Iteration 60, loss: 0.9893891517327431
Iteration 70, loss: 0.5380242236653578
Iteration 80, loss: 0.29257452918677535
Iteration 90, loss: 0.1591003738562249
Iteration 100, loss: 0.08651788326054576
Iteration 110, loss: 0.04704793547908108
Iteration 120, loss: 0.025584401159906914
Iteration 130, loss: 0.013912652617925996
Iteration 140, loss: 0.007565621788733219
Iteration 150, loss: 0.004114142329436494
Iteration 160, loss: 0.00223724732474303
Iteration 170, loss: 0.0012166024389232565
Iteration 180, loss: 0.0006615815238773228
Iteration 190, loss: 0.0003597642900693548
Iteration 200, loss: 0.00019563778572677352
Final weights :  [-3.3990955  -0.20180899  0.80271349]
Final bias :  0.6009044964039992</code></pre>
</div>
</div>
</section>
<section id="backprop-for-a-layer-of-neurons" class="level2">
<h2 class="anchored" data-anchor-id="backprop-for-a-layer-of-neurons">Backprop for a layer of neurons</h2>
<p>We are now in a position to write a naive implementation of the backprop algorithm for a layer of neurons.</p>
<p>A neural network with a single hidden layer is shown below.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://quantdev.blog/posts/backpropogation/backprop.png" class="img-fluid figure-img"></p>
<figcaption>backprop</figcaption>
</figure>
</div>
<p>Let <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D"> be a loss function of a neural network to minimize. Let <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5Cmathbf%7BR%7D%5E%7Bd_0%7D"> be a single sample(input). Let <img src="https://latex.codecogs.com/png.latex?d_%7Bl%7D"> be number of neurons(inputs) in layer <img src="https://latex.codecogs.com/png.latex?l">. In our example, <img src="https://latex.codecogs.com/png.latex?x%20%5Cin%20%5Cmathbf%7BR%7D%5E4">.</p>
<p>Let’s derive expressions for all the derivatives we want to compute.</p>
<section id="gradient-of-the-loss-with-respect-to-haty" class="level3">
<h3 class="anchored" data-anchor-id="gradient-of-the-loss-with-respect-to-haty">Gradient of the loss with respect to <img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D"></h3>
<p>The gradient of the loss function <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D"> with respect to <img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D"> is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20%5Chat%7By%7D%7D%20&amp;=%202*(%5Chat%7By%7D%20-%20y)%0A%5Cend%7Balign*%7D"></p>
</section>
<section id="gradient-of-the-loss-with-respect-to-a" class="level3">
<h3 class="anchored" data-anchor-id="gradient-of-the-loss-with-respect-to-a">Gradient of the loss with respect to <img src="https://latex.codecogs.com/png.latex?a"></h3>
<p>The gradient of <img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D"> with respect to <img src="https://latex.codecogs.com/png.latex?a_1,%20a_2,%20a_3"> is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20a%7D%20&amp;=%20%5Cleft%5B%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20a_1%7D,%20%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20a_2%7D,%20%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20a_3%7D%5Cright%5D%20=%20%5B1,%201,%201%5D%0A%5Cend%7Balign*%7D"></p>
<p>So, by chain rule:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20a%7D%20&amp;=%20%5Cleft%5B%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20a_1%7D,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20a_2%7D,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20a_3%7D%5Cright%5D%20%5C%5C%0A&amp;=%5Cleft%5B%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20%5Chat%7By%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20a_1%7D,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20%5Chat%7By%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20a_2%7D,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20%5Chat%7By%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20a_3%7D%5Cright%5D%20%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20%5Chat%7By%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20a%7D%0A%5Cend%7Balign*%7D"></p>
<p>This vector has the shape <code>[1,layer_width]</code>. In this example, it’s dimensions are <code>(1,3)</code>.</p>
</section>
<section id="gradient-of-the-loss-with-respect-to-z" class="level3">
<h3 class="anchored" data-anchor-id="gradient-of-the-loss-with-respect-to-z">Gradient of the loss with respect to <img src="https://latex.codecogs.com/png.latex?z"></h3>
<p>In our example, <img src="https://latex.codecogs.com/png.latex?a_1%20=%20max(z_1,0)">, <img src="https://latex.codecogs.com/png.latex?a_2%20=%20max(z_2,0)"> and <img src="https://latex.codecogs.com/png.latex?a_3%20=%20max(z_3,0)">. Consequently, the derivative:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20a%7D%7B%5Cpartial%20z%7D%20&amp;=%20%5Cleft%5B%5Cfrac%7B%5Cpartial%20a_1%7D%7B%5Cpartial%20z_1%7D,%20%5Cfrac%7B%5Cpartial%20a_2%7D%7B%5Cpartial%20z_2%7D,%20%5Cfrac%7B%5Cpartial%20a_3%7D%7B%5Cpartial%20z_3%7D%5Cright%5D%5C%5C%0A&amp;=%20%5Cleft%5B1_%7B(z_1%20%3E%200)%7D,%201_%7B(z_2%20%3E%200)%7D,%201_%7B(z_3%20%3E%200)%7D%5Cright%5D%0A%5Cend%7Balign*%7D"></p>
<p>Again this vector has shape <code>[1,layer_width]</code>, which in our example equals <code>(1,3)</code>.</p>
<p>By the chain rule:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z%7D%20&amp;=%20%5Cleft%5B%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20a_1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20a_1%7D%7B%5Cpartial%20z_1%7D,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20a_2%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20a_2%7D%7B%5Cpartial%20z_2%7D,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20a_3%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20a_3%7D%7B%5Cpartial%20z_3%7D%5Cright%5D%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20a%7D%20%5Codot%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7Ba%7D%7D%7B%5Cpartial%20z%7D%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Codot"> denotes the element wise product of the two vectors. The gradient of the loss with respect to <img src="https://latex.codecogs.com/png.latex?z">, is also a vector of shape <code>[1,layer_width]</code>.</p>
</section>
<section id="gradient-of-the-loss-with-respect-to-weights-w" class="level3">
<h3 class="anchored" data-anchor-id="gradient-of-the-loss-with-respect-to-weights-w">Gradient of the loss with respect to weights <img src="https://latex.codecogs.com/png.latex?W"></h3>
<p>Since</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Az_1%20&amp;=%20w_%7B11%7Dx_1%20+%20w_%7B12%7Dx_2%20+%20w_%7B13%7Dx_3%20+%20w_%7B14%7Dx_4%20+%20b_1%20%5C%5C%0Az_2%20&amp;=%20w_%7B21%7Dx_1%20+%20w_%7B22%7Dx_2%20+%20w_%7B23%7Dx_3%20+%20w_%7B24%7Dx_4%20+%20b_2%20%5C%5C%0Az_3%20&amp;=%20w_%7B31%7Dx_1%20+%20w_%7B32%7Dx_2%20+%20w_%7B23%7Dx_3%20+%20w_%7B24%7Dx_4%20+%20b_3%0A%5Cend%7Balign*%7D"></p>
<p>it follows that: <img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20z_i%7D%7B%5Cpartial%20w_%7Bij%7D%7D%20=%20x_j%0A%5Cend%7Balign*%7D"></p>
<p>Now,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7Bij%7D%7D%20&amp;=%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_i%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_i%7D%7B%5Cpartial%20w_%7Bij%7D%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_i%7D%20%5Ccdot%20x_j%0A%5Cend%7Balign*%7D"></p>
<p>In other words:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B11%7D%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B12%7D%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B13%7D%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B14%7D%7D%0A%5Cend%7Bbmatrix%7D%0A&amp;=%20%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20w_%7B11%7D%7D%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20w_%7B12%7D%7D%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20w_%7B13%7D%7D%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20w_%7B14%7D%7D%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%20%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20x_1%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20x_2%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20x_3%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20x_4%0A%5Cend%7Bbmatrix%7D%0A%5Cend%7Balign*%7D"></p>
<p>Putting this together, we define the jacobian matrix <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20W%7D"> as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20W%7D&amp;=%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B11%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B21%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B31%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B41%7D%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B12%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B22%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B32%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B42%7D%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B13%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B23%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B33%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B43%7D%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B14%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B24%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B34%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B44%7D%7D%20%5C%5C%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%20%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20w_%7B11%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_2%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_2%7D%7B%5Cpartial%20w_%7B21%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_3%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_3%7D%7B%5Cpartial%20w_%7B31%7D%7D%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20w_%7B12%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_2%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_2%7D%7B%5Cpartial%20w_%7B22%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_3%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_3%7D%7B%5Cpartial%20w_%7B32%7D%7D%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20w_%7B13%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_2%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_2%7D%7B%5Cpartial%20w_%7B23%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_3%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_3%7D%7B%5Cpartial%20w_%7B33%7D%7D%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20w_%7B14%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_2%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_2%7D%7B%5Cpartial%20w_%7B24%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_3%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_3%7D%7B%5Cpartial%20w_%7B34%7D%7D%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%20%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20x_1%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_2%7D%20%5Ccdot%20x_1%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_3%7D%20%5Ccdot%20x_1%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20x_2%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_2%7D%20%5Ccdot%20x_2%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_3%7D%20%5Ccdot%20x_2%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20x_3%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_2%7D%20%5Ccdot%20x_3%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_3%7D%20%5Ccdot%20x_3%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20x_4%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_2%7D%20%5Ccdot%20x_4%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_3%7D%20%5Ccdot%20x_4%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%20%5Cbegin%7Bbmatrix%7D%0Ax_1%20%5C%5C%0Ax_2%20%5C%5C%0Ax_3%20%5C%5C%0Ax_4%0A%5Cend%7Bbmatrix%7D%20%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_2%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_3%7D%0A%5Cend%7Bbmatrix%7D%20%5C%5C%0A&amp;=%20X%5ET%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z%7D%0A%5Cend%7Balign*%7D"></p>
<p>The dimensions of <img src="https://latex.codecogs.com/png.latex?X%5ET"> and <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z%7D"> are <code>[input_size,1]</code> and <code>[1,layer_width]</code> respectively. Therefore, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20W%7D"> will be of dimensions <code>[input_size,layer_width]</code>. In our example this equals <code>(4,3)</code>.</p>
<p>The first column of <img src="https://latex.codecogs.com/png.latex?X%5ET%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z%7D"> gives the derivative with respect to the first neuron’s weights, the second column gives the derivative with respect to the second neuron’s weights and so forth.</p>
</section>
<section id="gradient-of-the-loss-with-respect-to-the-biases-b" class="level3">
<h3 class="anchored" data-anchor-id="gradient-of-the-loss-with-respect-to-the-biases-b">Gradient of the loss with respect to the biases <img src="https://latex.codecogs.com/png.latex?b"></h3>
<p>Since</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20z%7D%7B%5Cpartial%20b%7D%20&amp;=%20%5Cleft%5B%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20b_1%7D,%20%5Cfrac%7B%5Cpartial%20z_2%7D%7B%5Cpartial%20b_2%7D,%20%5Cfrac%7B%5Cpartial%20z_3%7D%7B%5Cpartial%20b_3%7D%5Cright%5D%5C%5C%0A&amp;=%20%5B1,1,1%5D%0A%5Cend%7Balign*%7D"></p>
<p>It follows that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20b%7D%20&amp;=%20%5Cleft%5B%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20b_1%7D,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20b_2%7D,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20b_3%7D%5Cright%5D%5C%5C%0A&amp;=%20%5Cleft%5B%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20b_1%7D,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20b_2%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_2%7D%7B%5Cpartial%20b_21%7D,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20b_3%7D%5Ccdot%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_3%7D%7B%5Cpartial%20b_3%7D%5Cright%5D%5C%5C%0A&amp;=%5Cleft%5B%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z_1%7D%20%5Ccdot%201,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20b_2%7D%20%5Ccdot%201,%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20b_3%7D%5Ccdot%20%5Ccdot%201%5Cright%5D%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z%7D%0A%5Cend%7Balign*%7D"></p>
</section>
<section id="naive-python-implementation" class="level3">
<h3 class="anchored" data-anchor-id="naive-python-implementation">Naive Python implementation</h3>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb36-2"></span>
<span id="cb36-3">inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>])</span>
<span id="cb36-4">weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>], [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>], [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>]])</span>
<span id="cb36-5"></span>
<span id="cb36-6">biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>])</span>
<span id="cb36-7"></span>
<span id="cb36-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Learning rate</span></span>
<span id="cb36-9">learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span></span>
<span id="cb36-10"></span>
<span id="cb36-11"></span>
<span id="cb36-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ReLU Activation function and its derivative</span></span>
<span id="cb36-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> relu(x):</span>
<span id="cb36-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.maximum(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb36-15"></span>
<span id="cb36-16"></span>
<span id="cb36-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> relu_derivative(z):</span>
<span id="cb36-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.where(z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>)</span>
<span id="cb36-19"></span>
<span id="cb36-20"></span>
<span id="cb36-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>):</span>
<span id="cb36-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb36-23">    z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(weights, inputs) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> biases</span>
<span id="cb36-24">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> relu(z)</span>
<span id="cb36-25">    y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(a)</span>
<span id="cb36-26">    y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb36-27">    loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_true) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb36-28"></span>
<span id="cb36-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward pass</span></span>
<span id="cb36-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of loss with respect to y_pred</span></span>
<span id="cb36-31">    dloss_dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_true)</span>
<span id="cb36-32"></span>
<span id="cb36-33">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of y_pred with respect to a</span></span>
<span id="cb36-34">    dy_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ones_like(a)</span>
<span id="cb36-35"></span>
<span id="cb36-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of the activation function with respect to z</span></span>
<span id="cb36-37">    da_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> relu_derivative(z)</span>
<span id="cb36-38"></span>
<span id="cb36-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of z with respect to the weights</span></span>
<span id="cb36-40">    dz_dw <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inputs</span>
<span id="cb36-41"></span>
<span id="cb36-42">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of z with respect to inputs</span></span>
<span id="cb36-43">    dz_dx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weights</span>
<span id="cb36-44"></span>
<span id="cb36-45">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of loss with respect to a</span></span>
<span id="cb36-46">    dloss_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dloss_dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dy_da</span>
<span id="cb36-47"></span>
<span id="cb36-48">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of loss with respect to z</span></span>
<span id="cb36-49">    dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dloss_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> da_dz</span>
<span id="cb36-50"></span>
<span id="cb36-51">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of loss with respect to the weights</span></span>
<span id="cb36-52">    dloss_dw <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.outer(dloss_dz, dz_dw)</span>
<span id="cb36-53"></span>
<span id="cb36-54">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of loss with respect to biases</span></span>
<span id="cb36-55">    dloss_db <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dloss_dz</span>
<span id="cb36-56"></span>
<span id="cb36-57">    weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dloss_dw</span>
<span id="cb36-58">    biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> learning_rate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dloss_db</span>
<span id="cb36-59"></span>
<span id="cb36-60">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb36-61">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Iteration </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">iter</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, loss = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb36-62"></span>
<span id="cb36-63"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Final weights : "</span>, weights)</span>
<span id="cb36-64"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Final bias : "</span>, biases)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration 20, loss = 6.057433318678514
Iteration 40, loss = 0.4681684867419663
Iteration 60, loss = 0.03618392815029436
Iteration 80, loss = 0.0027965928794077364
Iteration 100, loss = 0.00021614380010564146
Iteration 120, loss = 1.670537841532316e-05
Iteration 140, loss = 1.2911296454618448e-06
Iteration 160, loss = 9.978916489916474e-08
Iteration 180, loss = 7.712531012091791e-09
Iteration 200, loss = 5.96088109107831e-10
Final weights :  [[-0.00698895 -0.01397789 -0.02096684 -0.02795579]
 [ 0.25975286  0.11950572 -0.02074143 -0.16098857]
 [ 0.53548461  0.27096922  0.00645383 -0.25806156]]
Final bias :  [-0.00698895 -0.04024714 -0.06451539]</code></pre>
</div>
</div>
</section>
</section>
<section id="backprop-with-a-batch-of-inputs" class="level2">
<h2 class="anchored" data-anchor-id="backprop-with-a-batch-of-inputs">Backprop with a batch of inputs</h2>
<p>Let <img src="https://latex.codecogs.com/png.latex?x"> be a batch of inputs of dimensions <code>[batch_size,input_size]</code>. Consider</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb38-2">    [</span>
<span id="cb38-3">        [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>],</span>
<span id="cb38-4">        [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb38-5">        [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>]</span>
<span id="cb38-6">    ]</span>
<span id="cb38-7">)</span></code></pre></div>
</div>
<p>of shape <code>(3,4)</code>. Each sample will give one loss. Hence, the total loss <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BL%7D%20=%20L_1%20+%20L_2%20+%20L_3">.</p>
<section id="gradient-of-the-loss-with-respect-to-weights-w-1" class="level3">
<h3 class="anchored" data-anchor-id="gradient-of-the-loss-with-respect-to-weights-w-1">Gradient of the loss with respect to weights <img src="https://latex.codecogs.com/png.latex?w"></h3>
<p>I am going to denote use the following convention for the <img src="https://latex.codecogs.com/png.latex?z">’s:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cbegin%7Barray%7D%5Bc%7Cccc%5D%0A%5Ctext%7B%7D%20&amp;%20%5Ctext%7BNeuron%7D-1%20&amp;%20%5Ctext%7BNeuron%7D-2%20&amp;%20%5Ctext%7BNeuron%7D-3%5C%5C%0A%5Chline%0A%5Ctext%7BSample%7D-1%20&amp;%20z_%7B11%7D%20&amp;%20z_%7B12%7D%20&amp;%20z_%7B13%7D%20%5C%5C%0A%5Ctext%7BSample%7D-2%20&amp;%20z_%7B21%7D%20&amp;%20z_%7B22%7D%20&amp;%20z_%7B23%7D%20%5C%5C%0A%5Ctext%7BSample%7D-3%20&amp;%20z_%7B31%7D%20&amp;%20z_%7B32%7D%20&amp;%20z_%7B33%7D%20%5C%5C%0A%5Ctext%7BSample%7D-4%20&amp;%20z_%7B41%7D%20&amp;%20z_%7B42%7D%20&amp;%20z_%7B43%7D%0A%5Cend%7Barray%7D%0A%5Cend%7Balign*%7D"></p>
<p>In this case <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bd%5Cmathcal%7BL%7D%7D%7Bdz%7D"> will be a matrix of partial derivatives of shape <code>[batch_size,layer_width]</code>.</p>
<p>I can write:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20w_%7B11%7D%7D%20&amp;=%20%5Cfrac%7B%5Cpartial%20L_1%7D%7B%5Cpartial%20w_%7B11%7D%7D%20+%20%5Cfrac%7B%5Cpartial%20L_2%7D%7B%5Cpartial%20w_%7B11%7D%7D%20+%20%5Cfrac%7B%5Cpartial%20L_3%7D%7B%5Cpartial%20w_%7B11%7D%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cpartial%20L_1%7D%7B%5Cpartial%20z_%7B11%7D%7D%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_%7B11%7D%7D%7B%5Cpartial%20w_%7B11%7D%7D%20+%20%5Cfrac%7B%5Cpartial%20L_2%7D%7B%5Cpartial%20z_%7B21%7D%7D%5Ccdot%5Cfrac%7B%5Cpartial%20z_%7B21%7D%7D%7B%5Cpartial%20w_%7B11%7D%7D%20+%20%5Cfrac%7B%5Cpartial%20L_3%7D%7B%5Cpartial%20z_%7B31%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_%7B31%7D%7D%7B%5Cpartial%20w_%7B11%7D%7D%5C%5C%0A&amp;=%5Cfrac%7B%5Cpartial%20L_1%7D%7B%5Cpartial%20z_%7B11%7D%7D%5Ccdot%20x_%7B11%7D%20+%20%5Cfrac%7B%5Cpartial%20L_2%7D%7B%5Cpartial%20z_%7B21%7D%7D%5Ccdot%20x_%7B21%7D%20+%20%5Cfrac%7B%5Cpartial%20L_3%7D%7B%5Cpartial%20z_%7B31%7D%7D%20%5Ccdot%20x_%7B31%7D%0A%5Cend%7Balign*%7D"></p>
<p>If you work out the derivatives of the loss function with respect to each of the weights, you would find:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20W%7D%20&amp;=%20X%5ET%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z%7D%0A%5Cend%7Balign*%7D"></p>
<p><code>X.T</code> has shape <code>[input_size,batch_size]</code> and <code>dloss_dz</code> has shape <code>[batch_size,layer_width]</code>, so the matrix product will have dimensions <code>[input_size,layer_width]</code>.</p>
</section>
<section id="gradient-of-the-loss-with-respect-to-the-biases-b-1" class="level3">
<h3 class="anchored" data-anchor-id="gradient-of-the-loss-with-respect-to-the-biases-b-1">Gradient of the loss with respect to the biases <img src="https://latex.codecogs.com/png.latex?b"></h3>
<p>Consider again:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20b_1%7D%20&amp;=%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7B11%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_%7B11%7D%7D%7B%5Cpartial%20b_1%7D%20+%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7B21%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_%7B21%7D%7D%7B%5Cpartial%20b_1%7D%20+%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7B31%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_%7B31%7D%7D%7B%5Cpartial%20b_1%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7B11%7D%7D%20%5Ccdot%201%20+%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7B21%7D%7D%20%5Ccdot%201%20+%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7B31%7D%7D%20%5Ccdot%201%0A%5Cend%7Balign*%7D"></p>
<p>So, to find the partial derivative of the loss with respect to <img src="https://latex.codecogs.com/png.latex?b_1">, we will just look at the partial derivatives of the loss with respect to the first neuron and then add them up.</p>
<p>In python, we would write this as</p>
<div class="sourceCode" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">dloss_dbiases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(dloss_dz, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, keepdims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</section>
<section id="gradient-of-the-loss-with-respect-to-the-inputs" class="level3">
<h3 class="anchored" data-anchor-id="gradient-of-the-loss-with-respect-to-the-inputs">Gradient of the loss with respect to the inputs</h3>
<p>The gradients of the loss with respect to the weights in the layer <img src="https://latex.codecogs.com/png.latex?l">, require the gradients of the loss with respect to the inputs in layer <img src="https://latex.codecogs.com/png.latex?l+1">. It’s easy to see that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20w_%7B11%7D%5E%7B(l)%7D%7D%20&amp;=%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20x_1%5E%7B(l+1)%7D%7D%5Ccdot%20%5Cfrac%7B%5Cpartial%20x_1%5E%7B(l+1)%7D%7D%7B%5Cpartial%20z_%7B1%7D%5E%7Bl%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%5E%7B(l)%7D%7D%7B%5Cpartial%20w_%7B11%7D%5E%7B(l)%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>What is <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20x_1%7D">, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20x_2%7D">, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20x_3%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20x_4%7D">?</p>
<p>By the chain rule:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20x_1%7D%20&amp;=%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_1%7D%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_1%7D%7B%5Cpartial%20x_1%7D%20+%20%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_2%7D%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_2%7D%7B%5Cpartial%20x_1%7D%20+%20%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_3%7D%5Ccdot%20%5Cfrac%7B%5Cpartial%20z_3%7D%7B%5Cpartial%20x_1%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_1%7D%5Ccdot%20w_%7B11%7D%20+%20%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_2%7D%5Ccdot%20w_%7B21%7D%20+%20%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_3%7D%5Ccdot%20w_%7B31%7D%0A%5Cend%7Balign*%7D"></p>
<p>Consequently,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20x_1%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20x_2%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20x_3%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20x_4%7D%0A%5Cend%7Bbmatrix%7D%20&amp;=%0A%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_1%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_2%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_3%7D%0A%5Cend%7Bbmatrix%7D%0A%5Cbegin%7Bbmatrix%7D%0Aw_%7B11%7D%20&amp;%20w_%7B12%7D%20&amp;%20w_%7B13%7D%20&amp;%20w_%7B14%7D%5C%5C%0Aw_%7B21%7D%20&amp;%20w_%7B22%7D%20&amp;%20w_%7B23%7D%20&amp;%20w_%7B24%7D%5C%5C%0Aw_%7B31%7D%20&amp;%20w_%7B32%7D%20&amp;%20w_%7B33%7D%20&amp;%20w_%7B34%7D%0A%5Cend%7Bbmatrix%7D%5C%5C%0A%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20x%7D%20&amp;=%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z%7D%20%5Ccdot%20W%0A%5Cend%7Balign*%7D"></p>
<p>What if we have a batch of input data of 3 examples? In such case, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20%5Cmathcal%7BL%7D%7D%7B%5Cpartial%20z%7D"> will have shape <code>(3,3)</code> and <img src="https://latex.codecogs.com/png.latex?W"> will have shape <code>(3,4)</code>. So, we can multiply them and the result would be <code>(3,4)</code>.</p>
</section>
</section>
<section id="adding-backward-to-denselayer" class="level2">
<h2 class="anchored" data-anchor-id="adding-backward-to-denselayer">Adding <code>backward()</code> to <code>DenseLayer</code></h2>
<p>We will now add backward pass code to the <code>DenseLayer</code> and <code>ReLUActivation</code> classes.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> nnfs.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> spiral_data</span>
<span id="cb40-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb40-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb40-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nnfs</span>
<span id="cb40-5"></span>
<span id="cb40-6">nnfs.init()</span>
<span id="cb40-7"></span>
<span id="cb40-8"></span>
<span id="cb40-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> DenseLayer:</span>
<span id="cb40-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, n_inputs, n_neurons):</span>
<span id="cb40-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> n_neurons</span>
<span id="cb40-12">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Weight vectors per neuron</span></span>
<span id="cb40-13">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(</span>
<span id="cb40-14">            [[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>], [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>], [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>]]</span>
<span id="cb40-15">        )</span>
<span id="cb40-16">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>])</span>
<span id="cb40-17"></span>
<span id="cb40-18">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, inputs):</span>
<span id="cb40-19">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inputs</span>
<span id="cb40-20">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(inputs, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.weights.T) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.biases</span>
<span id="cb40-21"></span>
<span id="cb40-22">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> backward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, dloss_dz):</span>
<span id="cb40-23">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dloss_dz</span>
<span id="cb40-24">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dz_dweights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inputs</span>
<span id="cb40-25">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dz_dbiases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ones_like(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inputs)</span>
<span id="cb40-26">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dz_dinputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.weights</span>
<span id="cb40-27">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dweights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inputs.T, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dz).T</span>
<span id="cb40-28">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dbiases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dz, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, keepdims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb40-29">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dinputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dz, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dz_dinputs)</span>
<span id="cb40-30"></span>
<span id="cb40-31"></span>
<span id="cb40-32"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> ReLUActivation:</span>
<span id="cb40-33"></span>
<span id="cb40-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb40-35">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, inputs):</span>
<span id="cb40-36">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate output values from the inputs</span></span>
<span id="cb40-37">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inputs</span>
<span id="cb40-38">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.maximum(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, inputs)</span>
<span id="cb40-39"></span>
<span id="cb40-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward pass</span></span>
<span id="cb40-41">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> backward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, dloss_da):</span>
<span id="cb40-42">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dloss_da</span>
<span id="cb40-43">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.da_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.where(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>)</span>
<span id="cb40-44">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.da_dz</span>
<span id="cb40-45"></span>
<span id="cb40-46"></span>
<span id="cb40-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create dataset</span></span>
<span id="cb40-48">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>], [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>]])</span>
<span id="cb40-49"></span>
<span id="cb40-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a dense layer with 4 input features and 3 output values</span></span>
<span id="cb40-51">dense1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb40-52">relu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ReLUActivation()</span>
<span id="cb40-53"></span>
<span id="cb40-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass of our training data through this layer</span></span>
<span id="cb40-55">dense1.forward(X)</span>
<span id="cb40-56">relu.forward(dense1.output)</span>
<span id="cb40-57"></span>
<span id="cb40-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate loss</span></span>
<span id="cb40-59">y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(relu.output)</span>
<span id="cb40-60">y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb40-61">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_true) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb40-62"></span>
<span id="cb40-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gradient of the loss with respect to y</span></span>
<span id="cb40-64">dloss_dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_true)</span>
<span id="cb40-65">dy_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ones_like(relu.output)</span>
<span id="cb40-66">dloss_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dloss_dy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dy_da</span>
<span id="cb40-67"></span>
<span id="cb40-68">relu.backward(dloss_da)</span>
<span id="cb40-69">dense1.backward(relu.dloss_dz)</span>
<span id="cb40-70"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"dloss_dweights = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dense1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dloss_dweights<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb40-71"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"dloss_dbiases = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dense1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dloss_dbiases<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb40-72"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"dloss_dinputs = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dense1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dloss_dinputs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>dloss_dweights = [[124.560005 805.48804  440.112    307.24802 ]
 [124.560005 805.48804  440.112    307.24802 ]
 [124.560005 805.48804  440.112    307.24802 ]]
dloss_dbiases = [[249.12000303 249.12000303 249.12000303]]
dloss_dinputs = [[124.560005 149.472    174.384    199.296   ]
 [124.560005 149.472    174.384    199.296   ]
 [124.560005 149.472    174.384    199.296   ]]</code></pre>
</div>
</div>
</section>
<section id="categorical-cross-entropy-loss-derivative" class="level2">
<h2 class="anchored" data-anchor-id="categorical-cross-entropy-loss-derivative">Categorical cross-entropy loss derivative</h2>
<p>The cross-entropy loss of the <img src="https://latex.codecogs.com/png.latex?i">-th sample is given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AL_i%20=%20-%5Csum_k%20y_%7Bik%7Dlog(%5Chat%7By%7D_ik)%0A%5Cend%7Balign*%7D"></p>
<p>Differentiating with respect to <img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D_%7Bij%7D">, we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20L_i%7D%7B%5Cpartial%20%5Chat%7By%7D_%7Bij%7D%7D%20&amp;=%20-%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20%5Chat%7By%7D_%7Bik%7D%7D%20%5Cleft%5B%5Csum_k%20y_%7Bik%7D%5Clog%20(%5Chat%7By%7D_%7Bik%7D)%5Cright%5D%20%5C%5C%0A&amp;=%20-y_%7Bij%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20%7D%7B%5Cpartial%20%5Chat%7By%7D_%7Bij%7D%7D%20%5Clog%20(%5Chat%7By%7D_%7Bij%7D)%5C%5C%0A&amp;=%20-%5Cfrac%7By_%7Bij%7D%7D%7B%5Chat%7By%7D_%7Bij%7D%7D%0A%5Cend%7Balign*%7D"></p>
<section id="adding-backward-to-categoricalcrossentropyloss" class="level3">
<h3 class="anchored" data-anchor-id="adding-backward-to-categoricalcrossentropyloss">Adding <code>backward()</code> to <code>CategoricalCrossEntropyLoss</code></h3>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cross-Entropy loss</span></span>
<span id="cb42-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> CategoricalCrossEntropyLoss(Loss):</span>
<span id="cb42-3"></span>
<span id="cb42-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb42-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, y_pred, y_true):</span>
<span id="cb42-6">        num_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred)</span>
<span id="cb42-7"></span>
<span id="cb42-8">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clip data to prevent division by 0</span></span>
<span id="cb42-9">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clip both sides to not drag mean towards any value</span></span>
<span id="cb42-10">        epsilon <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span></span>
<span id="cb42-11">        y_pred_clipped <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.clip(y_pred, epsilon, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> epsilon)</span>
<span id="cb42-12"></span>
<span id="cb42-13">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If categorical labels</span></span>
<span id="cb42-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_true.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb42-15">            correct_confidences <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y_pred_clipped[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred)), y_true]</span>
<span id="cb42-16">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># else if one-hot encoding</span></span>
<span id="cb42-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_true.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:</span>
<span id="cb42-18">            correct_confidences <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(y_pred_clipped <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_true, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb42-19"></span>
<span id="cb42-20">        neg_log <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.log(correct_confidences)</span>
<span id="cb42-21">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> neg_log</span>
<span id="cb42-22"></span>
<span id="cb42-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward pass</span></span>
<span id="cb42-24">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> backward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, y_pred, y_true):</span>
<span id="cb42-25"></span>
<span id="cb42-26">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of samples</span></span>
<span id="cb42-27">        batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred)</span>
<span id="cb42-28"></span>
<span id="cb42-29">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of labels</span></span>
<span id="cb42-30">        num_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb42-31"></span>
<span id="cb42-32">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If labels are sparse, turn them into a one-hot vector</span></span>
<span id="cb42-33">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_true.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb42-34">            y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.eye(num_labels)[y_true]</span>
<span id="cb42-35"></span>
<span id="cb42-36">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate gradient</span></span>
<span id="cb42-37">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> y_pred</span>
<span id="cb42-38"></span>
<span id="cb42-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Normalize the gradient</span></span>
<span id="cb42-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_da <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> batch_size</span></code></pre></div>
</div>
</section>
</section>
<section id="softmax-activation-function-derivative" class="level2">
<h2 class="anchored" data-anchor-id="softmax-activation-function-derivative">Softmax Activation function derivative</h2>
<p>We are interested to calculate the derivative of the softmax function. The softmax activation function is defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AS_%7Bi,j%7D%20&amp;=%20%5Cfrac%7Be%5E%7Bz_%7Bi,j%7D%7D%7D%7B%5Csum_%7Bl=1%7D%5E%7Bd_l%7D%20e%5E%7Bz_%7Bi,l%7D%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?S_%7Bi,j%7D"> denotes the output of the <img src="https://latex.codecogs.com/png.latex?j">-th neuron for the <img src="https://latex.codecogs.com/png.latex?i">-th sample. Thus, <img src="https://latex.codecogs.com/png.latex?S_%7Bi,j%7D%20=%20f(z_%7Bi,1%7D,%5Cldots,z_%7Bi,d_l%7D)">. Let’s calculate the partial derivative of <img src="https://latex.codecogs.com/png.latex?S_%7Bi,j%7D"> with respect to <img src="https://latex.codecogs.com/png.latex?z_%7Bi,k%7D">.</p>
<p>By the <img src="https://latex.codecogs.com/png.latex?u/v"> rule:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20S_%7Bi,j%7D%7D%7B%5Cpartial%20z_%7Bi,k%7D%7D%20&amp;=%20%5Cfrac%7B%5Csum_%7Bl=1%7D%5E%7Bd_l%7D%20e%5E%7Bz_%7Bi,l%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20e%5E%7Bz_%7Bi,j%7D%7D%7D%7B%5Cpartial%20z_%7Bi,k%7D%7D-e%5E%7Bz_%7Bi,j%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20z_%7Bi,k%7D%7D%20%5Csum_%7Bl=1%7D%5E%7Bd_l%7D%20e%5E%7Bz_%7Bi,l%7D%7D%7D%7B%5Cleft(%5Csum_%7Bl=1%7D%5E%7Bd_l%7D%20e%5E%7Bz_%7Bi,l%7D%7D%5Cright)%5E2%7D%0A%5Cend%7Balign*%7D"></p>
<p>We have two cases. If <img src="https://latex.codecogs.com/png.latex?j=k">, then <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20e%5E%7Bz_%7Bi,j%7D%7D%7D%7B%5Cpartial%20z_%7Bi,k%7D%7D%20=%20e%5E%7Bz_%7Bi,k%7D%7D"> and we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20S_%7Bi,j%7D%7D%7B%5Cpartial%20z_%7Bi,k%7D%7D%20&amp;=%20%5Cfrac%7Be%5E%7Bz_%7Bi,k%7D%7D%20%5Ccdot%20%5Csum_%7Bl=1%7D%5E%7Bd_l%7D%20e%5E%7Bz_%7Bi,l%7D%7D%20-e%5E%7Bz_%7Bi,k%7D%7D%20%5Ccdot%20e%5E%7Bz_%7Bi,k%7D%7D%7D%7B%5Cleft(%5Csum_%7Bl=1%7D%5E%7Bd_l%7D%20e%5E%7Bz_%7Bi,l%7D%7D%5Cright)%5E2%7D%5C%5C%0A&amp;=%5Cfrac%7Be%5E%7Bz_%7Bi,k%7D%7D%7D%7B%5Csum_%7Bl=1%7D%5E%7Bd_l%7D%20e%5E%7Bz_%7Bi,l%7D%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Csum_%7Bl=1%7D%5E%7Bd_l%7D%20e%5E%7Bz_%7Bi,l%7D%7D%20-e%5E%7Bz_%7Bi,k%7D%7D%7D%7B%5Csum_%7Bl=1%7D%5E%7Bd_l%7D%20e%5E%7Bz_%7Bi,l%7D%7D%7D%5C%5C%0A&amp;=S_%7Bi,k%7D(1-S_%7Bi,k%7D)%0A%5Cend%7Balign*%7D"></p>
<p>In the case where <img src="https://latex.codecogs.com/png.latex?j%20%5Cneq%20k">, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20e%5E%7Bz_%7Bi,j%7D%7D%7D%7B%5Cpartial%20z_%7Bi,k%7D%7D%20=%200"> and we have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20S_%7Bi,j%7D%7D%7B%5Cpartial%20z_%7Bi,k%7D%7D%20&amp;=%20-%5Cfrac%7Be%5E%7Bz_%7Bi,j%7D%7D%7D%7B%5Csum_%7Bl=1%7D%5E%7Bd_l%7De%5E%7Bz_%7Bi,l%7D%7D%7D%5Ccdot%20%5Cfrac%7Be%5E%7Bz_%7Bi,k%7D%7D%7D%7B%5Csum_%7Bl=1%7D%5E%7Bd_l%7De%5E%7Bz_%7Bi,l%7D%7D%7D%5C%5C%0A&amp;=-S_%7Bi,j%7D%20S_%7Bi,k%7D%0A%5Cend%7Balign*%7D"></p>
<p>So, the derivative of the softmax activation function can be expressed in terms of Kronecker’s delta as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20S_%7Bi,j%7D%7D%7B%5Cpartial%20z_%7Bi,k%7D%7D%20&amp;=%20S_%7Bi,j%7D(%5Cdelta_%7Bj,k%7D%20-%20%20S_%7Bi,k%7D)%5C%5C%0A&amp;=%20S_%7Bi,j%7D%20%5Cdelta_%7Bj,k%7D%20-%20S_%7Bi,j%7DS_%7Bi,k%7D%0A%5Cend%7Balign*%7D"></p>
<p>Now, like before, let’s say we have neural network with a single hidden layer with <img src="https://latex.codecogs.com/png.latex?d_1%20=%203"> neurons. We apply the softmax activation function to the output of this layer. The jacobian matrix <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20S_i%7D%7B%5Cpartial%20z_i%7D"> for the <img src="https://latex.codecogs.com/png.latex?i">-th sample can be expressed as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20S_i%7D%7B%5Cpartial%20z_i%7D%20&amp;=%0A%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20S_%7Bi1%7D%7D%7B%5Cpartial%20z_%7Bi1%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi1%7D%7D%7B%5Cpartial%20z_%7Bi2%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi1%7D%7D%7B%5Cpartial%20z_%7Bi3%7D%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20S_%7Bi2%7D%7D%7B%5Cpartial%20z_%7Bi1%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi2%7D%7D%7B%5Cpartial%20z_%7Bi2%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi2%7D%7D%7B%5Cpartial%20z_%7Bi3%7D%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20S_%7Bi3%7D%7D%7B%5Cpartial%20z_%7Bi1%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi3%7D%7D%7B%5Cpartial%20z_%7Bi2%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi3%7D%7D%7B%5Cpartial%20z_%7Bi3%7D%7D%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%5Cbegin%7Bbmatrix%7D%0AS_%7Bi1%7D(%5Cdelta_%7B11%7D%20-%20S_%7Bi1%7D)%20&amp;%20S_%7Bi1%7D(%5Cdelta_%7B12%7D%20-%20S_%7Bi2%7D)%20&amp;%20S_%7Bi1%7D(%5Cdelta_%7B13%7D%20-%20S_%7Bi3%7D)%20%5C%5C%0AS_%7Bi2%7D(%5Cdelta_%7B21%7D%20-%20S_%7Bi1%7D)%20&amp;%20S_%7Bi2%7D(%5Cdelta_%7B22%7D%20-%20S_%7Bi2%7D)%20&amp;%20S_%7Bi2%7D(%5Cdelta_%7B23%7D%20-%20S_%7Bi3%7D)%20%5C%5C%0AS_%7Bi3%7D(%5Cdelta_%7B31%7D%20-%20S_%7Bi1%7D)%20&amp;%20S_%7Bi3%7D(%5Cdelta_%7B32%7D%20-%20S_%7Bi2%7D)%20&amp;%20S_%7Bi3%7D(%5Cdelta_%7B33%7D%20-%20S_%7Bi3%7D)%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%5Cbegin%7Bbmatrix%7D%0AS_%7Bi1%7D(1%20-%20S_%7Bi1%7D)%20&amp;%20S_%7Bi1%7D(0%20-%20S_%7Bi2%7D)%20&amp;%20S_%7Bi1%7D(0%20-%20S_%7Bi3%7D)%20%5C%5C%0AS_%7Bi2%7D(0%20-%20S_%7Bi1%7D)%20&amp;%20S_%7Bi2%7D(1%20-%20S_%7Bi2%7D)%20&amp;%20S_%7Bi2%7D(0%20-%20S_%7Bi3%7D)%20%5C%5C%0AS_%7Bi3%7D(0%20-%20S_%7Bi1%7D)%20&amp;%20S_%7Bi3%7D(0%20-%20S_%7Bi2%7D)%20&amp;%20S_%7Bi3%7D(1%20-%20S_%7Bi3%7D)%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%5Cbegin%7Bbmatrix%7D%0AS_%7Bi1%7D%5C%5C%0AS_%7Bi2%7D%5C%5C%0AS_%7Bi3%7D%0A%5Cend%7Bbmatrix%7D%5Codot%0A%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20&amp;%200%20%5C%5C%0A0%20&amp;%201%20&amp;%200%20%5C%5C%0A0%20&amp;%200%20&amp;%201%0A%5Cend%7Bbmatrix%7D%20-%0A%5Cbegin%7Bbmatrix%7D%0AS_%7Bi1%7D%5C%5C%0AS_%7Bi2%7D%5C%5C%0AS_%7Bi3%7D%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%0AS_%7Bi1%7D%20&amp;%20S_%7Bi2%7D%20&amp;%20S_%7Bi3%7D%0A%5Cend%7Bbmatrix%7D%0A%5Cend%7Balign*%7D"></p>
<p>Say the <code>softmax_output=[0.70, 0.10, 0.20]</code>. Then, in python, we can find the Jacobian matrix as:</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb43-2"></span>
<span id="cb43-3">softmax_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.10</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.20</span>])</span>
<span id="cb43-4"></span>
<span id="cb43-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape as a column vector</span></span>
<span id="cb43-6">softmax_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax_output.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb43-7"></span>
<span id="cb43-8">da_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.diagflat(softmax_output) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.dot(softmax_output, softmax_output.T)</span>
<span id="cb43-9"></span>
<span id="cb43-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"softmax_output = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>softmax_output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb43-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"da_dz = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>da_dz<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>softmax_output = [[0.7]
 [0.1]
 [0.2]]
da_dz = [[ 0.20999999 -0.07       -0.14      ]
 [-0.07        0.09       -0.02      ]
 [-0.14       -0.02        0.16      ]]</code></pre>
</div>
</div>
<p>What happens when we have a batch of inputs? By the chain rule:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7B11%7D%7D%20&amp;=%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_%7B11%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20S_%7B11%7D%7D%7B%5Cpartial%20z_%7B11%7D%7D%20+%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_%7B12%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20S_%7B12%7D%7D%7B%5Cpartial%20z_%7B11%7D%7D%20+%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_%7B13%7D%7D%5Ccdot%20%5Cfrac%7B%5Cpartial%20S_%7B13%7D%7D%7B%5Cpartial%20z_%7B11%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>In general,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7Bij%7D%7D%20&amp;=%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_%7Bi1%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20S_%7Bi1%7D%7D%7B%5Cpartial%20z_%7Bij%7D%7D%20+%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_%7Bi2%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20S_%7Bi2%7D%7D%7B%5Cpartial%20z_%7Bij%7D%7D%20+%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_%7Bi3%7D%7D%5Ccdot%20%5Cfrac%7B%5Cpartial%20S_%7Bi3%7D%7D%7B%5Cpartial%20z_%7Bij%7D%7D%5C%5C%0A&amp;=%5Csum_%7Bk=1%7D%5E%7B3%7D%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_%7Bik%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20S_%7Bik%7D%7D%7B%5Cpartial%20z_%7Bij%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>It follows that:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_i%7D%20&amp;=%20%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7Bi1%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7Bi2%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20z_%7Bi3%7D%7D%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_%7Bi1%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_%7Bi2%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_%7Bi3%7D%7D%0A%5Cend%7Bbmatrix%7D%20%5Cbegin%7Bbmatrix%7D%0A%5Cfrac%7B%5Cpartial%20S_%7Bi1%7D%7D%7B%5Cpartial%20z_%7Bi1%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi1%7D%7D%7B%5Cpartial%20z_%7Bi2%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi1%7D%7D%7B%5Cpartial%20z_%7Bi3%7D%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20S_%7Bi2%7D%7D%7B%5Cpartial%20z_%7Bi1%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi2%7D%7D%7B%5Cpartial%20z_%7Bi2%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi2%7D%7D%7B%5Cpartial%20z_%7Bi3%7D%7D%20%5C%5C%0A%5Cfrac%7B%5Cpartial%20S_%7Bi3%7D%7D%7B%5Cpartial%20z_%7Bi1%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi3%7D%7D%7B%5Cpartial%20z_%7Bi2%7D%7D%20&amp;%20%5Cfrac%7B%5Cpartial%20S_%7Bi3%7D%7D%7B%5Cpartial%20z_%7Bi3%7D%7D%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%5Cfrac%7B%5Cpartial%20L%7D%7B%5Cpartial%20S_i%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20S_i%7D%7B%5Cpartial%20z_i%7D%0A%5Cend%7Balign*%7D"></p>
<p>Now, <img src="https://latex.codecogs.com/png.latex?%5Cpartial%20L/%5Cpartial%20S_i"> has shape <code>[1,3]</code> and <img src="https://latex.codecogs.com/png.latex?%5Cpartial%20S_i/%5Cpartial%20z_i"> is a matrix of size <code>[3,3]</code>. So, <img src="https://latex.codecogs.com/png.latex?%5Cpartial%20L/%5Cpartial%20z_i"> will have dimensions <code>[1,3]</code>.</p>
</section>
<section id="softmax-backward-implementation" class="level2">
<h2 class="anchored" data-anchor-id="softmax-backward-implementation">Softmax <code>backward()</code> implementation</h2>
<p>We are now in a position to add <code>backward()</code> pass to the <code>SoftmaxActivation</code> layer.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> SoftmaxActivation:</span>
<span id="cb45-2"></span>
<span id="cb45-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb45-4">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, inputs):</span>
<span id="cb45-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inputs</span>
<span id="cb45-6">        exp_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.exp(inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(inputs, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, keepdims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>))</span>
<span id="cb45-7">        probabilities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(exp_values, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, keepdims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb45-8">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> probabilities</span>
<span id="cb45-9"></span>
<span id="cb45-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward pass</span></span>
<span id="cb45-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> backward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, dloss_da):</span>
<span id="cb45-12">        dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb45-13">        n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output)</span>
<span id="cb45-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n):</span>
<span id="cb45-15">            softmax_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output[i]</span>
<span id="cb45-16"></span>
<span id="cb45-17">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape as a column vector</span></span>
<span id="cb45-18">            softmax_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax_output.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb45-19"></span>
<span id="cb45-20">            dsoftmax_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.diagflat(softmax_output) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.dot(</span>
<span id="cb45-21">                softmax_output, softmax_output.T</span>
<span id="cb45-22">            )</span>
<span id="cb45-23">            dloss_dz.append(np.dot(dloss_da[i], dsoftmax_dz))</span>
<span id="cb45-24"></span>
<span id="cb45-25">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(dloss_dz)</span></code></pre></div>
</div>
</section>
<section id="categorical-cross-entropy-loss-and-softmax-activation-function-derivative" class="level2">
<h2 class="anchored" data-anchor-id="categorical-cross-entropy-loss-and-softmax-activation-function-derivative">Categorical cross-entropy loss and softmax activation function derivative</h2>
<p>The derivative of the categorical cross entropy loss and softmax activation function can be combined and results in a faster and simple implementation. The current implementation of the <code>backward</code> function in <code>SoftMaxActivation</code> is not vectorized and has a loop.</p>
<p>Let’s focus again on <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20L_%7Bi%7D%7D%7B%5Cpartial%20z_%7Bij%7D%7D">. We have:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7B%5Cpartial%20L_i%7D%7B%5Cpartial%20z_%7Bij%7D%7D%20&amp;=%20%5Csum_%7Bk%7D%20%5Cfrac%7B%5Cpartial%20L_i%7D%7B%5Cpartial%20S_%7Bik%7D%7D%20%5Cfrac%7B%5Cpartial%20S_%7Bik%7D%7D%7B%5Cpartial%20z_%7Bij%7D%7D%20%5C%5C%0A&amp;=%20%5Cfrac%7B%5Cpartial%20L_i%7D%7BS_%7Bij%7D%7D%20%5Ccdot%20%5Cfrac%7B%5Cpartial%20S_%7Bij%7D%7D%7B%5Cpartial%20z_%7Bij%7D%7D%20+%20%5Csum_%7Bk%5Cneq%20j%7D%5Cfrac%7B%5Cpartial%20L_i%7D%7B%5Cpartial%20S_%7Bik%7D%7D%20%5Cfrac%7B%5Cpartial%20S_%7Bik%7D%7D%7B%5Cpartial%20z_%7Bij%7D%7D%20%5C%5C%0A&amp;=%20-%5Cfrac%7By_%7Bij%7D%7D%7B%5Chat%7By%7D_%7Bij%7D%7D%5Chat%7By%7D_%7Bij%7D(1-%5Chat%7By%7D_%7Bij%7D)%20+%20%5Csum_%7Bk%20%5Cneq%20j%7D-%5Cfrac%7By_%7Bik%7D%7D%7B%5Chat%7By%7D_%7Bik%7D%7D%5Ccdot%20%5Chat%7By%7D_%7Bik%7D(0%20-%20%5Chat%7By%7D_%7Bij%7D)%5C%5C%0A&amp;=%20-%5Cfrac%7By_%7Bij%7D%7D%7B%5Ccancel%7B%5Chat%7By%7D_%7Bij%7D%7D%7D%5Ccancel%7B%5Chat%7By%7D_%7Bij%7D%7D(1-%5Chat%7By%7D_%7Bij%7D)%20+%20%5Csum_%7Bk%20%5Cneq%20j%7D-%5Cfrac%7By_%7Bik%7D%7D%7B%5Ccancel%7B%5Chat%7By%7D_%7Bik%7D%7D%7D%5Ccdot%20%5Ccancel%7B%5Chat%7By%7D_%7Bik%7D%7D(0%20-%20%5Chat%7By%7D_%7Bij%7D)%5C%5C%0A&amp;=%20-y_%7Bij%7D%20+%20y_%7Bij%7D%5Chat%7By%7D_%7Bij%7D%20+%20%5Csum_%7Bk%5Cneq%20j%7Dy_%7Bik%7D%20%5Chat%7By%7D_%7Bij%7D%5C%5C%0A&amp;=%20-y_%7Bij%7D%20+%20%5Chat%7By%7D_%7Bij%7D(%5Csum_%7Bk%7Dy_%7Bik%7D)%5C%5C%0A&amp;=%20%5Chat%7By%7D_%7Bij%7D%20-%20y_%7Bij%7D%0A%5Cend%7Balign*%7D"></p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> CategoricalCrossEntropySoftmax:</span>
<span id="cb46-2"></span>
<span id="cb46-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create activation and loss function objects</span></span>
<span id="cb46-4">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb46-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.activation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SoftmaxActivation()</span>
<span id="cb46-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CategoricalCrossEntropyLoss()</span>
<span id="cb46-7"></span>
<span id="cb46-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># forward pass</span></span>
<span id="cb46-9">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, inputs, y_true):</span>
<span id="cb46-10"></span>
<span id="cb46-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inputs</span>
<span id="cb46-12">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.activation.forward(inputs)</span>
<span id="cb46-13"></span>
<span id="cb46-14">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.activation.output</span>
<span id="cb46-15"></span>
<span id="cb46-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.loss.calculate(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output, y_true)</span>
<span id="cb46-17"></span>
<span id="cb46-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Backward pass</span></span>
<span id="cb46-19">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> backward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, y_pred, y_true):</span>
<span id="cb46-20">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of samples</span></span>
<span id="cb46-21">        batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred)</span>
<span id="cb46-22"></span>
<span id="cb46-23">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># number of labels</span></span>
<span id="cb46-24">        num_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_pred[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb46-25"></span>
<span id="cb46-26">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If labels are sparse, turn them into a one-hot vector</span></span>
<span id="cb46-27">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(y_true.shape) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb46-28">            y_true <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.eye(num_labels)[y_true]</span>
<span id="cb46-29"></span>
<span id="cb46-30">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the gradient</span></span>
<span id="cb46-31">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y_pred <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_true</span>
<span id="cb46-32"></span>
<span id="cb46-33">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Normalize the gradient</span></span>
<span id="cb46-34">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.dloss_dz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> batch_size</span></code></pre></div>
</div>
<p>We can now test if the combined backward step returns the same values compared to when we backpropogate gradients through both of the functions separately.</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb47-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nnfs</span>
<span id="cb47-3"></span>
<span id="cb47-4">nnfs.init()</span>
<span id="cb47-5"></span>
<span id="cb47-6">softmax_outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>], [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>], [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>]])</span>
<span id="cb47-7"></span>
<span id="cb47-8">class_targets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb47-9"></span>
<span id="cb47-10"></span>
<span id="cb47-11">activation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SoftmaxActivation()</span>
<span id="cb47-12">activation.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softmax_outputs</span>
<span id="cb47-13"></span>
<span id="cb47-14">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CategoricalCrossEntropyLoss()</span>
<span id="cb47-15">loss.backward(softmax_outputs, class_targets)</span>
<span id="cb47-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gradients : separate loss and activation"</span>)</span>
<span id="cb47-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"dloss_da = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dloss_da<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb47-18"></span>
<span id="cb47-19">activation.backward(loss.dloss_da)</span>
<span id="cb47-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"dloss_dz = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>activation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dloss_dz<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb47-21"></span>
<span id="cb47-22">softmax_cce <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CategoricalCrossEntropySoftmax()</span>
<span id="cb47-23">softmax_cce.backward(softmax_outputs, class_targets)</span>
<span id="cb47-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gradients : combined loss and activation"</span>)</span>
<span id="cb47-25"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"dloss_dz = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>softmax_cce<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>dloss_dz<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Gradients : separate loss and activation
dloss_da = [[-0.47619048 -0.         -0.        ]
 [-0.         -0.66666667 -0.        ]
 [-0.         -0.37037037 -0.        ]]
dloss_dz = [[-0.09999999  0.03333334  0.06666667]
 [ 0.03333334 -0.16666667  0.13333334]
 [ 0.00666667 -0.03333333  0.02666667]]
Gradients : combined loss and activation
dloss_dz = [[-0.1         0.03333333  0.06666667]
 [ 0.03333333 -0.16666667  0.13333333]
 [ 0.00666667 -0.03333333  0.02666667]]</code></pre>
</div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>Machine Learning</category>
  <guid>https://quantdev.blog/posts/backpropogation/</guid>
  <pubDate>Tue, 04 Jun 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/backpropogation/image.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Coding a neural network layer</title>
  <dc:creator>Quasar </dc:creator>
  <link>https://quantdev.blog/posts/coding-a-neural-network-layer/</link>
  <description><![CDATA[ 





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In 1943, McCulloch and Pitts introduced artificial intelligence to the world. Their idea was to develop an algorithmic approach to mimic the functionality of the human brain. Due to the structure of the brain consisting of a net of neurons, they introduced the so-called <em>artificial neurons</em> as building blocks.</p>
<p>In it’s most simple form, the neuron consists of :</p>
<ul>
<li>dendrites, which receive the information from other neurons</li>
<li>soma, which processes the information</li>
<li>synapse, transmits the output of this neuron</li>
<li>axon, point of connection to other neurons</li>
</ul>
<p>Consequently, a mathematical definition of an artificial neuron is as follows.</p>
<p><em>Definition.</em> An <em>artificial neuron</em> with weights <img src="https://latex.codecogs.com/png.latex?w_1,%5Cldots,w_n%20%5Cin%20%5Cmathbf%7BR%7D">, bias <img src="https://latex.codecogs.com/png.latex?b%5Cin%5Cmathbf%7BR%7D"> and an activation function <img src="https://latex.codecogs.com/png.latex?%5Crho:%5Cmathbf%7BR%7D%20%5Cto%20%5Cmathbf%7BR%7D"> is defined as the scalar-valued function <img src="https://latex.codecogs.com/png.latex?f:%5Cmathbf%7BR%7D%5En%20%5Cto%20%5Cmathbf%7BR%7D"> given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Af(x_1,%5Cldots,x_n)%20=%20%5Crho%20%5Cleft(%5Csum_%7Bi=1%7D%5E%7Bn%7Dw_i%20x_i%20+%20b%5Cright)%20=%20%5Crho(%5Cmathbf%7Bw%7D%5ET%20%5Cmathbf%7Bx%7D+b)%20%5Ctag%7B1%7D%0A%5Cend%7Balign*%7D"></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bw%7D%20=%20(w_1,%5Cldots,w_n)"> and <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D=(x_1,%5Cldots,x_n)">.</p>
<p>A single neuron by itself is useless, but when combined with hundreds or thousands(or many more) of other neurons, the interconnectivity can approximate any complex function and frequently outperforms any other machine learning methods.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>load_ext itikz</span></code></pre></div>
</div>
<div class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb2-2">\begin{tikzpicture}</span>
<span id="cb2-3">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb2-4">{</span>
<span id="cb2-5">    \node[circle, </span>
<span id="cb2-6">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb2-7">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb2-8">        ] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $x_\i$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-9">}</span>
<span id="cb2-10">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>}</span>
<span id="cb2-11">{</span>
<span id="cb2-12">    \node[circle, </span>
<span id="cb2-13">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb2-14">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb2-15">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span> mm</span>
<span id="cb2-16">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-17">        </span>
<span id="cb2-18">}</span>
<span id="cb2-19">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>}</span>
<span id="cb2-20">{</span>
<span id="cb2-21">    \node[circle, </span>
<span id="cb2-22">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb2-23">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb2-24">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span> mm</span>
<span id="cb2-25">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-26">}</span>
<span id="cb2-27">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb2-28">{</span>
<span id="cb2-29">    \node[circle, </span>
<span id="cb2-30">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb2-31">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>] (Output<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $\hat{y}_\i$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-32">}</span>
<span id="cb2-33"></span>
<span id="cb2-34"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb2-35">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb2-36">{</span>
<span id="cb2-37">    \foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>}</span>
<span id="cb2-38">    {</span>
<span id="cb2-39">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb2-40">    }</span>
<span id="cb2-41">}</span>
<span id="cb2-42">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>}</span>
<span id="cb2-43">{</span>
<span id="cb2-44">    \foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>}</span>
<span id="cb2-45">    {</span>
<span id="cb2-46">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb2-47">    }</span>
<span id="cb2-48">}</span>
<span id="cb2-49">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>}</span>
<span id="cb2-50">{</span>
<span id="cb2-51">    \foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>}</span>
<span id="cb2-52">    {</span>
<span id="cb2-53">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb2-54">    }</span>
<span id="cb2-55">}</span>
<span id="cb2-56">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-3-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Dense layers, the most common layers, consist of interconnected neurons. In a dense layer, each neuron of a given layer is connected to every neuron of the next layer, which means its output value becomes an input for the next neurons. Each connection between neurons has a weight associated with it, which is a trainable factor of how much of this input to use. Once all of the <img src="https://latex.codecogs.com/png.latex?%5Ctext%7Binputs%7D%20%5Ccdot%20%5Ctext%7B%20weights%7D"> flow into our neuron, they are summed and a bias, another trainable parameter is added.</p>
<p>Say, we have an input <img src="https://latex.codecogs.com/png.latex?x_1"> and weight <img src="https://latex.codecogs.com/png.latex?w_1">, then the output <img src="https://latex.codecogs.com/png.latex?y_1%20=%20w_1%20x_1"> is a straight-line with slope <img src="https://latex.codecogs.com/png.latex?w_1">.</p>
<div class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb3-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb3-3">\begin{axis}</span>
<span id="cb3-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue]{x}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-5">\addlegendentry{\(f(x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x\)}</span>
<span id="cb3-6">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red]{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-7">\addlegendentry{\(f(x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">x</span>\)}</span>
<span id="cb3-8">\end{axis}</span>
<span id="cb3-9">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-4-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The bias offsets the overall function.</p>
<div class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb4-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb4-3">\begin{axis}</span>
<span id="cb4-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>black]{x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-5">\addlegendentry{\(f(x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>\)}</span>
<span id="cb4-6">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>gray]{x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-7">\addlegendentry{\(f(x)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>\)}</span>
<span id="cb4-8">\end{axis}</span>
<span id="cb4-9">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-5-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="activation-functions" class="level3">
<h3 class="anchored" data-anchor-id="activation-functions">Activation functions</h3>
<p>Let us now look at some examples of activation functions.</p>
<p>The heaviside function is defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Crho(x)%20&amp;=%0A%5Cbegin%7Bcases%7D%0A1,%20&amp;%20x%20%3E%200%20%5C%5C%0A0,%20&amp;%20x%20%5Cleq%200%0A%5Cend%7Bcases%7D%0A%5Cend%7Balign*%7D"></p>
<p>The sigmoid function is defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Crho(x)%20&amp;=%20%5Cfrac%7B1%7D%7B1+e%5E%7B-x%7D%7D%0A%5Cend%7Balign*%7D"></p>
<div class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb5-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb5-3">\begin{axis}</span>
<span id="cb5-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>black]{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>exp(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-5">\end{axis}</span>
<span id="cb5-6">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-6-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The Rectifiable Linear Unit (ReLU) function is defined as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Crho(x)%20&amp;=%20%5Cmax(0,x)%0A%5Cend%7Balign*%7D"></p>
<div class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb6-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb6-3">\begin{axis}</span>
<span id="cb6-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>black]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,x)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-5">\end{axis}</span>
<span id="cb6-6">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-7-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="coding-a-layer-with-3-neurons" class="level2">
<h2 class="anchored" data-anchor-id="coding-a-layer-with-3-neurons">Coding a layer with 3-neurons</h2>
<p>Let’s code a simple layer with <img src="https://latex.codecogs.com/png.latex?n=3"> neurons.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>]</span>
<span id="cb7-2">weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>], [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.91</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.26</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>], [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.26</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.17</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.87</span>]]</span>
<span id="cb7-3"></span>
<span id="cb7-4">biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>]</span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output of the current layer</span></span>
<span id="cb7-7">layer_outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For each neuron</span></span>
<span id="cb7-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> neuron_weights, neuron_bias <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(weights, biases):</span>
<span id="cb7-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># zeroed output of the neuron</span></span>
<span id="cb7-12">    neuron_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb7-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for each input and weight to the neuron</span></span>
<span id="cb7-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span>, weight <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(inputs, neuron_weights):</span>
<span id="cb7-15">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># multiply this input with the associated weight</span></span>
<span id="cb7-16">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and add to the neuron's output variable</span></span>
<span id="cb7-17">        neuron_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> weight</span>
<span id="cb7-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add bias</span></span>
<span id="cb7-19">    neuron_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> neuron_bias</span>
<span id="cb7-20">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Put the neuron's result to the layer's output list</span></span>
<span id="cb7-21">    layer_outputs.append(neuron_output)</span>
<span id="cb7-22"></span>
<span id="cb7-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(layer_outputs)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[4.8, 1.21, 2.385]</code></pre>
</div>
</div>
<p>We can achieve the same results as in our pure Python implementation of multiplying each component in our input vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D"> and weights vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bw%7D"> element-wise, by taking an inner product <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bw%7D%20%5Ccdot%20%5Cmathbf%7Bx%7D">.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb9-2"></span>
<span id="cb9-3">inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>]</span>
<span id="cb9-4">weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb9-5">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>], </span>
<span id="cb9-6">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.91</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.26</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>], </span>
<span id="cb9-7">    [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.26</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.17</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.87</span>]</span>
<span id="cb9-8">]</span>
<span id="cb9-9"></span>
<span id="cb9-10">biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>]</span>
<span id="cb9-11"></span>
<span id="cb9-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output of the current layer</span></span>
<span id="cb9-13">layer_outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(weights, inputs) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> biases</span>
<span id="cb9-14"></span>
<span id="cb9-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(layer_outputs)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[4.8   1.21  2.385]</code></pre>
</div>
</div>
<p>To train, neural networks tend to receive data in <em>batches</em>. So far, the example input data has only one sample (or observation) of various features called a feature set instance:</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">sample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>]</span></code></pre></div>
<p>Often, neural networks expect to take in many <em>samples</em> at a time. One reason is its faster to train in batches in parallel processing. Also, if you fit on one sample at a time, you’re highly likely to keep fitting to that individual sample, rather than slowly producing general tweaks to the weights and biases that fit the entire dataset. Fitting or training in batches gives you a higher chance of making more meaningful changes to weights and biases.</p>
</section>
<section id="a-layer-of-neurons-and-a-batch-of-data" class="level2">
<h2 class="anchored" data-anchor-id="a-layer-of-neurons-and-a-batch-of-data">A layer of neurons and a batch of data</h2>
<p>Currently, the weights matrix looks as follows:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AW%20=%20%5Cbegin%7Bbmatrix%7D%0A0.2%20&amp;%200.8%20&amp;%20-0.5%20&amp;%201.0%20%5C%5C%0A0.5%20&amp;%20-0.91%20&amp;%200.26%20&amp;%20-0.5%20%5C%5C%0A-0.26%20&amp;%20-0.27%20&amp;%200.17%20&amp;%200.87%0A%5Cend%7Bbmatrix%7D%0A%5Cend%7Balign*%7D"></p>
<p>And say, that we have a batch of inputs:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AX%20=%20%5Cbegin%7Bbmatrix%7D%0A1.0%20&amp;%202.0%20&amp;%203.0%20&amp;%203.5%20%5C%5C%0A2.0%20&amp;%205.0%20&amp;%20-1.0%20&amp;%202.0%5C%5C%0A-1.5%20&amp;%202.7%20&amp;%203.3%20&amp;%20-0.8%0A%5Cend%7Bbmatrix%7D%0A%5Cend%7Balign*%7D"></p>
<p>We need to take the inner products <img src="https://latex.codecogs.com/png.latex?(1.0,%202.0,%203.0,%203.5)%20%5Ccdot%20(0.2,%200.8,%20-0.5,%201.0)">, <img src="https://latex.codecogs.com/png.latex?(2.0,%205.0,%20-1.0,%202.0)%20%5Ccdot%20(0.2,%200.8,%20-0.5,%201.0)"> and <img src="https://latex.codecogs.com/png.latex?(-1.5,%202.7,%203.3,%20-0.8)%20%5Ccdot%20(0.2,%200.8,%20-0.5,%201.0)"> for the first neuron.</p>
<p>We need to take the inner products <img src="https://latex.codecogs.com/png.latex?(1.0,%202.0,%203.0,%203.5)%20%5Ccdot%20(0.5,%20-0.91,%200.26,%20-0.5)">, <img src="https://latex.codecogs.com/png.latex?(2.0,%205.0,%20-1.0,%202.0)%20%5Ccdot%20(0.5,%20-0.91,%200.26,%20-0.5)"> and <img src="https://latex.codecogs.com/png.latex?(-1.5,%202.7,%203.3,%20-0.8)%20%5Ccdot%20(0.5,%20-0.91,%200.26,%20-0.5)"> for the second neuron.</p>
<p>And so forth.</p>
<p>Consider the matrix product <img src="https://latex.codecogs.com/png.latex?XW%5ET">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0AXW%5ET%20&amp;=%20%5Cbegin%7Bbmatrix%7D%0A1.0%20&amp;%202.0%20&amp;%203.0%20&amp;%202.5%20%5C%5C%0A2.0%20&amp;%205.0%20&amp;%20-1.0%20&amp;%202.0%5C%5C%0A-1.5%20&amp;%202.7%20&amp;%203.3%20&amp;%20-0.8%0A%5Cend%7Bbmatrix%7D%0A%5Cbegin%7Bbmatrix%7D%0A0.2%20&amp;%200.5%20&amp;%20-0.26%20%5C%5C%0A0.8%20&amp;%20-0.91%20&amp;%20-0.27%20%5C%5C%0A-0.5%20&amp;%200.26%20&amp;%200.17%20%5C%5C%0A1.0%20&amp;%20-0.5%20&amp;%200.87%0A%5Cend%7Bbmatrix%7D%5C%5C%0A&amp;=%20%5Cbegin%7Bbmatrix%7D%0A2.8%20&amp;%20-1.79%20&amp;%201.885%20%5C%5C%0A6.9%20&amp;%20-4.81%20&amp;%20-0.3%20%5C%5C%0A-0.59%20&amp;%20-1.949%20&amp;%20-0.474%0A%5Cend%7Bbmatrix%7D%0A%5Cend%7Balign*%7D"></p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb12-2"></span>
<span id="cb12-3">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb12-4">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>],</span>
<span id="cb12-5">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>],</span>
<span id="cb12-6">    [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>]</span>
<span id="cb12-7">]</span>
<span id="cb12-8"></span>
<span id="cb12-9">W <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb12-10">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>],</span>
<span id="cb12-11">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.91</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.26</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>],</span>
<span id="cb12-12">    [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.26</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.17</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.87</span>]</span>
<span id="cb12-13">]</span>
<span id="cb12-14"></span>
<span id="cb12-15">np.dot(X,np.array(W).T)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>array([[ 2.8  , -1.79 ,  1.885],
       [ 6.9  , -4.81 , -0.3  ],
       [-0.59 , -1.949, -0.474]])</code></pre>
</div>
</div>
<p>So, we can process a batch of inputs as:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">layer_outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(X,np.array(W).T) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> biases</span>
<span id="cb14-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(layer_outputs)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 4.8    1.21   2.385]
 [ 8.9   -1.81   0.2  ]
 [ 1.41   1.051  0.026]]</code></pre>
</div>
</div>
<p>The second argument for <code>np.dot()</code> is going to be our transposed weights. Before, we were computing the neuron output using a single sample of data, but now we’ve taken a step forward where we model the layer behavior on a batch of data.</p>
</section>
<section id="adding-layers" class="level2">
<h2 class="anchored" data-anchor-id="adding-layers">Adding Layers</h2>
<p>The neural network we have built is becoming more respectable, but at the moment, we have only one layer. Neural networks become deep when they have <img src="https://latex.codecogs.com/png.latex?2"> or more <em>hidden layers</em>. At the moment, we have just one layer, which is effectively an output layer. Why we want two or more hidden layers will become apparent later on. Currently, we have no hidden layers. A hidden layer isn’t an input or output layer; as the scientist, you see the data as they are handed to the input layer and the resulting data from the output layer. Layers between these endpoints have values that we don’t necessarily deal with, and hence the name “hidden”. Don’t let this name convince you that you can’t access these values, though. You will often use them to diagnose issues or improve your neural network. To explore this concept, let’s add another layer to this neural network, and for now, let’s assume that these two layers that we’re going to have will be hidden layers, and we just coded our output layer yet.</p>
<p>Before we add another layer, let’s think about what’s coming. In the case of the first layer, we can see that we have an input with <img src="https://latex.codecogs.com/png.latex?4"> features.</p>
<div class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb16-2">\begin{tikzpicture}</span>
<span id="cb16-3">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>}</span>
<span id="cb16-4">{</span>
<span id="cb16-5">    \node[circle, </span>
<span id="cb16-6">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb16-7">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb16-8">        ] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $x_\i$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb16-9">}</span>
<span id="cb16-10">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}</span>
<span id="cb16-11">{</span>
<span id="cb16-12">    \node[circle, </span>
<span id="cb16-13">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb16-14">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb16-15">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> mm</span>
<span id="cb16-16">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb16-17">        </span>
<span id="cb16-18">}</span>
<span id="cb16-19"></span>
<span id="cb16-20"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb16-21">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>}</span>
<span id="cb16-22">{</span>
<span id="cb16-23">    \foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}</span>
<span id="cb16-24">    {</span>
<span id="cb16-25">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb16-26">    }</span>
<span id="cb16-27">}</span>
<span id="cb16-28">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-12-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Samples(feature set data) get fed through the input, which does not change it in any way, to our first hidden layer, which we can see has <img src="https://latex.codecogs.com/png.latex?3"> sets of weights with <img src="https://latex.codecogs.com/png.latex?4"> values each.</p>
<p>Each of those <img src="https://latex.codecogs.com/png.latex?3"> unique weight sets is associated with its distinct neuron. Thus, since we have <img src="https://latex.codecogs.com/png.latex?3"> weight sets, we have <img src="https://latex.codecogs.com/png.latex?3"> neurons in the first hidden layer. Each neuron has a unique set of weights, of which we have <img src="https://latex.codecogs.com/png.latex?4"> (as there are <img src="https://latex.codecogs.com/png.latex?4"> inputs to this layer), which is why our initial weights have a shape of <img src="https://latex.codecogs.com/png.latex?(3,4)">.</p>
<p>Now we wish to add another layer. To do that, we must make sure that the expected input to that layer matches the previous layer’s output. We have set the number of neurons in a layer by setting how many weights and biases we have. The previous layer’s influence on weight sets for the current layer is that each weight set needs to have a separate weight per input. This means a distinct weight per neuron from the previous layer (or feature if we’re talking the input). The previous layer has <img src="https://latex.codecogs.com/png.latex?3"> weight sets and <img src="https://latex.codecogs.com/png.latex?3"> biases, so we know it has <img src="https://latex.codecogs.com/png.latex?3"> neurons. This then means, for the next layer, we can have as many weight sets as we want (because this is how many neurons this new layer will have), but each of those weight sets must have <img src="https://latex.codecogs.com/png.latex?3"> discrete weights.</p>
<p>To create this new layer, we are going to copy and paste our <code>weights</code> and <code>biases</code> to <code>weights2</code> and <code>biases2</code>, and change their values to new made up sets. Here’s an example:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb17-2">    [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>],</span>
<span id="cb17-3">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb17-4">    [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>]</span>
<span id="cb17-5">]</span>
<span id="cb17-6"></span>
<span id="cb17-7">weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb17-8">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb17-9">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.91</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.26</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>],</span>
<span id="cb17-10">    [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.26</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.17</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.87</span>]</span>
<span id="cb17-11">]</span>
<span id="cb17-12"></span>
<span id="cb17-13">biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>]</span>
<span id="cb17-14"></span>
<span id="cb17-15">weights2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb17-16">    [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.14</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>],</span>
<span id="cb17-17">    [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.12</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.33</span>],</span>
<span id="cb17-18">    [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.44</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.73</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.13</span>]</span>
<span id="cb17-19">]</span>
<span id="cb17-20"></span>
<span id="cb17-21">biases2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>]</span></code></pre></div>
</div>
<p>Next, we will now call the outputs <code>layer1_outputs</code>.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">layer1_outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(inputs, np.array(weights).T) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> biases</span></code></pre></div>
</div>
<p>As previously stated, inputs to the layers are either inputs from the actual dataset you’re training with, or outputs from a previous layer. That’s why we defined <img src="https://latex.codecogs.com/png.latex?2"> versions of <code>weights</code> and <code>biases</code>, but only one of <code>inputs</code>.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">layer2_outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(layer1_outputs, np.array(weights2).T) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> biases2</span></code></pre></div>
</div>
<p>At this point, our neural network could be visually represented as:</p>
<div class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb20-2">\begin{tikzpicture}</span>
<span id="cb20-3">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>}</span>
<span id="cb20-4">{</span>
<span id="cb20-5">    \node[circle, </span>
<span id="cb20-6">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb20-7">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb20-8">        ] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $x_\i$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-9">}</span>
<span id="cb20-10">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}</span>
<span id="cb20-11">{</span>
<span id="cb20-12">    \node[circle, </span>
<span id="cb20-13">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb20-14">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb20-15">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> mm</span>
<span id="cb20-16">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-17">        </span>
<span id="cb20-18">}</span>
<span id="cb20-19">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}</span>
<span id="cb20-20">{</span>
<span id="cb20-21">    \node[circle, </span>
<span id="cb20-22">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb20-23">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb20-24">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> mm</span>
<span id="cb20-25">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-26">        </span>
<span id="cb20-27">}</span>
<span id="cb20-28"></span>
<span id="cb20-29"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb20-30">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>}</span>
<span id="cb20-31">{</span>
<span id="cb20-32">    \foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}</span>
<span id="cb20-33">    {</span>
<span id="cb20-34">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb20-35">    }</span>
<span id="cb20-36">}</span>
<span id="cb20-37"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb20-38">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}</span>
<span id="cb20-39">{</span>
<span id="cb20-40">    \foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}</span>
<span id="cb20-41">    {</span>
<span id="cb20-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb20-43">    }</span>
<span id="cb20-44">}</span>
<span id="cb20-45">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-16-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="training-data" class="level2">
<h2 class="anchored" data-anchor-id="training-data">Training Data</h2>
<p>Next, rather than hand-typing in random data, we’ll use a function that can create non-linear data. What do we mean by non-linear? Linear data can be fit or represented by a straight line. Non-linear data cannot be represented well by a straight line.</p>
<p>We shall use the python package <code>nnfs</code> to create data. You can install it with</p>
<pre><code>pip install nnfs</code></pre>
<p>You typically don’t generate training data from a package like <code>nnfs</code> for your neural networks. Generating a dataset this way is purely for convenience at this stage. I shall also use this package to ensure repeatability.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb22-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nnfs</span>
<span id="cb22-3"></span>
<span id="cb22-4">nnfs.init()</span></code></pre></div>
</div>
<p>The <code>nnfs.init()</code> does three things: it sets the random seed to <img src="https://latex.codecogs.com/png.latex?0"> by default, creates a <code>float32</code> dtype default and overrides the original dot product from <code>numpy</code>. All of these are meant to ensure repeatable results for following along.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> nnfs.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> spiral_data</span>
<span id="cb23-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb23-3"></span>
<span id="cb23-4">X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spiral_data(samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb23-5"></span>
<span id="cb23-6">plt.scatter(X[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], X[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb23-7">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-18-output-1.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The <code>spiral_data</code> function allows us to create a dataset with as many classes as we want. The function has parameters to choose the number of classes and the number of points/observations per class in the resulting non-linear dataset.</p>
<p>If you trace from the center, you can determine all <img src="https://latex.codecogs.com/png.latex?3"> classes separately, but this is a very challenging problem for a machine learning classifier to solve. Adding color to the chart makes this more clear:</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">plt.scatter(X[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],X[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>y,cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'brg'</span>)</span>
<span id="cb24-2">plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-19-output-1.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Keep in mind that the neural network will not be aware of the color differences as the data have no class encodings. This is only made as an instruction for you. In the data above, each dot is an observation, that is, it’s coordinates are the samples that form the dataset. The classification for the dot has to do with which spiral it is a part of, depicted by red, blue or green color.</p>
</section>
<section id="dense-layer-class" class="level2">
<h2 class="anchored" data-anchor-id="dense-layer-class">Dense Layer Class</h2>
<p>Now that we no longer need to hand-type our data, we should create something similar for our various types of neural network layers. So far, we’ve only used what’s called a <strong>dense</strong> or <strong>fully-connected</strong> layer. These layers are commonly referred to as dense layers in papers, literature and code, but you will see them called fully-connected or fc for short in the code I write. Our dense layer class begins with two methods:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> DenseLayer:</span>
<span id="cb25-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, n_inputs, n_neurons):</span>
<span id="cb25-3">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize weights and biases</span></span>
<span id="cb25-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">pass</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># using pass statement as a placeholder</span></span>
<span id="cb25-5"></span>
<span id="cb25-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb25-7">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, inputs):</span>
<span id="cb25-8">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate output values from inputs, weights and biases</span></span>
<span id="cb25-9">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">pass</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># using pass statement as a placeholder</span></span></code></pre></div>
</div>
<p>Weights are often initialized randomly for a model, but not always. If you wish to load a pre-trained model, you will initialize the parameters to whatever that pretrained model finished with. It’s also possible that, even for a new model, you have some other initialization rules besides random. From now, we’ll stick with random initialization. Next, we have the <code>forward</code> method. When we pass data through a model from beginning to end, this is called a <strong>forward</strong> pass. Just like everything else, this is not the only way to do things. You can have the data loop back around and do other interesting things. We’ll keep it usual and perform a regular forward pass.</p>
<p>To continue the <code>LayerDense</code> class code, let’s add the random initialization of weights and biases:</p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Layer initialization</span></span>
<span id="cb26-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,n_inputs, n_neurons):</span>
<span id="cb26-3">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.random.randn(n_inputs,n_neurons)</span>
<span id="cb26-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,n_neurons))</span></code></pre></div>
<p>Here, we are setting the weights to be random and the biases to be <img src="https://latex.codecogs.com/png.latex?0">. Note that, we are initializing weights to be a matrix of dimensions <img src="https://latex.codecogs.com/png.latex?n_%7Binputs%7D%20%5Ctimes%20n_%7Bneurons%7D">, rather than <img src="https://latex.codecogs.com/png.latex?n_%7Bneurons%7D%20%5Ctimes%20n_%7Binputs%7D">. We’re doing this ahead instead of transposing everytime we perform a forward pass, as explained in the previous chapter.</p>
<p>We initialize the biases to zero, because with many samples containing values of <img src="https://latex.codecogs.com/png.latex?0">, it will ensure that a neuron fires initially. The most common initialization for biases is zero. This will vary depending on our use-case and is just one of the many things we can tweak when trying to improve results. One situation where we might want to try something else is with what’s called <em>dead neurons</em>.</p>
<p>Imagine our step function again:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0Ay%20=%20%5Cbegin%7Bcases%7D%0A1,%20&amp;%20x%20%3E%200%5C%5C%0A0,%20&amp;%20x%20%5Cleq%200%0A%5Cend%7Bcases%7D%0A%5Cend%7Balign*%7D"></p>
<p>It’s possible for <img src="https://latex.codecogs.com/png.latex?%5Ctext%7Bweights%7D%20%5Ccdot%20%5Ctext%7Binputs%7D%20+%20%5Ctext%7Bbiases%7D"> not to meet the threshold of the step function, which means the neuron will output a zero. On its own, this is not a big issue, but it becomes a problem if this happens to this neuron for every one of the input samples (it’ll become clear why once we learn about backpropogation). So, then this neuron’s <img src="https://latex.codecogs.com/png.latex?0"> output is the input to another neuron. Any weight multiplied by zero will be zero. With an increasing number of neurons outputting <img src="https://latex.codecogs.com/png.latex?0">, more inputs to the next neurons will be zeros, rendering the network essentially non-trainable or <em>dead</em>.</p>
<p>On to our <code>forward</code> method now.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> DenseLayer:</span>
<span id="cb27-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, n_inputs, n_neurons):</span>
<span id="cb27-3">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.random.randn(n_inputs,n_neurons)</span>
<span id="cb27-4">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,n_neurons))</span>
<span id="cb27-5"></span>
<span id="cb27-6">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,inputs):</span>
<span id="cb27-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(inputs,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.weights) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.biases</span></code></pre></div>
</div>
<p>We are now ready to make use of this new class instead of hardcoded calculations, so let’s generate some data using the discussed dataset creation method and use our new layer to perform a forward pass:</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create dataset</span></span>
<span id="cb28-2">X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spiral_data(samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb28-3"></span>
<span id="cb28-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a dense layer with 2 input features and 3 output values</span></span>
<span id="cb28-5">dense1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb28-6"></span>
<span id="cb28-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform a forward pass of our training data through this layer</span></span>
<span id="cb28-8">dense1.forward(X)</span>
<span id="cb28-9"></span>
<span id="cb28-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's see the output of the first few samples</span></span>
<span id="cb28-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(dense1.output[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [-1.11171044e-04 -5.11007493e-05 -1.12099799e-04]
 [ 2.99257295e-06 -2.69126613e-04 -1.45165104e-04]
 [ 8.95101766e-05 -4.30442247e-04 -1.68079801e-04]
 [-3.49893759e-04 -3.07208364e-04 -4.33002861e-04]]</code></pre>
</div>
</div>
</section>
<section id="activation-functions-1" class="level2">
<h2 class="anchored" data-anchor-id="activation-functions-1">Activation Functions</h2>
<p>We use activation functions because if the activation function itself is non-linear, it allows for neural networks with two or more layers to map non-linear functions. We’ll see how this works. In general, your neural network will have <img src="https://latex.codecogs.com/png.latex?2"> types of activation functions. The first will be the activation function used in hidden layers, and the second will be used in the output layer. Usually, the activation function used for hidden neurons will be all the same for all of them, but it doesn’t have to.</p>
<section id="why-use-activation-functions" class="level3">
<h3 class="anchored" data-anchor-id="why-use-activation-functions">Why use activation functions?</h3>
<p>Let’s discuss why we use activation functions in the first place? In most cases, for a neural network to fit a non-linear function, we need it to contain two or more hidden layers and we need those hidden layers to use a non-linear activation function.</p>
<p>While there are certainly problems in life that are linear in nature, for example, trying to figure out the cost of some number of shirts, and we know the cost of an individual shirt, then the equation to calculate the price of any number of those products is a linear equation; other problems in life are not so simple.</p>
<p>Many interesting and hard problems are non-linear. The main attraction of neural networks has to do with their ability to solve non-linear problems. If we allow only linear activation functions in a neural network, the output will just be a linear transformation of the input, which is not enough to form a universal function approximator.</p>
<p>For simplicity, suppose a neural network has <img src="https://latex.codecogs.com/png.latex?2"> hidden layers with <img src="https://latex.codecogs.com/png.latex?1"> neuron each.</p>
<div class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb30-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb30-3">    \node[circle, </span>
<span id="cb30-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb30-5">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb30-6">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-7"></span>
<span id="cb30-8">    \node[circle, </span>
<span id="cb30-9">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb30-10">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb30-11">        ] (Hidden1) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $h_1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-12">        </span>
<span id="cb30-13"></span>
<span id="cb30-14">    \node[circle, </span>
<span id="cb30-15">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb30-16">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb30-17">        ] (Hidden2) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $h_1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-18"></span>
<span id="cb30-19">    \node[circle, </span>
<span id="cb30-20">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb30-21">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb30-22">        ] (Output) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>        </span>
<span id="cb30-23">        </span>
<span id="cb30-24"></span>
<span id="cb30-25">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1) node [midway,above] {\large $w_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-26">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2) node [midway,above]  {\large $w_2$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-27">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-28">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>) node [below] {\large $b_1$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-29">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>) node [below] {\large $b_2$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-30">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-23-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Chat%7By%7D_1%20&amp;=%20h_1%5E%7B(2)%7D%20%5C%5C%0A&amp;=%20w_2%20h_1%5E%7B(1)%7D%20+%20b_2%20%5C%5C%0A&amp;=%20w_2%20(w_1%20x_1%20+%20b_1)%20+%20b_2%20%5C%5C%0A&amp;=%20w_2%20w_1%20x_1%20+%20(w_2%20b_1%20+%20b_2)%0A%5Cend%7Balign*%7D"></p>
<p>So, <img src="https://latex.codecogs.com/png.latex?%5Chat%7By%7D_1"> is a linear function of the inputs, no matter, what values we choose for weights and biases.</p>
<p>The composition of linear functions is linear. No matter what we do, however many layers we have, or neurons we have in each layer, this network can only model linear functions.</p>
</section>
</section>
<section id="relu-activation-in-a-pair-of-neurons" class="level2">
<h2 class="anchored" data-anchor-id="relu-activation-in-a-pair-of-neurons">ReLU Activation in a pair of Neurons</h2>
<p>It is less obvious how, with a barely non-linear activation function, like the rectified linear activation function, we can suddenly model non-linear relationships and functions. Let’s start with a single neuron. We’ll begin with both a weight of zero and a bias of zero:</p>
<div class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb31-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb31-3">    \node[circle, </span>
<span id="cb31-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb31-5">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb31-6">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb31-7">    </span>
<span id="cb31-8">    \node[] (w) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb31-9">    \node[] (b) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb31-10"></span>
<span id="cb31-11">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (w) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input) node [midway,above] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb31-12">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb31-13">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-24-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In this case, no matter what input we pass, the output of this neuron will always be <img src="https://latex.codecogs.com/png.latex?0">, because the weight is <img src="https://latex.codecogs.com/png.latex?0"> and the bias is <img src="https://latex.codecogs.com/png.latex?0">.</p>
<div class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb32-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb32-3">\begin{axis}[grid]</span>
<span id="cb32-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick]{<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-5">\end{axis}</span>
<span id="cb32-6">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-25-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Let’s set the weight to be <img src="https://latex.codecogs.com/png.latex?1.00">.</p>
<div class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb33-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb33-3">    \node[circle, </span>
<span id="cb33-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb33-5">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb33-6">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-7">    </span>
<span id="cb33-8">    \node[] (w) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-9">    \node[] (b) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-10"></span>
<span id="cb33-11">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (w) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input) node [midway,above] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-12">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-13">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-26-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now, it just looks like the basic rectified linear function. No surprises yet!</p>
<div class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb34-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb34-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>]</span>
<span id="cb34-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-5">\end{axis}</span>
<span id="cb34-6">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-27-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now, let’s set the bias to <img src="https://latex.codecogs.com/png.latex?0.50">:</p>
<div class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb35-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb35-3">    \node[circle, </span>
<span id="cb35-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb35-5">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb35-6">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb35-7">    </span>
<span id="cb35-8">    \node[] (w) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb35-9">    \node[] (b) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb35-10"></span>
<span id="cb35-11">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (w) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input) node [midway,above] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb35-12">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb35-13">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-28-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can see that in this case, with a single neuron, the bias offsets the overall function’s activation point horizontally.</p>
<div class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb36-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb36-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>]</span>
<span id="cb36-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb36-5">\end{axis}</span>
<span id="cb36-6">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-29-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>By increasing bias, we’re making this neuron activate earlier. What happens when we negate the weight to <img src="https://latex.codecogs.com/png.latex?-1.0">?</p>
<div class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb37-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb37-3">    \node[circle, </span>
<span id="cb37-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb37-5">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb37-6">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb37-7">    </span>
<span id="cb37-8">    \node[] (w) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb37-9">    \node[] (b) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb37-10"></span>
<span id="cb37-11">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (w) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input) node [midway,above] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb37-12">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb37-13">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-30-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>With a negative weight and this single neuron, the function has become a question of when this neuron <em>deactivates</em>.</p>
<div class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb38-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb38-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>]</span>
<span id="cb38-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb38-5">\end{axis}</span>
<span id="cb38-6">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-31-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>What happens if modify the weight to <img src="https://latex.codecogs.com/png.latex?-2.00">?</p>
<div class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb39-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb39-3">    \node[circle, </span>
<span id="cb39-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb39-5">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb39-6">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb39-7">    </span>
<span id="cb39-8">    \node[] (w) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb39-9">    \node[] (b) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb39-10"></span>
<span id="cb39-11">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (w) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input) node [midway,above] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb39-12">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb39-13">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-32-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The neuron now deactivates at <img src="https://latex.codecogs.com/png.latex?0.25">.</p>
<div class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb40-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb40-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>]</span>
<span id="cb40-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb40-5">\end{axis}</span>
<span id="cb40-6">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-33-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Upto this point, we’ve seen how we can use the bias to offset the function horizontally, and the weight to influence the slope of the activation. Moreover, we’re also able to control whether the function is one for determining where the neuron activates or deactivates. What happens when we have, rather than just one neuron, a pair of neurons? For example, let’s pretend that we have two hidden layers of <img src="https://latex.codecogs.com/png.latex?1"> neuron each. Thinking back to the <img src="https://latex.codecogs.com/png.latex?y=x"> activation function, we unsurprisingly discovered that a linear activation function produced linear results no matter what chain of neurons we made. Let’s see what happens with the rectified linear function for the activation.</p>
<p>We’ll begin with the last values for the first neuron and a weight of <img src="https://latex.codecogs.com/png.latex?1.00"> and a bias of <img src="https://latex.codecogs.com/png.latex?0.00"> for the second neuron.</p>
<div class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb41-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb41-3">    \node[circle, </span>
<span id="cb41-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb41-5">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb41-6">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb41-7"></span>
<span id="cb41-8">    \node[circle, </span>
<span id="cb41-9">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb41-10">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb41-11">        ] (Hidden1) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb41-12">    </span>
<span id="cb41-13">    \node[] (w1) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb41-14">    \node[] (b1) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb41-15">    \node[] (b2) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb41-16"></span>
<span id="cb41-17">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (w1) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input) node [midway,above] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb41-18">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b1) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb41-19">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1) node [midway,above] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb41-20">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b2) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb41-21">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-34-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As we can see so far, there’s no change. This is because the second neuron’s bias is doing no offsetting, and the second neuron’s weight is just multiplying the output by <img src="https://latex.codecogs.com/png.latex?1">, so there’s no change. Let’s try to adjust the second neuron’s bias now:</p>
<div class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb42-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb42-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>}]</span>
<span id="cb42-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb42-5">\end{axis}</span>
<span id="cb42-6">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-35-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Let’s try to adjust the second neuron’s bias now:</p>
<div class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb43-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb43-3">    \node[circle, </span>
<span id="cb43-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb43-5">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb43-6">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb43-7"></span>
<span id="cb43-8">    \node[circle, </span>
<span id="cb43-9">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb43-10">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb43-11">        ] (Hidden1) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb43-12">    </span>
<span id="cb43-13">    \node[] (w1) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb43-14">    \node[] (b1) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb43-15">    \node[] (b2) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb43-16"></span>
<span id="cb43-17">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (w1) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input) node [midway,above] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb43-18">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b1) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb43-19">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1) node [midway,above] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb43-20">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b2) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb43-21">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-36-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now, we see some fairly interesting behavior. The bias of the second neuron indeed shifted the overall function but, rather than shifting it horizontally, it shifted vertically.</p>
<div class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb44-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb44-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>}]</span>
<span id="cb44-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb44-5">\end{axis}</span>
<span id="cb44-6">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-37-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>What then might happen, if we make the <img src="https://latex.codecogs.com/png.latex?2">nd neuron’s weight <img src="https://latex.codecogs.com/png.latex?-2"> rather than <img src="https://latex.codecogs.com/png.latex?1">?</p>
<div class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb45-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb45-3">    \node[circle, </span>
<span id="cb45-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb45-5">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb45-6">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb45-7"></span>
<span id="cb45-8">    \node[circle, </span>
<span id="cb45-9">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb45-10">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb45-11">        ] (Hidden1) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb45-12">    </span>
<span id="cb45-13">    \node[] (w1) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb45-14">    \node[] (b1) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb45-15">    \node[] (b2) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb45-16"></span>
<span id="cb45-17">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (w1) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input) node [midway,above] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb45-18">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b1) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb45-19">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1) node [midway,above] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb45-20">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b2) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb45-21">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-38-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Something exciting has occurred! What we have here is a neuron that has both an activation and a deactivation point. Now, the output after these two neurons will be variable, so long as it is inside of some specific range. So, basically if both neurons are activated then we actually sort of see this influence on the value. Otherwise, if both neurons aren’t activated, then the output is just a static value.</p>
<div class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb46-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb46-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb46-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb46-5">\end{axis}</span>
<span id="cb46-6">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-39-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>So, when we are below the activation of the first neuron, the output will be the bias of the second neuron <img src="https://latex.codecogs.com/png.latex?1.00">.</p>
<div class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb47-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb47-3">    \node[circle, </span>
<span id="cb47-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb47-5">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb47-6">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-7"></span>
<span id="cb47-8">    \node[circle, </span>
<span id="cb47-9">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb47-10">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,</span>
<span id="cb47-11">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green</span>
<span id="cb47-12">        ] (Hidden1) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-13">    </span>
<span id="cb47-14">    \node[] (w1) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-15">    \node[] (b1) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-16">    \node[] (b2) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-17"></span>
<span id="cb47-18">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (w1) node [left] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input) node [midway,above] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-19">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b1) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-20">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1) node [midway,above] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-21">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b2) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-22">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) node [right] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb47-23">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-40-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The second neuron is activated if it’s input is smaller than <img src="https://latex.codecogs.com/png.latex?0.50">.</p>
<p>Consider what happens when the input to the first neuron is <img src="https://latex.codecogs.com/png.latex?0.00,%20-0.10,%20%5Cldots">. The output of the first neuron is <img src="https://latex.codecogs.com/png.latex?0.50,%200.60,%20%5Cldots"> which implies that the second neuron is deactivated, so the output of the second neuron is simply zero.</p>
<div class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb48-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb48-3">    \node[circle, </span>
<span id="cb48-4">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb48-5">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,</span>
<span id="cb48-6">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green</span>
<span id="cb48-7">        ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-8"></span>
<span id="cb48-9">    \node[circle, </span>
<span id="cb48-10">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb48-11">        draw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue</span>
<span id="cb48-12">        ] (Hidden1) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-13">    </span>
<span id="cb48-14">    \node[] (w1) at (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-15">    \node[] (b1) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-16">    \node[] (b2) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-17"></span>
<span id="cb48-18">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (w1) node [left] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input) node [midway,above] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-19">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b1) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.50</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Input)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-20">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1) node [midway,above] {\large $<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-21">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (b2) node [below] {\large $<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-22">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) node [right] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-23">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-41-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="relu-activation-in-hidden-layers" class="level2">
<h2 class="anchored" data-anchor-id="relu-activation-in-hidden-layers">ReLU Activation in hidden layers</h2>
<p>Let’s now take this concept and use it to fit to a sine wave-like function using two hidden layers of <img src="https://latex.codecogs.com/png.latex?8"> neurons each and we can hand-tune the values to fit the curve. We’ll do this by working with <img src="https://latex.codecogs.com/png.latex?1"> pair of neurons at a time, which means <img src="https://latex.codecogs.com/png.latex?1"> neuron from each layer individually. For simplicity, we are also going to assume that the layers are not densely connected, and each neuron from the first hidden layer connects to only one neuron from the second hidden layer. That’s usually not the case with the real models, but we want this simplification for the purpose of this demo. Additionally, this example model takes a single value as an input, the input to the sine function, and outputs a single value like the sine function. The output layer uses the linear activation function and the hidden layers will use the rectified linear activation function.</p>
<p>To start, we’ll set all weights to <img src="https://latex.codecogs.com/png.latex?0"> and work with the first pair of neurons:</p>
<div class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb49-2">\begin{tikzpicture}</span>
<span id="cb49-3"></span>
<span id="cb49-4">\node[circle, </span>
<span id="cb49-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb49-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb49-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-8"></span>
<span id="cb49-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb49-10">{</span>
<span id="cb49-11">    \node[circle, </span>
<span id="cb49-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb49-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb49-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb49-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-16">        </span>
<span id="cb49-17">}</span>
<span id="cb49-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb49-19">{</span>
<span id="cb49-20">    \node[circle, </span>
<span id="cb49-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb49-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb49-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb49-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-25">        </span>
<span id="cb49-26">}</span>
<span id="cb49-27"></span>
<span id="cb49-28">\node[circle, </span>
<span id="cb49-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb49-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb49-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-32"></span>
<span id="cb49-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb49-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb49-35">{</span>
<span id="cb49-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb49-37">}</span>
<span id="cb49-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb49-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb49-40">{</span>
<span id="cb49-41">    </span>
<span id="cb49-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb49-43">    </span>
<span id="cb49-44">}</span>
<span id="cb49-45"></span>
<span id="cb49-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb49-47">{</span>
<span id="cb49-48">    </span>
<span id="cb49-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb49-50">}</span>
<span id="cb49-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb49-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb49-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb49-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb49-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb49-56">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-42-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Next, we can set the weight for the hidden layer neurons and the output neuron to <img src="https://latex.codecogs.com/png.latex?1.00">, and we can see how this impacts the output:</p>
<div class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb50-2">\begin{tikzpicture}</span>
<span id="cb50-3"></span>
<span id="cb50-4">\node[circle, </span>
<span id="cb50-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb50-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb50-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb50-8"></span>
<span id="cb50-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb50-10">{</span>
<span id="cb50-11">    \node[circle, </span>
<span id="cb50-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb50-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb50-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb50-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb50-16">        </span>
<span id="cb50-17">}</span>
<span id="cb50-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb50-19">{</span>
<span id="cb50-20">    \node[circle, </span>
<span id="cb50-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb50-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb50-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb50-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb50-25">        </span>
<span id="cb50-26">}</span>
<span id="cb50-27"></span>
<span id="cb50-28">\node[circle, </span>
<span id="cb50-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb50-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb50-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb50-32"></span>
<span id="cb50-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb50-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb50-35">{</span>
<span id="cb50-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb50-37">}</span>
<span id="cb50-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb50-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb50-40">{</span>
<span id="cb50-41">    </span>
<span id="cb50-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb50-43">    </span>
<span id="cb50-44">}</span>
<span id="cb50-45"></span>
<span id="cb50-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb50-47">{</span>
<span id="cb50-48">    </span>
<span id="cb50-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb50-50">}</span>
<span id="cb50-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb50-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb50-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb50-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb50-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb50-56">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-43-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The output is:</p>
<div class="cell" data-execution_count="43">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb51-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb51-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb51-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb51-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb51-6">\end{axis}</span>
<span id="cb51-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-44-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can increase the slope of the output by adjusting the weight of the first neuron of the first layer to <img src="https://latex.codecogs.com/png.latex?6.00">.</p>
<div class="cell" data-execution_count="44">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb52-2">\begin{tikzpicture}</span>
<span id="cb52-3"></span>
<span id="cb52-4">\node[circle, </span>
<span id="cb52-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb52-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb52-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb52-8"></span>
<span id="cb52-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb52-10">{</span>
<span id="cb52-11">    \node[circle, </span>
<span id="cb52-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb52-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb52-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb52-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb52-16">        </span>
<span id="cb52-17">}</span>
<span id="cb52-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb52-19">{</span>
<span id="cb52-20">    \node[circle, </span>
<span id="cb52-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb52-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb52-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb52-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb52-25">        </span>
<span id="cb52-26">}</span>
<span id="cb52-27"></span>
<span id="cb52-28">\node[circle, </span>
<span id="cb52-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb52-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb52-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb52-32"></span>
<span id="cb52-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb52-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb52-35">{</span>
<span id="cb52-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb52-37">}</span>
<span id="cb52-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb52-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb52-40">{</span>
<span id="cb52-41">    </span>
<span id="cb52-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb52-43">    </span>
<span id="cb52-44">}</span>
<span id="cb52-45"></span>
<span id="cb52-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb52-47">{</span>
<span id="cb52-48">    </span>
<span id="cb52-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb52-50">}</span>
<span id="cb52-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb52-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb52-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb52-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb52-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb52-56">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-45-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can now see, for example, that the initial slope of this function is what we’d like, but we have a problem.</p>
<div class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb53-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb53-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb53-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb53-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb53-6">\end{axis}</span>
<span id="cb53-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-46-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Currently, this function never ends because this neuron pair never <em>deactivates</em>. We can visually see where we’d like the deactivation to occur. It’s where the red fitment line diverges from our green sine wave. So now, while we have the correct slope, we need to set this spot as our deactivation point. To do that, we start by increasing the bias for the second neuron of the hidden layer to <img src="https://latex.codecogs.com/png.latex?0.70">.</p>
<div class="cell" data-execution_count="46">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb54-2">\begin{tikzpicture}</span>
<span id="cb54-3"></span>
<span id="cb54-4">\node[circle, </span>
<span id="cb54-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb54-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb54-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb54-8"></span>
<span id="cb54-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb54-10">{</span>
<span id="cb54-11">    \node[circle, </span>
<span id="cb54-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb54-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb54-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb54-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb54-16">        </span>
<span id="cb54-17">}</span>
<span id="cb54-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb54-19">{</span>
<span id="cb54-20">    \node[circle, </span>
<span id="cb54-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb54-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb54-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb54-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb54-25">        </span>
<span id="cb54-26">}</span>
<span id="cb54-27"></span>
<span id="cb54-28">\node[circle, </span>
<span id="cb54-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb54-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb54-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb54-32"></span>
<span id="cb54-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb54-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb54-35">{</span>
<span id="cb54-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb54-37">}</span>
<span id="cb54-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb54-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb54-40">{</span>
<span id="cb54-41">    </span>
<span id="cb54-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb54-43">    </span>
<span id="cb54-44">}</span>
<span id="cb54-45"></span>
<span id="cb54-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb54-47">{</span>
<span id="cb54-48">    </span>
<span id="cb54-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb54-50">}</span>
<span id="cb54-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb54-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb54-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb54-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb54-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb54-56">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-47-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Recall, that this offsets the overall function vertically:</p>
<div class="cell" data-execution_count="47">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb55-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb55-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb55-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb55-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb55-6">\end{axis}</span>
<span id="cb55-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-48-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now, we can set the weight for the second neuron to <img src="https://latex.codecogs.com/png.latex?-1">, causing a deactivation point to occur, atleast horizontally, where we want it.</p>
<div class="cell" data-execution_count="48">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb56-2">\begin{tikzpicture}</span>
<span id="cb56-3"></span>
<span id="cb56-4">\node[circle, </span>
<span id="cb56-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb56-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb56-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb56-8"></span>
<span id="cb56-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb56-10">{</span>
<span id="cb56-11">    \node[circle, </span>
<span id="cb56-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb56-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb56-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb56-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb56-16">        </span>
<span id="cb56-17">}</span>
<span id="cb56-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb56-19">{</span>
<span id="cb56-20">    \node[circle, </span>
<span id="cb56-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb56-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb56-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb56-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb56-25">        </span>
<span id="cb56-26">}</span>
<span id="cb56-27"></span>
<span id="cb56-28">\node[circle, </span>
<span id="cb56-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb56-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb56-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb56-32"></span>
<span id="cb56-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb56-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb56-35">{</span>
<span id="cb56-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb56-37">}</span>
<span id="cb56-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb56-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb56-40">{</span>
<span id="cb56-41">    </span>
<span id="cb56-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb56-43">    </span>
<span id="cb56-44">}</span>
<span id="cb56-45"></span>
<span id="cb56-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb56-47">{</span>
<span id="cb56-48">    </span>
<span id="cb56-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb56-50">}</span>
<span id="cb56-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb56-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb56-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb56-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb56-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb56-56">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-49-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We get:</p>
<div class="cell" data-execution_count="49">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb57-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb57-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb57-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb57-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb57-6">\end{axis}</span>
<span id="cb57-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-50-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now, we’d like to flip this slope back. How might we flip the output of these two neurons?</p>
<div class="cell" data-execution_count="50">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb58-2">\begin{tikzpicture}</span>
<span id="cb58-3"></span>
<span id="cb58-4">\node[circle, </span>
<span id="cb58-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb58-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb58-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-8"></span>
<span id="cb58-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb58-10">{</span>
<span id="cb58-11">    \node[circle, </span>
<span id="cb58-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb58-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb58-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb58-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-16">        </span>
<span id="cb58-17">}</span>
<span id="cb58-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb58-19">{</span>
<span id="cb58-20">    \node[circle, </span>
<span id="cb58-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb58-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb58-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb58-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-25">        </span>
<span id="cb58-26">}</span>
<span id="cb58-27"></span>
<span id="cb58-28">\node[circle, </span>
<span id="cb58-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb58-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb58-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb58-32"></span>
<span id="cb58-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb58-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb58-35">{</span>
<span id="cb58-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb58-37">}</span>
<span id="cb58-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb58-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb58-40">{</span>
<span id="cb58-41">    </span>
<span id="cb58-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb58-43">    </span>
<span id="cb58-44">}</span>
<span id="cb58-45"></span>
<span id="cb58-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb58-47">{</span>
<span id="cb58-48">    </span>
<span id="cb58-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb58-50">}</span>
<span id="cb58-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb58-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb58-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb58-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb58-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb58-56">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-51-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>It seems like we can take the weights of the connection to the output neuron, which is currently <img src="https://latex.codecogs.com/png.latex?1.0"> and just flip it to a <img src="https://latex.codecogs.com/png.latex?-1">, and that flips the function:</p>
<div class="cell" data-execution_count="51">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb59-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb59-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb59-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb59-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb59-6">\end{axis}</span>
<span id="cb59-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="51">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-52-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We’re certainly getting closer to making this first section fit how we want. Now, all we need to do is offset this up a bit. For this hand-optimized example, we’re going to use the first <img src="https://latex.codecogs.com/png.latex?7"> pairs of neurons in the hidden layers to create the sine wave’s shape.</p>
<div class="cell" data-execution_count="52">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb60-2">\begin{tikzpicture}</span>
<span id="cb60-3"></span>
<span id="cb60-4">\node[circle, </span>
<span id="cb60-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb60-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb60-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb60-8"></span>
<span id="cb60-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb60-10">{</span>
<span id="cb60-11">    \node[circle, </span>
<span id="cb60-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb60-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb60-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb60-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb60-16">        </span>
<span id="cb60-17">}</span>
<span id="cb60-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb60-19">{</span>
<span id="cb60-20">    \node[circle, </span>
<span id="cb60-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb60-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb60-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb60-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb60-25">        </span>
<span id="cb60-26">}</span>
<span id="cb60-27"></span>
<span id="cb60-28">\node[circle, </span>
<span id="cb60-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb60-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb60-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb60-32"></span>
<span id="cb60-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb60-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb60-35">{</span>
<span id="cb60-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb60-37">}</span>
<span id="cb60-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb60-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb60-40">{</span>
<span id="cb60-41">    </span>
<span id="cb60-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb60-43">    </span>
<span id="cb60-44">}</span>
<span id="cb60-45"></span>
<span id="cb60-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb60-47">{</span>
<span id="cb60-48">    </span>
<span id="cb60-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb60-50">}</span>
<span id="cb60-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb60-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb60-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb60-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb60-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb60-56"></span>
<span id="cb60-57">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb60-58">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb60-59">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb60-60">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb60-61">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb60-62">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-53-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If we set the bias of the second neuron in the bottom pair to <img src="https://latex.codecogs.com/png.latex?1.0"> and the weight to the output neuron to <img src="https://latex.codecogs.com/png.latex?0.70">, we can vertically shift the line like so:</p>
<div class="cell" data-execution_count="53">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb61-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb61-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb61-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb61-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb61-6">\end{axis}</span>
<span id="cb61-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="53">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-54-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>At this point, we have completed the first section with an “area of effect” being the first upward section of the sine wave. We can start on the next section that we wish to do. We can start on the next section that we wish to do. We can start by setting all weights for this second pair of neurons to <img src="https://latex.codecogs.com/png.latex?1"> including the output neuron.</p>
<div class="cell" data-execution_count="54">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb62-2">\begin{tikzpicture}</span>
<span id="cb62-3"></span>
<span id="cb62-4">\node[circle, </span>
<span id="cb62-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb62-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb62-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb62-8"></span>
<span id="cb62-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb62-10">{</span>
<span id="cb62-11">    \node[circle, </span>
<span id="cb62-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb62-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb62-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb62-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb62-16">        </span>
<span id="cb62-17">}</span>
<span id="cb62-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb62-19">{</span>
<span id="cb62-20">    \node[circle, </span>
<span id="cb62-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb62-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb62-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb62-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb62-25">        </span>
<span id="cb62-26">}</span>
<span id="cb62-27"></span>
<span id="cb62-28">\node[circle, </span>
<span id="cb62-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb62-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb62-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb62-32"></span>
<span id="cb62-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb62-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb62-35">{</span>
<span id="cb62-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb62-37">}</span>
<span id="cb62-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb62-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb62-40">{</span>
<span id="cb62-41">    </span>
<span id="cb62-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb62-43">    </span>
<span id="cb62-44">}</span>
<span id="cb62-45"></span>
<span id="cb62-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb62-47">{</span>
<span id="cb62-48">    </span>
<span id="cb62-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb62-50">}</span>
<span id="cb62-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb62-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-56"></span>
<span id="cb62-57">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-58">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-59">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-60">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-61">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-62"></span>
<span id="cb62-63">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-64">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-65">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-66">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-67">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb62-68">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-55-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>At this point, this second pair of neurons activation is beginning too soon, which is impacting the area of effect of the top pair we already aligned.</p>
<div class="cell" data-execution_count="55">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb63-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb63-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb63-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb63-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb63-6">\end{axis}</span>
<span id="cb63-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-56-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To fix this, we want this second pair to start influencing the output where the first pair deactivates, so we want to adjust the function horizontally. As you can recall from earlier, we adjust the first neuron’s bias in this neuron pair to achieve this. Also, to modify the slope, we’ll set the weight coming into that first neuron for the second pair, setting it to <img src="https://latex.codecogs.com/png.latex?3.50">.</p>
<div class="cell" data-execution_count="56">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb64-2">\begin{tikzpicture}</span>
<span id="cb64-3"></span>
<span id="cb64-4">\node[circle, </span>
<span id="cb64-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb64-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb64-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb64-8"></span>
<span id="cb64-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb64-10">{</span>
<span id="cb64-11">    \node[circle, </span>
<span id="cb64-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb64-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb64-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb64-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb64-16">        </span>
<span id="cb64-17">}</span>
<span id="cb64-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb64-19">{</span>
<span id="cb64-20">    \node[circle, </span>
<span id="cb64-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb64-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb64-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb64-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb64-25">        </span>
<span id="cb64-26">}</span>
<span id="cb64-27"></span>
<span id="cb64-28">\node[circle, </span>
<span id="cb64-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb64-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb64-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb64-32"></span>
<span id="cb64-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb64-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb64-35">{</span>
<span id="cb64-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb64-37">}</span>
<span id="cb64-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb64-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb64-40">{</span>
<span id="cb64-41">    </span>
<span id="cb64-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb64-43">    </span>
<span id="cb64-44">}</span>
<span id="cb64-45"></span>
<span id="cb64-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb64-47">{</span>
<span id="cb64-48">    </span>
<span id="cb64-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb64-50">}</span>
<span id="cb64-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb64-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-56"></span>
<span id="cb64-57">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-58">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-59">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-60">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-61">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-62"></span>
<span id="cb64-63">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.50</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-64">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) node [below] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.42</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-65">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-66">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-67">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb64-68">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-57-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>After these adjustments:</p>
<div class="cell" data-execution_count="57">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb65-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb65-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb65-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.50</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.42</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb65-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb65-6">\end{axis}</span>
<span id="cb65-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-58-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We will now use the same methodology as we did with the first pair of neurons to set the deactivation point. We set the weight for the second neuron in the hidden layer pair to <img src="https://latex.codecogs.com/png.latex?-1.00"> and the bias to <img src="https://latex.codecogs.com/png.latex?0.27">.</p>
<div class="cell" data-execution_count="58">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb66-2">\begin{tikzpicture}</span>
<span id="cb66-3"></span>
<span id="cb66-4">\node[circle, </span>
<span id="cb66-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb66-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb66-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb66-8"></span>
<span id="cb66-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb66-10">{</span>
<span id="cb66-11">    \node[circle, </span>
<span id="cb66-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb66-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb66-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb66-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb66-16">        </span>
<span id="cb66-17">}</span>
<span id="cb66-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb66-19">{</span>
<span id="cb66-20">    \node[circle, </span>
<span id="cb66-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb66-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb66-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb66-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb66-25">        </span>
<span id="cb66-26">}</span>
<span id="cb66-27"></span>
<span id="cb66-28">\node[circle, </span>
<span id="cb66-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb66-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb66-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb66-32"></span>
<span id="cb66-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb66-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb66-35">{</span>
<span id="cb66-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb66-37">}</span>
<span id="cb66-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb66-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb66-40">{</span>
<span id="cb66-41">    </span>
<span id="cb66-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb66-43">    </span>
<span id="cb66-44">}</span>
<span id="cb66-45"></span>
<span id="cb66-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb66-47">{</span>
<span id="cb66-48">    </span>
<span id="cb66-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb66-50">}</span>
<span id="cb66-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb66-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-56"></span>
<span id="cb66-57">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-58">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-59">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-60">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-61">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-62"></span>
<span id="cb66-63">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.50</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-64">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) node [below] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.42</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-65">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-66">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-67">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb66-68">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="58">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-59-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This results in:</p>
<div class="cell" data-execution_count="59">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb67-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb67-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb67-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.50</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.42</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb67-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb67-6">\end{axis}</span>
<span id="cb67-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-60-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Then, we can flip this section’s function again the same way we did with the first one, by setting the weight to the output neuron from <img src="https://latex.codecogs.com/png.latex?1.0"> to <img src="https://latex.codecogs.com/png.latex?-1.0">.</p>
<div class="cell" data-execution_count="60">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb68-2">\begin{tikzpicture}</span>
<span id="cb68-3"></span>
<span id="cb68-4">\node[circle, </span>
<span id="cb68-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb68-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb68-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb68-8"></span>
<span id="cb68-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb68-10">{</span>
<span id="cb68-11">    \node[circle, </span>
<span id="cb68-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb68-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb68-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb68-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb68-16">        </span>
<span id="cb68-17">}</span>
<span id="cb68-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb68-19">{</span>
<span id="cb68-20">    \node[circle, </span>
<span id="cb68-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb68-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb68-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb68-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb68-25">        </span>
<span id="cb68-26">}</span>
<span id="cb68-27"></span>
<span id="cb68-28">\node[circle, </span>
<span id="cb68-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb68-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb68-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb68-32"></span>
<span id="cb68-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb68-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb68-35">{</span>
<span id="cb68-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb68-37">}</span>
<span id="cb68-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb68-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb68-40">{</span>
<span id="cb68-41">    </span>
<span id="cb68-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb68-43">    </span>
<span id="cb68-44">}</span>
<span id="cb68-45"></span>
<span id="cb68-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb68-47">{</span>
<span id="cb68-48">    </span>
<span id="cb68-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb68-50">}</span>
<span id="cb68-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb68-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-56"></span>
<span id="cb68-57">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-58">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-59">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-60">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-61">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-62"></span>
<span id="cb68-63">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.50</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-64">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) node [below] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.42</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-65">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-66">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-67">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb68-68">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-61-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Consequently, we have:</p>
<div class="cell" data-execution_count="61">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb69-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb69-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb69-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.50</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.42</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb69-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb69-6">\end{axis}</span>
<span id="cb69-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-62-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>And again, just like the first pair, we use the bottom pair to fix the vertical offset.</p>
<div class="cell" data-execution_count="62">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb70-2">\begin{tikzpicture}</span>
<span id="cb70-3"></span>
<span id="cb70-4">\node[circle, </span>
<span id="cb70-5">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb70-6">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb70-7">    ] (Input) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $x_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb70-8"></span>
<span id="cb70-9">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb70-10">{</span>
<span id="cb70-11">    \node[circle, </span>
<span id="cb70-12">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb70-13">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb70-14">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb70-15">        ] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb70-16">        </span>
<span id="cb70-17">}</span>
<span id="cb70-18">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>}</span>
<span id="cb70-19">{</span>
<span id="cb70-20">    \node[circle, </span>
<span id="cb70-21">        minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb70-22">        fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>,</span>
<span id="cb70-23">        yshift<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> mm</span>
<span id="cb70-24">        ] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) at (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.0</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {\large $h_\i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>{(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)}$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb70-25">        </span>
<span id="cb70-26">}</span>
<span id="cb70-27"></span>
<span id="cb70-28">\node[circle, </span>
<span id="cb70-29">    minimum size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">mm</span>,</span>
<span id="cb70-30">    fill<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>red<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb70-31">    ] (Output) at (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {\large $\hat{y}_1$}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb70-32"></span>
<span id="cb70-33"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons In<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden1</span>
<span id="cb70-34">\foreach \j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb70-35">{</span>
<span id="cb70-36">    \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\j)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb70-37">}</span>
<span id="cb70-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> Connect neurons Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Hidden2</span>
<span id="cb70-39">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb70-40">{</span>
<span id="cb70-41">    </span>
<span id="cb70-42">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb70-43">    </span>
<span id="cb70-44">}</span>
<span id="cb70-45"></span>
<span id="cb70-46">\foreach \i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> {<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>}</span>
<span id="cb70-47">{</span>
<span id="cb70-48">    </span>
<span id="cb70-49">        \draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>\i) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb70-50">}</span>
<span id="cb70-51">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>   </span>
<span id="cb70-52">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-53">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-54">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-55">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-56"></span>
<span id="cb70-57">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-58">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-59">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-60">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-61">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.97</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-62"></span>
<span id="cb70-63">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Input) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.50</span>$} (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-64">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) node [below] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.42</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-65">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway,above] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-66">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) node [below] {$<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>$} <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>  (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-67">\draw[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span>, shorten <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">pt</span>] (Hidden2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span> node [midway] {$<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.00</span>$} (Output)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb70-68">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-63-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We get:</p>
<div class="cell" data-execution_count="63">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>itikz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>temp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dir</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tex<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>packages<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tikz,pgfplots <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>tikz<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>libraries<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>implicit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>standalone</span>
<span id="cb71-2">\begin{tikzpicture}[scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>]</span>
<span id="cb71-3">\begin{axis}[grid,ymin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ymax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,ytick<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>},xmin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,xmax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb71-4">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blue,thick,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]{<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.70</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.97</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.50</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.42</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb71-5">\addplot[color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>green,samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,domain<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]{sin(deg(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x))}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb71-6">\end{axis}</span>
<span id="cb71-7">\end{tikzpicture}</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>
<figure class="figure">
<p><img src="https://quantdev.blog/posts/coding-a-neural-network-layer/index_files/figure-html/cell-64-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We then just continue this methodology. It should begin to make more sense to you now, how more neurons can enable more unique areas of effect, why we need two or more hidden layers, and why we need nonlinear activation functions to map nonlinear problems.</p>
<p>We can write a <code>ReLUActivation</code> class to represent the ReLU activation function:</p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> ReLUActivation:</span>
<span id="cb72-2"></span>
<span id="cb72-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb72-4">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, inputs):</span>
<span id="cb72-5">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate output values from the inputs</span></span>
<span id="cb72-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.maximum(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, inputs)</span></code></pre></div>
</div>
<p>Let’s apply this activation function to the <code>DenseLayer</code>’s outputs in our code:</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> nnfs.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> spiral_data</span>
<span id="cb73-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb73-3"></span>
<span id="cb73-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create dataset</span></span>
<span id="cb73-5">X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spiral_data(samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb73-6"></span>
<span id="cb73-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create Dense layer with 2 input features and 3 output values</span></span>
<span id="cb73-8">dense1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb73-9"></span>
<span id="cb73-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create ReLU activation function (to be used with the DenseLayer)</span></span>
<span id="cb73-11">activation1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ReLUActivation()</span>
<span id="cb73-12"></span>
<span id="cb73-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make a forward pass of our training data through this layer</span></span>
<span id="cb73-14">dense1.forward(X)</span>
<span id="cb73-15"></span>
<span id="cb73-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass through our activation function</span></span>
<span id="cb73-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Takes in output from the previous layer</span></span>
<span id="cb73-18">activation1.forward(dense1.output)</span>
<span id="cb73-19"></span>
<span id="cb73-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's see output of the first few samples</span></span>
<span id="cb73-21"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(activation1.output[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.0000000e+00 0.0000000e+00 0.0000000e+00]
 [1.3520580e-04 1.8173116e-05 0.0000000e+00]
 [2.3245417e-04 0.0000000e+00 0.0000000e+00]
 [3.8226307e-04 0.0000000e+00 0.0000000e+00]
 [5.7436468e-04 0.0000000e+00 0.0000000e+00]]</code></pre>
</div>
</div>
<p>As we can see, negative values have been clipped (modified to zero). That’s all there is to the rectified linear activation function used in the hidden layer. Let’s talk about the activation function that we are going to use on the output of the last layer.</p>
</section>
<section id="the-softmax-activation-function" class="level2">
<h2 class="anchored" data-anchor-id="the-softmax-activation-function">The Softmax Activation function</h2>
<p>In our case, we’re looking to get this model to be a classifier, so we want an activation function meant for classification. One of these is the softmax activation function. First, why are we bothering with another activation function? It just depends on what our overall goals are.</p>
<p>The rectified linear unit is unbounded, not normalized with other units and exclusive. “Not normalized” implies the values can be anything, an output of <code>[12,99,318]</code> is without context, and exclusive means each output is independent of others. To address this lack of context, the softmax activation function on the output data can take in non-normalized, or uncalibrated, inputs and produce a normalized distribution of probabilities for our classes. In the case of classification, what we want to see is a prediction of which class the network thinks the input represents. This distribution returned by the softmax activation function represents confidence scores in our overarching algorithm/program that uses this network. For example, if our network has a confidence distirbution for two classes <img src="https://latex.codecogs.com/png.latex?%5B0.45,0.55%5D">, the prediction is the <img src="https://latex.codecogs.com/png.latex?2">nd class, but the confidence in this prediction isn’t very high.</p>
<p>Maybe our program wouldn’t act in this case, since it’s not very confident.</p>
<p>The softmax function takes as input a vector of <img src="https://latex.codecogs.com/png.latex?L"> real numbers and normalizes it into a probability distribution consisting of <img src="https://latex.codecogs.com/png.latex?L"> probabilities proportional to the exponentials of the input numbers.</p>
<p><em>Definition</em>. The standard(unit) <strong>softmax</strong> function <img src="https://latex.codecogs.com/png.latex?%5Csigma:%5Cmathbf%7BR%7D%5EL%20%5Cto%20(0,1)%5EL"> takes a vector <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bz%7D=(z_1,%5Cldots,z_l)%5Cin%5Cmathbf%7BR%7D%5EL"> and computes each component of the vector <img src="https://latex.codecogs.com/png.latex?%5Csigma(%5Cmathbf%7Bz%7D)%5Cin(0,1)%5EL"> with:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Csigma(%5Cmathbf%7Bz%7D)_i%20=%20%5Cfrac%7Be%5E%7Bz_%7Bi%7D%7D%7D%7B%5Csum_%7Bl=1%7D%5E%7BL%7De%5E%7Bz_%7Bl%7D%7D%7D%0A%5Cend%7Balign*%7D"></p>
<p>That might look daunting, but it’s easy to follow. Suppose the example outputs from a neural network layer are:</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1">layer_outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.80</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.21</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.385</span>]</span></code></pre></div>
</div>
<p>Then, the normalized values are:</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb76-2"></span>
<span id="cb76-3">norm_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.exp(layer_outputs)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(np.exp(layer_outputs))</span>
<span id="cb76-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(norm_values)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.89528266 0.02470831 0.08000903]</code></pre>
</div>
</div>
<p>To train in batches, we need to convert this functionality to accept layer outputs in batches. Do this is easy:</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1">layer_outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.randn(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb78-2">norm_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.exp(layer_outputs)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(np.exp(layer_outputs),axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,keepdims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</div>
<p>We can now write a <code>SoftmaxActivation</code> class as:</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Softmax activation</span></span>
<span id="cb79-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> SoftmaxActivation:</span>
<span id="cb79-3"></span>
<span id="cb79-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb79-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, inputs):</span>
<span id="cb79-6">        exp_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.exp(inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(inputs, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, keepdims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>))</span>
<span id="cb79-7">        probabilities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(exp_values, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, keepdims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb79-8">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> probabilities</span></code></pre></div>
</div>
<p>We also included a subtraction of the largest of the inputs before we do the exponentiation. This does not affect the output of the softmax function, since:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Balign*%7D%0A%5Cfrac%7Be%5E%7Bz_%7Bi%7D-%7C%7C%5Cmathbf%7Bz%7D%7C%7C%7D%7D%7B%5Csum_%7Bl=1%7D%5E%7BL%7De%5E%7Bz_%7Bl%7D-%7C%7C%5Cmathbf%7Bz%7D%7C%7C%7D%7D%20=%20%5Cfrac%7Be%5E%7B-%7C%7C%5Cmathbf%7Bz%7D%7C%7C%7D%5Ccdot%20e%5E%7Bz_%7Bi%7D%7D%7D%7Be%5E%7B-%7C%7C%5Cmathbf%7Bz%7D%7C%7C%7D%5Ccdot%20%5Csum_%7Bl=1%7D%5E%7BL%7De%5E%7Bz_%7Bl%7D%7D%7D%20=%20%5Csigma(%5Cmathbf%7Bz%7D)_i%0A%5Cend%7Balign*%7D"></p>
<p>There are two main pervasive challenges with neural networks : dead neurons and very large numbers (referred to as exploding values). Dead neurons and enormous numbers can wreak havoc down the line and render a network useless over time.</p>
</section>
<section id="the-output-layer" class="level2">
<h2 class="anchored" data-anchor-id="the-output-layer">The output layer</h2>
<p>Now, we can add another <code>DenseLayer</code> as the output layer, setting it to contain as many inputs as the previous layer outputs and as many outputs as our data includes classes. Then, we can apply the softmax function to the output of this new layer.</p>
<section id="full-code-upto-this-point" class="level3">
<h3 class="anchored" data-anchor-id="full-code-upto-this-point">Full code upto this point</h3>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb80-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> nnfs</span>
<span id="cb80-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> nnfs.datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> spiral_data</span>
<span id="cb80-4"></span>
<span id="cb80-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> DenseLayer:</span>
<span id="cb80-6"></span>
<span id="cb80-7">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, n_inputs, n_neurons):</span>
<span id="cb80-8">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize all weights and biases</span></span>
<span id="cb80-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.random.randn(n_inputs,n_neurons)</span>
<span id="cb80-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.biases <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,n_neurons))</span>
<span id="cb80-11">    </span>
<span id="cb80-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, inputs):</span>
<span id="cb80-13">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dot(inputs,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.weights) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.biases</span>
<span id="cb80-14"></span>
<span id="cb80-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> ReLUActivation:</span>
<span id="cb80-16"></span>
<span id="cb80-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb80-18">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, inputs):</span>
<span id="cb80-19">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.maximum(inputs, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb80-20"></span>
<span id="cb80-21"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> SoftmaxActivation:</span>
<span id="cb80-22"></span>
<span id="cb80-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Forward pass</span></span>
<span id="cb80-24">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,inputs):</span>
<span id="cb80-25">        exp_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.exp(inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(inputs, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, keepdims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>))</span>
<span id="cb80-26">        probabilities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> exp_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(exp_values, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, keepdims<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb80-27">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> probabilities</span>
<span id="cb80-28"></span>
<span id="cb80-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create dataset</span></span>
<span id="cb80-30">X, y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> spiral_data(samples<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb80-31"></span>
<span id="cb80-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a DenseLayer with 2 input features and 3 neurons</span></span>
<span id="cb80-33">dense1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb80-34"></span>
<span id="cb80-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create ReLU Activation (to be used with DenseLayer)</span></span>
<span id="cb80-36">activation1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ReLUActivation()</span>
<span id="cb80-37"></span>
<span id="cb80-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a second DenseLayer with 3 input features and 3 output values</span></span>
<span id="cb80-39">dense2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DenseLayer(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb80-40"></span>
<span id="cb80-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create Softmax activation to be used with the output layer</span></span>
<span id="cb80-42">activation2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SoftmaxActivation()</span>
<span id="cb80-43"></span>
<span id="cb80-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make a forward pass of our training data through this layer</span></span>
<span id="cb80-45">dense1.forward(X)</span>
<span id="cb80-46"></span>
<span id="cb80-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make a forward pass through the activation function </span></span>
<span id="cb80-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># It takes the output of the first dense layer</span></span>
<span id="cb80-49">activation1.forward(dense1.output)</span>
<span id="cb80-50"></span>
<span id="cb80-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make a forward pass through the second DenseLayer</span></span>
<span id="cb80-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># It takes outputs of the activation function of the first layer</span></span>
<span id="cb80-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># as inputs</span></span>
<span id="cb80-54">dense2.forward(activation1.output)</span>
<span id="cb80-55"></span>
<span id="cb80-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make a forward pass through activation function</span></span>
<span id="cb80-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># It takes outputs of the second dense layer</span></span>
<span id="cb80-58">activation2.forward(dense2.output)</span>
<span id="cb80-59"></span>
<span id="cb80-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Let's see output of the first few examples</span></span>
<span id="cb80-61"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(activation2.output[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.33333334 0.33333334 0.33333334]
 [0.33333322 0.3333335  0.33333322]
 [0.3333332  0.3333332  0.3333336 ]
 [0.3333332  0.3333336  0.3333332 ]
 [0.33333287 0.33333436 0.33333275]]</code></pre>
</div>
</div>
<p>We’ve completed what we need for forward-passing data through the model.</p>
<p>Our example model is currently random. To remedy this, we need a way to calculate how wrong the neural network is at current predictions and begin adjusting weights and biases to decrease error over time. Thus, our next step is to quantify how wrong the model is through what’s defined as a <strong>loss function</strong>.</p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>Machine Learning</category>
  <guid>https://quantdev.blog/posts/coding-a-neural-network-layer/</guid>
  <pubDate>Mon, 27 May 2024 23:00:00 GMT</pubDate>
  <media:content url="https://quantdev.blog/posts/coding-a-neural-network-layer/image.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
