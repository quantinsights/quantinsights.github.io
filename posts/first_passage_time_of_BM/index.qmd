---
title: "The distribution of the first passage time of Brownian Motion"
author: "Quasar"
date: "2024-07-02"
categories: [Stochastic Calculus]      
image: "image.jpg"
toc: true
toc-depth: 3
---

The distribution of Brownian motion enjoys many interesting symmetries. The reflection of a Brownian motion about any time $s$ is also a Brownian motion. 

*Lemma 1.* (*Reflection at time $s$*) Let $B_t$ be a standard Brownian motion. Then, the process $(-B_t,t \geq 0)$ is a Brownian motion. More generally, for any $s \geq 0$, the process $(\tilde{B_t},t\geq 0)$ defined by:

\begin{align*}
\tilde{B}_t = \begin{cases}
B_t & \text{ if } t\leq s\\
B_s - (B_t - B_s) & \text{ if }t > s
\end{cases}
\end{align*}

is a Brownian motion.

*Claim*. $(-B_t,t\geq 0)$ is a Brownian motion.

*Proof*.

We have, $-B(0) = 0$.

For any increment $s < t$, the increment $(-B_t) - (-B_s) = B_s - B_t$ is a Gaussian random variable with mean $0$ and variance $t - s$.

For any choice of $n$ times, $0 \leq t_1 \leq t_2 \leq \ldots \leq t_n$, the increments:

\begin{align*} 
(B_{0} - B_{t_1}), (B_{t_1} - B_{t_2}), \ldots, (B_{t_n} - B_{t_{n-1}})
\end{align*}

are independent

The paths $-B_t(\omega)$ are continuous.

Thus, $(-B_t,t\geq 0)$ is a standard Brownian motion.

*Claim*. $(\tilde{B_t},t\geq 0)$ is a Brownian motion.

*Proof*.

Let $s \geq 0$ be any arbitrary time. 

We have, $\tilde{B}(0) = 0$.

Consider any increment $\tilde{B}(t_2) - \tilde{B}(t_1)$, $t_2 < t_1$. 

Case I. $s \leq t_1 < t_2$

Here 

\begin{align*}
\tilde{B}(t_2) - \tilde{B}(t_1) &= B(s) - (B(t_2) - B(s)) - (B(s) - (B(t_1) - B(s))) \\
&= -(B(t_2) - B(t_1))
\end{align*}

Hence, $\tilde{B}(t_2) - \tilde{B}(t_1) \sim \mathcal{N}(0,t_2 - t_1)$.

Case II. $t_1 < s < t_2$

Here 

\begin{align*}
\tilde{B}(t_2) - \tilde{B}(t_1) &= B(s) - (B(t_2) - B(s)) - B(t_1)\\
&= (B(s) - B(t_1)) - (B(t_2) - B(s))
\end{align*}

$B(s) - B(t_1)$ and $B(t_2) - B(s)$ are independent random variables. Moreover, $B(s) - B(t_1) \sim \mathcal{N}(0,s - t_1)$ and $B(t_2) - B(s) \sim \mathcal{N}(0,t_2 - s)$. Consequently, $\tilde{B}(t_2) - \tilde{B}(t_1) \sim \mathcal{N}(0,t_2 - t_1)$.

Case III. $t_1 < t_2 \leq s$

Here

\begin{align*}
\tilde{B}(t_2) - \tilde{B}(t_1) &= B(t_2) - B(t_1)
\end{align*}

so $\tilde{B}(t_2) - \tilde{B}(t_1) \sim \mathcal{N}(0,t_2 - t_1)$. 

Finally, the paths $\tilde{B}(t,\omega)$ are continuous. Hence, $(\tilde{B}(t),t\geq 0)$ is a standard brownian motion.

## Reflection Principle

It turns out that the above reflection property holds even if $s$ is replaced by a stopping time.


It is an amazing fact, that some simple manipulations using stopping time yield the complete distribution of the first passage time $\tau_a$ of a Brownian motion as well as the distribution of the running maximum of the Brownian path on an interval of time $[0,T]$. This is surprising since the maximum of the Brownian path on $[0,T]$, denoted by $\sup_{0\leq t \leq T} B_t$ is a random variable that depends on the whole path on $[0,T]$. This beautiful result is due to Bachelier.

*Proposition 1.* (*Bachelier's formula*) Let $(B_t,t\leq T)$ be a standard Brownian motion on $[0,T]$. Then, the CDF of the random variable $\sup_{0 \leq t\leq T} B_t$ is:

\begin{align*}
\mathbb{P}\left(\sup_{0\leq t \leq T} B_t \leq a\right) = \mathbb{P}(|B_T| \leq a) \quad \text{ for any }a\geq 0
\end{align*}

In particular, its PDF is:

\begin{align*}
f_{max}(a) = \frac{2}{\sqrt{2\pi T}} e^{-a^2/2T}
\end{align*}

In other words, the random variable $\sup_{0 \leq t \leq T} B_t$ (the maximum of the brownian motion at any time $t$) has the same distribution as $|B_T|$ (the terminal distribution of the absolute value of the brownian motion). 

This equality holds in distribution for a fixed $t$. As a bonus corollary, we get the distribution of the first passage time at $a$.