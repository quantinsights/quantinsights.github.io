---
title: "Numerical Integration"
author: "Quasar"
date: "2024-11-11"
categories: [Numerical Methods]      
image: "image.jpg"
toc: true
toc-depth: 3
format:
    html:
        code-tools: true
        code-block-border-left: true
        code-annotations: below
        highlight-style: pygments
---

## Interpolatory Quadrature Rules

### Introduction

We are interested in an approximate calculation of the definite integral

$$
\begin{align*}
I[f] = \int_{a}^{b}f(x)dx 
\end{align*}
$$ {#eq-definite-integral}

where $f(x)$ is a given function and $[a,b]$ is a finite interval. This problem is often called **numerical quadrature**, since it relates to the ancient problem of the quadrature of a circle i.e. constructing a square with equal area to that of a circle. The computation of the above quantity is equivalent to solving the IVP:

$$
\begin{align*}
y'(x) = f(x), \quad y(a)=0, \quad x \in[a,b]
\end{align*}
$$ {#eq-IVP}

for $y(b)=I[f]$.

As is well known, even many relatively simple integrals cannot be expressed in finite terms of elementary functions, and thus must be evaluated by numerical methods. Even when a closed form analytical solution exists, it may be preferable to use a numerical quadrature formula.

Since $I[f]$ is a linear functional, numerical integration is a special case of the problem of approximating a linear functional. The quadrature rules considered will be of the form 

$$
\begin{align*}
I[f] \approx \sum_{i=1}^n w_if(x_i)
\end{align*}
$$ {#eq-quadrature-rules}

where $x_1 < x_2 < \ldots < x_n$ are distinct **nodes** and $w_1$, $w_2$, $\ldots$, $w_n$ the **corresponding weights**. Often (but not always) all nodes lie in $[a,b]$.

The weights $w_i$ are usually determined so that @eq-quadrature-rules is exact for polynomials of as high degree as possible. The accuracy therefore depends on how well the integrand $f(x)$ can be approximated by a polynomial in $[a,b]$. If the integrand has a singularity, for example, it becomes infinite at some point in or near the interval of integration, some modification is necessary. Another complication arises, when the interval of integration is infinite. In both cases, it may be advantageous to consider a weighted quadrature rule:

$$
\begin{align*}
\int_{a}^b w(x) f(x) dx \approx \sum_{i=1}^n w_i f(x_i)
\end{align*}
$$ {#eq-weighted-quadrature}

Here, $w(x)$ is a **weight function** or a density function that incorporates the singularity so that $f(x)$ can be well approximated by a polynomial. The limits $(a,b)$ of integration are now allowed to be infinite. 

To ensure that the integral in @eq-weighted-quadrature is well-defined when $f(x)$ is a polynomial, we assume that in the following integrals 

$$
\begin{align*}
\mu_k = \int_{a}^b x^k w(x) dx, \quad k=1,2,\ldots
\end{align*}
$$ {#eq-kth-moment}

are well-defined for all $k\geq 0$ and $\mu_0 > 0$. The quantity $\mu_k$ is called the $k$th moment with respect to the weight function $w(x)$. Note that for the formula 