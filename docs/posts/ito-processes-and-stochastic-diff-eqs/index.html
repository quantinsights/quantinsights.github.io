<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Quasar">
<meta name="dcterms.date" content="2024-07-08">

<title>Quant Insights - Ito Processes and Stochastic Differential Equations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9993009899870547" crossorigin="anonymous"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Quant Insights</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Ito Processes and Stochastic Differential Equations</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Stochastic Calculus</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Quasar </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 8, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ito-processes-and-stochastic-differential-equations." id="toc-ito-processes-and-stochastic-differential-equations." class="nav-link active" data-scroll-target="#ito-processes-and-stochastic-differential-equations.">Ito Processes and Stochastic Differential Equations.</a>
  <ul class="collapse">
  <li><a href="#itos-formula." id="toc-itos-formula." class="nav-link" data-scroll-target="#itos-formula.">Ito’s Formula.</a></li>
  <li><a href="#multivariate-extension." id="toc-multivariate-extension." class="nav-link" data-scroll-target="#multivariate-extension.">Multivariate Extension.</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="ito-processes-and-stochastic-differential-equations." class="level1">
<h1>Ito Processes and Stochastic Differential Equations.</h1>
<p>Let’s start with the definition of Ito processes.</p>
<div id="def-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Ito Process) </strong></span>Let <span class="math inline">\((B(t):t\geq0)\)</span> be a standard brownian motion defined on <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span>. An Ito process <span class="math inline">\((X(t):t\geq0)\)</span> is of the form:</p>
<p><span id="eq-ito-process"><span class="math display">\[\begin{aligned}
X(t) &amp; =X(0)+\int_{0}^{t}V(s)dB(s)+\int_{0}^{t}D(s)ds
\end{aligned} \tag{1}\]</span></span></p>
<p>where <span class="math inline">\((V(t),t\geq0)\)</span> and <span class="math inline">\((D(t),t\geq0)\)</span> are two adapted processes for which the integrals make sense in the sense of Ito and Riemann. We refer to <span class="math inline">\((V(t):t\geq0)\)</span> as the <em>local volatility</em> and to <span class="math inline">\((D(t):t\geq0)\)</span> as the <em>local drift</em>.</p>
</div>
<p>We will often denote an Ito process <span class="math inline">\((X(t):t\geq0)\)</span> in differential form as:</p>
<p><span id="eq-ito-process-differential-form"><span class="math display">\[\begin{aligned}
dX(t) &amp; =D(t)dt+V(t)dB(t)
\end{aligned} \tag{2}\]</span></span></p>
<p>This form makes no rigorous sense; when we write it, we mean <a href="#eq-ito-process">Equation&nbsp;1</a>. Nevertheless, the differential equation has two great advantages:</p>
<p>(1) It gives some intuition on what drives the variation of <span class="math inline">\(X(t)\)</span>. On one hand, there is a contribution of the Brownian increments which are modulated by the volatility <span class="math inline">\(V(t)\)</span>. On the other hand, there is a smoother contribution coming from the time variation which is modulated by the drift <span class="math inline">\(D(t)\)</span>.</p>
<p>(2) The differential notation has computational power. In particular, evaluating Ito’s formula is reduced to computing differentials, as in classical calculus, but by doing it upto the second order.</p>
<p>An important class of Ito processes is given by processes for which the volatility and the drift are simply functions of the position of the process.</p>
<div id="def-time-homogenous-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2 </strong></span>Let <span class="math inline">\((B(t):t\geq0)\)</span> be a standard Brownian motion. An Ito process <span class="math inline">\((X(t):t\geq0)\)</span> of the form</p>
<p><span id="eq-time-homogenous-ito-process"><span class="math display">\[\begin{aligned}
dX(t) &amp; =\mu(X(t))dt+\sigma(X(t))dB(t),\quad X(0)=x
\end{aligned} \tag{3}\]</span></span></p>
<p>where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are functions from <span class="math inline">\(\mathbf{R}\)</span> to <span class="math inline">\(\mathbf{R}\)</span>, is called a time-homogenous diffusion.</p>
</div>
<div id="def-time-inhomogenous-ito-process" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3 </strong></span>An Ito-process <span class="math inline">\((Y(t),t\geq0)\)</span> of the form:</p>
<p><span id="eq-time-inhomogenous-SDE"><span class="math display">\[\begin{aligned}
{1}
dY(t) &amp; =\mu(t,X(t))dt+\sigma(t,X(t))dB(t)\quad Y(0)=y
\end{aligned} \tag{4}\]</span></span></p>
<p>where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are now functions <span class="math inline">\([0,\infty)\times\mathbf{R}\to\mathbf{R}\)</span> is called a time-inhomogenous diffusion.</p>
</div>
<p>The equations above are called <em>stochastic differential equations</em> (SDE) of the respective process <span class="math inline">\((X(t))\)</span> and <span class="math inline">\((Y(t))\)</span>.</p>
<p>In other words, a diffusion <span class="math inline">\((X(t),t\geq 0)\)</span> is called an Ito process whose local volatility <span class="math inline">\(V(t)\)</span> and local drift <span class="math inline">\(D(t)\)</span> at time <span class="math inline">\(t\)</span> depend only on the position of the process at time <span class="math inline">\(t\)</span> and possibly on the time <span class="math inline">\(t\)</span> itself. It cannot depend on the path of the process before time <span class="math inline">\(t\)</span> or on the explicit values of the driving Brownian motion at that time (which is not the process <span class="math inline">\(X(t)\)</span> itself). The class of diffusions, and of the Ito processes in general, constitutes a huge collection of stochastic processes for stochastic modelling.</p>
<p>Note that an SDE is a generalization of ordinary differential equations or ODEs. Indeed, if there were no randomness, that is, no Brownian motion, the SDE would be reduced to</p>
<p><span class="math display">\[\begin{aligned}
dX(t) &amp; =\mu(X(t))dt
\end{aligned}\]</span></p>
<p>This can be written for <span class="math inline">\(X(t)=f(t)\)</span> as:</p>
<p><span class="math display">\[\begin{aligned}
\frac{df}{dt} &amp; =\mu(f)
\end{aligned}\]</span></p>
<p>This is a first-order ordinary differential equation. It governs the deterministic evolution of the function <span class="math inline">\(X(t)=f(t)\)</span> in time. An SDE adds a random term to this evolution that is formally written as:</p>
<p><span class="math display">\[\begin{aligned}
\frac{dX}{dt} &amp; =\mu(X(t))+\sigma(X(t))\frac{dB(t)}{dt}
\end{aligned}\]</span></p>
<p>We know very well, that Brownian motion is not differentiable; hence the above is not well-defined. The ill-defined term <span class="math inline">\(dB(t)/dt\)</span> is sometimes called white noise. However, equation <a href="#eq-time-homogenous-ito-process">Equation&nbsp;3</a> is well-defined in the sense of the Ito process. These types of equations are well-suited to model phenomena with intrinsic randomness.</p>
<p>Here are some examples of diffusions:</p>
<div id="exm-brownian-motion-with-a-drift" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 </strong></span>(Brownian Motion with a drift). If we take <span class="math inline">\(X(t)=\sigma B(t)+\mu t\)</span> for some <span class="math inline">\(\sigma&gt;0\)</span> and <span class="math inline">\(\mu\in\mathbf{R}\)</span>, then we can write <span class="math inline">\(X(t)\)</span> as:</p>
<p><span class="math display">\[\begin{aligned}
X(t) &amp; =\int_{0}^{t}\sigma dB(t)+\int_{0}^{t}\mu dt,\quad X(0)=0
\end{aligned}\]</span></p>
<p>In the differential form this becomes</p>
<p><span class="math display">\[\begin{aligned}
dX(t) &amp; =\mu dt+\sigma dB(t)
\end{aligned}\]</span></p>
<p>In this case, the local drift and the local volatility are constant.</p>
</div>
<div id="exm-geometric-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 </strong></span>(Geometric Brownian Motion). We consider the process <span class="math inline">\(S(t)=\exp((\mu-\sigma^{2}/2)t+\sigma B(t))\)</span>. To find the stochastic differential equation, we apply the Ito’s Lemma to</p>
<p><span class="math display">\[\begin{aligned}
f(t,x) &amp; =\exp((\mu-\sigma^{2}/2)t+\sigma x)
\end{aligned}\]</span></p>
<p>We have:</p>
<p><span class="math display">\[\begin{aligned}
df(t,x) &amp; =\left((\mu-\sigma^{2}/2)+\frac{1}{2}\sigma^{2}\right)\exp((\mu-\sigma^{2}/2)t+\sigma x)dt+\sigma\exp((\mu-\sigma^{2}/2)t+\sigma x)dB(t)\\
&amp; =\mu S(t)dt+\sigma S(t)dB(t)
\end{aligned}\]</span></p>
<p>Note that the local drift and the local volatility are now proportional to the position. So, the higher <span class="math inline">\(S(t)\)</span>, the higher the volatility and drift.</p>
</div>
<div id="exm-smooth-function-of-brownian-motion" class="theorem example">
<p><span class="theorem-title"><strong>Example 3 </strong></span>(Any smooth function of Brownian motion). Ito’s formula gurarantees that any smooth function <span class="math inline">\(f(t,B(t))\)</span> of time and a Brownian motion is an Ito process with volatility <span class="math inline">\(V(t)=\partial_{t}f(t,B(t))\)</span> and drift <span class="math inline">\(D(t)=\partial_{x}f(t,B(t))+\frac{1}{2}\partial_{xx}f(t,B(t))\)</span>. We will see in further ahead, that, in general, any reasonable function of an Ito process remains an Ito process.</p>
</div>
<div id="exm-ito-process-that-is-not-a-diffusion" class="theorem example">
<p><span class="theorem-title"><strong>Example 4 </strong></span>(An Ito process that is not a diffusion) Consider the process</p>
<p><span class="math display">\[\begin{aligned}
X(t) &amp; =\int_{0}^{t}B^{2}(s)dB(s)
\end{aligned}\]</span></p>
<p>This is an Ito process with local volatility <span class="math inline">\(V(t)=B(t)^{2}\)</span> and local drift <span class="math inline">\(D(t)=0\)</span>. However, it is not a diffusion, because the local volatility is not an explicit function of <span class="math inline">\(X(t)\)</span>.</p>
<p>It turns out that the Brownian bridge is a time-inhomogenous diffusion and that the Ornstein-Uhlenbeck process is a time-homogenous diffusion. To understand these examples, we need to extend Ito’s formula to Ito processes.</p>
</div>
<section id="itos-formula." class="level2">
<h2 class="anchored" data-anchor-id="itos-formula.">Ito’s Formula.</h2>
<p>The first step towards a general Ito’s formula is the quadratic variation of an Ito process.</p>
<div id="prp-quadratic-variation-of-an-ito-process" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1 (Quadratic variation of an Ito process.) </strong></span>Let <span class="math inline">\((B(t),t\geq0)\)</span> be a standard Brownian motion and <span class="math inline">\((X(t):t\geq0)\)</span> be an Ito process of the form <span class="math inline">\(dX(t)=V(t)dB(t)+D(t)dt\)</span>. Then, the quadratic variation of the process <span class="math inline">\((X(t):t\geq0)\)</span> is:*</p>
<p><span id="eq-quadratic-variation-ito-process"><span class="math display">\[\begin{aligned}
&lt;X,X&gt;_{t} &amp; =\lim_{n\to\infty}\sum_{j=0}^{n-1}(X(t_{j+1})-X(t_{j}))^{2}=\int_{0}^{t}V(s)^{2}ds
\end{aligned} \tag{5}\]</span></span></p>
<p><em>for any partition <span class="math inline">\((t_{j},j\leq n)\)</span> of <span class="math inline">\([0,t]\)</span>, where the limit is in probability.</em></p>
</div>
<div id="rem-remark1">
<p>Note that the quadratic variation is increasing in <span class="math inline">\(t\)</span>, but it is not deterministic in general! <span class="math inline">\(V_t\)</span> is a random variable. The quadratic variation is a smooth stochastic process. (It is differentiable) Observe that we recover the quadratic variation for the Brownian motion for <span class="math inline">\(V(t)=1\)</span> as expected. We also notice that the formula follows easily from the rules of Ito Calculus, thereby showing the consistency of the theory. Indeed we have:</p>
<p><span class="math display">\[\begin{aligned}
d&lt;X,X&gt;_{t} &amp; =(dX(t))^{2}=(V(t)dB(t)+D(t)dt)^{2}\\
&amp; =V(t)^{2}(dB(t))^{2}+2V(t)D(t)dB(t)\cdot dt+D^{2}(t)(dt)^{2}\\
&amp; =V(t)^{2}dt
\end{aligned}\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><em>Proof.</em> The proof is involved, but it reviews some important concepts of stochastic calculus. We prove the case when the process <span class="math inline">\(V\)</span> is in <span class="math inline">\(\mathcal{L}_{c}^{2}(T)\)</span> for some <span class="math inline">\(T&gt;0\)</span>. We write <span class="math inline">\(I(t)=\int_{0}^{t}V(s)dB(s)\)</span> and <span class="math inline">\(R(t)=\int_{0}^{t}D(s)ds\)</span>. We first show that only the Ito integral contributes to the quadratic variation and the Riemann integral does not contribute, so that:</p>
<p><span id="eq-quadratic-variation-ito-process-ii"><span class="math display">\[\begin{aligned}
&lt;X,X&gt;_{t} &amp; =&lt;I,I&gt;_{t}
\end{aligned} \tag{6}\]</span></span></p>
<p>We have that the increment square of <span class="math inline">\(X(t)\)</span> is:</p>
<p><span class="math display">\[\begin{aligned}
(X(t_{j+1})-X(t_{j}))^{2} &amp; =(I(t_{j+1})-I(t_{j}))^{2}+2(I(t_{j+1})-I(t_{j}))(R(t_{j+1})-R(t_{j}))+(R(t_{j+1})-R(t_{j}))^{2}
\end{aligned}\]</span></p>
<p>The Cauchy-Schwarz inequality implies :</p>
<p><span class="math display">\[\begin{aligned}
\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))(R(t_{j+1})-R(t_{j})) &amp; \leq\left(\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}\right)^{1/2}\left(\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2}\right)^{1/2}
\end{aligned}\]</span></p>
<p>Therefore, to prove equation <a href="#eq-quadratic-variation-ito-process">Equation&nbsp;5</a>, it suffices to show that <span class="math inline">\(\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2}\to 0\)</span> almost surely. Since <span class="math inline">\(D(s)\)</span> is an almost surely continuous process, the stochastic process <span class="math inline">\(R(t)=\int_{0}^{t}D(s)ds\)</span> has continuous paths with probability <span class="math inline">\(1\)</span>. Therefore:</p>
<p><span class="math display">\[\begin{aligned}
\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))^{2} &amp; =\max_{1\leq j\leq n}|R(t_{j+1})-R(t_{j})|\sum_{j=0}^{n-1}(R(t_{j+1})-R(t_{j}))
\end{aligned}\]</span></p>
<p>Since, <span class="math inline">\(R(t)\)</span> is continuous on the compact set <span class="math inline">\([0,t]\)</span>, it is uniformly continuous a.s. So, as <span class="math inline">\(|t_{j+1}-t_{j}|\to 0\)</span>, by uniform continuity it follows that <span class="math inline">\(\max|R(t_{j+1})-R(t_{j})|\to 0\)</span> a.s.</p>
<p>It remains to prove that <span class="math inline">\(&lt;I,I&gt;_{t}=\int_{0}^{t}V(s)^{2}ds\)</span>. We first prove the case when <span class="math inline">\(V\in\mathcal{S}(T)\)</span> is a simple adapted process. Consider a partition <span class="math inline">\((t_{j}:j\leq n)\)</span> of <span class="math inline">\([0,t]\)</span>. Without loss of generality, we can suppose that <span class="math inline">\(V\)</span> is constant on each <span class="math inline">\([t_{j},t_{j+1})\)</span> by refining the partition. We then have:</p>
<p><span class="math display">\[\begin{aligned}
\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2} &amp; =\sum_{j=0}^{n-1}V(t_{j})^{2}(B(t_{j+1})-B(t_{j}))^{2}
\end{aligned}\]</span></p>
<p>Now, we have seen in the proof of Ito’s formula that <span class="math inline">\(\mathbb{E}\left[\left\{ \sum_{j=0}^{n-1}V(t_{j})^{2}((B(t_{j+1})-B(t_{j}))^{2}-(t_{j+1}-t_{j})\right\} ^{2}\right]\to 0\)</span>, so <span class="math inline">\(\sum_{j=0}^{n-1}V(t_{j})^{2}(B(t_{j+1})-B(t_{j}))^{2}\)</span> approaches <span class="math inline">\(\sum_{j=0}^{n-1}V(t_{j})^{2}(t_{j+1}-t_{j})\)</span> in the mean square sense. As the mesh size becomes finer, the <span class="math inline">\(L^{2}\)</span>-limit is <span class="math inline">\(\int_{0}^{t}V(t)^{2}dt\)</span>.</p>
<p>The case <span class="math inline">\(V\in\mathcal{L}_{c}^{2}(T)\)</span> is proved by approximating <span class="math inline">\(V\)</span> by a simple process in <span class="math inline">\(\mathcal{S}(T)\)</span>. More precisely, we can find a simple process <span class="math inline">\(V^{(\epsilon)}(t)\)</span> that is <span class="math inline">\(\epsilon\)</span>-close to <span class="math inline">\(V\)</span> in the sense:</p>
<p><span id="eq-sequence-of-simple-processes"><span class="math display">\[\begin{aligned}
||I^{(\epsilon)}-I|| &amp; =||\int V^{\epsilon}dB(t)-\int VdB(t)||=\int_{0}^{t}\mathbb{E}[(V^{(\epsilon)}(t)-V(t))^{2}]ds&lt;\epsilon
\end{aligned} \tag{7}\]</span></span></p>
<p>To prove the claim, we need to show that for <span class="math inline">\(t\leq T\)</span>,</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-\int_{0}^{t}(V(s))^{2}ds\right|\right] &amp; \to0\quad\text{as }\quad n\to\infty
\end{aligned}\]</span></p>
<p><span class="math inline">\(L^{1}\)</span>-convergence implies convergence in probability of the sequence <span class="math inline">\(\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}\)</span>. We now introduce the <span class="math inline">\(V^{(\epsilon)}(t)\)</span> approximation inside the absolute value as well as its corresponding integral <span class="math inline">\(I^{(\epsilon)}(t)=\int_{0}^{t}V^{(\epsilon)}(s)ds\)</span>. By the triangle inequality, we have:</p>
<p><span id="eq-quadratic-variation-of-ito-process-i"><span class="math display">\[\begin{aligned}
&amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-\int_{0}^{t}(V(s))^{2}ds\right|\right]\nonumber \\
= &amp; \mathbb{E}\left[\Biggl|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}+(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}-\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds\right.\nonumber \\
&amp; +\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\Biggr]\nonumber \\
\leq &amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I(t_{j+1})-I(t_{j}))^{2}-(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}\right|\right]+\mathbb{E}\left[\left|\sum_{j=0}^{n-1}(I^{(\epsilon)}(t_{j+1})-I^{(\epsilon)}(t_{j}))^{2}-\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds\right|\right]\\
&amp; +\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\right]\nonumber
\end{aligned} \tag{8}\]</span></span></p>
<p>We show that the first and third terms converge uniformly and that the second term goes to <span class="math inline">\(0\)</span> as <span class="math inline">\(n\to\infty\)</span>.</p>
<p>The second term goes to <span class="math inline">\(0\)</span> as <span class="math inline">\(n\to\infty\)</span> by the argument for simple processes.</p>
<p><span class="math inline">\(&lt;I^{(\epsilon)},I^{(\epsilon)}&gt;_{t}=\int_{0}^{t}V^{(\epsilon)}(s)^{2}ds\)</span>.</p>
<p>For the third term, the linearity of the integral and the Cauchy Schwarz inequality (applied to <span class="math inline">\(\mathbb{E}\int_{0}^{t}\)</span>) imply that it is:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s))^{2}ds-\int_{0}^{t}(V(s))^{2}ds\Biggr|\right] &amp; \leq\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s)-V(s))^{2}ds\Biggr|\right]^{1/2}\mathbb{E}\left[\Biggl|\int_{0}^{t}(V^{(\epsilon)}(s)+V(s))^{2}ds\Biggr|\right]^{1/2}
\end{aligned}\]</span></p>
<p>The first factor is smaller than the square root of <span class="math inline">\(\epsilon\)</span> by <a href="#eq-sequence-of-simple-processes">Equation&nbsp;7</a>, whereas the second factor is bounded.</p>
<p>The first term in equation <a href="#eq-quadratic-variation-of-ito-process-i">Equation&nbsp;8</a> is handled similarly. The linearity of the Ito integral and the Cauchy-Schwarz inequality applied to <span class="math inline">\(\mathbb{E}\left[\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}\cdot\right)\right]\)</span> give that the first term is:</p>
<p><span class="math display">\[\begin{aligned}
&amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}(V(s))^{2}dB(s)-\int_{t_{j}}^{t_{j+1}}(V^{\epsilon}(s))^{2}dB(s)\right|\right]\\
= &amp; \mathbb{E}\left[\left|\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\int_{t_{j}}^{t_{j+1}}(V(s)+V^{\epsilon}(s))dB(s)\right|\right]\\
\leq &amp; \mathbb{E}\left[\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\right]^{1/2}\mathbb{E}\left[\Biggl|\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)+V^{\epsilon}(s))dB(s)\right)^{2}\Biggr|\right]^{1/2}
\end{aligned}\]</span></p>
<p>By Ito isometry, the first factor in the above expression can be simplified:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\sum_{j=0}^{n-1}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\right]^{1/2} &amp; =\sum_{j=0}^{n-1}\mathbb{E}\left(\int_{t_{j}}^{t_{j+1}}(V(s)-V^{\epsilon}(s))dB(s)\right)^{2}\\
&amp; =\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}\mathbb{E}[(V(s)-V^{\epsilon}(s))^{2}]ds
\end{aligned}\]</span></p>
<p>By <a href="#eq-sequence-of-simple-processes">Equation&nbsp;7</a>, this factor is smaller than <span class="math inline">\(\epsilon\)</span>. The second factor equals <span class="math inline">\(\sum_{j=0}^{n-1}\int_{t_{j}}^{t_{j+1}}\mathbb{E}[(V(s)+V^{\epsilon}(s))^{2}]ds\)</span> by Ito-isometry and is uniformly bounded. This concludes the proof of the proposition. <span class="math inline">\(\blacksquare\)</span></p>
</div>
<p>Note that quadratic variation <span class="math inline">\(&lt;I,I&gt;_{t}=\int(V(s))^{2}ds\)</span> is computed path-by-path and hence the result is random. On the other the variance of the Ito integral <span class="math inline">\(Var(I(t))=\mathbb{E}[I_{t}^{2}]=\int\mathbb{E}[V_{s}^{2}]ds\)</span> is the mean value of all possible paths of the quadratic variation and hence is non-random. We are now ready to state Ito’s formula for Ito processes. We write the result in differential form for conciseness.</p>
<div id="thm-ito-formula-for-ito-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Ito’s formula for Ito processes) </strong></span>Let <span class="math inline">\((B(t):t\geq0)\)</span> be a standard brownian motion, and let <span class="math inline">\((X(t):t\geq0)\)</span> be an Ito process of the form <span class="math inline">\(dX(t)=V(t)dB(t)+D(t)dt\)</span>. Consider a function <span class="math inline">\(f(t,x)\in\mathcal{C}^{1,2}([0,T]\times\mathbf{R})\)</span>. Then we have with probability one for all <span class="math inline">\(t\leq T\)</span>:*</p>
<p><em><span class="math display">\[\begin{aligned}
df(t,X(t)) &amp; =\partial_{x}f(t,X(t))dX(t)+\partial_{t}f(t,X(t))dt+\frac{1}{2}\partial_{xx}f(t,X(t))d&lt;X,X&gt;_{t}
\end{aligned}\]</span></em></p>
<p><em>This can also be written as:</em></p>
<p><em><span class="math display">\[\begin{aligned}
df(t,X(t))= &amp; \partial_{x}f(t,X(t))V(t)dB(t)+\left[\partial_{x}f(t,X(t))D(t)+\partial_{t}f(t,X(t))+\frac{1}{2}(V(t))^{2}\partial_{xx}f(t,X(t))\right]dt
\end{aligned}\]</span></em></p>
</div>
<p>The proof of the <a href="#thm-ito-formula-for-ito-processes">Theorem&nbsp;1</a> is again a Taylor approximation with the form of the quadratic variation of the process. We will omit it.</p>
<div id="exm-ornstein-uhlenbeck-process" class="theorem example">
<p><span class="theorem-title"><strong>Example 5 </strong></span>(Ornstein-Uhlenbeck Process). Consider the Ornstein-Uhlenbeck process <span class="math inline">\((Y(t):t\geq0)\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
Y(t) &amp; =Y(0)e^{-t}+e^{-t}\int_{0}^{t}e^{s}dB(s)
\end{aligned}\]</span></p>
<p>Note that this process is an explicit function of <span class="math inline">\(t\)</span> and of the Ito process <span class="math inline">\(X(t)=Y(0)+\int_{0}^{t}e^{s}dB(s)\)</span>. Indeed, we have:</p>
<p><span class="math display">\[\begin{aligned}
Y(t) &amp; =e^{-t}X(t)
\end{aligned}\]</span></p>
<p>Let <span class="math inline">\(f(t,x)=e^{-t}x\)</span>. Then, <span class="math inline">\(f_{x}(t,x)=e^{-t}\)</span>, <span class="math inline">\(f_{xx}(t,x)=0\)</span> and <span class="math inline">\(f_{t}(t,x)=-e^{-t}x\)</span>. So, by Ito’s lemma,</p>
<p><span id="eq-ornstein-uhlenbeck-sde"><span class="math display">\[\begin{aligned}
df(t,x) &amp; =f_{t}(t,X(t))dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}\nonumber \\
dY(t) &amp; =-Y(t)dt+e^{-t}dX(t)\nonumber \\
dY(t) &amp; =-Y(t)dt+e^{-t}(e^{t}dB(t))\nonumber \\
dY(t) &amp; =-Y(t)dt+dB(t)
\end{aligned} \tag{9}\]</span></span></p>
<p>This is the SDE for the Ornstein Uhlenbeck process.</p>
<p>The SDE has a very nice interpretation: The drift is positive if <span class="math inline">\(Y(t)&lt;0\)</span> and negative if <span class="math inline">\(Y(t)&gt;0\)</span>. Moreover, the drift is proportional to the position (exactly like a spring pulling the process back to the <span class="math inline">\(x\)</span>-axis following the Hooke’s law!). This is the mechanism that ensures that the process does not venture too far from <span class="math inline">\(0\)</span> and is eventually stationary.</p>
<p>The SDE <a href="#eq-ornstein-uhlenbeck-sde">Equation&nbsp;9</a> is now easily generalized by adding two parameters for the volatility and the drift:</p>
<p><span id="eq-ornstein-uhlenbeck-sde-ii"><span class="math display">\[\begin{aligned}
dY(t) &amp; =-kY(t)dt+\sigma dB(t),\quad k\in\mathbf{R},\sigma&gt;0
\end{aligned} \tag{10}\]</span></span></p>
<p>It is not hard to check that the solution to the SDE is:</p>
<p><span id="eq-solution-to-the-ornstein-uhlenbeck-sde"><span class="math display">\[\begin{aligned}
Y(t) &amp; =Y(0)e^{-kt}+e^{-kt}\int_{0}^{t}e^{ks}\sigma dB(s)
\end{aligned} \tag{11}\]</span></span></p>
</div>
<div id="exr-the-ornstein-uhlenbeck-process-with-parameters" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1 </strong></span>The Ornstein-Uhlenbeck process with parameters. Use the Ito’s formula to show that the <a href="#eq-solution-to-the-ornstein-uhlenbeck-sde">Equation&nbsp;11</a> is the solution to the Ornstein-Uhlenbeck SDE <a href="#eq-ornstein-uhlenbeck-sde-ii">Equation&nbsp;10</a>.</p>
</div>
<p><em>Solution.</em></p>
<p>Let <span class="math inline">\(X(t)=Y(0)+\int_{0}^{t}e^{ks}\sigma dB(s)\)</span>, so <span class="math inline">\(dX(t)=e^{kt}\sigma dB(t)\)</span>. Then, <span class="math inline">\(Y(t)=e^{-kt}X(t)\)</span>. Let <span class="math inline">\(f(t,x)=e^{-kt}x\)</span>. Then, by Ito’s formula:</p>
<p><span class="math display">\[\begin{aligned}
df(t,x) &amp; =-ke^{-kt}X(t)dt+e^{-kt}dX(t)\\
dY(t) &amp; =-kY(t)dt+e^{-kt}e^{kt}\sigma dB(t)\\
dY(t) &amp; =-kY(t)dt+\sigma dB(t)
\end{aligned}\]</span></p>
<p>The latest version of Ito’s formula is another useful tool for producing martingales from a function of an Ito process. We start with two examples generalizing martingales for Brownian motion.</p>
<div id="exm-generalization-of-bt2-t" class="theorem example">
<p><span class="theorem-title"><strong>Example 6 </strong></span>(A generalization of <span class="math inline">\((B(t))^{2}-t\)</span>). Let <span class="math inline">\((V(t):t\leq T)\)</span> be a process in <span class="math inline">\(\mathcal{L}_{c}^{2}(T)\)</span>. Consider an Ito process <span class="math inline">\((X(t):t\leq T)\)</span> given by <span class="math inline">\(dX(t)=V(t)dB(t)\)</span>. Note that <span class="math inline">\(((X(t))^{2}:t\leq T)\)</span> is a submartingale by Jensen’s inequality, since <span class="math inline">\(\mathbb{E}[X^{2}(t)|\mathcal{F}_{s}]\geq(\mathbb{E}[X(t)|\mathcal{F}_{s})^{2}=X^{2}(s)\)</span>. We show that the compensated process</p>
<p><span class="math display">\[\begin{aligned}
M(t) &amp; =X^{2}(t)-\int_{0}^{t}V^{2}(s)ds,\quad t\leq T
\end{aligned}\]</span></p>
<p>is a martingale for the Brownian filtration. (This is another instance of the Doob-Meyer decomposition). By the Ito’s formula for <span class="math inline">\(f(x)=x^{2}\)</span>, we have:</p>
<p><span class="math display">\[\begin{aligned}
df(x) &amp; =f_{x}(X(t)dX(t)+\frac{1}{2}f_{xx}(X(t))d&lt;X,X&gt;_{t}\\
&amp; =2X(t)dX(t)+(V(t))^{2}dt\\
df(X(t)) &amp; =2X(t)V(t)dB(t)+(V(t))^{2}dt
\end{aligned}\]</span></p>
<p>In Integral form this implies:</p>
<p><span class="math display">\[\begin{aligned}
(X(t))^{2} &amp; =(X(0))^{2}+2\int_{0}^{t}X(s)V(s)dB(s)+\int_{0}^{t}(V(s))^{2}ds\\
M(t)=(X(t))^{2}-\int_{0}^{t}(V(s))^{2}ds &amp; =(X(0))^{2}+2\int_{0}^{t}X(s)V(s)dB(s)
\end{aligned}\]</span></p>
<p>We conclude that <span class="math inline">\((M(t):t\leq T)\)</span> is a martingale, provided <span class="math inline">\(X(t)V(t)\in L_{c}^{2}(T)\)</span>.</p>
<p>There is another more direct way to prove that <span class="math inline">\((M(t):t\leq T)\)</span> is a martingale whenever <span class="math inline">\((V(t):t\leq T)\in\mathcal{L}_{c}^{2}(T)\)</span>. This is by using increments: for <span class="math inline">\(t'&lt;t\leq T\)</span>,</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[X_{t'}^{2}|\mathcal{F}_{t}] &amp; =\mathbb{E}[(X_{t}+(X_{t'}-X_{t}))^{2}|\mathcal{F}_{t}]\\
&amp; =\mathbb{E}[X_{t}^{2}+2X_{t}(X_{t'}-X_{t})+(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}]\\
&amp; =X_{t}^{2}+2X_{t}\mathbb{E}[X_{t'}-X_{t}|\mathcal{F}_{t}]+\mathbb{E}[(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}]
\end{aligned}\]</span></p>
<p>Since <span class="math inline">\((X_{t}:t\geq0)\)</span> is a martingale, <span class="math inline">\(\mathbb{E}[(X_{t'}-X_{t})|M_{t}]=0\)</span>, so the middle term equals zero and we are left with:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[X_{t'}^{2}|\mathcal{F}_{t}] &amp; =X_{t}^{2}+\mathbb{E}[(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}]
\end{aligned}\]</span></p>
<p>By conditional Ito Isometry,</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[(X_{t'}-X_{t})^{2}|\mathcal{F}_{t}] &amp; =\int_{0}^{t'}V_{s}^{2}ds-\int_{0}^{t}V_{s}^{2}ds=\int_{t}^{t'}V_{s}^{2}ds
\end{aligned}\]</span></p>
</div>
<div id="exm-generalization-of-gbm" class="theorem example">
<p><span class="theorem-title"><strong>Example 7 </strong></span>(A generalization of the geometric Brownian motion). Let <span class="math inline">\(\sigma(t)\)</span> be a continuous, deterministic function such that <span class="math inline">\(|\sigma(t)|\leq1\)</span>, <span class="math inline">\(t\in[0,T]\)</span>. The process</p>
<p><span class="math display">\[\begin{aligned}
M(t) &amp; =\exp\left(\int_{0}^{t}\sigma(s)dB(s)-\frac{1}{2}\int_{0}^{t}\sigma^{2}(s)ds\right),\quad t\leq T
\end{aligned}\]</span></p>
<p>is a martingale for the Brownian filtration. To see this, note that we can write <span class="math inline">\(M(t)=f(t,X(t))\)</span> where <span class="math inline">\(f(t,x)=\exp(x-\frac{1}{2}\int\sigma^{2}(s)ds)\)</span> and <span class="math inline">\(X(t)=\int_{0}^{t}\sigma(s)dB(s)\)</span>, so <span class="math inline">\(dX(t)=\sigma(t)dB(t)\)</span>. Ito’s formula gives:</p>
<p><span class="math display">\[\begin{aligned}
df(t,x) &amp; =f_{t}(t,X(t)dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}\\
dM(t) &amp; =-\frac{1}{2}\sigma^{2}(t)M(t)dt+M(t)\sigma(t)dB(t)+\frac{1}{2}M(t)\sigma^{2}(t)dt\\
&amp; =M(t)\sigma(t)dB(t)\\
M(t) &amp; =M(0)+\int_{0}^{t}M(s)\sigma(s)dB(s)
\end{aligned}\]</span></p>
<p>Observe also that:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}[M_{t}^{2}] &amp; =e^{-\int_{0}^{t}\sigma^{2}(s)ds}\mathbb{E}[e^{2\int_{0}^{t}\sigma(s)dB(s)}]=e^{\int_{0}^{t}\sigma^{2}(s)ds}
\end{aligned}\]</span></p>
<p>since <span class="math inline">\(\int_{0}^{t}\sigma(s)dB(s)\)</span> is a Gaussian random variable with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\int_{0}^{t}\sigma^{2}(s)ds\)</span>.</p>
<p>We conclude from the equation that <span class="math inline">\((M(t),t\geq0)\)</span> is a martingale.</p>
</div>
<div id="exm-martingales-of-gbm" class="theorem example">
<p><span class="theorem-title"><strong>Example 8 </strong></span>(Martingales of Geometric Brownian Motion). Let</p>
<p><span class="math display">\[\begin{aligned}
S(t) &amp; =S(0)\exp(\sigma B(t)-\sigma^{2}t/2)
\end{aligned}\]</span></p>
<p>be a geometric brownian motion. We find a PDE satisfied by <span class="math inline">\(f(t,x)\)</span> for <span class="math inline">\(f(t,S(t))\)</span> to be a martingale. It suffices to apply Ito’s formula of <a href="#thm-ito-formula-for-ito-processes">Theorem&nbsp;1</a>. We get:</p>
<p><span class="math display">\[\begin{aligned}
df(t,S(t)) &amp; =f_{t}(t,S(t))dt+f_{x}(t,S(t))dS(t)+\frac{1}{2}f_{xx}(t,S(t))dS(t)\cdot dS(t)
\end{aligned}\]</span></p>
<p>Now note from the earlier result that <span class="math inline">\(dS(t)=S(t)\sigma dB(t)\)</span>. So, <span class="math inline">\(dS(t)\cdot dS(t)=\frac{1}{2}\sigma^{2}(S(t))^{2}dt\)</span>. So,</p>
<p><span class="math display">\[\begin{aligned}
df(t,S(t)) &amp; =\left\{ \frac{\partial f}{\partial t}+\frac{1}{2}\sigma^{2}(S(t))^{2}\frac{\partial^{2}f}{\partial x^{2}}\right\} dt+\sigma S(t)\frac{\partial f}{\partial x}dB(t)
\end{aligned}\]</span></p>
<p>Finally, the PDE for <span class="math inline">\(f(t,x)\)</span> is obtained by setting the factor in front of <span class="math inline">\(dt\)</span> to <span class="math inline">\(0\)</span>, because we want <span class="math inline">\(f\)</span> to be a martingale process. It is important to keep in mind, that the PDE should always be written in terms of the time variable <span class="math inline">\(t\)</span> and the space variable <span class="math inline">\(x\)</span>. Therefore, the PDE of <span class="math inline">\(f\)</span> as a function of time and space is:</p>
<p><span class="math display">\[\begin{aligned}
\frac{1}{2}\sigma^{2}x^{2}\frac{\partial^{2}f}{\partial x^{2}}(t,x)+\frac{\partial f}{\partial t}(t,x) &amp; =0
\end{aligned}\]</span></p>
<p>No more randomness appears in the PDE!</p>
</div>
<p>Here is a specific case where we can apply the Ito’s formula to construct martingales of Ito processes.</p>
<div id="exm-martingale-1" class="theorem example">
<p><span class="theorem-title"><strong>Example 9 </strong></span>Consider the process given by the SDE:</p>
<p><span class="math display">\[\begin{aligned}
dX(t) &amp; =X(t)dB(t),\quad X(0)=2
\end{aligned}\]</span></p>
<p>Let’s find a PDE for which <span class="math inline">\(f(t,X(t))\)</span> is a martingale for the Brownian filtration. We have by Ito’s formula that:</p>
<p><span class="math display">\[\begin{aligned}
df(t,X(t)) &amp; =f_{t}(t,X(t))dt+f_{x}(t,X(t))dX(t)+\frac{1}{2}f_{xx}(t,X(t))d&lt;X,X&gt;_{t}\\
&amp; =\left(\frac{\partial f}{\partial t}+\frac{1}{2}(X(t))^{2}\frac{\partial^{2}f}{\partial x^{2}}\right)dt+X(t)\frac{\partial f}{\partial x}dB(t)
\end{aligned}\]</span></p>
<p>Setting the drift term to <span class="math inline">\(0\)</span> gives the PDE:</p>
<p><span class="math display">\[\begin{aligned}
\frac{\partial f}{\partial t}+\frac{1}{2}x^{2}\frac{\partial^{2}f}{\partial x^{2}} &amp; =0
\end{aligned}\]</span></p>
<p>It is then easy to check that <span class="math inline">\(X(t)\)</span> is a martingale and so is <span class="math inline">\(t+\log(X(t))^{2}\)</span>, since the functions <span class="math inline">\(f(t,x)=x\)</span> and <span class="math inline">\(f(t,x)=t+\log x^{2}\)</span> satisfy the PDE. However, the process <span class="math inline">\(tX(t)\)</span> is not, as the function <span class="math inline">\(f(t,x)=xt\)</span> is not a solution of the PDE.</p>
</div>
</section>
<section id="multivariate-extension." class="level2">
<h2 class="anchored" data-anchor-id="multivariate-extension.">Multivariate Extension.</h2>
<p>Ito’s formula can be generalized to several Ito processes. Let’s start by stating an example of a function of two Ito processes. Such a function <span class="math inline">\(f(x_{1},x_{2})\)</span> will be a function of two space variables. Not surprisingly, it needs to have two derivatives in each variable and they need to be a continuous function; we need <span class="math inline">\(f\in\mathcal{C}^{2\times2}(\mathbf{R}\times\mathbf{R})\)</span>.</p>
<div id="thm-ito-formula-for-many-ito-processes" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Ito’s formula for many Ito processes) </strong></span>Let <span class="math inline">\((X(t):t\geq0)\)</span> and (Y(t):t)$ be two Ito processes of the form:</p>
<p><span id="eq-two-ito-processes"><span class="math display">\[\begin{aligned}
dX(t) &amp; =V(t)dB(t)+D(t)dt\nonumber \\
dY(t) &amp; =U(t)dB(t)+R(t)dt
\end{aligned} \tag{12}\]</span></span></p>
<p>where <span class="math inline">\((B(t):t\geq0)\)</span> is a standard Brownian motion. Then, for <span class="math inline">\(f\in\mathcal{C}^{2\times2}(\mathbf{R}\times\mathbf{R})\)</span>, we have:</p>
<p><span class="math display">\[\begin{aligned}
df(X(t),Y(t)) &amp; =f_{x}(X(t),Y(t))dX(t)+f_{y}(X(t),Y(t))dY(t)+\frac{1}{2}f_{xx}(X(t),Y(t))d&lt;X,X&gt;_{t}\\
&amp; +f_{xy}(X(t),Y(t))d&lt;X,Y&gt;_{t}+\frac{1}{2}f_{yy}(X(t),Y(t))d&lt;Y,Y&gt;_{t}
\end{aligned}\]</span></p>
</div>
<p>The idea of the proof is the same as in <a href="#thm-ito-formula-for-ito-processes">Theorem&nbsp;1</a> : Taylor’s expansion and quadratic variation, together with the cross-variation of two processes.</p>
<p><span class="math display">\[\begin{aligned}
dX(t)\cdot dY(t) &amp; =(V(t)dB(t)+D(t)dt)(U(t)dB(t)+R(t)dt)\\
&amp; =U(t)V(t)dt
\end{aligned}\]</span></p>
<div id="exm-product-rule" class="theorem example">
<p><span class="theorem-title"><strong>Example 10 </strong></span>(Product Rule) An important example of this formula is Ito’s product rule. Let <span class="math inline">\(X(t)\)</span> and <span class="math inline">\(Y(t)\)</span> be as in <a href="#eq-two-ito-processes">Equation&nbsp;12</a>. Then:</p>
<p><span class="math display">\[\begin{aligned}
d(X(t)Y(t)) &amp; =Y(t)dX(t)+X(t)dY(t)+dX(t)\cdot dY(t)
\end{aligned}\]</span></p>
</div>
<div id="exr-a-riemann-integral" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2 </strong></span>Let <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> be a probability space and let <span class="math inline">\((B_{t}:t\geq0)\)</span> be a standard brownian motion. Using integration by parts, show that</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}B(s)ds &amp; =\int_{0}^{t}(t-s)dB(s)
\end{aligned}\]</span></p>
<p>and prove that <span class="math inline">\(\int_{0}^{t}B(s)ds\sim\mathcal{N}(0,t^{3}/3)\)</span>.</p>
<p>Is</p>
<p><span class="math display">\[\begin{aligned}
X(t) &amp; =\begin{cases}
0 &amp; t=0\\
\frac{\sqrt{3}}{t}\int_{0}^{t}B(s)ds &amp; t&gt;0
\end{cases}
\end{aligned}\]</span></p>
<p>a standard Wiener process?</p>
<p><em>Solution.</em></p>
<p>Clearly, <span class="math inline">\(B(s,\omega)\)</span> is a random variable and the Riemann integral <span class="math inline">\(\int_0^t B(s,\omega)ds\)</span> depends on the sample path <span class="math inline">\(\omega\)</span>. So, <span class="math inline">\((\int_0^t B_s ds, t\leq T)\)</span> is a stochastic process. Using integration by parts:</p>
<p><span class="math display">\[\begin{aligned}
\int u\left(\frac{dv}{ds}\right)ds &amp; =uv-\int v\left(\frac{du}{ds}\right)ds
\end{aligned}\]</span></p>
<p>We set <span class="math inline">\(u=B(s)\)</span> and <span class="math inline">\(dv/ds=1\)</span>. Then:</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}B(s)ds &amp; =sB(s)|_{0}^{t}-\int_{0}^{t}sdB(s)\\
&amp; =tB(t)-\int_{0}^{t}sdB(s)\\
&amp; =\int_{s=0}^{s=t}tdB(s)-\int_{0}^{t}sdB(s)\\
&amp; =\int_{0}^{t}(t-s)dB(s)
\end{aligned}\]</span></p>
<p>Thus, <span class="math inline">\(\int_{0}^{t}B(s)ds\)</span> is a Gaussian random variable with:</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\int_{0}^{t}B(s)ds\right] &amp; =\mathbb{E}\left[\int_{0}^{t}(t-s)dB(s)\right]\\
&amp; =0
\end{aligned}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{aligned}
\mathbb{E}\left[\left(\int_{0}^{t}B(s)ds\right)^{2}\right] &amp; =\int_{0}^{t}(t-s)^{2}ds\\
&amp; =\left.\frac{(t-s)^{3}}{-3}\right|_{0}^{t}\\
&amp; =\frac{t^{3}}{3}
\end{aligned}\]</span></p>
<p>Thus, using the properties of Ito Integral, <span class="math inline">\(\int_{0}^{t}B(s)ds=\int_{0}^{t}(t-s)dB(s)\)</span> is a martingale. Now the quadratic variation <span class="math inline">\(&lt;M,M&gt;_{t}=0\)</span>, and this can be a bit tricky. Remember, <span class="math inline">\(\left\langle \int_{0}^{t}f(s,B_{s})dB(s),\int_{0}^{t}f(s,B_{s})dB(s)\right\rangle =\int_{0}^{t}f^{2}(s,B_{s})ds\)</span> if and only if <span class="math inline">\(f\)</span> is a function of the time <span class="math inline">\(s\)</span> and the position of the Brownian motion <span class="math inline">\(B(s)\)</span>. Since, <span class="math inline">\(f\)</span> is a function of <span class="math inline">\(t\)</span> as well, this rule cannot be applied.</p>
<p>By first principles, we can show that, the quadratic variation is indeed <span class="math inline">\(0\)</span>: <span class="math display">\[\begin{aligned}
\lim_{n\to\infty}\mathbb{E}\left[\sum_{j=0}^{n-1}\left(I(t_{j+1})-I(t_{j})\right)^{2}\right] &amp; =\lim_{n\to\infty}\mathbb{E}\left[\sum_{j=0}^{n-1}B_{t_{j}}^{2}(t_{j+1}-t_{j})^{2}\right]\\
&amp; =\lim_{n\to\infty}\max_{1\leq j\leq n}|t_{j+1}-t_{j}|\cdot\mathbb{E}\left[\sum_{j=0}^{n-1}B_{t_{j}}^{2}(t_{j+1}-t_{j})\right]
\end{aligned}\]</span></p>
<p>Since the paths of <span class="math inline">\(B_{t}\)</span> are continuous, so are the paths <span class="math inline">\(B_{t}^{2}\)</span> on the compact interval <span class="math inline">\([0,t]\)</span>. So, <span class="math inline">\((B_{s}^{2},s\in[0,t])\)</span> is uniformly bounded. Thus, the expectation term is bounded. As <span class="math inline">\(n\to\infty\)</span>, the mesh size approaches zero, and consequently the quadratic variation approaches zero.</p>
</div>
<div id="exm-something-that-is-not-a-martingale" class="theorem example">
<p><span class="theorem-title"><strong>Example 11 </strong></span>Let <span class="math inline">\(X_{t}=\int_{0}^{t}B_{s}dB_{s}\)</span> and <span class="math inline">\(Y_{t}=\int_{0}^{t}B_{s}^{2}dB_{s}\)</span>. Is <span class="math inline">\((X_{t}Y_{t},t\geq0)\)</span> a martingale?</p>
</div>
<p><em>Solution.</em></p>
<p>By Ito’s product rule, we have:</p>
<p><span class="math display">\[\begin{aligned}
d(X_{t}Y_{t}) &amp; =X_{t}dY_{t}+Y_{t}dX_{t}+dX_{t}\cdot dY_{t}\\
&amp; =X_{t}B_{s}^{2}dB_{s}+Y_{t}B_{s}dB_{s}+(B_{s}dB_{s})\cdot(B_{s}^{2}dB_{s})\\
&amp; =X_{t}B_{s}^{2}dB_{s}+Y_{t}B_{s}dB_{s}+B_{s}^{3}dt\\
X_{t}Y_{t} &amp; =X_{0}Y_{0}+\int_{0}^{t}X_{t}B_{s}^{2}dB_{s}+\int_{0}^{t}Y_{t}B_{s}dB_{s}+\int_{0}^{t}B_{s}^{3}dt
\end{aligned}\]</span></p>
<p>The term in <span class="math inline">\(dt\)</span> is not zero, so the product cannot be a martingale.</p>
<div id="exm-generalization-of-gbm-ii" class="theorem example">
<p><span class="theorem-title"><strong>Example 12 </strong></span>(A generalization of Geometric Brownian Motion). Consider <span class="math inline">\((\int_{0}^{t}V_{s}dB_{s},t\geq0)\)</span> an Ito process. Define the positive process:</p>
<p><span id="eq-generalization-of-gbm"><span class="math display">\[\begin{aligned}
M_{t} &amp; =\exp\left(\int_{0}^{t}V_{s}dB_{s}-\frac{1}{2}\int_{0}^{t}V_{s}^{2}ds\right),\quad t\geq0
\end{aligned} \tag{13}\]</span></span></p>
</div>
<p><em>Solution.</em></p>
<p>Ito’s formula applied to the processes <span class="math inline">\(X_{t}=\int_{0}^{t}V_{s}dB_{s}\)</span> and <span class="math inline">\(Y_{t}=\frac{1}{2}\int_{0}^{t}V_{s}^{2}ds\)</span> with the function <span class="math inline">\(f(x,y)=e^{x-y}\)</span> yields:</p>
<p><span class="math display">\[\begin{aligned}
df(x,y) &amp; =f_{x}(X_{t},Y_{t})dX_{t}+f_{y}(X_{t},Y_{t})dY_{t}\\
&amp; +\frac{1}{2}f_{xx}(X_{t},Y_{t})dX_{t}\cdot dX_{t}+\frac{1}{2}f_{yy}(X_{t},Y_{t})dY_{t}\cdot dY_{t}\\
&amp; +f_{xy}(X_{t},Y_{t})dX_{t}\cdot dY_{t}
\end{aligned}\]</span></p>
<p>Now, all first and second order derivatives are <span class="math inline">\(\partial_{x}(e^{x-y})=M_{t}\)</span>, <span class="math inline">\(\partial_{y}(e^{x-y})=-e^{x-y}=-M_{t}\)</span>, <span class="math inline">\(\partial_{xx}(e^{x-y})=M_{t}\)</span></p>
<p><span class="math inline">\(dX_{t}=V_{t}dB_{t}\)</span>. <span class="math inline">\(dY_{t}=\frac{1}{2}V_{t}^{2}dt\)</span>.</p>
<p><span class="math inline">\(dX_{t}\cdot dX_{t}=V_{t}^{2}dt\)</span>, <span class="math inline">\(dX_{t}\cdot dY_{t}=0\)</span>,</p>
<p><span class="math inline">\(dY_{t}\cdot dY_{t}=0\)</span>.</p>
<p>Consequently, we have:</p>
<p><span class="math display">\[\begin{aligned}
dM_{t} &amp; =M_{t}V_{t}dB_{t}-\frac{1}{2}M_{t}V_{t}^{2}dt\\
&amp; +\frac{1}{2}M_{t}V_{t}^{2}dt\\
&amp; =M_{t}V_{t}dB_{t}
\end{aligned}\]</span></p>
<p>Thus, <span class="math inline">\((M_{t},t\geq0)\)</span> is a martingale.</p>
<div id="exr-generalized-ito-integral" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3 </strong></span>(Generalized Ito Integral). Let <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span> be a probability space and let <span class="math inline">\((B_{t}:t\geq0)\)</span> be a standard brownian motion. Given that <span class="math inline">\(f\)</span> is a simple process, show that:</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}f(s,B_{s})dB_{s} &amp; =B_{t}f(t,B_{t})-\int_{0}^{t}\left[B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}B_{s}\frac{\partial^{2}f}{\partial x^{2}}\right]ds\\
&amp; -\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{aligned}
\int_{0}^{t}f(s,B_{s})ds &amp; =tf(t,B_{t})-\int_{0}^{t}s\left[\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right]ds-\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
</div>
<p><em>Solution.</em></p>
<p>I suppress <span class="math inline">\((t,B_{t})\)</span> for simplicity. Applying the product rule to <span class="math inline">\(B_{t}f\)</span>, we get:</p>
<p><span class="math display">\[\begin{aligned}
d(B_{t}f) &amp; =fdB_{t}+B_{t}df+dB_{t}\cdot df\\
&amp; =fdB_{t}+B_{t}\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; +dB_{t}\cdot\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; =fdB_{t}+\left(B_{t}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}B_{t}\right)dt+B_{t}\frac{\partial f}{\partial x}dB_{t}\\
B_{t}f &amp; =\int_{0}^{t}fdB_{s}+\int_{0}^{t}\left(B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}B_{s}\right)ds+\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}\\
\int_{0}^{t}fdB_{s} &amp; =B_{t}f-\int_{0}^{t}\left(B_{s}\frac{\partial f}{\partial t}+\frac{\partial f}{\partial x}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}B_{s}\right)ds-\int_{0}^{t}B_{s}\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
<p>Applying product rule to <span class="math inline">\(tf(t,B_{t})\)</span>, we get:</p>
<p><span class="math display">\[\begin{aligned}
d(tf) &amp; =fdt+tdf+dt\cdot df\\
&amp; =fdt+t\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; +dt\left(\frac{\partial f}{\partial t}dt+\frac{\partial f}{\partial x}dB_{t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}(dB_{t})^{2}\right)\\
&amp; =fdt+t\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)dt+t\frac{\partial f}{\partial x}dB_{t}\\
tf &amp; =\int_{0}^{t}fds+\int_{0}^{t}s\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)ds+\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}\\
\int_{0}^{t}fds &amp; =tf-\int_{0}^{t}s\left(\frac{\partial f}{\partial t}+\frac{1}{2}\frac{\partial^{2}f}{\partial x^{2}}\right)ds-\int_{0}^{t}s\frac{\partial f}{\partial x}dB_{s}
\end{aligned}\]</span></p>
<p>The following example will be important when we discuss the Girsanov theorem.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>