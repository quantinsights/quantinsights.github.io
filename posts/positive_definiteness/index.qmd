
---
title: "Positive Definiteness"
author: "Quasar"
date: "2024-06-10"
categories: [Linear Algebra]      
image: "image.jpg"
toc: true
toc-depth: 3
---

## Positive Definite Matrices

*Definition*. A real-valued matrix $A$ is *positive-definite* (written as $A \succ 0$), if for every real valued vector $\mathbf{x}$, the quadratic form

\begin{align*}
q(\mathbf{x}) = \mathbf{x}^T A \mathbf{x} > 0
\end{align*}

The matrix $A$ is positive semi-definite (written as $A \succeq 0$) if :

\begin{align*}
q(\mathbf{x}) = \mathbf{x}^T A \mathbf{x} \geq 0
\end{align*}

$\forall \mathbf{x} \in \mathbf{R}^n$.

Intuitively, positive definite matrices are like strictly positive real numbers. Consider a scalar $a > 0$. The sign of $ax$ will depend on the sign of $x$. And $x\cdot ax > 0$. However, if $a < 0$, multiplying it with $x$ will flip the sign, so $x$ and $ax$ have opposite signs and $x \cdot ax < 0$. 

If $A \succ 0$, then by definition $\mathbf{x}^T A \mathbf{x} > 0$ for all $\mathbf{x} \in \mathbf{R}^n$. Thus, the vector $\mathbf{x}$ and it's transformed self $A\mathbf{x}$ should make an angle $\theta \in \left[-\frac{\pi}{2},\frac{\pi}{2}\right]$. Both $\mathbf{x}$ and $A\mathbf{x}$ lie on the same side of the hyperplane $\mathbf{x}^{\perp}$.

```{python}
%load_ext itikz
```

```{python}
# | code-fold: true
# | code-summary: "Show the code"
%%itikz --temp-dir --tex-packages=tikz --tikz-libraries=arrows --implicit-standalone
\begin{tikzpicture}[scale=1.5]
\draw [->] (-2,0) -- (6,0) node [below] {\huge $x_1$};
\draw [->] (0,-2) -- (0,6) node [above] {\huge $x_2$};
\draw [->] (0,0) -- (3,1) node [above] {\huge $\mathbf{x}$};
\draw [->] (0,0) -- (2,5) node [above] {\huge $A\mathbf{x}$};
\draw [dashed] (-2,6) -- (1,-3) node [] {\huge $\mathbf{x}^{\perp}$};
\draw[draw=green!50!black,thick] (1,1/3) arc (18.43:68.19:1) node [midway,above] {\huge $\theta$};
\end{tikzpicture}
```

## Convex functions

There is a second geometric way to think about positive definite matrices : a quadratic form is convex when the matrix is symmetric and positive definite.

*Definition.* (Convex function) A function $f:\mathbf{R}^n \to \mathbf{R}$ is *convex*, if for all $\mathbf{x},\mathbf{y}\in \mathbf{R}^n$ and $0 \leq \lambda \leq 1$, we have:

\begin{align*}
f(\lambda \mathbf{x} + (1-\lambda)\mathbf{y}) \leq \lambda f(\mathbf{x}) + (1-\lambda) f(\mathbf{y}) \tag{1}
\end{align*}

*Proposition.* Assume that the function $f:\mathbf{R}^n \to \mathbf{R}$ is differentiable. Then, $f$ is convex, if and only if, for all $\mathbf{x},\mathbf{y} \in \mathbf{R}^n$, the inequality

\begin{align*}
f(\mathbf{y}) \geq f(\mathbf{x}) + \nabla f(\mathbf{y})^T (\mathbf{y} - \mathbf{x}) \tag{2}
\end{align*}

is satisfied.

*Proof.*

$\Longrightarrow$ direction.

Assume that $f$ is convex and let $\mathbf{x} \neq \mathbf{y} \in \mathbf{R}^n$. The convexity of $f$ implies that:

\begin{align*}
f((\mathbf{x} + \mathbf{y})/2) \leq \frac{1}{2}f(\mathbf{x}) + \frac{1}{2}f(\mathbf{y}) 
\end{align*}

Denote now $\mathbf{h} = \mathbf{y}-\mathbf{x}$. Then this inequality reads:

\begin{align*}
f(\mathbf{x} + \mathbf{h}/2) \leq \frac{1}{2} f(\mathbf{x}) + \frac{1}{2}f(\mathbf{x} + \mathbf{h}) 
\end{align*}

Using elementary transformations, we have:

\begin{align*}
\frac{f(\mathbf{x} + \mathbf{h}/2)}{1/2} &\leq f(\mathbf{x}) + f(\mathbf{x} + \mathbf{h}) \\
f(\mathbf{x} + \mathbf{h}) - f(\mathbf{x}) &\geq \frac{f(\mathbf{x} + \mathbf{h}/2) - f(\mathbf{x})}{1/2} 
\end{align*}

Repeating this line of argumentation:

\begin{align*}
f(\mathbf{x} + \mathbf{h}) - f(\mathbf{x}) \geq \frac{f(\mathbf{x} + \mathbf{h}/2) - f(\mathbf{x})}{1/2} \geq \frac{f(\mathbf{x} + \mathbf{h}/4) - f(\mathbf{x})}{1/4}
\end{align*}

Consequently,

\begin{align*}
f(\mathbf{x} + \mathbf{h}) - f(\mathbf{x}) \geq \frac{f(\mathbf{x} + 2^{-k}\mathbf{h}) - f(\mathbf{x})}{2^{-k}} \tag{2}
\end{align*}

By the order limit theorem,

\begin{align*}
f(\mathbf{x} + \mathbf{h}) - f(\mathbf{x}) \geq \lim_{k \to \infty}\frac{f(\mathbf{x} + 2^{-k}\mathbf{h}) - f(\mathbf{x})}{2^{-k}} = D_{\mathbf{h}}f(\mathbf{x}) = \nabla f(\mathbf{x}) \cdot (\mathbf{y} - \mathbf{x}) 
\end{align*}

Replacing $\mathbf{y}-\mathbf{x}$ by $\mathbf{h}$, we have:

\begin{align*}
f(\mathbf{y}) \geq f(\mathbf{x}) + \nabla f(\mathbf{x})^T (\mathbf{y} - \mathbf{x})
\end{align*}

$\Longleftarrow$ direction.

Let $\mathbf{w}, \mathbf{z} \in \mathbf{R}^n$. Moreover, denote:

\begin{align*}
\mathbf{x} := \lambda \mathbf{w} + (1-\lambda)\mathbf{z}
\end{align*}

Then, the inequality in (1) implies that:

\begin{align*}
f(\mathbf{w}) &\geq f(\mathbf{x}) + \nabla f(\mathbf{x})^T (\mathbf{w} - \mathbf{x})\\
f(\mathbf{z}) &\geq f(\mathbf{x}) + \nabla f(\mathbf{x})^T (\mathbf{z} - \mathbf{x}) \tag{3}
\end{align*}

Note moreover that:

\begin{align*}
\mathbf{w} - \mathbf{x} &= (1-\lambda)(\mathbf{w}-\mathbf{z})\\
\mathbf{z} - \mathbf{x} &= \lambda(\mathbf{z}-\mathbf{w})
\end{align*}

Thus, if we multiply the first line in (3) with $\lambda$ and the second line with $(1-\lambda)$ and then add the two inequalities, we obtain:

\begin{align*}
\lambda f(\mathbf{w}) + (1-\lambda)f(\mathbf{z}) &\geq f(\mathbf{x}) + \nabla f(\mathbf{x})[\lambda(1-\lambda)(\mathbf{w} - \mathbf{z} + \mathbf{z} - \mathbf{w})\\
&=f(\lambda \mathbf{w} + (1-\lambda)\mathbf{z})
\end{align*}

Since $\mathbf{w}$ and $\mathbf{z}$ were arbitrary, this proves the convexity of $f$. 

The convexity of a differentiable function can either be characterized by the fact that all secants lie above the graph or that all tangents lie below the graph.

*Corollary*. Assume that $f:\mathbf{R}^n \to \mathbf{R}$ is convex and differentiable. Then $\mathbf{x}*$ is a global minimizer of $f$, if and only if $\nabla f(\mathbf{x}^{*}) = 0$.

*Proof*.



